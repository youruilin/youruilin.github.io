<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>GitHub实现自动部署时所需的密钥对总结</title>
      <link href="/posts/eacf83d3/"/>
      <url>/posts/eacf83d3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><p>需要 <strong>区分「GitHub 平台用的公钥」</strong> 和 <strong>「你为部署远程服务器所生成的 SSH 密钥对」</strong>，两者<strong>本质不同、作用也不同</strong>。我们来详细解释清楚：</p><hr><h2 id="🧩-一、GitHub-中确实存在公钥，但用途不同"><a href="#🧩-一、GitHub-中确实存在公钥，但用途不同" class="headerlink" title="🧩 一、GitHub 中确实存在公钥，但用途不同"></a>🧩 一、GitHub 中确实存在公钥，但用途不同</h2><p>GitHub 上有两种跟「SSH 公钥」相关的机制：</p><h3 id="✅-1-用户-SSH-公钥（用于-git-clone-push）"><a href="#✅-1-用户-SSH-公钥（用于-git-clone-push）" class="headerlink" title="✅ 1. 用户 SSH 公钥（用于 git clone/push）"></a>✅ 1. <strong>用户 SSH 公钥</strong>（用于 git clone/push）</h3><p>你可以在 GitHub 的个人设置页面中添加「SSH 公钥」：</p><ul><li>位置：<code>Settings → SSH and GPG keys → New SSH key</code></li><li>作用：允许你从本地用 SSH 协议 <code>git clone git@github.com:xxx.git</code> 或 <code>git push</code>。</li></ul><p>💡<strong>这个公钥用于你「连接 GitHub 仓库」，而不是连接服务器。</strong></p><hr><h3 id="✅-2-部署密钥（Deploy-Keys）"><a href="#✅-2-部署密钥（Deploy-Keys）" class="headerlink" title="✅ 2. 部署密钥（Deploy Keys）"></a>✅ 2. <strong>部署密钥（Deploy Keys）</strong></h3><ul><li>针对某个仓库设置，用于「只读」或「读写」的方式，赋予 CI 或服务器访问 GitHub 仓库权限。</li><li>存储在仓库页面的：<ul><li><code>Settings → Deploy keys</code></li></ul></li><li>比如有些服务器想要直接从 GitHub 拉代码（<code>git pull</code>），就可以在这里添加公钥。</li></ul><hr><h2 id="🔐-二、你部署远程服务器的密钥是另一套"><a href="#🔐-二、你部署远程服务器的密钥是另一套" class="headerlink" title="🔐 二、你部署远程服务器的密钥是另一套"></a>🔐 二、你部署远程服务器的密钥是另一套</h2><p>你现在的目标是：</p><blockquote><p>✨ 用 GitHub Actions 自动将构建产物上传到远程服务器（如 Ubuntu 的 <code>/www/vitepress</code>）</p></blockquote><p>这件事需要 GitHub Actions「通过 SSH 登录你自己的服务器」，而这个连接也需要 SSH 公钥-私钥机制，但：</p><ul><li><strong>这套密钥不是 GitHub 用户自己的公钥</strong></li><li><strong>也不是部署密钥</strong></li><li>而是 <strong>你本地用 <code>ssh-keygen</code> 自己生成的一对密钥</strong></li></ul><p>👇具体怎么用：</p><div class="table-container"><table><thead><tr><th>文件</th><th>存放位置</th><th>用途</th></tr></thead><tbody><tr><td>私钥（如 <code>github_actions_key</code>）</td><td>粘贴进 GitHub Secrets 中（变量名如 <code>SSH_PRIVATE_KEY</code>）</td><td>GitHub Actions 使用</td></tr><tr><td>公钥（如 <code>github_actions_key.pub</code>）</td><td>放入你远程服务器的 <code>~/.ssh/authorized_keys</code></td><td>服务器验证身份</td></tr></tbody></table></div><hr><h2 id="✅-举个完整的例子帮你理清"><a href="#✅-举个完整的例子帮你理清" class="headerlink" title="✅ 举个完整的例子帮你理清"></a>✅ 举个完整的例子帮你理清</h2><div class="table-container"><table><thead><tr><th>目的</th><th>公钥存放位置</th><th>私钥使用位置</th></tr></thead><tbody><tr><td>从你本地 <code>git push</code> 到 GitHub</td><td>GitHub 设置页面的「SSH keys」</td><td>你自己本地电脑</td></tr><tr><td>GitHub Actions 构建后上传到服务器</td><td>服务器上的 <code>~/.ssh/authorized_keys</code></td><td>GitHub Secrets（私钥变量）</td></tr><tr><td>远程服务器想从 GitHub 拉代码</td><td>GitHub 仓库的「Deploy Key」</td><td>远程服务器</td></tr></tbody></table></div><hr><h2 id="✅-最终结论"><a href="#✅-最终结论" class="headerlink" title="✅ 最终结论"></a>✅ 最终结论</h2><div class="table-container"><table><thead><tr><th>判断项</th><th>是否正确</th></tr></thead><tbody><tr><td>“GitHub 也存有我们的公钥”</td><td>✅ 正确（用于连接 GitHub 仓库）</td></tr><tr><td>“这个公钥可用于远程服务器部署连接”</td><td>❌ 不正确（是两个系统）</td></tr><tr><td>“部署远程服务器需要我们单独生成一对密钥”</td><td>✅ 正确</td></tr><tr><td>“GitHub Actions 通过 Secrets 存私钥用于远程登录”</td><td>✅ 正确</td></tr></tbody></table></div><h2 id="👇-具体操作步骤如下（超清晰版）："><a href="#👇-具体操作步骤如下（超清晰版）：" class="headerlink" title="👇 具体操作步骤如下（超清晰版）："></a>👇 具体操作步骤如下（超清晰版）：</h2><h3 id="🧩-第-1-步：在远程服务器（Ubuntu）中生成密钥对"><a href="#🧩-第-1-步：在远程服务器（Ubuntu）中生成密钥对" class="headerlink" title="🧩 第 1 步：在远程服务器（Ubuntu）中生成密钥对"></a>🧩 第 1 步：在远程服务器（Ubuntu）中生成密钥对</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bash</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制编辑</span><br><span class="line">ssh-keygen -t rsa -b 4096 -C &quot;github-actions-deploy&quot;</span><br></pre></td></tr></table></figure><p>然后按提示保存，比如路径是：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">swift</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制编辑</span><br><span class="line">/home/ubuntu/.ssh/id_rsa_github_actions</span><br></pre></td></tr></table></figure><p>生成的两个文件是：</p><div class="table-container"><table><thead><tr><th>文件路径</th><th>用途</th></tr></thead><tbody><tr><td><code>~/.ssh/id_rsa_github_actions</code></td><td>私钥（要复制到 GitHub Secrets）</td></tr><tr><td><code>~/.ssh/id_rsa_github_actions.pub</code></td><td>公钥（追加到服务器自己的 <code>authorized_keys</code>）</td></tr></tbody></table></div><hr><h3 id="🧩-第-2-步：将公钥追加到自己的-authorized-keys"><a href="#🧩-第-2-步：将公钥追加到自己的-authorized-keys" class="headerlink" title="🧩 第 2 步：将公钥追加到自己的 authorized_keys"></a>🧩 第 2 步：将公钥追加到自己的 authorized_keys</h3><p>仍在你的 Ubuntu 服务器上运行：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bash复制编辑cat ~/.ssh/id_rsa_github_actions.pub &gt;&gt; ~/.ssh/authorized_keys</span><br><span class="line">chmod 600 ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure><blockquote><p>✅ 这一步让“GitHub Actions 的 SSH 登录”被信任。</p></blockquote><hr><h3 id="🧩-第-3-步：复制私钥内容，添加到-GitHub-Secrets"><a href="#🧩-第-3-步：复制私钥内容，添加到-GitHub-Secrets" class="headerlink" title="🧩 第 3 步：复制私钥内容，添加到 GitHub Secrets"></a>🧩 第 3 步：复制私钥内容，添加到 GitHub Secrets</h3><p>你现在需要复制这个私钥文件的内容：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bash</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制编辑</span><br><span class="line">cat ~/.ssh/id_rsa_github_actions</span><br></pre></td></tr></table></figure><p>然后登录 GitHub 仓库 → <code>Settings</code> → <code>Secrets and variables</code> → <code>Actions</code> → <code>New repository secret</code></p><div class="table-container"><table><thead><tr><th>名称</th><th>内容</th></tr></thead><tbody><tr><td><code>SSH_PRIVATE_KEY</code></td><td>粘贴 <code>id_rsa_github_actions</code> 私钥内容</td></tr></tbody></table></div><hr><h3 id="🧩-第-4-步：在-GitHub-Actions-工作流中使用这个密钥"><a href="#🧩-第-4-步：在-GitHub-Actions-工作流中使用这个密钥" class="headerlink" title="🧩 第 4 步：在 GitHub Actions 工作流中使用这个密钥"></a>🧩 第 4 步：在 GitHub Actions 工作流中使用这个密钥</h3><p>工作流中新增一个步骤，像这样部署构建产物到服务器：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yaml复制编辑      - name: Deploy to Remote Server via SCP</span><br><span class="line">        uses: appleboy/scp-action@v0.1.7</span><br><span class="line">        with:</span><br><span class="line">          host: $&#123;&#123; secrets.SERVER_HOST &#125;&#125;</span><br><span class="line">          username: $&#123;&#123; secrets.SERVER_USER &#125;&#125;</span><br><span class="line">          key: $&#123;&#123; secrets.SSH_PRIVATE_KEY &#125;&#125;</span><br><span class="line">          source: &quot;docs/.vitepress/dist/*&quot;</span><br><span class="line">          target: &quot;/www/vitepress&quot;</span><br></pre></td></tr></table></figure><blockquote><p>注意：你还要另外添加 2 个 Secrets：</p><ul><li><code>SERVER_HOST</code>（远程服务器的 IP 地址）</li><li><code>SERVER_USER</code>（远程登录用户名，如 <code>ubuntu</code>）</li></ul></blockquote><hr><h2 id="🧠-为什么这么做是合理的？"><a href="#🧠-为什么这么做是合理的？" class="headerlink" title="🧠 为什么这么做是合理的？"></a>🧠 为什么这么做是合理的？</h2><ul><li><strong>你是服务器管理员</strong>，在服务器上生成密钥更安全，不用担心私钥传输过程被窃取。</li><li>公钥不需要传输，因为本身就生成在服务器上，可以直接用。</li><li>私钥可以安全地贴到 GitHub Secrets 中，由 GitHub Actions 使用。</li></ul><hr><h2 id="✅-最终确认"><a href="#✅-最终确认" class="headerlink" title="✅ 最终确认"></a>✅ 最终确认</h2><div class="table-container"><table><thead><tr><th>步骤</th><th>是否正确</th></tr></thead><tbody><tr><td>在 Ubuntu 上运行 <code>ssh-keygen</code> 生成密钥对</td><td>✅ 是</td></tr><tr><td>把 <code>.pub</code> 添加到 <code>authorized_keys</code></td><td>✅ 是</td></tr><tr><td>把私钥内容添加到 GitHub Secrets</td><td>✅ 是</td></tr><tr><td>GitHub Actions 中引用该私钥进行远程部署</td><td>✅ 是</td></tr></tbody></table></div>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>proxmox安装ubuntu+openwrt全过程记录</title>
      <link href="/posts/3acd2171/"/>
      <url>/posts/3acd2171/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><h2 id="大致思路"><a href="#大致思路" class="headerlink" title="大致思路"></a>大致思路</h2><p>年青的时候不懂，为软路由安排了严重过剩的配置：</p><p>3865u 工控机，4g ddr4 2666 (实际cpu仅支持2133)，msata 固态128g.. 全铝合金无风扇散热、工业级防尘设计  /</p><p>因为amazon ec2 免费实例的性能非常底下，且硬盘仅10g，用来部署后端服务非常吃力，于是想到将性能严重过剩的软路由重新设计为：使用proxmox做基系统，使用虚拟机安装openwrt和ubuntu系统。</p><h2 id="前戏准备"><a href="#前戏准备" class="headerlink" title="前戏准备"></a>前戏准备</h2><details class="folding-tag" ><summary> 安装pve </summary>              <div class='content'>              <p>✅ 一、准备工作</p><ol><li><p>下载 Proxmox VE 安装镜像</p><ul><li>官方下载地址：<br>👉 <a href="https://www.proxmox.com/en/downloads/category/iso-images-pve">https://www.proxmox.com/en/downloads/category/iso-images-pve</a><br>推荐版本：<code>Proxmox VE 8.x</code>（基于 Debian 12）</li></ul></li><li><p>准备 U 盘启动盘</p><ul><li>U 盘大小：建议 ≥ 2GB</li><li>制作启动盘工具：</li><li><strong>Rufus</strong>（Windows）：<a href="https://rufus.ie/zh/">https://rufus.ie/zh/</a> （已验证免费）</li><li><strong>balenaEtcher</strong>（Mac/Linux 也可用）：<a href="https://www.balena.io/etcher/">https://www.balena.io/etcher/</a></li></ul></li><li><p>备份重要数据</p><ul><li>Proxmox 会<strong>清空整块硬盘</strong>安装系统，请确认磁盘已备份或空盘。</li></ul></li></ol><hr><p>✅ 二、安装步骤（图形化安装）</p><ol><li><p>启动安装器</p><ul><li>将写好 Proxmox 的 U 盘插入电脑</li><li>开机按 <code>F2/F10/ESC/Delete</code> 进入 BIOS，设置 <strong>U盘启动</strong></li></ul><p>坑爹预警！！也许是工控机主板比较老，当安装完毕后，重启机器后，会立刻检测usb键盘设备，如没有检测到（例如廉价9.9包邮键盘），直接卡死在开机前的阶段，并不会正常的进入系统，导致在工作台上无数次测试均正常，移至机房却N多次启动失败。</p><p>最终在工作台前的反复测试时，意外的发现此规律！！</p><p>应该会记住此次教训！毕竟9.9包邮的廉价键盘，在bios阶段根本无法正常被识别！！</p><ul><li>启动后看到 <code>Install Proxmox VE</code>，选择回车继续</li></ul></li><li><p>安装向导步骤</p></li></ol><div class="table-container"><table><thead><tr><th>步骤</th><th>设置项</th><th>说明</th></tr></thead><tbody><tr><td>第一步</td><td>同意协议</td><td>点击“我同意”</td></tr><tr><td>第二步</td><td>选择磁盘</td><td>选中你的 SSD（通常是 <code>/dev/sda</code>）</td></tr><tr><td>第三步</td><td>设置国家/时区/键盘</td><td>设置为 <code>Asia/Shanghai</code> 或你所在地区</td></tr><tr><td>第四步</td><td>设置管理员密码</td><td>用于 Web UI 登录，不可丢失</td></tr><tr><td>第五步</td><td>设置网络</td><td>推荐设置固定 IP，或 DHCP（后续也能修改）</td></tr></tbody></table></div><p>安装完成后重启</p><ul><li>拔掉 U 盘</li><li>系统会自动进入 Proxmox 管理界面</li></ul>              </div>            </details><details class="folding-tag" ><summary> proxmox的清华大学源 </summary>              <div class='content'>              <p>✅ 步骤一：确认当前 Proxmox 使用的是哪个源</p><p>你可以运行下面的命令来列出所有启用的源：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">grep -r ^deb /etc/apt/</span><br></pre></td></tr></table></figure><p>然后得到：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@proxmox:~# grep -r ^deb /etc/apt/</span><br><span class="line">/etc/apt/sources.list.d/pve-enterprise.list:deb https://enterprise.proxmox.com/debian/pve bookworm pve-enterprise</span><br><span class="line">/etc/apt/sources.list.d/ceph.list:deb https://enterprise.proxmox.com/debian/ceph-quincy bookworm enterprise</span><br><span class="line">/etc/apt/sources.list.bak:deb http://ftp.debian.org/debian bookworm main contrib</span><br><span class="line">/etc/apt/sources.list.bak:deb http://ftp.debian.org/debian bookworm-updates main contrib</span><br><span class="line">/etc/apt/sources.list.bak:deb http://security.debian.org bookworm-security main contrib</span><br><span class="line">/etc/apt/sources.list:deb http://ftp.debian.org/debian bookworm main contrib</span><br><span class="line">/etc/apt/sources.list:deb http://ftp.debian.org/debian bookworm-updates main contrib</span><br><span class="line">/etc/apt/sources.list:deb http://security.debian.org bookworm-security main contrib</span><br><span class="line">root@proxmox:~# </span><br></pre></td></tr></table></figure><p>这说明：</p><p>🔍 当前使用情况总结：</p><div class="table-container"><table><thead><tr><th>文件</th><th>当前内容</th><th>建议</th></tr></thead><tbody><tr><td><code>/etc/apt/sources.list</code></td><td>Debian 官方主源：<code>ftp.debian.org</code> 和 <code>security.debian.org</code></td><td>✅ 可改为清华镜像，加快速度</td></tr><tr><td><code>/etc/apt/sources.list.d/pve-enterprise.list</code></td><td>Proxmox 企业源（需订阅）</td><td>❌ 建议禁用（否则 apt 会报 401 错误）</td></tr><tr><td><code>/etc/apt/sources.list.d/ceph.list</code></td><td>企业版 Ceph 源</td><td>❌ 同样不适用于无订阅用户</td></tr></tbody></table></div><hr><p>✅ 接下来你可以这样操作：</p><hr><p>✅ 第一步：禁用企业源</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mv /etc/apt/sources.list.d/pve-enterprise.list /etc/apt/sources.list.d/pve-enterprise.list.disabled</span><br><span class="line">mv /etc/apt/sources.list.d/ceph.list /etc/apt/sources.list.d/ceph.list.disabled</span><br></pre></td></tr></table></figure><p>然后，可以直接用命令写入文件，避免格式问题：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &lt;&lt; EOF &gt; /etc/apt/sources.list</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm main contrib non-free non-free-firmware</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm-updates main contrib non-free non-free-firmware</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/debian-security bookworm-security main contrib non-free non-free-firmware</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p>以及，更改的 Proxmox VE 的“无订阅”（社区免费版）软件源：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &quot;deb https://mirrors.tuna.tsinghua.edu.cn/proxmox/debian/pve bookworm pve-no-subscription&quot; &gt; /etc/apt/sources.list.d/pve-no-subscription.list</span><br></pre></td></tr></table></figure><p>二者针对的是 <strong>不同的软件源类型</strong>，它们各自负责系统中不同的软件包管理：</p><hr><div class="table-container"><table><thead><tr><th>操作命令</th><th>作用对象</th><th>说明</th></tr></thead><tbody><tr><td>修改 <code>/etc/apt/sources.list</code></td><td><strong>Debian 操作系统主源</strong></td><td>负责管理系统底层软件和通用依赖包，保证 Debian 系统核心和常用软件包的安装和更新。 你改成清华镜像是为了加速和稳定访问。</td></tr><tr><td>修改 <code>/etc/apt/sources.list.d/pve-no-subscription.list</code></td><td><strong>Proxmox VE 专用源（社区免费版）</strong></td><td>负责管理 Proxmox VE 特有的软件包和功能（虚拟化管理工具等）。 无订阅用户使用该社区源，且改为清华镜像加速下载。</td></tr></tbody></table></div><hr><p>简单理解：</p><ul><li>Debian 源 是系统“基础包”的来源，类似操作系统的软件仓库</li><li>Proxmox 源 是专门针对 Proxmox 虚拟化环境的软件仓库</li></ul><p>两者都需要配置正确，系统才能既保持稳定的 Debian 基础环境，也能正常获取 Proxmox 相关软件更新。</p><p>完成后执行：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt update</span><br></pre></td></tr></table></figure><p>确认无报错后就配置好了。</p>              </div>            </details><h2 id="ubuntu的清华大学源"><a href="#ubuntu的清华大学源" class="headerlink" title="ubuntu的清华大学源"></a>ubuntu的清华大学源</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>长期支持版本：<a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu-releases/">https://mirrors.tuna.tsinghua.edu.cn/ubuntu-releases/</a></p><p>安装完成后，需要更改软件源，步骤如下：</p><p>✅ 更换为清华源的步骤（Ubuntu 22.04）</p><p>你可以按以下步骤操作：</p><ol><li>备份原有源列表</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak</span><br></pre></td></tr></table></figure><hr><ol><li>编辑源列表文件</li></ol><p>使用 nano（或你喜欢的编辑器）：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nano /etc/apt/sources.list</span><br></pre></td></tr></table></figure><hr><ol><li>替换为清华源内容（适用于 Ubuntu 22.04 “jammy”）</li></ol><p>将内容全部替换为以下内容：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-security main restricted universe multiverse</span><br></pre></td></tr></table></figure><p>由于不好粘贴，可以这样：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo tee /etc/apt/sources.list &gt; /dev/null &lt;&lt; EOF</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-security main restricted universe multiverse</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p>这样就一步到位了！！</p><hr><ol><li>更新软件列表</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="开始折腾"><a href="#开始折腾" class="headerlink" title="开始折腾"></a>开始折腾</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>到这里，就可以使用 finalshell 登录了，因为之前从github拉取了公钥，需要携带私钥进行登录。</p><p>先安装个lychee图床试试：</p><ol><li><p>先安装docker：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install docker.io</span><br></pre></td></tr></table></figure></li><li><p>配置docker镜像源</p><p><strong>步骤1：创建配置文件</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo mkdir -p /etc/docker  </span><br><span class="line">sudo vim /etc/docker/daemon.json</span><br></pre></td></tr></table></figure><p><strong>步骤2：添加镜像源（推荐）</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo tee /etc/docker/daemon.json &gt; /dev/null &lt;&lt;EOF</span><br><span class="line">&#123;  </span><br><span class="line">  &quot;registry-mirrors&quot;: [&quot;https://docker.xuanyuan.me&quot;]  </span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p><strong>步骤3：重启服务</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl daemon-reload  </span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure></li><li><p>然后，运行以下命令：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name=lychee \</span><br><span class="line">  --memory=&quot;300m&quot; \</span><br><span class="line">  -v /opt/docker/lychee/conf:/conf \</span><br><span class="line">  -v /opt/docker/lychee/uploads:/uploads \</span><br><span class="line">  -v /opt/docker/lychee/sym:/sym \</span><br><span class="line">  -e PUID=1000 \</span><br><span class="line">  -e PGID=1000 \</span><br><span class="line">  -e PHP_TZ=America/New_York \</span><br><span class="line">  -e TIMEZONE=America/New_York \</span><br><span class="line">  -e DB_CONNECTION=mysql \</span><br><span class="line">  -e DB_HOST=35.164.210.202 \</span><br><span class="line">  -e DB_PORT=3306 \</span><br><span class="line">  -e DB_DATABASE=lychee \</span><br><span class="line">  -e DB_USERNAME=iooio \</span><br><span class="line">  -e DB_PASSWORD=5320di \</span><br><span class="line">  -e APP_URL=http://192.168.5.229:90 \</span><br><span class="line">  -e APP_FORCE_HTTPS=false \</span><br><span class="line">  -e TRUSTED_PROXIES=* \</span><br><span class="line">  -p 90:80 \</span><br><span class="line">  lycheeorg/lychee</span><br></pre></td></tr></table></figure></li><li><p>执行<code>docker ps</code>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@proxmoxubuntu:~# docker ps</span><br><span class="line">CONTAINER ID   IMAGE              COMMAND                  CREATED          STATUS                    PORTS                                 NAMES</span><br><span class="line">ef1b2448d3ac   lycheeorg/lychee   &quot;/entrypoint.sh nginx&quot;   51 seconds ago   Up 49 seconds (healthy)   0.0.0.0:90-&gt;80/tcp, [::]:90-&gt;80/tcp   lychee</span><br><span class="line">root@proxmoxubuntu:~# </span><br></pre></td></tr></table></figure></li></ol><p>然后常出现了一个扯淡的现象：lychee仅能加载远程mysql中的模糊缩略图</p><p>ChatGPT 说：</p><p>其实这里涉及几个关键点，需要理清：</p><hr><ol><li><p>MySQL 数据库里<strong>并不直接存储图片文件</strong></p><ul><li>MySQL 里存的是图片的<strong>元数据和文件路径</strong>（比如文件名、路径、缩略图路径等）。</li><li><strong>图片本身是存放在 Lychee 服务器的文件系统里的</strong>，数据库只存文件位置或索引。</li></ul></li><li><p>Lychee 访问图片是通过 Web 服务器直接读取本地磁盘文件</p><ul><li>当浏览器访问图片时，请求会发送到运行 Lychee 的服务器（即 Web 服务器）。</li><li>服务器根据数据库中图片路径，直接去本地文件系统读取对应图片文件，再返回给浏览器。</li><li>数据库只是告诉 Lychee 图片存在“哪儿”，而不是把图片内容从数据库传出来。</li></ul></li><li><p>为什么“远程 MySQL”依然能正常显示图片？</p><ul><li>远程 MySQL 只是一个数据库服务，它保存路径和索引，Lychee 服务器连接它取数据。</li><li><strong>关键是图片文件必须在 Lychee 服务器上（Web 服务器上）存在</strong>。</li><li>只要 Lychee 服务器能通过网络连接远程 MySQL，查询到图片路径，且图片文件在本地目录，图片显示就正常。</li></ul></li><li><p>缩略图为什么也能显示？</p><ul><li>缩略图和原图一样，都是存成文件，路径存数据库。</li><li>Lychee 根据数据库里的缩略图路径，访问本地文件系统对应文件。</li><li>远程数据库不影响文件的实际读取。</li></ul></li><li><p>如果图片文件和数据库不在同一服务器，图片无法显示的原因</p><ul><li>如果 Lychee 服务器本地没有对应图片文件（不管数据库是本地还是远程），请求图片时会 404。</li><li>数据库远程，只要网络连通和权限正常，查询路径没问题，能拿到文件路径；<br>但文件系统没图片，访问就失败。</li></ul></li></ol><hr><p>简单总结：</p><div class="table-container"><table><thead><tr><th>作用</th><th>位置</th><th>说明</th></tr></thead><tbody><tr><td>MySQL 数据库</td><td>远程服务器</td><td>存储图片路径、文件名、元数据</td></tr><tr><td>图片文件</td><td>Lychee 服务器本地磁盘</td><td>真实图片和缩略图存放位置</td></tr><tr><td>浏览器访问图片</td><td>Lychee 服务器（Web 服务器）</td><td>根据数据库路径读取本地文件，返回给客户端</td></tr></tbody></table></div><hr><p>如果你希望图片和数据库分开，必须保证：</p><ul><li><strong>图片文件实际存储在 Lychee 服务器可访问的本地目录，且路径对应数据库路径。</strong></li><li>或者通过网络文件系统（NFS/SMB等）把远程图片目录挂载到 Lychee 服务器。</li></ul><p>lychee图床需要和数据库部署在一起</p><p>否则加载非常慢！！</p><p>现在本地安装数据库试试：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 更新系统包</span><br><span class="line">sudo apt update</span><br><span class="line"># 会根据你本机当前配置的软件源，把所有已安装的包升级到软件源中提供的最新版本。</span><br><span class="line">sudo apt upgrade </span><br><span class="line"></span><br><span class="line"># 安装nvm</span><br><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.3/install.sh | bash</span><br><span class="line"></span><br><span class="line"># 安装完成后，按照输出的提示重启终端，或者手动运行以下命令来加载 nvm：</span><br><span class="line">source ~/.bashrc</span><br><span class="line"></span><br><span class="line">nvm --version</span><br><span class="line">nvm install 18  # 安装 Node.js 18.x 版本</span><br><span class="line"></span><br><span class="line"># 在 EC2 上安装 MySQL 数据库：</span><br><span class="line">sudo apt install mysql-server</span><br><span class="line"></span><br><span class="line"># 启动</span><br><span class="line">sudo systemctl start mysql</span><br><span class="line"># 开机自启</span><br><span class="line">sudo systemctl enable mysql</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> root 用户下安装nvm时的小坑 </summary>              <div class='content'>              <ol><li><p>追加 nvm 初始化代码到 <code>/root/.bashrc</code></p><p>执行下面命令：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;export NVM_DIR=&quot;$HOME/.nvm&quot;&#x27; &gt;&gt; /root/.bashrc</span><br><span class="line">echo &#x27;[ -s &quot;$NVM_DIR/nvm.sh&quot; ] &amp;&amp; \. &quot;$NVM_DIR/nvm.sh&quot;&#x27; &gt;&gt; /root/.bashrc</span><br></pre></td></tr></table></figure></li><li><p>重新加载 bashrc</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">source /root/.bashrc</span><br></pre></td></tr></table></figure></li><li><p>测试 nvm 是否可用</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nvm --version</span><br></pre></td></tr></table></figure><p>如果输出版本号，说明成功了。</p><p>这是因为 nvm 的安装脚本本应该自动把初始化代码写入你的 shell 配置文件（比如 <code>.bashrc</code> 或 <code>.zshrc</code>），但在某些情况下：</p><ul><li>安装脚本检测不到你的 shell 类型，没自动写入；</li><li>你用的是 root 用户，脚本权限或者环境变量导致没写入；</li><li>之前的配置文件被覆盖或者没有权限修改。</li></ul><p>所以你需要手动把加载 nvm 的代码加到 <code>.bashrc</code>，才能让 shell 识别 <code>nvm</code> 命令。</p></li></ol><hr><p><strong>简单说就是</strong>：</p><p>安装时它默认只修改了当前普通用户的配置文件，或者没成功写入 root 用户的配置文件，所以你得自己手动加进去让 root 用户生效。</p>              </div>            </details><h2 id="紧急将proxmox网卡直通给openwrt"><a href="#紧急将proxmox网卡直通给openwrt" class="headerlink" title="紧急将proxmox网卡直通给openwrt"></a>紧急将proxmox网卡直通给openwrt</h2><details class="folding-tag" ><summary> 设置网卡直通 </summary>              <div class='content'>              <p>安装nvm包管理工具时，遇到了需要挂梯子才可以正常拉取的情况，为了避免以后同样的麻烦，先解决一下。</p><ol><li>编辑 grub 配置文件：</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nano /etc/default/grub</span><br></pre></td></tr></table></figure><p>找到这一行：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet&quot;</span><br></pre></td></tr></table></figure><p>修改为：</p><ul><li><strong>如果你是 Intel CPU：</strong></li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet intel_iommu=on&quot;</span><br></pre></td></tr></table></figure><ul><li><strong>如果你是 AMD CPU：</strong></li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet amd_iommu=on&quot;</span><br></pre></td></tr></table></figure><p>💡 你可以用 <code>lscpu | grep Vendor</code> 来确认 CPU 类型。</p><hr><ol><li>更新 grub：</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">update-grub</span><br></pre></td></tr></table></figure><hr><ol><li>加载 vfio 模块（可选但建议）：</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo -e &quot;vfio\nvfio_iommu_type1\nvfio_pci\nvfio_virqfd&quot; &gt;&gt; /etc/modules</span><br></pre></td></tr></table></figure><p>然后立即加载（无需重启）：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">modprobe vfio</span><br><span class="line">modprobe vfio_iommu_type1</span><br><span class="line">modprobe vfio_pci</span><br></pre></td></tr></table></figure><hr><ol><li>重启系统：</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">update-initramfs -u -k all </span><br><span class="line"></span><br><span class="line">reboot</span><br></pre></td></tr></table></figure><hr><ol><li>验证是否启用成功：</li></ol><p>重启后运行：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dmesg | grep -e DMAR -e IOMMU</span><br></pre></td></tr></table></figure><p>如果你看到：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mathematica复制编辑DMAR: IOMMU enabled</span><br><span class="line">DMAR-IR: Enabled IRQ remapping...</span><br><span class="line">Intel(R) Virtualization Technology for Directed I/O</span><br></pre></td></tr></table></figure><p>✅ 就说明启用了。</p>              </div>            </details><details class="folding-tag" ><summary> 接下来要安装 op </summary>              <div class='content'>              <p>创建虚拟机，暂不添加启动介质，磁盘删掉，cpu类别选择host..</p><p>然后，宿主中执行：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">qm importdisk 100 /var/lib/vz/template/iso/Openwrt.img local-lvm</span><br></pre></td></tr></table></figure><p>✅ <strong>把 <code>Openwrt.img</code> 这个磁盘镜像文件，导入到 ID 为 100 的虚拟机中，作为一个虚拟硬盘，存储在 Proxmox 的 <code>local-lvm</code> 存储池中。</strong></p><p>接下来，双击这款磁盘镜像，确认添加，然后调整引导顺序，既可以启动op安装！</p>              </div>            </details><details class="folding-tag" ><summary> op 做主路由还是二级路由或旁路由？ </summary>              <div class='content'>              <p>先说一下第一次折腾完毕的方案吧：</p><p>首先，华硕路由器作为主路由器pppoe拨号，lan口（192.168.5.1）怼在op（op虚拟在pve当中）的wan网口（dhcp客户端），然后剩余的一个lan口（此两个网口均物理直通）ip地址为192.168.10.1，没错，这种玩法，就是让op做了二级路由，并且桥接了一个虚拟接口，该虚拟接口分配给了位于pve中的ubuntu。</p><p>这样的弊端，家里需要开启两台无线路由器。</p><p>所以接下来很可能会换方法，直接让op做主路由，尽管他是装置pve内的虚拟机，只需要更改op wan口的协议为 pppoe ，设置拨号即可。然后，将之前的主路由器模式改为无线中继，直接转发op的lan口，lan 口的ip地址仍继续使用192.168.10.1就行..</p><p>记得设置好启动顺序 ~</p><details class="folding-tag" ><summary> 让 pve op 做主路由的前置准备 </summary>              <div class='content'>              <ol><li><p>执行nano /etc/network/interfaces，得到默认的网络设置如下：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">auto lo</span><br><span class="line">iface lo inet loopback</span><br><span class="line"></span><br><span class="line">auto enp1s0</span><br><span class="line">iface enp1s0 inet manual</span><br><span class="line"></span><br><span class="line">iface enp2s0 inet manual</span><br><span class="line"></span><br><span class="line">iface enp3s0 inet manual</span><br><span class="line"></span><br><span class="line">iface ens9 inet manual</span><br><span class="line"></span><br><span class="line">iface enp5s0 inet manual</span><br><span class="line"></span><br><span class="line">iface enp6s0 inet manual</span><br><span class="line"></span><br><span class="line">auto vmbr0</span><br><span class="line">iface vmbr0 inet static</span><br><span class="line">        address 192.168.5.99/24</span><br><span class="line">        gateway 192.168.5.1</span><br><span class="line">        bridge-ports enp1s0</span><br><span class="line">        bridge-stp off</span><br><span class="line">        bridge-fd 0</span><br><span class="line"></span><br><span class="line">auto vmbr_op</span><br><span class="line">iface vmbr_op inet manual</span><br><span class="line">        bridge-ports none</span><br><span class="line">        bridge-stp off</span><br><span class="line">        bridge-fd 0</span><br><span class="line"></span><br><span class="line">source /etc/network/interfaces.d/*</span><br></pre></td></tr></table></figure><p>✅ 当前配置解读</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">auto lo</span><br><span class="line">iface lo inet loopback</span><br></pre></td></tr></table></figure><ul><li>本地回环设备，默认，正常。</li></ul><hr><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">auto enp1s0</span><br><span class="line">iface enp1s0 inet manual</span><br></pre></td></tr></table></figure><ul><li><code>enp1s0</code> 是你当前连接主路由的<strong>物理 LAN 网口</strong>，用于外网访问。</li><li>它被 <code>vmbr0</code> 桥接使用。</li></ul><hr><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">auto vmbr0</span><br><span class="line">iface vmbr0 inet static</span><br><span class="line">    address 192.168.5.99/24</span><br><span class="line">    gateway 192.168.5.1</span><br><span class="line">    bridge-ports enp1s0</span><br><span class="line">    bridge-stp off</span><br><span class="line">    bridge-fd 0</span><br></pre></td></tr></table></figure><ul><li><code>vmbr0</code> 是你当前的主网桥，<strong>桥接了物理网口 enp1s0</strong>。</li><li>分配了 IP <code>192.168.5.99</code>，这是你当前访问 PVE 的地址。</li><li>所有虚拟机使用 <code>vmbr0</code> 就可以访问外网。</li></ul><hr><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">auto vmbr_op</span><br><span class="line">iface vmbr_op inet manual</span><br><span class="line">    bridge-ports none</span><br><span class="line">    bridge-stp off</span><br><span class="line">    bridge-fd 0</span><br></pre></td></tr></table></figure><ul><li><code>vmbr_op</code> 是你为 OpenWrt LAN 创建的纯虚拟桥。</li><li>目前还没分配 IP（手动模式），<strong>所以 PVE 本机无法通过此网桥通信</strong>。</li></ul><hr><p>✅ 下一步操作：让 PVE 本机加入 <code>vmbr_op</code></p><p>你只需把 <code>vmbr_op</code> 的配置从 <code>inet manual</code> 改为 <code>inet static</code>，并添加 IP 信息：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">auto vmbr_op</span><br><span class="line">-iface vmbr_op inet manual</span><br><span class="line">+iface vmbr_op inet static</span><br><span class="line">+    address 192.168.10.99</span><br><span class="line">+    netmask 255.255.255.0</span><br><span class="line">+    gateway 192.168.10.1</span><br><span class="line">     bridge-ports none</span><br><span class="line">     bridge-stp off</span><br><span class="line">     bridge-fd 0</span><br></pre></td></tr></table></figure><blockquote><p>⚠️ 注意：<strong>如果你同时保留了 vmbr0 的默认网关 <code>192.168.5.1</code>，那就不要在 <code>vmbr_op</code> 再写 gateway，否则可能冲突</strong>。</p></blockquote><hr><p>✅ 推荐方案：设置 <code>vmbr_op</code> 无 gateway</p><p>如果你当前的 <code>vmbr0</code>（192.168.5.99）是 PVE 的管理口，并且未来也继续保留它用于访问 PVE，那 <code>vmbr_op</code> 不要再设网关。</p><p>也就是说：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">auto vmbr_op</span><br><span class="line">iface vmbr_op inet static</span><br><span class="line">    address 192.168.10.99</span><br><span class="line">    netmask 255.255.255.0</span><br><span class="line">    bridge-ports none</span><br><span class="line">    bridge-stp off</span><br><span class="line">    bridge-fd 0</span><br></pre></td></tr></table></figure><blockquote><p>✅ 这样配置后，PVE 会在 192.168.10.99 网段“上线”，但不走这条路由出外网。</p></blockquote><hr><p>✅ 修改后操作：</p><ol><li>保存文件后，运行：</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ifreload -a</span><br></pre></td></tr></table></figure><p>或重启网络服务：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl restart networking</span><br></pre></td></tr></table></figure><p>也可以选择重启 PVE（保险做法）：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure></li></ol>              </div>            </details>              </div>            </details><p>填坑记录1：op版本还是老的香，新版有意想不到的bug，例如：esir新版的高大全，无法使用列表模式，非常的操蛋，我选择装回之前的2021版；</p><p>填坑记录2：pve安装op，概览当中显示的网口顺序和命名，实际为pve宿主机中为op添加的网口顺序，从eth0开始，依此命名，最佳实践为，启动之前添加好所有网口，虚拟在前，物理直通在后，安装完毕，（好像是）默认为第一个eth0 lan 口写入管理地址：192.168.5.1。</p><p>从控制台进入系统后，尽量先不要着急改ip，正确的做法是先进入ui界面勾选lan口，然后更改lan口ip为另一网段，例如：192.168.10.1。</p><p>至此，基本上小工告成。</p><details class="folding-tag" ><summary> 为什么？ </summary>              <div class='content'>              <p><strong>为什么 Windows（192.168.10.x）能访问 PVE（192.168.5.99）？</strong></p><p><strong>情况 1：OpenWRT 的 WAN 口连接到主路由（NAT 模式）</strong></p><ul><li>OpenWRT 的 WAN 口从主路由获取 IP（如 <code>192.168.5.x</code>），而 LAN 口是 <code>192.168.10.1</code>。</li><li>Windows 连接 OpenWRT 的 WiFi，获取 <code>192.168.10.x</code> 的 IP。</li><li><strong>默认情况下，OpenWRT 会启用 NAT（网络地址转换）</strong>，使得 LAN 设备（Windows）可以通过 WAN 口访问外网（包括主路由和 PVE）。</li><li><strong>NAT 的作用</strong>：Windows 的流量会被 OpenWRT 转换为 WAN 口的 IP（<code>192.168.5.x</code>）访问主路由，主路由认为流量来自 OpenWRT，而不是 Windows。</li><li><strong>因此，Windows 可以访问 PVE</strong>，因为 OpenWRT 做了 NAT 转发。</li></ul><p>✅ <strong>这是最常见的情况</strong>，也是当前能访问 PVE 的原因。</p>              </div>            </details><details class="folding-tag" ><summary> 初始化数据库 </summary>              <div class='content'>              <ul><li><p>root用户执行<code>sudo mysql_secure_installation</code>，进行数据库初始化：</p><p>| 步骤               | 作用                    | 推荐操作（生产环境）    |<br>| ————————— | ———————————- | ———————————- |<br>| 启用密码验证组件   | 防止设置弱密码          | 是                      |<br>| root 认证方式      | 默认为 auth_socket 插件 | 本地保留 / 远程改为密码 |<br>| 删除匿名用户       | 防止无授权访问          | 是                      |<br>| 禁止 root 远程登录 | 降低被暴力破解风险      | 是                      |<br>| 删除 test 数据库   | 减少潜在安全风险        | 是                      |<br>| 重新加载权限表     | 使配置生效              | 是                      |</p></li><li><p>接下来，创建数据库表，以及lychee的专属用户：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE DATABASE lychee CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;</span><br><span class="line"></span><br><span class="line">CREATE USER &#x27;lychee&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;386898136Di!&#x27;;</span><br><span class="line"></span><br><span class="line">GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER ON lychee.* TO &#x27;lychee&#x27;@&#x27;%&#x27;;</span><br><span class="line"></span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure></li><li><p>以下情况，表示 MySQL 只接受本地连接，<strong>远程连接会被拒绝。</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo grep -r &quot;bind-address&quot; /etc/mysql/</span><br><span class="line">/etc/mysql/mysql.conf.d/mysqld.cnf:bind-address = 127.0.0.1</span><br></pre></td></tr></table></figure><p>得到：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@proxmoxubuntu:~# sudo grep -r &quot;bind-address&quot; /etc/mysql/</span><br><span class="line">/etc/mysql/mysql.conf.d/mysqld.cnf:bind-address = 127.0.0.1</span><br><span class="line">/etc/mysql/mysql.conf.d/mysqld.cnf:bind-address         = 127.0.0.1</span><br><span class="line">/etc/mysql/mysql.conf.d/mysqld.cnf:mysqlx-bind-address  = 127.0.0.1</span><br></pre></td></tr></table></figure><p>你需要用编辑器打开文件，比如：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nano /etc/mysql/mysql.conf.d/mysqld.cnf</span><br></pre></td></tr></table></figure><p>找到 <code>bind-address</code> 行，将其改为：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bind-address = 0.0.0.0</span><br></pre></td></tr></table></figure><p>保存并重启 MySQL 服务：；</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl restart mysql</span><br></pre></td></tr></table></figure></li></ul>              </div>            </details><h2 id="使用-Docker-Compose-管理（推荐）"><a href="#使用-Docker-Compose-管理（推荐）" class="headerlink" title="使用 Docker Compose 管理（推荐）"></a>使用 Docker Compose 管理（推荐）</h2><p>将配置写到 <code>docker-compose.yml</code>，修改时只需修改文件然后重新 <code>docker-compose up -d</code>，更方便管理。</p><details class="folding-tag" ><summary> 使用 docker-compose </summary>              <div class='content'>              <p>安装 Docker Compose CLI 插件，下载最新 Compose CLI 插件：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkdir -p ~/.docker/cli-plugins/</span><br><span class="line">curl -SL https://github.com/docker/compose/releases/latest/download/docker-compose-linux-x86_64 -o ~/.docker/cli-plugins/docker-compose</span><br><span class="line">chmod +x ~/.docker/cli-plugins/docker-compose</span><br></pre></td></tr></table></figure><p>然后试试：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker compose version</span><br></pre></td></tr></table></figure><p>✅ 第一步：创建文件夹（如果还没有）</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkdir -p /opt/docker/lychee</span><br></pre></td></tr></table></figure><hr><p>✅ 第二步：创建 <code>docker-compose.yml</code> 文件</p><p>你可以使用你熟悉的文本编辑器，比如 <code>nano</code>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nano /opt/docker/lychee/docker-compose.yml</span><br></pre></td></tr></table></figure><p>用 <code>cat &gt; 文件名</code> 快速粘贴（推荐）</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /opt/docker/lychee/docker-compose.yml</span><br></pre></td></tr></table></figure><p>粘贴以下 <strong>纯文本内容</strong> 后，按下 <code>Ctrl + D</code> 结束输入保存。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">version: &quot;3.8&quot;</span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line">  lychee:</span><br><span class="line">    image: lycheeorg/lychee</span><br><span class="line">    container_name: lychee</span><br><span class="line">    restart: unless-stopped</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;90:80&quot;</span><br><span class="line">    environment:</span><br><span class="line">      PUID: 1000</span><br><span class="line">      PGID: 1000</span><br><span class="line">      PHP_TZ: America/New_York</span><br><span class="line">      TIMEZONE: America/New_York</span><br><span class="line">      DB_CONNECTION: mysql</span><br><span class="line">      DB_HOST: 192.168.10.224</span><br><span class="line">      DB_PORT: 3306</span><br><span class="line">      DB_DATABASE: lychee</span><br><span class="line">      DB_USERNAME: lychee</span><br><span class="line">      DB_PASSWORD: 386898136Di!</span><br><span class="line">      APP_URL: http://192.168.10.224:90</span><br><span class="line">      APP_FORCE_HTTPS: &quot;false&quot;</span><br><span class="line">      TRUSTED_PROXIES: &quot;*&quot;</span><br><span class="line">    volumes:</span><br><span class="line">      - /opt/docker/lychee/conf:/conf</span><br><span class="line">      - /opt/docker/lychee/uploads:/uploads</span><br><span class="line">      - /opt/docker/lychee/sym:/sym</span><br><span class="line">    mem_limit: 300m</span><br></pre></td></tr></table></figure><p>按下 <code>Ctrl + O</code> 保存，回车确认，然后 <code>Ctrl + X</code> 退出编辑器。</p><hr><p>✅ 第三步：使用 Compose 启动容器</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /opt/docker/lychee</span><br><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure><hr><p>✅ 后续常用命令</p><div class="table-container"><table><thead><tr><th>命令</th><th>说明</th></tr></thead><tbody><tr><td><code>docker compose up -d</code></td><td>后台启动容器</td></tr><tr><td><code>docker compose down</code></td><td>停止并删除容器</td></tr><tr><td><code>docker compose logs -f</code></td><td>查看实时日志</td></tr><tr><td><code>docker compose ps</code></td><td>查看当前运行状态</td></tr></tbody></table></div><details class="folding-tag" ><summary> 再进阶 - 使用.env存储易发生变动的变量 </summary>              <div class='content'>              <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nano /opt/docker/lychee/.env</span><br></pre></td></tr></table></figure><p>用 <code>cat &gt; 文件名</code> 快速粘贴（推荐）</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /opt/docker/lychee/.env</span><br></pre></td></tr></table></figure><p>粘贴以下 <strong>纯文本内容</strong> 后，按下 <code>Ctrl + D</code> 结束输入保存。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PUID=1000</span><br><span class="line">PGID=1000</span><br><span class="line">PHP_TZ=America/New_York</span><br><span class="line">TIMEZONE=America/New_York</span><br><span class="line"></span><br><span class="line">DB_CONNECTION=mysql</span><br><span class="line">DB_HOST=192.168.10.224</span><br><span class="line">DB_PORT=3306</span><br><span class="line">DB_DATABASE=lychee</span><br><span class="line">DB_USERNAME=lychee</span><br><span class="line">DB_PASSWORD=386898136Di!</span><br><span class="line"></span><br><span class="line">APP_URL=http://192.168.10.224:90</span><br><span class="line">APP_FORCE_HTTPS=false</span><br><span class="line">TRUSTED_PROXIES=*</span><br></pre></td></tr></table></figure><ul><li>如果只是简单修改配置文件并想更新容器，可以用：</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker compose up -d --force-recreate</span><br></pre></td></tr></table></figure><p><code>docker compose up -d --force-recreate</code> 也是让修改后的 <code>.env</code> 文件配置生效的好办法。</p><p>它会：</p><ul><li>停止并删除旧容器</li><li>重新基于最新配置（包括 <code>.env</code>）创建并启动容器</li><li>保留你的挂载卷数据不丢失</li></ul><p>这个命令其实比单纯重启更“彻底”，适合确保配置完全更新的场景。</p><hr><p><strong>总结：</strong></p><div class="table-container"><table><thead><tr><th>命令</th><th>作用</th><th>适用情况</th></tr></thead><tbody><tr><td><code>docker compose restart lychee</code></td><td>只重启容器，不重新创建，配置不变</td><td>仅容器重启，无配置修改时</td></tr><tr><td><code>docker compose up -d --force-recreate</code></td><td>强制重建容器，应用最新配置</td><td>修改环境变量或配置文件时</td></tr></tbody></table></div><hr><p>所以，修改 <code>.env</code> 后，直接执行：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker compose up -d --force-recreate</span><br></pre></td></tr></table></figure><p>是个非常好的选择。</p>              </div>            </details>              </div>            </details><h2 id="nginx反向代理"><a href="#nginx反向代理" class="headerlink" title="nginx反向代理"></a>nginx反向代理</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p><strong>📌 1. 确保 Nginx 已安装</strong></p><p>如果你还没有安装 Nginx，可以执行：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install nginx -y</span><br></pre></td></tr></table></figure><p>然后启动并设置开机自启：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl start nginx</span><br><span class="line">sudo systemctl enable nginx</span><br></pre></td></tr></table></figure><p><strong>📌 2. 创建一个新的 Nginx 配置文件</strong></p><p>你可以在 <code>/etc/nginx/sites-available/</code> 下创建一个新的配置文件，比如 <code>lychee.conf</code>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nano /etc/nginx/sites-available/lychee.conf</span><br></pre></td></tr></table></figure><p>使用命令：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo tee /etc/nginx/sites-available/lychee.conf &lt;&lt;-&#x27;EOF&#x27;</span><br></pre></td></tr></table></figure><p>是一个 <strong>Here Document（heredoc）</strong> 的写法，用于 <strong>将多行文本内容直接写入文件</strong>，同时避免手动粘贴时可能出现的格式问题（如换行丢失）。下面详细解释它的作用和用法：</p><p><strong>配置文件内容（HTTP 版本，稍后配置 HTTPS）</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name lychee.iooio.cn;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://localhost:90;  # 如果 Lychee 运行在 90 端口</span><br><span class="line">        proxy_set_header Host $host;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>粘贴后，回车切换下一行，顶格输入<code>EOF</code>，再按回车退出。</p><p><strong>📌 3. 启用新的 Nginx 配置</strong></p><p><strong>创建软链接</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo ln -s /etc/nginx/sites-available/lychee.conf /etc/nginx/sites-enabled/</span><br></pre></td></tr></table></figure><p>这条命令的作用是<strong>创建一个符号链接（软链接）</strong>，用于<strong>启用 Nginx 的站点配置</strong>。</p><p><strong>测试 Nginx 配置</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nginx -t</span><br></pre></td></tr></table></figure><p>如果没有错误，重启 Nginx：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl restart nginx</span><br></pre></td></tr></table></figure><details class="folding-tag" ><summary> 关于 server_name </summary>              <div class='content'>              <ul><li>当用户在浏览器中输入域名（如 <code>yourdomain.com</code>），过程是这样的：<ol><li><strong>DNS 查询</strong>：浏览器先通过 DNS 将 <code>yourdomain.com</code> 解析为一个 IP 地址，比如 <code>123.123.123.123</code>。</li><li><strong>浏览器发送请求</strong>：它向该 IP 地址的服务器发送一个请求，<strong>同时在 HTTP 请求头中带上了 <code>Host: yourdomain.com</code></strong>。</li><li><strong>Nginx 接收请求</strong>：Nginx 收到这个请求后，会根据 <code>server_name</code> 来判断是哪个虚拟主机要响应这个请求。</li></ol></li></ul>              </div>            </details><details class="folding-tag" ><summary> 为什么创建这种软连接？ </summary>              <div class='content'>              <p>✅ 工作机制解释：</p><ol><li><p><strong>主配置文件：</strong><br> <code>/etc/nginx/nginx.conf</code> 是主配置文件，其中有一行：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">include /etc/nginx/sites-enabled/*;</span><br></pre></td></tr></table></figure><p>这表示 Nginx 启动时会自动加载 <code>sites-enabled</code> 目录下的所有配置文件。</p></li><li><p><strong>两个相关目录：</strong></p><ul><li><code>/etc/nginx/sites-available/</code>：放置<strong>你写好的 Nginx 配置文件</strong>，可以有多个，但不会被自动加载。</li><li><code>/etc/nginx/sites-enabled/</code>：放置 Nginx 实际要启用的配置，一般通过软链接指向 <code>sites-available</code> 中的文件。</li></ul></li><li><p><strong>启用站点的正确方式：</strong></p><p>假设你创建了一个配置文件：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nano /etc/nginx/sites-available/my_site.conf</span><br></pre></td></tr></table></figure><p>启用它（创建软链接）：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo ln -s /etc/nginx/sites-available/my_site.conf /etc/nginx/sites-enabled/</span><br></pre></td></tr></table></figure></li><li><p><strong>重启或重载生效：</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nginx -t       # 检查语法</span><br><span class="line">sudo systemctl reload nginx</span><br></pre></td></tr></table></figure></li></ol><hr><p>🔥 为什么这样设计？</p><p>这样做的好处是：</p><ul><li>你可以随时修改、启用或禁用某个站点。</li><li>管理多个站点配置时更清晰、安全（避免直接修改 <code>nginx.conf</code>）。</li><li>保留 <code>sites-available</code> 作为备份或草稿，启用再软链即可。</li></ul><hr><p>🧠 小提醒</p><ul><li>配置文件名可以是任意的，如 <code>myapp.conf</code>、<code>default</code> 等。</li><li>文件内容必须合法，否则 <code>nginx -t</code> 会报错，导致 Nginx 无法重载。</li></ul><hr><p>如果你在 Docker 容器中使用的是 <strong>官方 Nginx 镜像</strong>，那默认是没有 <code>sites-enabled/</code> 和 <code>sites-available/</code> 这套结构的，而是直接用 <code>/etc/nginx/nginx.conf</code> 或 <code>/etc/nginx/conf.d/*.conf</code>。</p><p>所以如果你在容器里部署 Nginx，记得区分这两种结构。</p>              </div>            </details><details class="folding-tag" ><summary> lychee图床赞不支持其他端口部署 </summary>              <div class='content'>              <p>Lychee 图床目前在 <code>APP_URL</code> 中 <strong>确实不完全支持带端口号的配置</strong>，尤其是配合反向代理（Nginx）时，会导致以下典型问题：</p><hr><p>❌ 现象回顾：</p><p>当 <code>APP_URL=http://lychee.iooio.cn:9527</code> 时，访问出现以下错误：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">If you can read me, it means that you misconfigured Lychee.</span><br></pre></td></tr></table></figure><p>或控制台报错：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Refused to load the stylesheet... violates Content Security Policy...</span><br></pre></td></tr></table></figure><p>这些都说明 Lychee 识别到的 URL、路径、协议或端口与它预期中的不一致。</p><hr><p>🎯 原因分析</p><p>Lychee 是一个基于 Laravel 框架的 PHP 应用，它在内部使用 <code>APP_URL</code>：</p><ul><li>生成资源链接（如 JS、CSS、图片）</li><li>校验请求来源是否可信</li><li>配合 CSP（Content Security Policy）进行前端安全策略检查</li></ul><p>当你配置 <code>APP_URL=http://lychee.iooio.cn:9527</code>：</p><ol><li><p><strong>Laravel 认为这是标准 URL，会用来构造资源路径</strong>，如：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://lychee.iooio.cn:9527/build/assets/app-xxxx.css</span><br></pre></td></tr></table></figure></li><li><p><strong>但是浏览器通过域名访问 <code>lychee.iooio.cn</code>（默认 80）时，不加端口号</strong></p></li><li><p><strong>资源链接中的端口和页面本身不一致 → 触发 CSP 拒绝加载</strong></p></li></ol><hr><p>✅ 正确做法（最佳实践）</p><p>✅ 方案 A（推荐）</p><p>使用 <strong>默认端口</strong>，让 <code>APP_URL</code> 不带端口号：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">APP_URL=http://lychee.iooio.cn</span><br><span class="line">APP_FORCE_HTTPS=false</span><br><span class="line">TRUSTED_PROXIES=*</span><br></pre></td></tr></table></figure><p>然后：</p><ul><li>使用路由器/云防火墙将外部端口（如 9527）<strong>映射到内部主机的 80 端口</strong></li><li>保持 Nginx 的监听端口为 <code>listen 80;</code>，并通过 <code>server_name</code> 控制转发</li></ul><hr><p>✅ 方案 B（启用 HTTPS）</p><ol><li>配置 <code>APP_URL=https://lychee.iooio.cn</code></li><li>设置反向代理监听 <code>443</code>（开启 HTTPS）</li><li><code>APP_FORCE_HTTPS=true</code> 强制走 HTTPS</li><li>使用 Let’s Encrypt 免费证书自动续期（如配合 <code>certbot</code>）</li></ol><hr><p>🚫 不推荐的方案</p><ul><li>在 <code>APP_URL</code> 中加上端口号（Laravel/Lychee 对此支持不完整）</li><li>在本地监听多个端口（如 Nginx <code>listen 9527;</code>） → 会出现跳转和 CSP 错误</li></ul><hr><p>🧩 总结</p><div class="table-container"><table><thead><tr><th>选项</th><th>是否推荐</th><th>原因</th></tr></thead><tbody><tr><td><code>APP_URL</code> 带端口号</td><td>❌ 不推荐</td><td>造成资源路径错乱、CSP 报错</td></tr><tr><td>路由器将外部端口映射到主机 80</td><td>✅ 推荐</td><td>对外暴露非 80 端口，内部统一反代</td></tr><tr><td><code>APP_URL</code> 不带端口 + <code>server_name</code> 控制</td><td>✅ 推荐</td><td>最兼容 Laravel 的反向代理方式</td></tr></tbody></table></div>              </div>            </details><details class="folding-tag" ><summary> 配置证书 </summary>              <div class='content'>              <p>安装 Let’s Encrypt 的 Certbot 工具</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install certbot python3-certbot-nginx -y</span><br></pre></td></tr></table></figure><hr><p>🚀 使用 Certbot 自动为 Nginx 配置 HTTPS</p><p>执行以下命令：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo certbot --nginx</span><br></pre></td></tr></table></figure><p>然后根据提示：</p><ul><li>输入你的邮箱地址</li><li>同意服务条款</li><li>选择你要启用 HTTPS 的域名（如 <code>lychee.iooio.cn</code>）</li><li>Certbot 会自动配置好 Nginx 的 SSL 段落</li></ul><p>最后一步会提示选择之前使用nginx配置好的http反代域名，选择相应的数字，确认即可自动申请下来证书：</p><p>🔐 成功后 Nginx 配置（自动生成如下）</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name lychee.iooio.cn;</span><br><span class="line">    return 301 https://$host$request_uri;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen 443 ssl;</span><br><span class="line">    server_name lychee.iooio.cn;</span><br><span class="line"></span><br><span class="line">    ssl_certificate /etc/letsencrypt/live/lychee.iooio.cn/fullchain.pem;</span><br><span class="line">    ssl_certificate_key /etc/letsencrypt/live/lychee.iooio.cn/privkey.pem;</span><br><span class="line">    include /etc/letsencrypt/options-ssl-nginx.conf;</span><br><span class="line">    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://localhost:90;  # Lychee 实际运行端口</span><br><span class="line">        proxy_set_header Host $host;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>🌐 更新 <code>.env</code> 文件（Lychee）</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">APP_URL=https://lychee.iooio.cn</span><br><span class="line">APP_FORCE_HTTPS=true</span><br><span class="line">TRUSTED_PROXIES=*</span><br></pre></td></tr></table></figure><p>但：</p><p>在 <strong>运营商封闭了443端口</strong> 的前提下，<strong>配置 HTTPS 证书对于公网访问是没有意义的</strong>，原因如下：</p><hr><p>🚫 为什么没有意义？</p><ul><li><strong>HTTPS 的标准端口是 443</strong>，浏览器访问 <code>https://yourdomain.com</code> 默认就是请求 443。</li><li>如果运营商封禁了 443，那么：<ul><li>证书可以生成 ✅</li><li>本地访问可以正常 ✅</li><li>但公网用户无法访问 ❌</li></ul></li><li>虽然可以尝试使用 <strong>端口转发（例如把外网 8443 转发到内网 443）</strong>，但：<ul><li>用户就需要手动输入 <code>https://yourdomain.com:8443</code>，这样就 <strong>破坏了 Lychee 的 APP_URL 识别机制</strong>。</li><li>证书也无法通过 Let’s Encrypt 自动验证，因为默认验证是走端口 80 或 443。</li><li>Lychee 很严格地校验 <code>APP_URL</code>，<strong>加端口号会导致前端资源无法加载</strong>，你已经遇到过这种情况。</li></ul></li></ul><hr><p>✅ 有意义的场景（可选）：</p><ul><li>如果你是局域网内访问、使用 <strong>自签名证书</strong> 或配置了 <strong>自建 DNS + 可信中间代理</strong>，还是可以用 HTTPS。</li><li>或者你有能力<strong>切换到没有封锁 443 的服务器</strong>，比如：<ul><li>买个便宜的云服务器（阿里云、腾讯云、Oracle Free Tier）</li><li>让别人帮你做外部反代</li></ul></li></ul><hr><p>💡 替代方案建议</p><p>由于 Lychee 不支持端口号加在 <code>APP_URL</code> 后，所以：</p><ul><li>✅ 推荐你用 <strong>80 端口 + HTTP 反向代理 + 防火墙控制访问来源</strong></li><li>✅ 或者部署一个<strong>中间转发层</strong>（例如 Caddy 或 Nginx 的公网反代服务器）</li><li>❌ 不推荐将 HTTPS 部署在非标准端口（如 8443、9443），这会引起兼容性和 Lychee 报错</li></ul><hr><p>🔚 结论</p><p><strong>在运营商封闭 443 的环境下，不建议折腾 HTTPS</strong>，除非你满足以下条件之一：</p><ol><li>有公网服务器做中继（外部反向代理）</li><li>不使用 Lychee 默认的 URL 检查机制（自行魔改）</li><li>可以通过 DNS-01 方式手动生成证书（但仍无法解决 443 封锁问题）</li></ol><p>否则，建议继续使用 HTTP + 强口令 + 安全网络策略，作为过渡方案。</p>              </div>            </details>              </div>            </details><h2 id="关于ssh登录权限"><a href="#关于ssh登录权限" class="headerlink" title="关于ssh登录权限"></a>关于ssh登录权限</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <details class="folding-tag" ><summary> 为root用户配置密码登录 </summary>              <div class='content'>              <p>sudo -i 切换至 root 用户，然后执行 sudo passwd root 为 root 用户设置密码</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 编辑配置文件</span><br><span class="line">sudo nano /etc/ssh/sshd_config</span><br><span class="line"></span><br><span class="line">// 找到并修改以下参数</span><br><span class="line">PermitRootLogin yes          # 允许 root 登录（默认可能为 prohibit-password 或 no）</span><br><span class="line">PasswordAuthentication yes   # 启用密码认证</span><br><span class="line">PubkeyAuthentication no      # 禁用公钥认证（关键！关闭密钥登录）</span><br></pre></td></tr></table></figure><p><strong>关键说明</strong>：</p><ul><li><code>PermitRootLogin yes</code>：允许 root 登录（如果之前是 <code>prohibit-password</code> 或 <code>no</code>，需改为 <code>yes</code>）。</li><li><code>PasswordAuthentication yes</code>：启用密码认证。</li><li><code>PubkeyAuthentication no</code>：禁用公钥认证（确保 root 只能密码登录）</li></ul><p>某些系统（如 Ubuntu）会从 <code>/etc/ssh/sshd_config.d/</code> 加载额外配置，检查是否有冲突：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo grep -r &quot;PermitRootLogin\|PasswordAuthentication\|PubkeyAuthentication&quot; /etc/ssh/sshd_config.d/</span><br></pre></td></tr></table></figure><p>如果发现 <code>PermitRootLogin no</code> 或 <code>PubkeyAuthentication yes</code> 的配置，需删除或修改对应文件。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nano /etc/ssh/sshd_config.d/50-cloud-init.conf</span><br></pre></td></tr></table></figure><p>最后，重启ssh服务：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// Debian/Ubuntu/Proxmox VE 等系统默认使用 ssh 作为服务名称</span><br><span class="line">sudo systemctl restart ssh</span><br></pre></td></tr></table></figure><p>允许root密码登录，需要在生产环境中关闭。</p>              </div>            </details><details class="folding-tag" ><summary> 为root复制一份公钥 </summary>              <div class='content'>              <p>公钥已经存储到了ubuntu用户中，在安装ubuntu系统时，我填写了github 账户，已经将公钥添加到了 ubuntu 用户中，只需以下几步即可：</p><p><strong>1. 切换到 root 用户：</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -i</span><br></pre></td></tr></table></figure><p><strong>2. 创建 root 的 <code>.ssh</code> 目录（如不存在）：</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkdir -p /root/.ssh</span><br><span class="line">chmod 700 /root/.ssh</span><br></pre></td></tr></table></figure><p><strong>3. 将 ubuntu 用户的公钥复制到 root：</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat /home/ubuntu/.ssh/authorized_keys &gt;&gt; /root/.ssh/authorized_keys</span><br><span class="line">chmod 600 /root/.ssh/authorized_keys</span><br></pre></td></tr></table></figure><blockquote><p>这会把 <code>ubuntu</code> 的密钥授权也加到 root 里，<strong>两个用户可以使用同一个私钥登录服务器</strong>。</p></blockquote><hr><p>✅ 确保 SSH 配置允许 root 密钥登录</p><p>编辑 SSH 配置文件：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nano /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure><p>确保这几行配置是以下内容：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PermitRootLogin prohibit-password</span><br><span class="line">PubkeyAuthentication yes</span><br></pre></td></tr></table></figure><blockquote><p>如果你写成 <code>PermitRootLogin yes</code> 也可以，但更推荐 <code>prohibit-password</code>，这样即使有人知道 root 密码，也不能用它登录。</p></blockquote><p>保存并退出，然后：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl restart ssh</span><br></pre></td></tr></table></figure>              </div>            </details>              </div>            </details><h2 id="配置-vitepress"><a href="#配置-vitepress" class="headerlink" title="配置 vitepress"></a>配置 vitepress</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p><strong>📌 1. 确保 Nginx 已安装</strong></p><p>如果你还没有安装 Nginx，可以执行：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install nginx -y</span><br></pre></td></tr></table></figure><p>然后启动并设置开机自启：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl start nginx</span><br><span class="line">sudo systemctl enable nginx</span><br></pre></td></tr></table></figure><p><strong>📌 2. 创建一个新的 Nginx 配置文件</strong></p><p>你可以在 <code>/etc/nginx/sites-available/</code> 下创建一个新的配置文件，比如 <code>lychee.conf</code>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nano /etc/nginx/sites-available/vitepress.conf</span><br></pre></td></tr></table></figure><p>使用命令：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo tee /etc/nginx/sites-available/vitepress.conf &lt;&lt;-&#x27;EOF&#x27;</span><br></pre></td></tr></table></figure><p>是一个 <strong>Here Document（heredoc）</strong> 的写法，用于 <strong>将多行文本内容直接写入文件</strong>，同时避免手动粘贴时可能出现的格式问题（如换行丢失）。下面详细解释它的作用和用法：</p><p><strong>配置文件内容（HTTP 版本，稍后配置 HTTPS）</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 9528;</span><br><span class="line">    server_name vitepress.iooio.cn;</span><br><span class="line"></span><br><span class="line">    location /vitepress_init/ &#123;</span><br><span class="line">        alias /var/www/vitepress_init/;</span><br><span class="line">        index index.html;</span><br><span class="line">        try_files $uri $uri/ /index.html;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>粘贴后，回车切换下一行，顶格输入<code>EOF</code>，再按回车退出。</p><details class="folding-tag" ><summary> 关于 location / 的说明 </summary>              <div class='content'>              <p><strong>VitePress 的 <code>base</code> 配置必须与你在 Nginx 中设置的访问路径保持一致</strong>，这是确保静态资源（JS、CSS、图片等）加载正常的关键。否则会出现样式丢失、页面空白、资源 404 等问题。</p><hr><p>✅ 举个例子：</p><ol><li>如果你想通过这个地址访问：</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://vitepress.iooio.cn:9528/</span><br></pre></td></tr></table></figure><p>那你的配置应该是：</p><p>Nginx：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    alias /var/www/vitepress_init/;</span><br><span class="line">    index index.html;</span><br><span class="line">    try_files $uri $uri/ /index.html;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>VitePress <code>.vitepress/config.ts</code>:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  base: &#x27;/&#x27;, // 和 Nginx 的 location / 对应</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后重新构建：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vitepress build</span><br></pre></td></tr></table></figure><hr><ol><li>如果你使用子路径访问，例如：</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://vitepress.iooio.cn:9528/vitepress_init/</span><br></pre></td></tr></table></figure><p>那配置应为：</p><p>Nginx：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">location /vitepress_init/ &#123;</span><br><span class="line">    alias /var/www/vitepress_init/;</span><br><span class="line">    index index.html;</span><br><span class="line">    try_files $uri $uri/ /index.html;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>VitePress <code>.vitepress/config.ts</code>:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  base: &#x27;/vitepress_init/&#x27;, // 和 Nginx 的 location 对应</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>🔁 总结：</p><div class="table-container"><table><thead><tr><th>访问地址</th><th>Nginx <code>location</code></th><th>VitePress <code>base</code></th></tr></thead><tbody><tr><td><code>http://域名:端口/</code></td><td><code>/</code></td><td><code>&#39;/&#39;</code></td></tr><tr><td><code>http://域名:端口/某路径/</code></td><td><code>/某路径/</code></td><td><code>&#39;/某路径/&#39;</code></td></tr></tbody></table></div><p>👉 <strong>两者必须严格一致。</strong></p><p>需要我帮你自动判断当前的路径和 <code>base</code> 是否一致，也可以贴上你的 <code>config.ts</code> 和实际访问路径，我来帮你检查。</p>              </div>            </details><p><strong>📌 3. 启用新的 Nginx 配置</strong></p><p><strong>创建软链接</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo ln -s /etc/nginx/sites-available/vitepress.conf /etc/nginx/sites-enabled/</span><br></pre></td></tr></table></figure><p>这条命令的作用是<strong>创建一个符号链接（软链接）</strong>，用于<strong>启用 Nginx 的站点配置</strong>。</p><p><strong>测试 Nginx 配置</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nginx -t</span><br></pre></td></tr></table></figure><p>如果没有错误，重启 Nginx：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl restart nginx</span><br></pre></td></tr></table></figure><details class="folding-tag" ><summary> 关于 server_name </summary>              <div class='content'>              <ul><li>当用户在浏览器中输入域名（如 <code>yourdomain.com</code>），过程是这样的：<ol><li><strong>DNS 查询</strong>：浏览器先通过 DNS 将 <code>yourdomain.com</code> 解析为一个 IP 地址，比如 <code>123.123.123.123</code>。</li><li><strong>浏览器发送请求</strong>：它向该 IP 地址的服务器发送一个请求，<strong>同时在 HTTP 请求头中带上了 <code>Host: yourdomain.com</code></strong>。</li><li><strong>Nginx 接收请求</strong>：Nginx 收到这个请求后，会根据 <code>server_name</code> 来判断是哪个虚拟主机要响应这个请求。</li></ol></li></ul>              </div>            </details>              </div>            </details>]]></content>
      
      
      
        <tags>
            
            <tag> 虚拟机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>神领物流Vue3-AntDesign重构</title>
      <link href="/posts/ac06df29/"/>
      <url>/posts/ac06df29/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><h1 id="Antd-Vue3-构建后台管理系统"><a href="#Antd-Vue3-构建后台管理系统" class="headerlink" title="Antd-Vue3 构建后台管理系统"></a>Antd-Vue3 构建后台管理系统</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>随着前端 Vue3 技术发展和生态的完善，越来越多企业使用 Vue3 技术栈搭建后台管理系统，本课程采用 Vue3 生态的 antd-vue 热门组件库，帮助开发者快速构建后台管理系统模板。  </p><h3 id="课程收获"><a href="#课程收获" class="headerlink" title="课程收获"></a>课程收获</h3><ol><li>最新 Vue3 前端技术栈应用</li><li>详解 ESLint + Prettier 团队编码规范</li><li>Antd-Vue 组件库主题定制&amp;布局搭建</li><li>动态路由菜单和权限控制</li><li>等…</li></ol><h2 id="Vue3-项目初始化"><a href="#Vue3-项目初始化" class="headerlink" title="Vue3 项目初始化"></a>Vue3 项目初始化</h2><p>Vue3 官网：<a href="https://cn.vuejs.org/">https://cn.vuejs.org/</a></p><h3 id="初始化-Vue3"><a href="#初始化-Vue3" class="headerlink" title="初始化 Vue3"></a>初始化 Vue3</h3><p>初始化安装</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm create vue@latest</span><br></pre></td></tr></table></figure><p>选择模板功能</p><p><img src="1700133049909.png" alt="1700133049909"></p><h3 id="VS-Code-扩展安装"><a href="#VS-Code-扩展安装" class="headerlink" title="VS Code 扩展安装"></a>VS Code 扩展安装</h3><p>推荐安装扩展：<code>.vscode/extensions.json</code></p><ul><li>输入 <code>@recommended</code> 可一键安装推荐拓展</li></ul><p><img src="1700122731585.png" alt="1700122731585"></p><ul><li>“Vue.volar”,<ul><li>Vue.js 语言插件，提供 Vue 文件代码提示等功能。</li></ul></li><li>“Vue.vscode-typescript-vue-plugin”,<ul><li>Vue.js 文件中 TypeScript 的增强支持。</li></ul></li><li>“dbaeumer.vscode-eslint”,<ul><li>ESLint 插件，用于在编写 JavaScript 和 TypeScript 时检查和修复代码质量问题。</li></ul></li><li>“esbenp.prettier-vscode”<ul><li>Prettier 是一个代码格式化工具，保持一致的代码风格。</li></ul></li></ul><h3 id="项目文件清理"><a href="#项目文件清理" class="headerlink" title="项目文件清理"></a>项目文件清理</h3><ol><li>删除 src 所有文件</li><li>新建 App.vue 和 main.js</li></ol><h3 id="准备基础代码"><a href="#准备基础代码" class="headerlink" title="准备基础代码"></a>准备基础代码</h3><p><code>App.vue</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h1&gt;Hello vue3👍&lt;/h1&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p><code>main.js</code></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>vite.config.js</code></p><p> 开发服务器启动时，自动在浏览器中打开应用程序。</p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">import &#123; fileURLToPath, URL &#125; from &#x27;node:url&#x27;</span><br><span class="line"></span><br><span class="line">import &#123; defineConfig &#125; from &#x27;vite&#x27;</span><br><span class="line">import vue from &#x27;@vitejs/plugin-vue&#x27;</span><br><span class="line">import vueJsx from &#x27;@vitejs/plugin-vue-jsx&#x27;</span><br><span class="line"></span><br><span class="line">// https://vitejs.dev/config/</span><br><span class="line">export default defineConfig(&#123;</span><br><span class="line">  plugins: [vue(), vueJsx()],</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      &#x27;@&#x27;: fileURLToPath(new URL(&#x27;./src&#x27;, import.meta.url)),</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"><span class="addition">+  server: &#123;</span></span><br><span class="line"><span class="addition">+    open: true, // 自动打开浏览器</span></span><br><span class="line"><span class="addition">+  &#125;,</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="团队编码规范"><a href="#团队编码规范" class="headerlink" title="团队编码规范"></a>团队编码规范</h3><p>eslint + prettier 配置参考，可根据项目情况定制。</p><h4 id="组件文件名规范"><a href="#组件文件名规范" class="headerlink" title="组件文件名规范"></a>组件文件名规范</h4><p>新建文件 <code>views/Login/index.vue</code>，结果文件名报错，配置 ESlint 规则为允许 <code>index.vue</code> 命名。</p><p>同时配置 jsx 语法支持，用于动态生成侧栏菜单。</p><p><code>.eslintrc.cjs</code></p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">/* eslint-env node */</span><br><span class="line">require(&#x27;@rushstack/eslint-patch/modern-module-resolution&#x27;)</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  root: true,</span><br><span class="line">  extends: [</span><br><span class="line">    &#x27;plugin:vue/vue3-essential&#x27;,</span><br><span class="line">    &#x27;eslint:recommended&#x27;,</span><br><span class="line">    &#x27;@vue/eslint-config-prettier/skip-formatting&#x27;</span><br><span class="line">  ],</span><br><span class="line">  parserOptions: &#123;</span><br><span class="line">    ecmaVersion: &#x27;latest&#x27;,</span><br><span class="line"><span class="addition">+    // jsx 支持</span></span><br><span class="line"><span class="addition">+    ecmaFeatures: &#123;</span></span><br><span class="line"><span class="addition">+      jsx: true,</span></span><br><span class="line"><span class="addition">+      tsx: true,</span></span><br><span class="line"><span class="addition">+    &#125;,</span></span><br><span class="line">  &#125;,</span><br><span class="line"><span class="addition">+  rules: &#123;</span></span><br><span class="line"><span class="addition">+    &#x27;vue/multi-word-component-names&#x27;: [</span></span><br><span class="line"><span class="addition">+      &#x27;warn&#x27;,</span></span><br><span class="line"><span class="addition">+      &#123;</span></span><br><span class="line"><span class="addition">+        ignores: [&#x27;index&#x27;]</span></span><br><span class="line"><span class="addition">+      &#125;</span></span><br><span class="line"><span class="addition">+    ]</span></span><br><span class="line"><span class="addition">+  &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="统一添加末尾分号-可选"><a href="#统一添加末尾分号-可选" class="headerlink" title="统一添加末尾分号(可选)"></a>统一添加末尾分号(可选)</h4><p><code>.prettierrc.json</code></p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;$schema&quot;: &quot;https://json.schemastore.org/prettierrc&quot;,</span><br><span class="line">  &quot;semi&quot;: false,</span><br><span class="line">  &quot;tabWidth&quot;: 2,</span><br><span class="line">  &quot;singleQuote&quot;: true,</span><br><span class="line">  &quot;printWidth&quot;: 100,</span><br><span class="line"><span class="deletion">-  &quot;trailingComma&quot;: &quot;none&quot;,</span></span><br><span class="line"><span class="addition">+  &quot;trailingComma&quot;: &quot;all&quot;,</span></span><br><span class="line"><span class="addition">+  &quot;endOfLine&quot;: &quot;auto&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>.eslintrc.cjs</code></p><p>温馨提示：prettierrc 的配置复制一份到 eslintrc 中，用于避免插件冲突。</p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">/* eslint-env node */</span><br><span class="line">require(&#x27;@rushstack/eslint-patch/modern-module-resolution&#x27;)</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  root: true,</span><br><span class="line">  extends: [</span><br><span class="line">    &#x27;plugin:vue/vue3-essential&#x27;,</span><br><span class="line">    &#x27;eslint:recommended&#x27;,</span><br><span class="line">    &#x27;@vue/eslint-config-prettier/skip-formatting&#x27;,</span><br><span class="line">  ],</span><br><span class="line">  parserOptions: &#123;</span><br><span class="line">    ecmaVersion: &#x27;latest&#x27;,</span><br><span class="line">    // jsx 支持</span><br><span class="line">    ecmaFeatures: &#123;</span><br><span class="line">      jsx: true,</span><br><span class="line">      tsx: true,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  rules: &#123;</span><br><span class="line">    &#x27;vue/multi-word-component-names&#x27;: [</span><br><span class="line">      &#x27;warn&#x27;,</span><br><span class="line">      &#123;</span><br><span class="line">        ignores: [&#x27;index&#x27;],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line"><span class="addition">+    &#x27;prettier/prettier&#x27;: [</span></span><br><span class="line"><span class="addition">+      &#x27;warn&#x27;,</span></span><br><span class="line"><span class="addition">+      &#123;</span></span><br><span class="line"><span class="addition">+        semi: false,</span></span><br><span class="line"><span class="addition">+        tabWidth: 2,</span></span><br><span class="line"><span class="addition">+        singleQuote: true,</span></span><br><span class="line"><span class="addition">+        printWidth: 100,</span></span><br><span class="line"><span class="addition">+        trailingComma: &#x27;all&#x27;,</span></span><br><span class="line"><span class="addition">+        endOfLine: &#x27;auto&#x27;,</span></span><br><span class="line"><span class="addition">+      &#125;,</span></span><br><span class="line"><span class="addition">+    ],</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="VS-Code工作区设置"><a href="#VS-Code工作区设置" class="headerlink" title="VS Code工作区设置"></a>VS Code工作区设置</h4><p>新建文件 <code>.vscode/setting.json</code>，保存时自动运行 eslint </p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="comment">// 启用 eslint  </span></span><br><span class="line">  <span class="attr">&quot;eslint.enable&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// 保存时为编辑器运行</span></span><br><span class="line">  <span class="attr">&quot;editor.codeActionsOnSave&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// 保存时运行 eslint</span></span><br><span class="line">    <span class="attr">&quot;source.fixAll.eslint&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// 处理以下后缀名文件</span></span><br><span class="line">  <span class="attr">&quot;eslint.options&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;extensions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;.vue&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;.jsx&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;.tsx&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="antd-vue-组件库"><a href="#antd-vue-组件库" class="headerlink" title="antd-vue 组件库"></a>antd-vue 组件库</h2><p>官方文档：<a href="https://www.antdv.com/docs/vue/introduce-cn">https://www.antdv.com/docs/vue/introduce-cn</a></p><h3 id="antdv-组件库"><a href="#antdv-组件库" class="headerlink" title="antdv 组件库"></a>antdv 组件库</h3><h4 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h4><p>安装组件库</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install ant-design-vue@4.x --save</span><br></pre></td></tr></table></figure><p>基本使用</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h1&gt;antd 组件库&lt;/h1&gt;</span><br><span class="line">  &lt;a-button type=&quot;primary&quot;&gt;按钮&lt;/a-button&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p>注意：此时发现组件库按钮不生效，若全量导入组件库体积太大，建议配置按需引入组件。</p><h4 id="自动按需引入组件"><a href="#自动按需引入组件" class="headerlink" title="自动按需引入组件"></a>自动按需引入组件</h4><p>安装依赖</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install unplugin-vue-components -D</span><br></pre></td></tr></table></figure><p>vite.config.js</p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">import &#123; fileURLToPath, URL &#125; from &#x27;node:url&#x27;</span><br><span class="line"></span><br><span class="line">import &#123; defineConfig &#125; from &#x27;vite&#x27;</span><br><span class="line">import vue from &#x27;@vitejs/plugin-vue&#x27;</span><br><span class="line">import vueJsx from &#x27;@vitejs/plugin-vue-jsx&#x27;</span><br><span class="line"><span class="addition">+ import Components from &#x27;unplugin-vue-components/vite&#x27;</span></span><br><span class="line"><span class="addition">+ import &#123; AntDesignVueResolver &#125; from &#x27;unplugin-vue-components/resolvers&#x27;</span></span><br><span class="line"></span><br><span class="line">// https://vitejs.dev/config/</span><br><span class="line">export default defineConfig(&#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    vue(),</span><br><span class="line">    vueJsx(),</span><br><span class="line"><span class="addition">+    Components(&#123;</span></span><br><span class="line"><span class="addition">+      resolvers: [</span></span><br><span class="line"><span class="addition">+        // 自动按需引入 antd 组件</span></span><br><span class="line"><span class="addition">+        AntDesignVueResolver(&#123;</span></span><br><span class="line"><span class="addition">+          importStyle: false, // css in js</span></span><br><span class="line"><span class="addition">+        &#125;),</span></span><br><span class="line"><span class="addition">+      ],</span></span><br><span class="line"><span class="addition">+    &#125;),</span></span><br><span class="line">  ],</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      &#x27;@&#x27;: fileURLToPath(new URL(&#x27;./src&#x27;, import.meta.url)),</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  server: &#123;</span><br><span class="line">    open: true,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="antdv-图标库"><a href="#antdv-图标库" class="headerlink" title="antdv 图标库"></a>antdv 图标库</h3><h4 id="安装和基本使用"><a href="#安装和基本使用" class="headerlink" title="安装和基本使用"></a>安装和基本使用</h4><p>安装依赖</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install @ant-design/icons-vue --save</span><br></pre></td></tr></table></figure><p>使用图标</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; StepForwardOutlined &#125; from &#x27;@ant-design/icons-vue&#x27;</span><br><span class="line">import &#123; h &#125; from &#x27;vue&#x27;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h1&gt;antd 图标演示&lt;/h1&gt;</span><br><span class="line">  &lt;!-- 图标基础用法 --&gt;</span><br><span class="line">  &lt;StepForwardOutlined /&gt;</span><br><span class="line">  &lt;!-- 带图标的按钮 icon 属性 --&gt;</span><br><span class="line">  &lt;a-button type=&quot;primary&quot; :icon=&quot;h(StepForwardOutlined)&quot;&gt;按钮图标&lt;/a-button&gt;</span><br><span class="line">  &lt;!-- 带图标的按钮 icon 插槽 --&gt;</span><br><span class="line">  &lt;a-button type=&quot;primary&quot;&gt;</span><br><span class="line">    &lt;template #icon&gt;</span><br><span class="line">      &lt;StepForwardOutlined /&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    按钮图标</span><br><span class="line">  &lt;/a-button&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h4 id="图标全局按需导入"><a href="#图标全局按需导入" class="headerlink" title="图标全局按需导入"></a>图标全局按需导入</h4><p><code>components/Icons/index.js</code></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">HomeOutlined</span>,</span><br><span class="line">  <span class="title class_">PartitionOutlined</span>,</span><br><span class="line">  <span class="title class_">SettingOutlined</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons-vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 以上图标都需要全局注册</span></span><br><span class="line"><span class="keyword">const</span> icons = [</span><br><span class="line">  <span class="title class_">HomeOutlined</span>,</span><br><span class="line">  <span class="title class_">PartitionOutlined</span>,</span><br><span class="line">  <span class="title class_">SettingOutlined</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">install</span>(<span class="params">app</span>) &#123;</span><br><span class="line">    <span class="comment">// 全局注册引入的所有图标，需在 main.js 中使用 app.use(icons) 注册</span></span><br><span class="line">    icons.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">      app.<span class="title function_">component</span>(item.<span class="property">displayName</span>, item)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>main.js</code></p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">import &#123; createApp &#125; from &#x27;vue&#x27;</span><br><span class="line">import App from &#x27;./App.vue&#x27;</span><br><span class="line"><span class="addition">+ import Icons from &#x27;./components/Icons&#x27;</span></span><br><span class="line"></span><br><span class="line">const app = createApp(App)</span><br><span class="line"></span><br><span class="line"><span class="addition">+ app.use(Icons)</span></span><br><span class="line">app.mount(&#x27;#app&#x27;)</span><br></pre></td></tr></table></figure><h3 id="组件库代码提示配置和-别名映射"><a href="#组件库代码提示配置和-别名映射" class="headerlink" title="组件库代码提示配置和 @ 别名映射"></a>组件库代码提示配置和 @ 别名映射</h3><p>配置后使用 antd 组件库有代码提示，@ 导入的文件也</p><p><code>jsconfig.json</code></p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;types&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="comment">// 添加 antdv 的类型声明文件，方便代码提示</span></span><br><span class="line">      <span class="string">&quot;ant-design-vue/typings/global.d.ts&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 配置路径别名映射，识别类型，方便代码提示</span></span><br><span class="line">    <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;src/*&quot;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="antdv-定制主题和国际化"><a href="#antdv-定制主题和国际化" class="headerlink" title="antdv 定制主题和国际化"></a>antdv 定制主题和国际化</h3><p>antdv 默认主题色时蓝色，默认语言为英文。</p><ul><li><p>国际化： <a href="https://www.antdv.com/docs/vue/i18n-cn">https://www.antdv.com/docs/vue/i18n-cn</a></p></li><li><p>定制主题： <a href="https://www.antdv.com/docs/vue/customize-theme-cn">https://www.antdv.com/docs/vue/customize-theme-cn</a></p></li><li>ConfigProvider 全局化配置: <a href="https://www.antdv.com/components/config-provider-cn">https://www.antdv.com/components/config-provider-cn</a></li></ul><p><code>App.vue</code></p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="addition">+ import zhCN from &#x27;ant-design-vue/es/locale/zh_CN&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="addition">+ const theme = &#123;</span></span><br><span class="line"><span class="addition">+   token: &#123;</span></span><br><span class="line"><span class="addition">+     colorPrimary: &#x27;#e15536&#x27;,</span></span><br><span class="line"><span class="addition">+   &#125;,</span></span><br><span class="line"><span class="addition">+ &#125;</span></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line"><span class="addition">+   &lt;a-config-provider :theme=&quot;theme&quot; :locale=&quot;zhCN&quot;&gt;</span></span><br><span class="line">      &lt;h1&gt;定制主题和国际化&lt;/h1&gt;</span><br><span class="line">      &lt;!-- 主色按钮 --&gt;</span><br><span class="line">      &lt;a-button type=&quot;primary&quot;&gt;主色按钮&lt;/a-button&gt;</span><br><span class="line">      &lt;!-- 分页器 --&gt;</span><br><span class="line">      &lt;a-pagination :total=&quot;50&quot; show-size-changer /&gt;</span><br><span class="line"><span class="addition">+   &lt;/a-config-provider&gt;</span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h2 id="CSS-预处理器和全局样式"><a href="#CSS-预处理器和全局样式" class="headerlink" title="CSS 预处理器和全局样式"></a>CSS 预处理器和全局样式</h2><h3 id="安装依赖-1"><a href="#安装依赖-1" class="headerlink" title="安装依赖"></a>安装依赖</h3><p> 考虑到不同的团队习惯把 sass 和 less 都安装上，按需使用。</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install sass less -D</span><br></pre></td></tr></table></figure><h3 id="样式全局变量"><a href="#样式全局变量" class="headerlink" title="样式全局变量"></a>样式全局变量</h3><p>styles/var.less</p><figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attr">--color-primary</span>: #e15536;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>styles/main.less</p><figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;./var.less&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局样式</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: inherit;</span><br><span class="line">  <span class="attribute">text-decoration</span>: none;</span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--color-primary);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">h1</span>,</span><br><span class="line"><span class="selector-tag">h2</span>,</span><br><span class="line"><span class="selector-tag">h3</span>,</span><br><span class="line"><span class="selector-tag">h4</span>,</span><br><span class="line"><span class="selector-tag">h5</span>,</span><br><span class="line"><span class="selector-tag">h6</span>,</span><br><span class="line"><span class="selector-tag">p</span>,</span><br><span class="line"><span class="selector-tag">ul</span>,</span><br><span class="line"><span class="selector-tag">ol</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用于修改 nprogress 进度条颜色</span></span><br><span class="line"><span class="selector-id">#nprogress</span> &#123;</span><br><span class="line">  <span class="selector-class">.bar</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">var</span>(--color-primary) <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.peg</span> &#123;</span><br><span class="line">    <span class="attribute">box-shadow</span>:</span><br><span class="line">      <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="built_in">var</span>(--color-primary),</span><br><span class="line">      <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">var</span>(--color-primary) <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>main.js</code></p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">import &#123; createApp &#125; from &#x27;vue&#x27;</span><br><span class="line">import App from &#x27;./App.vue&#x27;</span><br><span class="line">import Icons from &#x27;./components/Icons&#x27;</span><br><span class="line"><span class="addition">+ import &#x27;@/styles/main.less&#x27;</span></span><br><span class="line"></span><br><span class="line">const app = createApp(App)</span><br><span class="line"></span><br><span class="line">app.use(Icons)</span><br><span class="line">app.mount(&#x27;#app&#x27;)</span><br></pre></td></tr></table></figure><p><code>App.vue</code></p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import zhCN from &#x27;ant-design-vue/es/locale/zh_CN&#x27;</span><br><span class="line"></span><br><span class="line">const theme = &#123;</span><br><span class="line">  token: &#123;</span><br><span class="line">    colorPrimary: &#x27;#e15536&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;a-config-provider :theme=&quot;theme&quot; :locale=&quot;zhCN&quot;&gt;</span><br><span class="line">    &lt;h1&gt;定制主题和国际化&lt;/h1&gt;</span><br><span class="line">    &lt;!-- 主色按钮 --&gt;</span><br><span class="line">    &lt;a-button type=&quot;primary&quot;&gt;主色按钮&lt;/a-button&gt;</span><br><span class="line">    &lt;!-- 分页器 --&gt;</span><br><span class="line">    &lt;a-pagination :total=&quot;50&quot; show-size-changer /&gt;</span><br><span class="line"><span class="addition">+   &lt;a href=&quot;#&quot;&gt;超链接悬停时为主色&lt;/a&gt;</span></span><br><span class="line">  &lt;/a-config-provider&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="antdv-布局和项目路由"><a href="#antdv-布局和项目路由" class="headerlink" title="antdv 布局和项目路由"></a>antdv 布局和项目路由</h2><h3 id="antd-布局"><a href="#antd-布局" class="headerlink" title="antd 布局"></a>antd 布局</h3><p><code>src\views\Layout\index.vue</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;a-layout has-sider class=&quot;layout&quot;&gt;</span><br><span class="line">    &lt;!-- 侧边栏 --&gt;</span><br><span class="line">    &lt;div&gt;侧边栏&lt;/div&gt;</span><br><span class="line">    &lt;a-layout class=&quot;main&quot;&gt;</span><br><span class="line">      &lt;!-- 页头 --&gt;</span><br><span class="line">      &lt;div&gt;页头&lt;/div&gt;</span><br><span class="line">      &lt;!-- 主体 --&gt;</span><br><span class="line">      &lt;a-layout-content class=&quot;content&quot;&gt;</span><br><span class="line">        &lt;div&gt;内容&lt;/div&gt;</span><br><span class="line">        &lt;div&gt;内容&lt;/div&gt;</span><br><span class="line">        &lt;div&gt;内容&lt;/div&gt;</span><br><span class="line">        &lt;div&gt;内容&lt;/div&gt;</span><br><span class="line">        &lt;div&gt;内容&lt;/div&gt;</span><br><span class="line">        &lt;div&gt;内容&lt;/div&gt;</span><br><span class="line">      &lt;/a-layout-content&gt;</span><br><span class="line">      &lt;!-- 页脚 --&gt;</span><br><span class="line">      &lt;div&gt;页脚&lt;/div&gt;</span><br><span class="line">    &lt;/a-layout&gt;</span><br><span class="line">  &lt;/a-layout&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.layout &#123;</span><br><span class="line">  min-height: 100vh;</span><br><span class="line">  background-color: #ccc;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.main &#123;</span><br><span class="line">  margin-left: 200px;</span><br><span class="line">  background-color: #ddd;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content &#123;</span><br><span class="line">  background-color: #f4f4f4;</span><br><span class="line">  padding: 20px;</span><br><span class="line">  overflow-y: auto;</span><br><span class="line">  margin-top: 60px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h3 id="vue-router-路由"><a href="#vue-router-路由" class="headerlink" title="vue-router 路由"></a>vue-router 路由</h3><p><code>src\router\index.js</code></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">BASE_URL</span>),</span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;home&#x27;</span>,</span><br><span class="line">      <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;主页&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;HomeOutlined&#x27;</span> &#125;,</span><br><span class="line">      <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Layout/index.vue&#x27;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;login&#x27;</span>,</span><br><span class="line">      <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;登录页&#x27;</span> &#125;,</span><br><span class="line">      <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Login/index.vue&#x27;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">  ],</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure><p><code>App.vue</code></p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import zhCN from &#x27;ant-design-vue/es/locale/zh_CN&#x27;</span><br><span class="line"></span><br><span class="line">const theme = &#123;</span><br><span class="line">  token: &#123;</span><br><span class="line">    colorPrimary: &#x27;#e15536&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;a-config-provider :theme=&quot;theme&quot; :locale=&quot;zhCN&quot;&gt;</span><br><span class="line"><span class="addition">+    &lt;router-view /&gt;</span></span><br><span class="line">  &lt;/a-config-provider&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h3 id="加载进度条和标题设置"><a href="#加载进度条和标题设置" class="headerlink" title="加载进度条和标题设置"></a>加载进度条和标题设置</h3><p>安装依赖</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install nprogress</span><br></pre></td></tr></table></figure><p>应用</p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">import &#123; createRouter, createWebHistory &#125; from &#x27;vue-router&#x27;</span><br><span class="line"><span class="addition">+ import NProgress from &#x27;nprogress&#x27;</span></span><br><span class="line"><span class="addition">+ import &#x27;nprogress/nprogress.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="addition">+ NProgress.configure(&#123;</span></span><br><span class="line"><span class="addition">+   showSpinner: false,</span></span><br><span class="line"><span class="addition">+ &#125;)</span></span><br><span class="line"></span><br><span class="line">const router = createRouter(&#123;</span><br><span class="line">  history: createWebHistory(import.meta.env.BASE_URL),</span><br><span class="line">  routes: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: &#x27;/&#x27;,</span><br><span class="line">      name: &#x27;home&#x27;,</span><br><span class="line">      meta: &#123;</span><br><span class="line">        title: &#x27;主页&#x27;,</span><br><span class="line">      &#125;,</span><br><span class="line">      component: () =&gt; import(&#x27;@/views/Layout/index.vue&#x27;),</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: &#x27;/login&#x27;,</span><br><span class="line">      name: &#x27;login&#x27;,</span><br><span class="line">      meta: &#123;</span><br><span class="line">        title: &#x27;登录页&#x27;,</span><br><span class="line">      &#125;,</span><br><span class="line">      component: () =&gt; import(&#x27;@/views/Login/index.vue&#x27;),</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="addition">+ router.beforeEach(() =&gt; &#123;</span></span><br><span class="line"><span class="addition">+   // 进度条开始</span></span><br><span class="line"><span class="addition">+   NProgress.start()</span></span><br><span class="line"><span class="addition">+ &#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="addition">+ // 全局的后置导航</span></span><br><span class="line"><span class="addition">+ router.afterEach((to) =&gt; &#123;</span></span><br><span class="line"><span class="addition">+   // 进度条结束</span></span><br><span class="line"><span class="addition">+   NProgress.done()</span></span><br><span class="line"><span class="addition">+   // 动态设置标题</span></span><br><span class="line"><span class="addition">+   document.title = `$&#123;to.meta.title || import.meta.env.VITE_APP_TITLE&#125;`</span></span><br><span class="line"><span class="addition">+ &#125;)</span></span><br><span class="line"></span><br><span class="line">export default router</span><br></pre></td></tr></table></figure><h3 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h3><ul><li><code>.env.development</code></li></ul><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">VITE_APP_TITLE = 后台管理系统 - dev</span><br><span class="line">VITE_APP_BASE_URL = https://slwl-api.itheima.net/manager</span><br></pre></td></tr></table></figure><ul><li><code>.env.production</code></li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">VITE_APP_TITLE = 后台管理系统</span><br><span class="line">VITE_APP_BASE_URL = https://slwl-api.itheima.net/manager</span><br></pre></td></tr></table></figure><h2 id="基于路由生成菜单"><a href="#基于路由生成菜单" class="headerlink" title="基于路由生成菜单"></a>基于路由生成菜单</h2><h3 id="JSX-版侧栏菜单-静态结构"><a href="#JSX-版侧栏菜单-静态结构" class="headerlink" title="JSX 版侧栏菜单-静态结构"></a>JSX 版侧栏菜单-静态结构</h3><p>侧栏菜单：<code>src\views\Layout\components\AppSideBar.vue</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script lang=&quot;jsx&quot;&gt;</span><br><span class="line">import &#123; defineComponent, ref, h, resolveComponent &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">export default defineComponent(&#123;</span><br><span class="line">  name: &#x27;SideBarItem&#x27;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const openKeys = ref([&#x27;1&#x27;]) // 展开的一级菜单 key</span><br><span class="line">    const selectedKeys = ref([&#x27;11&#x27;]) // 高亮的二级菜单 key</span><br><span class="line"></span><br><span class="line">    return () =&gt; (</span><br><span class="line">      &lt;a-layout-sider theme=&quot;light&quot; width=&quot;200&quot; class=&quot;sidebar&quot;&gt;</span><br><span class="line">        &#123;/* logo */&#125;</span><br><span class="line">        &lt;h1 class=&quot;logo&quot;&gt;</span><br><span class="line">          &lt;RouterLink to=&quot;/&quot;&gt; Logo &lt;/RouterLink&gt;</span><br><span class="line">        &lt;/h1&gt;</span><br><span class="line">        &#123;/* 菜单 */&#125;</span><br><span class="line">        &lt;a-menu</span><br><span class="line">          v-model:openKeys=&#123;openKeys.value&#125;</span><br><span class="line">          v-model:selectedKeys=&#123;selectedKeys.value&#125;</span><br><span class="line">          theme=&quot;light&quot;</span><br><span class="line">          mode=&quot;inline&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;a-sub-menu title=&#123;&#x27;基础数据管理&#x27;&#125; key=&quot;1&quot; icon=&#123;h(resolveComponent(&#x27;HomeOutlined&#x27;))&#125;&gt;</span><br><span class="line">            &lt;a-menu-item key=&quot;11&quot;&gt;机构管理&lt;/a-menu-item&gt;</span><br><span class="line">            &lt;a-menu-item key=&quot;12&quot;&gt;机构作业范围&lt;/a-menu-item&gt;</span><br><span class="line">            &lt;a-menu-item key=&quot;13&quot;&gt;运费管理&lt;/a-menu-item&gt;</span><br><span class="line">          &lt;/a-sub-menu&gt;</span><br><span class="line">          &lt;a-sub-menu title=&#123;&#x27;车辆管理&#x27;&#125; key=&quot;2&quot; icon=&#123;h(resolveComponent(&#x27;PartitionOutlined&#x27;))&#125;&gt;</span><br><span class="line">            &lt;a-menu-item key=&quot;21&quot;&gt;车型管理&lt;/a-menu-item&gt;</span><br><span class="line">            &lt;a-menu-item key=&quot;32&quot;&gt;车辆列表&lt;/a-menu-item&gt;</span><br><span class="line">            &lt;a-menu-item key=&quot;33&quot;&gt;回车管理&lt;/a-menu-item&gt;</span><br><span class="line">          &lt;/a-sub-menu&gt;</span><br><span class="line">        &lt;/a-menu&gt;</span><br><span class="line">      &lt;/a-layout-sider&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.sidebar &#123;</span><br><span class="line">  // 侧栏菜单固定定位</span><br><span class="line">  position: fixed;</span><br><span class="line">  left: 0;</span><br><span class="line">  top: 0;</span><br><span class="line">  bottom: 0;</span><br><span class="line">  z-index: 99;</span><br><span class="line">  height: 100vh;</span><br><span class="line">  overflow-y: auto;</span><br><span class="line">&#125;</span><br><span class="line">.logo &#123;</span><br><span class="line">  height: 150px;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  align-items: center;</span><br><span class="line"></span><br><span class="line">  &amp;-img &#123;</span><br><span class="line">    width: 152px;</span><br><span class="line">    height: 113px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h3 id="项目路由参考"><a href="#项目路由参考" class="headerlink" title="项目路由参考"></a>项目路由参考</h3><h4 id="新建静态路由"><a href="#新建静态路由" class="headerlink" title="新建静态路由"></a>新建静态路由</h4><p> <code>src\router\constantRoutes.js</code></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> constantRoutes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Login/index.vue&#x27;</span>),</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;login&#x27;</span>,</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">    <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;登录&#x27;</span> &#125;,</span><br><span class="line">    <span class="attr">hidden</span>: <span class="literal">true</span>, <span class="comment">// 侧边栏隐藏该路由</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Layout/index.vue&#x27;</span>),</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;dashboard&#x27;</span>,</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">redirect</span>: <span class="string">&#x27;/dashboard&#x27;</span>,</span><br><span class="line">    <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;工作台&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;HomeOutlined&#x27;</span>, <span class="attr">order</span>: <span class="number">0</span> &#125;,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/dashboard&#x27;</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;Dashboard&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Dashboard/index.vue&#x27;</span>),</span><br><span class="line">        <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;数据面板&#x27;</span>, <span class="attr">parent</span>: <span class="string">&#x27;dashboard&#x27;</span> &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 捕获所有路由或 404 Not found 路由</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/:pathMatch(.*)&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/NotFound/index.vue&#x27;</span>),</span><br><span class="line">    <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;页面不存在&#x27;</span> &#125;,</span><br><span class="line">    <span class="attr">hidden</span>: <span class="literal">true</span>, <span class="comment">// 侧边栏隐藏该路由</span></span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h4 id="新建动态路由"><a href="#新建动态路由" class="headerlink" title="新建动态路由"></a>新建动态路由</h4><p><code>src\router\asyncRoutes.js</code> ，基于模块生成路由树。</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 官方文档：https://cn.vitejs.dev/guide/features.html#glob-import</span></span><br><span class="line"><span class="keyword">const</span> modules = <span class="keyword">import</span>.<span class="property">meta</span>.<span class="title function_">glob</span>(<span class="string">&#x27;./modules/*.js&#x27;</span>, &#123; <span class="attr">eager</span>: <span class="literal">true</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 格式化模块</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">formatModules</span>(<span class="params">_modules, result</span>) &#123;</span><br><span class="line">  <span class="comment">// 遍历模块</span></span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">keys</span>(_modules).<span class="title function_">forEach</span>(<span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 获取模块</span></span><br><span class="line">    <span class="keyword">const</span> defaultModule = _modules[key].<span class="property">default</span></span><br><span class="line">    <span class="comment">// 模块存在</span></span><br><span class="line">    <span class="keyword">if</span> (defaultModule) &#123;</span><br><span class="line">      <span class="comment">// 把模块放入结果数组</span></span><br><span class="line">      result.<span class="title function_">push</span>(defaultModule)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// 返回结果数组</span></span><br><span class="line">  <span class="keyword">return</span> result.<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a.<span class="property">meta</span>?.<span class="property">order</span> - b.<span class="property">meta</span>?.<span class="property">order</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据文件生成路由树</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> asyncRoutes = <span class="title function_">formatModules</span>(modules, [])</span><br></pre></td></tr></table></figure><h4 id="新建路由模块"><a href="#新建路由模块" class="headerlink" title="新建路由模块"></a>新建路由模块</h4><ul><li>新建多个路由模块1：<code>src\router\modules\base.js</code></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;base&#x27;</span>,</span><br><span class="line">  <span class="attr">path</span>: <span class="string">&#x27;/base&#x27;</span>,</span><br><span class="line">  <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Layout/index.vue&#x27;</span>),</span><br><span class="line">  <span class="attr">redirect</span>: <span class="string">&#x27;/base/department&#x27;</span>,</span><br><span class="line">  <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;基础数据管理&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;BarChartOutlined&#x27;</span>, <span class="attr">order</span>: <span class="number">1</span> &#125;,</span><br><span class="line">  <span class="attr">children</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;base-department&#x27;</span>,</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/base/department&#x27;</span>,</span><br><span class="line">      <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;机构管理&#x27;</span>, <span class="attr">parent</span>: <span class="string">&#x27;base&#x27;</span> &#125;,</span><br><span class="line">      <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Base/Department/index.vue&#x27;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;base-departwork&#x27;</span>,</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/base/departwork&#x27;</span>,</span><br><span class="line">      <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;机构作业范围&#x27;</span>, <span class="attr">parent</span>: <span class="string">&#x27;base&#x27;</span> &#125;,</span><br><span class="line">      <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Base/DepartWork/index.vue&#x27;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;base-freight&#x27;</span>,</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/base/freight&#x27;</span>,</span><br><span class="line">      <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;运费管理&#x27;</span>, <span class="attr">parent</span>: <span class="string">&#x27;base&#x27;</span> &#125;,</span><br><span class="line">      <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Base/Freight/index.vue&#x27;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>新建多个路由模块2：<code>src\router\modules\base.js</code></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;business&#x27;</span>,</span><br><span class="line">  <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Layout/index.vue&#x27;</span>),</span><br><span class="line">  <span class="attr">path</span>: <span class="string">&#x27;/business&#x27;</span>,</span><br><span class="line">  <span class="attr">redirect</span>: <span class="string">&#x27;/business/orderlist&#x27;</span>,</span><br><span class="line">  <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;业务管理&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;ScheduleOutlined&#x27;</span>, <span class="attr">order</span>: <span class="number">4</span> &#125;,</span><br><span class="line">  <span class="attr">children</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;business-orderlist&#x27;</span>,</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/business/orderlist&#x27;</span>,</span><br><span class="line">      <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;运单管理&#x27;</span>, <span class="attr">parent</span>: <span class="string">&#x27;business&#x27;</span> &#125;,</span><br><span class="line">      <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Business/WayBill/index.vue&#x27;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;business-businesslist&#x27;</span>,</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/business/businesslist&#x27;</span>,</span><br><span class="line">      <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;订单管理&#x27;</span>, <span class="attr">parent</span>: <span class="string">&#x27;business&#x27;</span> &#125;,</span><br><span class="line">      <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Business/Order/index.vue&#x27;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="导入并应用路由"><a href="#导入并应用路由" class="headerlink" title="导入并应用路由"></a>导入并应用路由</h4><p>删除掉旧路由，替换成新的路由。</p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line"><span class="addition">+ import &#123; constantRoutes &#125; from &#x27;./constantRoutes&#x27;  // 导入静态路由</span></span><br><span class="line"><span class="addition">+ import &#123; asyncRoutes &#125; from &#x27;./asyncRoutes&#x27;        // 导入动态路由</span></span><br><span class="line"></span><br><span class="line">const router = createRouter(&#123;</span><br><span class="line">   history: createWebHashHistory(),</span><br><span class="line">   routes: [</span><br><span class="line"><span class="addition">+     ...constantRoutes,    // 静态路由</span></span><br><span class="line"><span class="addition">+     ...asyncRoutes,       // 动态路由</span></span><br><span class="line">   ],</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>注意：侧栏菜单需要用到图标，记得在 <code>src\components\Icons\index.js</code> 全局导入。</li></ul><h3 id="基于路由生成菜单-1"><a href="#基于路由生成菜单-1" class="headerlink" title="基于路由生成菜单"></a>基于路由生成菜单</h3><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">&lt;script lang=&quot;jsx&quot;&gt;</span><br><span class="line"><span class="addition">+ import &#123; defineComponent, h, resolveComponent, computed, ref &#125; from &#x27;vue&#x27;</span></span><br><span class="line"><span class="addition">+ import &#123; useRouter &#125; from &#x27;vue-router&#x27;</span></span><br><span class="line"></span><br><span class="line">export default defineComponent(&#123;</span><br><span class="line">  name: &#x27;SideBarItem&#x27;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const openKeys = ref([]) // 展开的一级菜单 key</span><br><span class="line">    const selectedKeys = ref([]) // 高亮的二级菜单 key</span><br><span class="line"></span><br><span class="line"><span class="addition">+    const router = useRouter() // 获取路由实例</span></span><br><span class="line"><span class="addition">+    // 获取路由表</span></span><br><span class="line"><span class="addition">+    const routes = computed(() =&gt; &#123;</span></span><br><span class="line"><span class="addition">+      // 隐藏 hidden: true 的路由</span></span><br><span class="line"><span class="addition">+      return router.options.routes.filter((v) =&gt; !v.hidden)</span></span><br><span class="line"><span class="addition">+    &#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="addition">+    // 渲染侧栏菜单的函数</span></span><br><span class="line"><span class="addition">+    const renderSubMenu = () =&gt; &#123;</span></span><br><span class="line"><span class="addition">+      // 递归渲染侧栏菜单</span></span><br><span class="line"><span class="addition">+      function travel(_route, nodes = []) &#123;</span></span><br><span class="line"><span class="addition">+        // _route 是一个数组，里面是路由对象</span></span><br><span class="line"><span class="addition">+        if (_route) &#123;</span></span><br><span class="line"><span class="addition">+          // 遍历路由对象</span></span><br><span class="line"><span class="addition">+          _route.forEach((element) =&gt; &#123;</span></span><br><span class="line"><span class="addition">+            const &#123; icon, title &#125; = element.meta</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+            const node =</span></span><br><span class="line"><span class="addition">+              element.children &amp;&amp; element.children.length &gt; 0 ? (</span></span><br><span class="line"><span class="addition">+                // 一级菜单：渲染 标题 和 图标</span></span><br><span class="line"><span class="addition">+                &lt;a-sub-menu title=&#123;title&#125; key=&#123;element.name&#125; icon=&#123;h(resolveComponent(icon))&#125;&gt;</span></span><br><span class="line"><span class="addition">+                  &#123;/* 如果有子路由，递归渲染 */&#125;</span></span><br><span class="line"><span class="addition">+                  &#123;travel(element.children)&#125;</span></span><br><span class="line"><span class="addition">+                &lt;/a-sub-menu&gt;</span></span><br><span class="line"><span class="addition">+              ) : (</span></span><br><span class="line"><span class="addition">+                // 二级菜单：渲染 路由链接 和 标题</span></span><br><span class="line"><span class="addition">+                &lt;a-menu-item key=&#123;element.path&#125;&gt;</span></span><br><span class="line"><span class="addition">+                  &lt;router-link to=&#123;element.path&#125;&gt;&#123;title&#125;&lt;/router-link&gt;</span></span><br><span class="line"><span class="addition">+                &lt;/a-menu-item&gt;</span></span><br><span class="line"><span class="addition">+              )</span></span><br><span class="line"><span class="addition">+            nodes.push(node)</span></span><br><span class="line"><span class="addition">+          &#125;)</span></span><br><span class="line"><span class="addition">+        &#125;</span></span><br><span class="line"><span class="addition">+        return nodes</span></span><br><span class="line"><span class="addition">+      &#125;</span></span><br><span class="line"><span class="addition">+      return travel(routes.value)</span></span><br><span class="line"><span class="addition">+    &#125;</span></span><br><span class="line"></span><br><span class="line">    return () =&gt; (</span><br><span class="line">      &lt;a-layout-sider theme=&quot;light&quot; width=&quot;200&quot; class=&quot;sidebar&quot;&gt;</span><br><span class="line">        &#123;/* logo */&#125;</span><br><span class="line">        &lt;h1 class=&quot;logo&quot;&gt;</span><br><span class="line">          &lt;RouterLink to=&quot;/&quot;&gt; Logo &lt;/RouterLink&gt;</span><br><span class="line">        &lt;/h1&gt;</span><br><span class="line">        &#123;/* 菜单 */&#125;</span><br><span class="line">        &lt;a-menu</span><br><span class="line">          v-model:openKeys=&#123;openKeys.value&#125;</span><br><span class="line">          v-model:selectedKeys=&#123;selectedKeys.value&#125;</span><br><span class="line">          theme=&quot;light&quot;</span><br><span class="line">          mode=&quot;inline&quot;</span><br><span class="line">        &gt;</span><br><span class="line"><span class="addition">+          &#123;renderSubMenu()&#125;</span></span><br><span class="line">        &lt;/a-menu&gt;</span><br><span class="line">      &lt;/a-layout-sider&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="高亮侧栏菜单"><a href="#高亮侧栏菜单" class="headerlink" title="高亮侧栏菜单"></a>高亮侧栏菜单</h3><p>监听路由切换，展开并高亮对应的菜单项</p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">&lt;script lang=&quot;jsx&quot;&gt;</span><br><span class="line">import &#123; useRouter &#125; from &#x27;vue-router&#x27;</span><br><span class="line"><span class="addition">+ import &#123; watch &#125; from &#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line">export default defineComponent(&#123;</span><br><span class="line">  name: &#x27;SideBarItem&#x27;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    // ...省略</span><br><span class="line">    const router = useRouter() // 获取路由实例</span><br><span class="line">    </span><br><span class="line"><span class="addition">+   // 监听路由变化，更新选中的菜单</span></span><br><span class="line"><span class="addition">+   watch(</span></span><br><span class="line"><span class="addition">+     () =&gt; router.currentRoute.value,</span></span><br><span class="line"><span class="addition">+     (route) =&gt; &#123;</span></span><br><span class="line"><span class="addition">+       // 设置一级菜单高亮</span></span><br><span class="line"><span class="addition">+       openKeys.value = [route.meta?.parent]</span></span><br><span class="line"><span class="addition">+       // 设置二级菜单高亮</span></span><br><span class="line"><span class="addition">+       selectedKeys.value = [route.path]</span></span><br><span class="line"><span class="addition">+     &#125;,</span></span><br><span class="line"><span class="addition">+     // 立即执行</span></span><br><span class="line"><span class="addition">+     &#123; immediate: true &#125;,</span></span><br><span class="line"><span class="addition">+   )</span></span><br><span class="line"></span><br><span class="line">   // ...省略</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="Pinia-状态管理和持久化"><a href="#Pinia-状态管理和持久化" class="headerlink" title="Pinia 状态管理和持久化"></a>Pinia 状态管理和持久化</h2><p>Vue3 推荐的 Store 状态管理是 pinia (Vuex5)，项目中一般会按需配置 Store 的持久化。</p><p>Pinia官方：<a href="https://pinia.vuejs.org/zh/">https://pinia.vuejs.org/zh/</a></p><p>持久化存储：<a href="https://prazdevs.github.io/pinia-plugin-persistedstate/zh/guide/config.html#paths">https://prazdevs.github.io/pinia-plugin-persistedstate/zh/guide/config.html#paths</a></p><h3 id="安装依赖-2"><a href="#安装依赖-2" class="headerlink" title="安装依赖"></a>安装依赖</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install pinia-plugin-persistedstate</span><br></pre></td></tr></table></figure><h3 id="新建用户模块"><a href="#新建用户模块" class="headerlink" title="新建用户模块"></a>新建用户模块</h3><p><code>src\store\modules\account.js</code></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useAccountStore = <span class="title function_">defineStore</span>(</span><br><span class="line">  <span class="string">&#x27;account&#x27;</span>, <span class="comment">// store id</span></span><br><span class="line">  <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// store state</span></span><br><span class="line">    <span class="keyword">const</span> role = <span class="title function_">ref</span>(<span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> token = <span class="title function_">ref</span>(<span class="string">&#x27;token-string&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// store actions</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">changeRole</span> = (<span class="params">payload</span>) =&gt; &#123;</span><br><span class="line">      role.<span class="property">value</span> = payload</span><br><span class="line">      location.<span class="title function_">reload</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// return store state and actions</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      role,</span><br><span class="line">      token,</span><br><span class="line">      changeRole,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// 持久化存储 role 和 token</span></span><br><span class="line">    <span class="attr">persist</span>: &#123;</span><br><span class="line">      <span class="attr">paths</span>: [<span class="string">&#x27;role&#x27;</span>, <span class="string">&#x27;token&#x27;</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="配置持久化存储"><a href="#配置持久化存储" class="headerlink" title="配置持久化存储"></a>配置持久化存储</h3><p><code>src\store\index.js</code></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Vue3 推荐状态管理是 pinia (Vuex5)</span></span><br><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="comment">// 导入持久化存储插件</span></span><br><span class="line"><span class="keyword">import</span> persist <span class="keyword">from</span> <span class="string">&#x27;pinia-plugin-persistedstate&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 store 实例</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createPinia</span>()</span><br><span class="line"><span class="comment">// 使用持久化插件</span></span><br><span class="line">store.<span class="title function_">use</span>(persist)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出 store 实例</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出所有模块</span></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&#x27;./modules/account&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="全局应用-Store"><a href="#全局应用-Store" class="headerlink" title="全局应用 Store"></a>全局应用 Store</h3><p><code>src\main.js</code></p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">import &#123; createApp &#125; from &#x27;vue&#x27;</span><br><span class="line">import App from &#x27;./App.vue&#x27;</span><br><span class="line">import &#x27;./styles/main.less&#x27;</span><br><span class="line"></span><br><span class="line">import Icons from &#x27;./components/Icons&#x27;</span><br><span class="line">import router from &#x27;./router&#x27;</span><br><span class="line"><span class="addition">+ import store from &#x27;./store&#x27;</span></span><br><span class="line"></span><br><span class="line">const app = createApp(App)</span><br><span class="line"></span><br><span class="line">app.use(Icons)</span><br><span class="line">app.use(router)</span><br><span class="line"><span class="addition">+ app.use(store)</span></span><br><span class="line">app.mount(&#x27;#app&#x27;)</span><br></pre></td></tr></table></figure><h3 id="测试-Store-数据"><a href="#测试-Store-数据" class="headerlink" title="测试 Store 数据"></a>测试 Store 数据</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; useAccountStore &#125; from &#x27;@/store&#x27;</span><br><span class="line"></span><br><span class="line">// 获取用户 Store</span><br><span class="line">const accountStore = useAccountStore()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h3&gt;Store 角色: &#123;&#123; accountStore.role &#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;button @click=&quot;accountStore.changeRole(&#x27;admin&#x27;)&quot;&gt;切换角色 admin&lt;/button&gt;</span><br><span class="line">  &lt;button @click=&quot;accountStore.changeRole(&#x27;user&#x27;)&quot;&gt;切换角色 user&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h2 id="Mock-模拟数据"><a href="#Mock-模拟数据" class="headerlink" title="Mock 模拟数据"></a>Mock 模拟数据</h2><h3 id="安装依赖-3"><a href="#安装依赖-3" class="headerlink" title="安装依赖"></a>安装依赖</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install mockjs vite-plugin-mock -D</span><br></pre></td></tr></table></figure><h3 id="项目配置"><a href="#项目配置" class="headerlink" title="项目配置"></a>项目配置</h3><ul><li>配置 mock 服务： <code>vite.config.js</code></li></ul><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">import &#123; defineConfig &#125; from &#x27;vite&#x27;</span><br><span class="line">// ...省略</span><br><span class="line"><span class="addition">+ import &#123; viteMockServe &#125; from &#x27;vite-plugin-mock&#x27;</span></span><br><span class="line"></span><br><span class="line">// https://vitejs.dev/config/</span><br><span class="line">export default defineConfig(&#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    // ...省略</span><br><span class="line"><span class="addition">+    viteMockServe(&#123;</span></span><br><span class="line"><span class="addition">+      mockPath: &#x27;./src/mock&#x27;,</span></span><br><span class="line"><span class="addition">+      enable: true,</span></span><br><span class="line"><span class="addition">+      watchFiles: false,</span></span><br><span class="line"><span class="addition">+    &#125;),</span></span><br><span class="line">  ],</span><br><span class="line">  // ...省略</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="参考例子"><a href="#参考例子" class="headerlink" title="参考例子"></a>参考例子</h3><ul><li>新建 mock 数据文件：<code>src\mock\user.js</code></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> [</span><br><span class="line">  <span class="comment">// 模拟接口1</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/api/user/info&#x27;</span>, <span class="comment">// 请求地址</span></span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>, <span class="comment">// 请求方法</span></span><br><span class="line">    <span class="attr">response</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 返回数据</span></span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">code</span>: <span class="number">200</span>,</span><br><span class="line">        <span class="attr">msg</span>: <span class="string">&#x27;ok&#x27;</span>,</span><br><span class="line">        <span class="attr">data</span>: &#123;</span><br><span class="line">          <span class="comment">// MockJS 数据占位符定义：http://mockjs.com/examples.html#DPD</span></span><br><span class="line">          <span class="attr">id</span>: <span class="string">&#x27;@id&#x27;</span>, <span class="comment">// 随机 id</span></span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;黑马程序员&#x27;</span>, <span class="comment">// 普通信息</span></span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ...省略</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><ul><li>在 vue 文件中使用，先使用原生 fetch 获取数据，可根据项目需要换成 axios 。</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">const userInfo = ref()</span><br><span class="line">const getUserInfo = async () =&gt; &#123;</span><br><span class="line">  // 通过 fetch 获取用户信息(mock)</span><br><span class="line">  const response = await fetch(&#x27;/api/user/info&#x27;)</span><br><span class="line">  // 获取响应数据</span><br><span class="line">  const res = await response.json()</span><br><span class="line">  // 保存用户信息</span><br><span class="line">  userInfo.value = res.data</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;button @click=&quot;getUserInfo()&quot;&gt;获取 mock 用户信息&lt;/button&gt;</span><br><span class="line">  &lt;a-divider /&gt;</span><br><span class="line">  &lt;div&gt;用户信息：&#123;&#123; userInfo &#125;&#125;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p>注意事项：mock 数据更新后不生效，需要重启服务 <code>npm run dev</code>。</p><h2 id="request-封装"><a href="#request-封装" class="headerlink" title="request 封装"></a>request 封装</h2><p>axios官网：<a href="https://www.axios-http.cn/docs/intro">https://www.axios-http.cn/docs/intro</a></p><h3 id="安装依赖-4"><a href="#安装依赖-4" class="headerlink" title="安装依赖"></a>安装依赖</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">npm install axios</span><br></pre></td></tr></table></figure><h3 id="封装-axios-工具"><a href="#封装-axios-工具" class="headerlink" title="封装 axios 工具"></a>封装 axios 工具</h3><p>新建文件：<code>src\utils\request.js</code></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; message &#125; <span class="keyword">from</span> <span class="string">&#x27;ant-design-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useAccountStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入路由</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;@/router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 axios 实例</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> http = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_APP_BASE_URL</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">10000</span>, <span class="comment">// timeout</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// axios 请求拦截器</span></span><br><span class="line"><span class="comment">// https://axios-http.com/zh/docs/interceptors</span></span><br><span class="line">http.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; token &#125; = <span class="title function_">useAccountStore</span>()</span><br><span class="line">    <span class="keyword">if</span> (token) &#123;</span><br><span class="line">      config.<span class="property">headers</span>[<span class="string">&#x27;Authorization&#x27;</span>] = token</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 对请求错误做些什么</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">  &#125;,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// axios 响应拦截器</span></span><br><span class="line">http.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 提取响应数据</span></span><br><span class="line">    <span class="keyword">const</span> data = response.<span class="property">data</span></span><br><span class="line">    <span class="comment">// 如果是下载文件(图片等)，直接返回数据</span></span><br><span class="line">    <span class="keyword">if</span> (data <span class="keyword">instanceof</span> <span class="title class_">ArrayBuffer</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> data</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// code 为非 200 是抛错，可结合自己业务进行修改</span></span><br><span class="line">    <span class="keyword">const</span> &#123; code, msg &#125; = data</span><br><span class="line">    <span class="keyword">if</span> (code !== <span class="number">200</span>) &#123;</span><br><span class="line">      message.<span class="title function_">error</span>(msg)</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(msg)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 响应数据</span></span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> response = error.<span class="property">response</span></span><br><span class="line">    <span class="keyword">const</span> status = response &amp;&amp; response.<span class="property">status</span></span><br><span class="line">    <span class="comment">// 和后端约定的3种状态码会跳转登录，可结合自己业务进行修改</span></span><br><span class="line">    <span class="keyword">if</span> ([<span class="number">400</span>, <span class="number">401</span>, <span class="number">403</span>].<span class="title function_">includes</span>(status)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (status === <span class="number">400</span>) &#123;</span><br><span class="line">        message.<span class="title function_">warning</span>(<span class="string">&#x27;权限不足&#x27;</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (status === <span class="number">401</span>) &#123;</span><br><span class="line">        message.<span class="title function_">warning</span>(<span class="string">&#x27;登录状态过期&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 清理用户信息 token，重置权限路由等，可结合自己业务进行修改</span></span><br><span class="line">      <span class="comment">// TODO...</span></span><br><span class="line">      <span class="comment">// 跳转登录页</span></span><br><span class="line">      router.<span class="title function_">push</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="参考例子-1"><a href="#参考例子-1" class="headerlink" title="参考例子"></a>参考例子</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">import &#123; http &#125; from &#x27;@/utils/request&#x27;</span><br><span class="line"></span><br><span class="line">const userInfo = ref()</span><br><span class="line">const getUserInfo = async () =&gt; &#123;</span><br><span class="line">  // 通过 axios 获取用户信息(注意：请求 mock 需拼接成 http 开头的路径)</span><br><span class="line">  const res = await http.get(`$&#123;location.origin&#125;/api/user/info`)</span><br><span class="line">  userInfo.value = res.data</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;button @click=&quot;getUserInfo()&quot;&gt;获取 mock 用户信息&lt;/button&gt;</span><br><span class="line">  &lt;a-divider /&gt;</span><br><span class="line">  &lt;div&gt;用户信息：&#123;&#123; userInfo &#125;&#125;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h2 id="权限控制"><a href="#权限控制" class="headerlink" title="权限控制"></a>权限控制</h2><p>权限控制常见有两种业务需求：权限指令、权限路由(菜单)。</p><h3 id="权限指令"><a href="#权限指令" class="headerlink" title="权限指令"></a>权限指令</h3><p>基于权限控制按需展示某些功能模块，相当于结合了权限控制的 <code>v-if</code> 指令。</p><h4 id="权限指令封装"><a href="#权限指令封装" class="headerlink" title="权限指令封装"></a>权限指令封装</h4><p><code>src\directive\modules\permission.js</code></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useAccountStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 权限校验方法</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkPermission</span>(<span class="params">el, &#123; value &#125;</span>) &#123;</span><br><span class="line">  <span class="comment">// 获取用户 Store</span></span><br><span class="line">  <span class="keyword">const</span> accountStore = <span class="title function_">useAccountStore</span>()</span><br><span class="line">  <span class="comment">// 获取用户 Store 的角色，可根据业务情况进行调整</span></span><br><span class="line">  <span class="keyword">const</span> currentRole = accountStore.<span class="property">role</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 传入的权限值要求是一个数组</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(value) &amp;&amp; value.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// 判断用户角色是否有权限</span></span><br><span class="line">    <span class="keyword">const</span> hasPermission = value.<span class="title function_">includes</span>(currentRole)</span><br><span class="line">    <span class="comment">// 没有权限则删除当前dom</span></span><br><span class="line">    <span class="keyword">if</span> (!hasPermission) el.<span class="title function_">remove</span>()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`格式错误，正确用法 v-permission=&quot;[&#x27;admin&#x27;,&#x27;employee&#x27;]&quot;`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params">el, binding</span>) &#123;</span><br><span class="line">    <span class="title function_">checkPermission</span>(el, binding)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">updated</span>(<span class="params">el, binding</span>) &#123;</span><br><span class="line">    <span class="title function_">checkPermission</span>(el, binding)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="指令入口管理"><a href="#指令入口管理" class="headerlink" title="指令入口管理"></a>指令入口管理</h4><p><code>src\directive\index.js</code></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> permission <span class="keyword">from</span> <span class="string">&#x27;./modules/permission&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">install</span>(<span class="params">app</span>) &#123;</span><br><span class="line">    <span class="comment">// 注册全局指令</span></span><br><span class="line">    app.<span class="title function_">directive</span>(<span class="string">&#x27;permission&#x27;</span>, permission)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="全局注册指令"><a href="#全局注册指令" class="headerlink" title="全局注册指令"></a>全局注册指令</h4><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">import &#123; createApp &#125; from &#x27;vue&#x27;</span><br><span class="line">import App from &#x27;./App.vue&#x27;</span><br><span class="line">import &#x27;./styles/main.less&#x27;</span><br><span class="line"></span><br><span class="line">import Icons from &#x27;./components/Icons&#x27;</span><br><span class="line">import router from &#x27;./router&#x27;</span><br><span class="line">import store from &#x27;./store&#x27;</span><br><span class="line"><span class="addition">+ import directive from &#x27;./directive&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const app = createApp(App)</span><br><span class="line"></span><br><span class="line">app.use(Icons)</span><br><span class="line">app.use(router)</span><br><span class="line">app.use(store)</span><br><span class="line"><span class="addition">+ app.use(directive)</span></span><br><span class="line">app.mount(&#x27;#app&#x27;)</span><br></pre></td></tr></table></figure><h4 id="参考例子-2"><a href="#参考例子-2" class="headerlink" title="参考例子"></a>参考例子</h4><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; useAccountStore &#125; from &#x27;@/store&#x27;</span><br><span class="line"></span><br><span class="line">// 获取用户 Store</span><br><span class="line">const accountStore = useAccountStore()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h3&gt;Store 角色: &#123;&#123; accountStore.role &#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;button @click=&quot;accountStore.changeRole(&#x27;admin&#x27;)&quot;&gt;切换角色 admin&lt;/button&gt;</span><br><span class="line">  &lt;button @click=&quot;accountStore.changeRole(&#x27;user&#x27;)&quot;&gt;切换角色 user&lt;/button&gt;</span><br><span class="line">  &lt;a-divider /&gt;</span><br><span class="line"><span class="addition">+  &lt;a-button v-permission=&quot;[&#x27;admin&#x27;]&quot; type=&quot;primary&quot;&gt;admin 权限按钮&lt;/a-button&gt;</span></span><br><span class="line"><span class="addition">+  &lt;a-button v-permission=&quot;[&#x27;user&#x27;]&quot; type=&quot;primary&quot; ghost&gt; user 权限按钮&lt;/a-button&gt;</span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h3 id="权限路由-菜单"><a href="#权限路由-菜单" class="headerlink" title="权限路由(菜单)"></a>权限路由(菜单)</h3><p>业务较为复杂，请参考素材中的源码解读。</p><p>权限路由常见业务为：</p><ol><li>获取后端返回的用户菜单(权限)</li><li>基于返回的菜单(权限)，查找匹配的路由</li><li>注册成路由，添加路由导航守卫等</li><li>基于新注册的路由，生成后台管理系统的菜单</li><li>退出登录，清理用户信息的同时，清理权限路由</li></ol><h2 id="感言"><a href="#感言" class="headerlink" title="感言"></a>感言</h2><p>感谢各位小伙伴能学习到这里，自己动手丰衣足食。</p><p>当然 Vue3 生态在国内非常活跃，有很多优秀的后台管理系统模板，作为最后给大家的分享。</p><h3 id="Vue3-生态后台管理系统分享"><a href="#Vue3-生态后台管理系统分享" class="headerlink" title="Vue3 生态后台管理系统分享"></a>Vue3 生态后台管理系统分享</h3><p><a href="https://github.com/search?q=vue3+admin&amp;type=repositories&amp;s=stars&amp;o=desc">GitHub 排名</a></p><div class="table-container"><table><thead><tr><th>开源仓库</th><th>预览地址</th><th>组件库</th><th>Star 数量</th></tr></thead><tbody><tr><td><a href="https://github.com/vbenjs/vue-vben-admin">vbenjs/vue-vben-admin</a></td><td><a href="https://vben.vvbin.cn/">预览地址</a></td><td><a href="https://antdv.com/docs/vue/introduce-cn/">Ant-Design-Vue</a></td><td><img src="https://img.shields.io/github/stars/vbenjs/vue-vben-admin" /></td></tr><tr><td><a href="https://github.com/flipped-aurora/gin-vue-admin">flipped-aurora/gin-vue-admin</a></td><td><a href="https://demo.gin-vue-admin.com/">预览地址</a></td><td><a href="https://element-plus.org/zh-CN/">element-plus</a></td><td><img src="https://img.shields.io/github/stars/flipped-aurora/gin-vue-admin" /></td></tr><tr><td><a href="https://github.com/chuzhixin/vue-admin-better">chuzhixin/vue-admin-better</a></td><td><a href="https://vue-admin-beautiful.com/shop-vite">预览地址</a></td><td><a href="https://element-plus.org/zh-CN/">element-plus</a></td><td><img src="https://img.shields.io/github/stars/chuzhixin/vue-admin-better" /></td></tr><tr><td><a href="https://github.com/pure-admin/vue-pure-admin">pure-admin/vue-pure-admin</a></td><td><a href="https://yiming_chang.gitee.io/vue-pure-admin/">预览地址</a></td><td><a href="https://element-plus.org/zh-CN/">element-plus</a></td><td><img src="https://img.shields.io/github/stars/pure-admin/vue-pure-admin" /></td></tr><tr><td><a href="https://github.com/honghuangdc/soybean-admin">honghuangdc/soybean-admin</a></td><td><a href="https://admin.soybeanjs.cn/">预览地址</a></td><td><a href="https://www.naiveui.com/zh-CN/os-theme">Naive UI</a></td><td><img src="https://img.shields.io/github/stars/honghuangdc/soybean-admin" /></td></tr><tr><td><a href="https://github.com/HalseySpicy/Geeker-Admin">HalseySpicy/Geeker-Admin</a></td><td><a href="https://admin.spicyboy.cn/#/login">预览地址</a></td><td><a href="https://element-plus.org/zh-CN/">element-plus</a></td><td><img src="https://img.shields.io/github/stars/HalseySpicy/Geeker-Admin" /></td></tr><tr><td><a href="https://github.com/jekip/naive-ui-admin">jekip/naive-ui-admin</a></td><td><a href="http://naive-ui-admin.vercel.app/">预览地址</a></td><td><a href="https://www.naiveui.com/zh-CN/os-theme">Naive UI</a></td><td><img src="https://img.shields.io/github/stars/jekip/naive-ui-admin" /></td></tr><tr><td><a href="https://github.com/yangzongzhuan/RuoYi-Vue3">yangzongzhuan/RuoYi-Vue3</a></td><td><a href="https://vue.ruoyi.vip/">预览地址</a></td><td><a href="https://element-plus.org/zh-CN/">element-plus</a></td><td><img src="https://img.shields.io/github/stars/yangzongzhuan/RuoYi-Vue3" /></td></tr><tr><td><a href="https://github.com/un-pany/v3-admin-vite/">un-pany/v3-admin-vite</a></td><td><a href="https://un-pany.github.io/v3-admin-vite/">预览地址</a></td><td><a href="https://element-plus.org/zh-CN/">element-plus</a></td><td><img src="https://img.shields.io/github/stars/un-pany/v3-admin-vite" /></td></tr><tr><td><a href="https://github.com/buqiyuan/vue3-antdv-admin">buqiyuan/vue3-antdv-admin</a></td><td><a href="https://buqiyuan.gitee.io/vue3-antdv-admin/">预览地址</a></td><td><a href="https://antdv.com/docs/vue/introduce-cn/">Ant-Design-Vue</a></td><td><img src="https://img.shields.io/github/stars/buqiyuan/vue3-antdv-admin" /></td></tr><tr><td><a href="https://github.com/arco-design/arco-design-pro-vue">arco-design/arco-design-pro-vue</a></td><td><a href="https://vue-pro.arco.design/">预览地址</a></td><td><a href="https://arco.design/">arco.design-字节跳动</a></td><td><img src="https://img.shields.io/github/stars/arco-design/arco-design-pro-vue" /></td></tr></tbody></table></div>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Vue3.2+Vite+Typescript 开发（三）</title>
      <link href="/posts/bef0cccb/"/>
      <url>/posts/bef0cccb/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><div class="note blue no-icon flat"><p>Vue3.2+Vite+Typescript 开发双端招聘全过程系列导航</p><ol><li><a href="/posts/976198b5/">基础环境配置（一）</a></li><li><a href="/posts/f3ee6f99/">可复用的页面交互逻辑（二）</a></li><li>个人中心模块（三） ⇦当前位置🪂</li><li>即将闪亮登场..</li></ol></div><h2 id="子组件中的标签重复渲染问题发现与解决"><a href="#子组件中的标签重复渲染问题发现与解决" class="headerlink" title="子组件中的标签重复渲染问题发现与解决"></a>子组件中的标签重复渲染问题发现与解决</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>此为一个展示账户信息的页面组件 - /src/my/components/AccountInfo.vue</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; useRouter &#125; from &#x27;vue-router&#x27;</span><br><span class="line">import &#123; myStore &#125; from &#x27;@/stores/my&#x27;</span><br><span class="line"></span><br><span class="line">const store = myStore()</span><br><span class="line">const router = useRouter()</span><br><span class="line"></span><br><span class="line">const gotoPath = path =&gt; &#123;</span><br><span class="line">  router.push(path)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (!store.userInfo.user_name) &#123;</span><br><span class="line">  store.getUserInfo()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(&#x27;accountInfo setup start&#x27;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;account-info&quot;&gt;</span><br><span class="line">    &lt;p&gt;</span><br><span class="line">      &lt;label</span><br><span class="line">        &gt;账户余额 &lt;van-icon name=&quot;question-o&quot; @click=&quot;gotoPath(&#x27;/my/account/CoinExplain&#x27;)&quot;</span><br><span class="line">      /&gt;&lt;/label&gt;</span><br><span class="line">      &lt;span&gt;提现&lt;van-icon name=&quot;arrow&quot; /&gt;&lt;/span&gt;</span><br><span class="line">    &lt;/p&gt;</span><br><span class="line">    &lt;!-- 这里，逻辑上的瑕疵居然会导致该组件重复渲染，真是晕了 --&gt;</span><br><span class="line">    &lt;h3&gt;&#123;&#123; store.userInfo.account_price?.toFixed(2) ?? &#x27;0.00&#x27; &#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p>其中，<code>store.userInfo.account_price?.toFixed(2)</code> 导致控制台出现了一个有关报错，起初我没有在意，但是在父页面执行刷新时，导致该组件出现了重复二次渲染的现象。</p><p>原因为：<code>store.userInfo</code> 是响应式数据，当其值从 <code>null/undefined</code> 变为有值时会触发渲染。</p><p>其中：</p><ul><li><code>?.</code> 安全访问属性</li><li><code>??</code> 提供默认值</li></ul>              </div>            </details><h2 id="输入框-type-number时的莫名提示解决"><a href="#输入框-type-number时的莫名提示解决" class="headerlink" title="输入框 type=number时的莫名提示解决"></a>输入框 type=number时的莫名提示解决</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>实际页面中，输入 123.45 点击提交时， 输入框会弹出一个距离最近的有效值提示，提示输入123 或124 。</p><p>这个问题的根本原因是 <strong>浏览器对 <code>&lt;input type=&quot;number&quot;&gt;</code> 的默认行为</strong> 结合 <strong>浮点数精度处理</strong> 导致的。以下是详细分析和解决方案：</p><hr><h3 id="🔍-问题根源分析"><a href="#🔍-问题根源分析" class="headerlink" title="🔍 问题根源分析"></a>🔍 <strong>问题根源分析</strong></h3><ol><li>浏览器对 <code>type=&quot;number&quot;</code> 的默认行为</li></ol><p>​    当使用 <code>&lt;input type=&quot;number&quot;&gt;</code> 时：</p><ul><li>浏览器会自动进行<strong>步进值（step）校验</strong></li><li>默认 <code>step=&quot;1&quot;</code>，导致浏览器会尝试将输入值对齐到最近的整数</li><li>触发条件：提交表单或失去焦点时</li></ul><ol><li>浮点数精度问题（关键原因）</li></ol><ul><li>当你输入 <code>123.45</code> 时，实际存储的值可能是 <code>123.44999999999999</code>（二进制浮点数误差）</li><li>浏览器根据 <code>step=&quot;1&quot;</code> 的规则，会将其修正为最近的整数：<ul><li><code>123.449...</code> → 向下取整提示 <code>123</code></li><li><code>123.55</code> → 向上取整提示 <code>124</code></li></ul></li></ul><hr><h3 id="🛠️-解决方案"><a href="#🛠️-解决方案" class="headerlink" title="🛠️ 解决方案"></a>🛠️ <strong>解决方案</strong></h3><p>方案1：强制指定 <code>step</code> 属性（推荐）</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;input </span><br><span class="line">  type=&quot;number&quot;</span><br><span class="line">  v-model=&quot;state.price&quot;</span><br><span class="line">  step=&quot;0.01&quot;  &lt;!-- 允许2位小数 --&gt;</span><br><span class="line">  min=&quot;0&quot;</span><br><span class="line">  max=&quot;50000&quot;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><p><strong>效果</strong>：</p><ul><li>明确告知浏览器允许2位小数</li><li>不再进行整数修正</li></ul><p>方案2：改用 <code>type=&quot;text&quot;</code> + 自定义校验</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;input </span><br><span class="line">  type=&quot;text&quot;</span><br><span class="line">  v-model=&quot;state.price&quot;</span><br><span class="line">  @input=&quot;handlePriceInput&quot;</span><br><span class="line">  pattern=&quot;^\d+(\.\d&#123;1,2&#125;)?$&quot;  &lt;!-- 正则验证 --&gt;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><p><strong>JS 处理</strong>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const handlePriceInput = (e) =&gt; &#123;</span><br><span class="line">  // 过滤非数字字符</span><br><span class="line">  state.price = e.target.value.replace(/[^\d.]/g, &#x27;&#x27;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>方案3：精确控制数值（处理浮点数误差）</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 提交时强制修正精度</span><br><span class="line">const submit = () =&gt; &#123;</span><br><span class="line">  const fixedPrice = parseFloat((state.price).toFixed(2)) // 强制2位小数</span><br><span class="line">  // 使用 fixedPrice 提交</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>🌟 <strong>最佳实践建议</strong></p><ol><li><p><strong>始终为 <code>type=&quot;number&quot;</code> 设置明确的 <code>step</code></strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;input type=&quot;number&quot; step=&quot;any&quot;&gt;  &lt;!-- 允许任意小数 --&gt;</span><br><span class="line">&lt;!-- 或 --&gt;</span><br><span class="line">&lt;input type=&quot;number&quot; step=&quot;0.01&quot;&gt; &lt;!-- 明确2位小数 --&gt;</span><br></pre></td></tr></table></figure></li></ol>              </div>            </details>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>为双招api项目增加中转服务全过程</title>
      <link href="/posts/46edb940/"/>
      <url>/posts/46edb940/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><h3 id="1-方案构思"><a href="#1-方案构思" class="headerlink" title="1. 方案构思"></a>1. 方案构思</h3><p>其实，仅仅是中转服务，也可以考虑在原有api的主文件中增加中转逻辑，尤其是原有api与中转逻辑存在管理的情景</p><h3 id="2-可行性分析-amp-方案实施"><a href="#2-可行性分析-amp-方案实施" class="headerlink" title="2.可行性分析&amp;方案实施"></a>2.可行性分析&amp;方案实施</h3><p>完全可以在原有 API 的主文件中直接增加中转逻辑，尤其是当你的原有 API 和中转逻辑存在相互管理和协调的情景时，这样的设计方式会更加简洁且易于维护。</p><p> ✅ 在原有 API 中增加中转逻辑的优势：</p><ol><li><strong>集中管理</strong>：所有的服务逻辑都集中在一个地方，便于管理和调试。</li><li><strong>减少复杂性</strong>：不需要单独启动一个额外的中转服务，避免了服务间的协调和多端口监听的复杂性。</li><li><strong>共享资源</strong>：可以直接共享原有 API 的资源、认证逻辑和中间件，避免重复的代码。</li><li><strong>高效的开发和部署</strong>：如果你已经有一个稳定的 API 服务，直接在其基础上增加中转逻辑可以加快开发进度，并且减少部署过程中的中转和负载均衡等问题。</li></ol><p>✅ 设计思路：</p><ol><li><strong>在原有 API 中实现中转逻辑</strong>：你可以通过在现有 API 中增加一个新的路由，处理那些需要代理的请求。这个新路由会接收到来自前端的请求，执行相应的处理后，将其转发到真实的 API 服务。</li><li><strong>与现有逻辑结合</strong>：你可以将中转服务与现有的 API 控制器或服务层进行集成，共享已有的验证、授权等逻辑。</li></ol><p>原有app.js主文件：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在文件顶部引入 dotenv，加载环境变量</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;dotenv&#x27;</span>).<span class="title function_">config</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&#x27;axios&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入 express</span></span><br><span class="line"><span class="keyword">const</span>  express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建 express 实例</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入 Joi 模块</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Joi</span> = <span class="built_in">require</span>(<span class="string">&#x27;joi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 cors 跨域中间件</span></span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解析 JSON 数据</span></span><br><span class="line"><span class="comment">// 确保后端启用了 app.use(express.json());</span></span><br><span class="line"><span class="comment">// 这样可以避免由于请求格式不一致导致的问题, 例如在 apifox 中（会自动帮我们转换为json格式）发送请求可正常得到响应</span></span><br><span class="line"><span class="comment">// 但是在实际前端项目中由于携带的参数未经json转换，导致后端无法解析参数，从而导致请求失败</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>())</span><br><span class="line"><span class="comment">// 配置解析表单数据的中间件，仅能解析 application/x-www-form-urlencoded 类型的表单数据</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应数据的中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="property">cc</span> = <span class="function">(<span class="params">err, status = <span class="number">1</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// status 默认值为 1，表示失败的情况</span></span><br><span class="line">    <span class="comment">// err 可能是一个 Error 对象，也可能时一个描述错误信息的字符串</span></span><br><span class="line">    res.<span class="title function_">send</span>(&#123;</span><br><span class="line">      status,</span><br><span class="line">      <span class="attr">message</span>: err <span class="keyword">instanceof</span> <span class="title class_">Error</span> ? err.<span class="property">message</span> : err</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 一定要在路由之前，应用此中间件</span></span><br><span class="line"><span class="keyword">const</span> &#123; expressjwt &#125; = <span class="built_in">require</span>(<span class="string">&#x27;express-jwt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(</span><br><span class="line">  <span class="title function_">expressjwt</span>(&#123;</span><br><span class="line">    <span class="attr">secret</span>: process.<span class="property">env</span>.<span class="property">JWT_SECRET_KEY</span>, <span class="comment">// 从环境变量中读取密钥, // 与生成 Token 时的密钥保持一致</span></span><br><span class="line">    <span class="attr">algorithms</span>: [<span class="string">&#x27;HS256&#x27;</span>], <span class="comment">// 确保算法与 Token 的签名方式匹配</span></span><br><span class="line">    <span class="attr">getToken</span>: <span class="function">(<span class="params">req</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 从 x-access-token 提取 Token</span></span><br><span class="line">      <span class="keyword">const</span> token = req.<span class="property">headers</span>[<span class="string">&#x27;x-access-token&#x27;</span>]</span><br><span class="line">      <span class="keyword">if</span> (token &amp;&amp; token.<span class="title function_">startsWith</span>(<span class="string">&#x27;Bearer &#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> token.<span class="title function_">slice</span>(<span class="number">7</span>) <span class="comment">// 去掉 &quot;Bearer &quot; 前缀</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;).<span class="title function_">unless</span>(&#123;</span><br><span class="line">    <span class="attr">path</span>: [<span class="regexp">/^\/api\/login(\/.*)?$/</span>, <span class="regexp">/^\/proxy(\/.*)?$/</span>] <span class="comment">// 允许 /proxy 路径不进行认证 // 豁免登录相关接口</span></span><br><span class="line">  &#125;)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入并使用用户路由模块</span></span><br><span class="line"><span class="keyword">const</span> userRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/user&#x27;</span>)</span><br><span class="line"><span class="comment">// /api 是一个统一的接口路径前缀</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, userRouter)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 任务列表路由模块</span></span><br><span class="line"><span class="keyword">const</span> taskRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/task&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, taskRouter)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义错误级别中间件</span></span><br><span class="line"><span class="comment">// 这里必须要有 next()</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err, req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 数据验证失败</span></span><br><span class="line">  <span class="keyword">if</span> (err <span class="keyword">instanceof</span> <span class="title class_">Joi</span>.<span class="property">ValidationError</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line">  <span class="comment">// 身份认证失败</span></span><br><span class="line">  <span class="keyword">if</span> (err.<span class="property">name</span> === <span class="string">&#x27;UnauthorizedError&#x27;</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;身份认证失败！&#x27;</span>)</span><br><span class="line">  <span class="comment">// 未知错误</span></span><br><span class="line">  res.<span class="title function_">cc</span>(err)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(err)</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动服务器</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3007</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;服务器启动成功: http://127.0.0.1:3007&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>其中，增加以下中转逻辑</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 中转所有 /proxy 开头的请求</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/proxy&#x27;</span>, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> targetUrl = <span class="string">&#x27;https://imooc.zcwytd.com&#x27;</span> + req.<span class="property">originalUrl</span>.<span class="title function_">replace</span>(<span class="regexp">/^\/proxy/</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">axios</span>(&#123;</span><br><span class="line">      <span class="attr">method</span>: req.<span class="property">method</span>,</span><br><span class="line">      <span class="attr">url</span>: targetUrl,</span><br><span class="line">      <span class="attr">headers</span>: &#123;</span><br><span class="line">        ...req.<span class="property">headers</span>,</span><br><span class="line">        <span class="attr">host</span>: <span class="string">&#x27;imooc.zcwytd.com&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">data</span>: req.<span class="property">body</span> <span class="comment">// 支持 POST/PUT 等请求体</span></span><br><span class="line">    &#125;)</span><br><span class="line">    res.<span class="title function_">status</span>(response.<span class="property">status</span>).<span class="title function_">send</span>(response.<span class="property">data</span>)</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;代理请求出错：&#x27;</span>, err.<span class="property">message</span>)</span><br><span class="line">    res.<span class="title function_">status</span>(err.<span class="property">response</span>?.<span class="property">status</span> || <span class="number">500</span>).<span class="title function_">send</span>(&#123;</span><br><span class="line">      <span class="attr">error</span>: err.<span class="property">message</span>,</span><br><span class="line">      <span class="attr">details</span>: err.<span class="property">response</span>?.<span class="property">data</span> || <span class="string">&#x27;无法获取更多信息&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><details class="folding-tag" ><summary> - 需要在 expressjwt.unless 中放行新增的代理路径 </summary>              <div class='content'>              <p>✅ 解决方案</p><p>修改这段代码中的 <code>unless</code> 配置，让 <code>/hmhrproxy</code> 也豁免掉身份认证：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">js复制编辑app.use(</span><br><span class="line">  expressjwt(&#123;</span><br><span class="line">    secret: process.env.JWT_SECRET_KEY,</span><br><span class="line">    algorithms: [&#x27;HS256&#x27;],</span><br><span class="line">    getToken: (req) =&gt; &#123;</span><br><span class="line">      const token = req.headers[&#x27;x-access-token&#x27;]</span><br><span class="line">      if (token &amp;&amp; token.startsWith(&#x27;Bearer &#x27;)) &#123;</span><br><span class="line">        return token.slice(7)</span><br><span class="line">      &#125;</span><br><span class="line">      return null</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;).unless(&#123;</span><br><span class="line">    path: [</span><br><span class="line">      /^\/api\/login(\/.*)?$/, </span><br><span class="line">      /^\/proxy(\/.*)?$/, </span><br><span class="line">      /^\/hmhrproxy(\/.*)?$/  // ✅ 加上这一行，豁免 /hmhrproxy 的中转请求</span><br><span class="line">    ]</span><br><span class="line">  &#125;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="3-重新拉取"><a href="#3-重新拉取" class="headerlink" title="3.重新拉取"></a>3.重新拉取</h3><p>在 <code>/var/www/shuangzhao-api-project</code> 目录下，如果要确认本地 Git 分支，可以直接运行：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git branch  #确认本地分支</span><br><span class="line">git branch -a #同时看到本地分支和远程分支</span><br><span class="line"></span><br><span class="line">git pull #从远程拉取最新代码</span><br></pre></td></tr></table></figure><p>然后，执行 <code>npm -i</code>，执行安装！</p><details class="folding-tag" ><summary> 为了确保正常通信 - 需要建立密钥关系 </summary>              <div class='content'>              <p>运行以下命令：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t ed25519 -C &quot;youruilin@gmail.com&quot;</span><br></pre></td></tr></table></figure><p>系统会提示你输入文件保存路径。默认是 <code>/root/.ssh/id_rsa</code>，如果你不想改变路径，直接按 <strong>回车</strong> 就行。如果你想自定义路径，可以输入新的文件路径。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Enter file in which to save the key (/root/.ssh/id_rsa): [直接按回车或输入路径]</span><br></pre></td></tr></table></figure><p>完成密钥生成后，你可以查看生成的公钥（<code>id_rsa.pub</code>），并将其添加到 GitHub：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure><p>接下来，需要将复制的内容添加至 github：</p><ul><li><p>登录到你的 GitHub 账户，进入 <strong>Settings</strong> -&gt; <strong>SSH and GPG keys</strong> -&gt; <strong>New SSH key</strong>，然后粘贴你刚刚复制的公钥，保存即可。</p></li><li><p>公钥添加到 GitHub 后，可以通过以下命令测试 SSH 连接：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure></li></ul>              </div>            </details><details class="folding-tag" ><summary> 关于node环境确实 </summary>              <div class='content'>              <p>Node.js 和 npm 的安装通常会绑定到特定用户的环境中，而当使用 root 用户时，可能无法访问普通用户的配置或安装的工具。因此，解决方法主要是确保你在正确的用户环境下执行命令。</p>              </div>            </details><h3 id="4-修改nginx规则"><a href="#4-修改nginx规则" class="headerlink" title="4. 修改nginx规则"></a>4. 修改nginx规则</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 编辑配置文件</span><br><span class="line">sudo nano /etc/nginx/sites-available/default</span><br></pre></td></tr></table></figure><p>增加 proxy 字段</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 反向代理本地 API 服务</span><br><span class="line">location /api/ &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1:3007;  # 不加路径，完整转发 /api/**</span><br><span class="line">    proxy_set_header Host $host;</span><br><span class="line">    proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 转发代理第三方 API（Node 中转）</span><br><span class="line">location /proxy/ &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1:3007;  # /proxy/** 会走 Node 中转</span><br><span class="line">    proxy_set_header Host $host;</span><br><span class="line">    proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong><code>Ctrl</code> + <code>O</code></strong>（字母 O）来保存文件，然后<code>Ctrl</code>+<code>X</code>退出</p><p>测试配置</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nginx -t</span><br></pre></td></tr></table></figure><p>重新加载 nginx</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl reload nginx</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2025-04-05 新标日语中级</title>
      <link href="/posts/ff180d2/"/>
      <url>/posts/ff180d2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><style>#web_bg{  /* background: url(/img/newbg.png)!important; */  /*重新定义background会导致原有定位属性失效，所以也需要再声明一次加权的定位属性*/  /* background-position: center !important;  background-size: cover !important;  background-repeat: no-repeat !important; */}</style><div class="note blue no-icon flat"><p>日本語の勉強すればするほど、楽しいに感じになりました。ここで、全过程系列导航～</p><ol><li><a href="/posts/d711a81c/">新标准日本语文法要点（上） </a></li><li>新标准日本语文法要点（中） ⇦当前位置🪂</li><li>新标准日本语文法要点（下）</li><li><a href="/posts/42edf4c9/">日本語能力練習</a></li></ol></div><div class="note warning flat"><p>注意：此页面偶尔会存在CSS冲突问题!</p></div><h2 id="1-第一单元"><a href="#1-第一单元" class="headerlink" title="1. 第一单元"></a>1. 第一单元</h2><details class="folding-tag" ><summary> 1. 出会い </summary>              <div class='content'>              <p>　李：あのう，すみません！<br>男性：えっ？<br>　李：これ，【落ちました|おちます，落ちます　初级上册33课】よ。<br>男性：あっ！すみません。ありがとうございます。</p><p>　李：あのう，失礼ですが，先ほどの方じゃありませんか。<br>男性：ああ，さっきは，とてもありがとうございました。【助かりました|たすかる】<br>　李：いいえ，【どういたしまして|没关系，哪里哪里】。<br>男性：中国の方ですか。日本語がお上手ですね。<br>　李：いいえ，まだまだです。勉強【すればするほど|动/一类形  ば  动/一类形  ほど  小句：表示某性质的程度与其相关的动作、性质成正比例关系；】，難しくなる感じがします。</p><p>男性：ええ。こちらに【転勤|てんきん】になったんです。空港が【すっかり|完全的】変わりましたね。【驚きました|おどろきます，吃惊】。<br>　李：街もずいぶん変わっていますよ。変化が早くて，わたしたちも【ついていけない|这里用的是 ついていく 的可能态 ついていける 的否定形式 ついていけない，ついていかない 是 ついていく 的 ない 形，意思：跟不上】くらいです。<br>男性：そうでしょうね。<br>　李：ほら，高層ビルが見えてきた【でしょう|简体小句+でしょう：推测】？あの辺は上海の新しい中心地なんです。<br>男性：すごい。【まるでニューヨークみたいですね|まるで＋名词＋みたい：简直就像…一样，宛如…】。</p><p>　李：じゃあ，ここで。<br>男性：ええ，どうもありがとうございました。さようなら。</p><p>【文法説明】</p><ol><li><p>自动词和他动词：自动词落ちます，他动词落とします。日语当中存在相应的自他动词时，不能用无生命的物体来充当主语。</p></li><li><p>先ほど：さっき的礼貌说法，意思相同，区别是さっき只用于口语，而先ほど也可以用于书面语。</p></li><li><p>先ほどの方　[助词の]：省略动词，采用名词＋の＋名词的形式比较多见，例如：昨日の料理。</p><p><a href="https://docs.google.com/document/d/1l_ZreTaSpfFiniwh1Niq7zZ9Ao7WotmHtmUsOEERvjE/edit#bookmark=id.vcmams5p2dn1">另外需要特别说明，日语当中动词（简体形）可以直接修饰名词。</a>如本课文当中的：先ほどあった方或先ほど手帳を落とした方。</p><p>あのう，失礼ですが，先ほどの方じゃありませんか。</p><p>先ほどの質問にお答えします。</p></li><li><p>助かりました：<strong>助かります是自动词</strong>，<strong>助けます是他动词</strong>，表示对~有帮助的意思。<strong>自动词助かります可以用助词が提示获得帮助的人；</strong></p><p>天気がいいので，助かります。</p><p>仕事を手伝え<a href="https://docs.google.com/document/d/1l_ZreTaSpfFiniwh1Niq7zZ9Ao7WotmHtmUsOEERvjE/edit#bookmark=id.d0uawpnhc93b">ば，</a>＊お父さんが助かります。</p><p>另外，如本课出现的那样，助かります还可以用来表示感谢。</p><p>さっきは，どうもありがとうございました。助かりました。</p><p>荷物を持っ<strong>ていただ</strong>いて，助かりました。</p><p>基本形～もらう  →  自谦语基本形～いただく  自谦语ます形～ていただきます</p></li><li><p>感じがします：表示有印象，意思与感感じます相近，但感じます多用来表示直接感受，而感じがします多表示留有某种印象。</p><p>日本人ではない<strong>という</strong>感じがします。</p><p>行ったほうがいい<strong>という</strong>感じがします。</p><p>勉強すればするほど，難しくなる感じがします。</p><p>北京の街並みがすっかり変わってしまって，＊不思議な感じがします。</p><p>この<strong>景色</strong>を見ると，日本に来たという感じがします。</p><p><strong>～という也可以用于给名词1下定义或对其进行解释</strong></p></li><li><p>～へは／は：</p><p>助词が和を后续助词は时，需要省略掉が或を＋は。</p><p>助词へ后续は时，へ可以省略也可以不省略。</p><p>助词に、で、と、から、より等后续は时，直接在后面＋は。</p><p>上海へは，仕事で【いらっしゃったんですか|来る／行く／いる 的<strong>敬语表达</strong>】。</p></li></ol><div class="table-container"><table><thead><tr><th>が＋は＝は</th><th>この駅の駅弁はおいしいです</th></tr></thead><tbody><tr><td>を＋は＝は</td><td>お酒は飲みません</td></tr><tr><td>へ＋は＝は／へは</td><td>京都へは（は）行きませんでした</td></tr><tr><td>と＋は＝とは</td><td>李さんとはどこで待ち合わせましたか</td></tr><tr><td>から＋は＝からは</td><td>外からはなかにだれいるのか分かりません</td></tr></tbody></table></div><ol><li><p>転勤になった：</p><p>転勤指公司职员或公务员调到该公司或组织的其他工作地点工作。します是他动词， なります是自动词，になります表示不是出于本人意愿，而是由于自身以外的原因才导致的。因为工作调动最终是要公司决定，所以転勤になります更为适用。<br>ええ，こちらに転勤になったんです。</p></li><li><p>すっかり和ずいぶん：</p><p>すっかり表示变化的程度，用于综合性、整体性的变化。</p><p>空港がすっかり変わりましたね。驚きましたよ。（おどろきます，驚きます，吃惊）</p><p>病気はもうすっかりよくなりました。</p><p>李さんにもらった＊あめはすっかり＊なめてしまいました。</p><p>ずいぶん，可以表示动作的量，也可以如ずいぶん新しい这样修饰形容词。而すっかり表示状态发生整体性变化，不能表示动作的量。简单来说，两者用法一样，但是所传达的意思有所区别。</p><p>街もずいぶん変わっていますよ。ずいぶんたくさん買い物をしましたね。</p><p>陳さんの病気はすっかりよくなりました。陳さんの病気はずいぶんよくなりました。　　　　</p><p>すっかり，完全、彻底；ずいぶん，非常，相当；</p></li><li><p>ついていけない：</p><p>基本形　　　　　　ます形　　　　  可能形式      可能形式的否定形式 → 对应的简体形</p><p>ついていく     ついていきます    ついていけます   ついていけません     ついていけない</p><p>忘れる　　    　　　忘れます    忘れられる        忘れられません    忘れられない</p><p>変化が早くて，わたしたちもついていけないくらいです。</p><p>あの人の考え方にはついていけません。</p></li><li><p>～くらいです[强调程度]：～くらい／～ぐらい表示大概的数量，其实～くらい还用来强调某种状态达到何种程度，具体用法为：</p><p>❶小句简体形＋くらい／ぐらい，～　　</p><p>これは＊中学校の＊テストですが，大人でもわからないくらいむずかしい問題です。</p><p>❷～くらい／ぐらい＋の＋名词　</p><p>財布を忘れましたが，ジュースを買うくらいのお金は持っています。</p><p>❸小句简体形＋くらい／ぐらい　です　　</p><p>変化が早くて，わたしたちもついていけないくらいです。この辺は，静か過ぎて寂しいくらいです。</p><p>拓展：～ほど：小句简体形+ほど与小句简体形+くらい／ぐらい相同，意思大致相同，都是强调程度的表达方式。ほど主要用于书面语，くらい用于口语。</p><p><em>涙がでるほど，嬉しかったです。昨日はとても疲れました。最後は立っていられないほどでした。<br>首都開発計画は，面白いほど<em>*うまく</em></em>進んだ。（うまく，高明的，很好的）</p></li><li><p>～てきました＆～た：<a href="https://docs.google.com/document/d/1l_ZreTaSpfFiniwh1Niq7zZ9Ao7WotmHtmUsOEERvjE/edit#bookmark=id.dntr28aeli6d"><strong>～てきました表示变化的开始，或者不断朝着某个结果进展的状态。</strong></a></p><p>日本語の発音に少し慣れてきました。<br>＊救急車のサイレンの音がだんだん大きなってきました。<br>日本語の勉強がおもしろくなってきました。<br>ほら，高層ビルが見えてきたでしょう。<br>高層ビルが見えてきだでしょう。（能渐渐看到大楼了吧） 确定建筑物一点一滴进入视线的过程。<br>高層ビルが見えたでしょう。（能看到大楼的了吧）重点不在于变化，而指示单纯的确认是否看见</p></li></ol><p>【表現と言葉の説明】</p><ol><li><p>～とは:<a href="https://docs.google.com/document/d/1l_ZreTaSpfFiniwh1Niq7zZ9Ao7WotmHtmUsOEERvjE/edit#bookmark=id.1pxezwc">〜というのは的 省略形式</a>。用于提出某个名称，并就其进行说明或询问。</p><p>ゴンバシャーレンにというのは，＊エビと＊ピーナッツと＊唐辛子を＊炒めた料理です。</p><p>～とは还有下定义的用法，表现形式为 ~とは～のことです。</p><p>＊おせち料理とは，＊【正月|しょうがつ】に食べる＊お【祝い|いわい】の料理のことです。</p></li><li><p>～てき，表示抽象意义的汉语词后续てき，相当于汉语当中的“de”，作为二类形容词使用。</p><p>世界的に有名な新幹線もJRの路線の一つで，日本の主要な都市と都市を結んでいます。</p><p>彼はどんな事でも積極的です。</p><p>よくわからないので，もっと具体的に説明してください。</p></li><li><p>～は～の１つです：AはBの１つです，表示A属于B范围当中的一种；</p><p>世界的に有名な新幹線もJRの１つです。</p><p>日本は＊アジアの国の１つです。</p></li><li><p>都市と都市を【結ぶ|むすびます】：結ぶ本意为结绳，引申到后来，不仅用于物品，而且涵盖场所，事情，人际关系等，表示连接、建立关系等意思。用于句尾时，使用結んでいます的形式表示状态。</p><p>世界的に有名な新幹線もJRの路線の１つで，日本の主要な都市と都市を結んでいます。</p><p>靴の<strong>＊ひも</strong>を「きちんと｜好好的，正经的」結ぶ。（把鞋带挤紧。）</p><p>中国旅行は，私と妹を結ぶ【大切|たいせつ，很，非常】な＊【思い出|おもい出します，想起，想出】です。</p><p>*化石は，古い時代と現代を結んでいます。</p></li><li><p>どんどん[表示样子地副词]：表示事物发展无阻碍，进展十分顺利地拟态词。</p><p>山陽新幹線、東北新幹線、九州新幹線など，路線がどんどん【延びています|のびる】。</p></li><li><p>大~ ：根据词性不同，大~的读法有三种：</p><p>❶　だい：后续词一般为两个汉字词 ，如：大事件、大地震、大成功等々；</p><p>❷　たい：大一般形成了词语的一部分，不能分离，如：大変、大切等々；</p><p>❸　おお：一般为日语固有的词，如：*大金持ち、大雨、大汗等々；</p><p>但要注意，不是所有名词前都可以+大，如：大感謝、大進歩在日语中是不可这么说的，所以不要滥用。</p><p>另外，只有大規模是二类形容词，常用大規模な的形式修饰名词，但一般不用大規模だ的形式结句。</p><p>だい～　　　　大事件　　　　　　　大規模　　　　＊大感激</p><p>おお～　　　　大風　　　　　　　　大昔　　　　　　大笑い</p><p>大都市には大きな私鉄がたくさんあります。</p><p>さっき,社長から,今回の企画案がいいと「褒められて｜ほめる」，大感激です。</p><p>中国では大規模な都市開発「計画｜けいかく」が進んでいます。</p></li><li><p>また：连词，表示并列，相当于汉语当中的并且，另外。</p></li><li><p>もの：相当于汉语的“的”。</p><p>公営の鉄道は，地方自治体などが「経営する｜けいえい」ものです。</p><p>この資料は昨日お送りしたものと同じです。</p><p>の可以代替名词，もの有时可以变成の，有时不能，需要注意。公営の鉄道は，地方自治体などが経営するものです。当中的もの就不可以用の替换，因为这样会对句子的理解构成干扰，分不清到底是代替了名词的の，还是表示确认语气的のです。</p><p>この資料は昨日お送りした<strong>もの</strong>と同じです。（おなじです，同じです。）<strong>当中，もの指代具体事务，可以与no混用。</strong></p></li><li><p>～化：きんだいか，近代化，電子化，高齢化等。デジタル化、＊IT化。由于表示变化的意思，所以既可以用作名词，也可以后续する用作三类动词。</p><p>世界で初めて実用かされたリニアモーターカーも国営です。</p><p>この村では，近代化が進んで，高速ビルが建設されています。（被动形される）</p></li><li><p>上り，下り：</p></li><li><p>そこで，于是（更正式） ；それで，所以（更随意）；</p><p>JRや私鉄の各路線（かくろせん）では，運行（うんこう）の方向を表す（あらわす）特別な言葉を使っています。それは、「上り」「下り」という言葉です。そこで，こんななぞなぞがあります。</p><p>道がわからなくて【困りました|こまります】。そこで，近くにいた人に教えてもらいました。</p><p>東京に向かう路線を「上り（のぼり）」、地方に向かう路線を「下り（くだり）」をといいます。それで、こんななぞなぞができました。</p></li><li><p>のんな[指示上下文内容①]：是<strong>このような</strong>的比较随意的说法。指示后述内容时，只能用こ开头的指示词，使用これ、この、＊これらの等，以こ开头的 指示词。</p><p>そこで，こんななぞなぞがあります。日本で一番高い駅はどこでしょう。</p><p>これは＊秘密<a href="https://docs.google.com/document/d/1l_ZreTaSpfFiniwh1Niq7zZ9Ao7WotmHtmUsOEERvjE/edit#bookmark=id.vbpnl5pdn88f">だけど</a>，大川さんは昨日会社を休んでコンサートへ行ったらしいです。</p></li></ol><p>【课文】</p><p>日本の鉄道</p><p>日本には，JR，私鉄，公営の3種類の鉄道会社があります。JRとは，Japan　Raiways　の略です。以前は国営の鉄道でしたが，1987年に民営化されました。世界的に有名な新幹線もJRの路線の１つで，日本の主要な都市と都市を結んでいます。最高時速は300キロを超えます。最初に完成したのは東海道新幹線ですが，山陽新幹線、東北新幹線、九州新幹線など,路線がどんどんの延びています。</p><p>私鉄とは，JR以外の民間企業が経営する鉄道会社で，大都市には大きな私鉄がたくさんあります。また，公営の鉄道は，地方自治体などが経営するものです。</p><p>中国の鉄道は，ほとんど国営です。主要都市を「結ぶ｜むすびます」路線はもちろん，世界で初めて実用化されたリニアモーターカーも国営です。</p><p>ところで，JRや私鉄の各路線では，運行の方向を表すのに特別な言葉を使っています。それは，上り、下りという言葉です。特に本州では，地方から東京方面へ向かう路線を上りと言い<strong>（去掉ます表示中顿）</strong>，東京から地方へ向かう路線を下りといいます。</p><p><strong>ます形去ます，中顿</strong></p><p>そこで，こんななぞなぞがあります。日本で一番高い駅はどこでしょう。【答え|こたえ】は東京駅です。東京駅は上りの最終の駅に【なっている|表示的是结果状态的存续。可以翻译成：变为，成为~，强调最后的状态。】からです。</p><p><strong>直接用です结句也可以，但就不能体现“已经成为了”这种语感~</strong></p>              </div>            </details><details class="folding-tag" ><summary> 2. あいさつ </summary>              <div class='content'>              <p>【話し】</p><p>大山：すみません，お待たせしました。</p><p>佐藤：どうもごぶさたしています。</p><p>大山：本当にお久しぶりです。佐藤さんと一緒に仕事をするのは，4年ぶりですね。</p><p>佐藤：ええ。早いものですね。その節はお世話になります。</p><p>大山：いいえ，こちらこそ。</p><p>佐藤：今回もよろしくお願いいたします。</p><p>同僚：お話し中，失礼します。JC企画の李さんがいらっしゃいました。</p><p>大山：あ，そうですか。じゃあ，こちらにお願いします。</p><p>同僚：はい。</p><p>　李：こんにちは。</p><p>大山：李さん，紹介します。こちらは今度の金星プロジェクトの責任者で，佐藤です。</p><p>　李＆佐藤：はじめまして..　　あれっ、昨日の..！</p><p>【语法与表达】</p><ol><li><p>ぶり前接表示时间段的名词，是一种含有感叹语气的表达方式，表示离再次发生同样事情的时间较长，本人觉得已经过去那么长的时间。修饰动词使用～ぶりに＋动词的形式，修饰名词时使用～ぶりに＋の＋名词的形式。～ぶりに比～日更短的，如～＊秒、～分、～時間等时间单位。～日也只能用于两天以上。不能说1日ぶり。如果时间较长还可以使用，久しぶり（久违了）。</p><p>佐藤さんと一緒に仕事をするのは，4年ぶりですね。</p><p>3か月ぶりに東京へ行きました。</p><p><strong>3か月：3个月（的时间）</strong></p><p><strong>中间的【か】（也可以写成【ヶ】）相当于汉语中的数量词个，例如：两个月：2か月</strong></p><p>10年ぶりの寒さで、湖が＊凍りました。</p></li><li><p>～ものです：小句简体形+ものです，有表示说话人感叹的用法，它表示对事物的性质或变化很吃惊或者与よく一起使用，表示对平常不会发生的事情地诧异。另外在前接~ほしい、～たい时表示对愿望的强调，小句部分二类形容词时，其形式为二类形容词＋な＋ものです。</p><p>早いものですね。</p><p>1人でよく帰ってこられたものです。</p><p>＊平和な世界になってほしいものです。</p><p>休暇が取れたら，ゆっくり旅行したいものです。</p></li><li><p>その節：その節一般仅限于その節はお世話になりました、その節はありがとうございました等提到前不久发生的事并表示感谢地场合，但是需要注意没有あの節或この節的说法。</p><p>その節はお世話になりました。</p><p>その節は結構な物をいただきまして、ありがとうございました。</p></li><li><p>いらっしゃいました：对来宾要用的表示尊重的表达方式，来ます的敬语形式有：いらっしゃいます、来られます等，但一般来说いらっしゃいます比 来られます尊敬程度更高，所以较多使用。</p><p>JC企画の李さんがいらっしゃいました。</p></li><li><p>こちらにお願いします：听话，人很清楚请求的内容时，说话人可以省略表示具体动作的词语。</p><p>JC企画の李さんがいらっしゃいました。ーーあ、そうですか。じゃあ、こちらにお願いします。</p></li><li><p>今度：除了用于表示下回、下次以外，还如本课中那样，用于表示这次、这回的意思，有时还表示最近的。</p><p>今度の金星のプロジェクトの責任者で，佐藤さんです。    </p><p>今度発売した＊指輪のデザインは＊若者に人気があります。</p><p>今度ぜひ私の家に遊びに来てください。</p></li></ol><p>【课文会话·语法与表达】</p><ol><li><p>　～よりも：表示比较对象的助词，和より意思一样，但语气更为强一些。</p><p>日本人は握手よりもお辞儀をするのが一般的です。</p><p>日本人は握手よりお辞儀をするのが一般的です。</p><p>私はスプーンよりもスカートのほうが好きです。</p><p><strong>の是形式名词</strong></p><p><strong>日本人は、这是大主题，“日本人”</strong></p><p><strong>握手より（も）、比起握手</strong></p><p><strong>お辞儀をする、这是个固定搭配，表示进行“鞠躬”这个动作，</strong></p><p><strong>の、形式名词，加上后前面整个动词部分当名词使用。</strong></p><p><strong>が、助词，提示小主语</strong></p><p><strong>一般的です、是普遍的，普通的。</strong></p><p><strong>综上，意思是：日本人，比起握手鞠躬是更普遍的。</strong></p><p>より还有表示起点的用法，如会議は3時より始めます。这种情况下不能后续も。</p></li><li><p>～から～まで：表示时间或场所的范围。日语当中表示事物的范围时也可以使用。</p><p>​お辞儀の角度には，首を曲げるだける軽いものから，深く頭を下げるものまで，色々あります。</p><p>​この映画は子供から大人まで人気があります。</p><p>​この工場では，＊ゴムの＊製造から＊加工まで行っています。</p></li><li><p>お辞儀をし，口语中经常使用～て，～的形式表示事件发生的先后顺序，书面语中一般不用这种方式，而是用动词的第一连用形连接。动词的第一连用形，用来表示<strong>中顿。</strong></p><p>​深いお辞儀をし、相手の名刺をお辞儀をしながら受け取ります。</p><p>​まずここにお金を入れ、1のボタンを押し、最後に2のボタンを押します。</p><p>但是当前一个动作和后一个动作几乎是同时发生时，或者前一个动词修饰后一个动词时通常使用～て，～的形式。如持っていきます，歩いてきます、帽子をかぶって出かけます。</p></li><li><p>～ほうが～です：表示比较的表达方式，除了用于名词的比较，还用于小句及动词的比较，在小句简体＋より＋小句简体＋ほうが＋形容词这个表示比较的形式中，动词可以使用基本形，也可以使用た形。使用た形表示建议的语气较强，使用基本型表示一般性的看法。</p><p>​名刺を出す時も、受け取る時も両手を使うほうが丁寧です。</p><p>​食事は1人で食べるより大勢で食べるほうが楽しいです。</p><p>​ジョギングは急ぐよりゆっくり走るほうがいいそうです。</p></li><li><p>仕事の場：場不单单表示场所，而且还含有将要特别进行某事的场所或时间的语气，将要进行的活动内容用名词+の＋場表示。</p><p>​特に仕事の場であった相手には、個人的な質問は避けたほうがいいでしょう。</p><p>戴さんは昨日、会議の場で社長に褒められました。    </p></li><li><p>～ほうがいいでしょう：是向对方提出某种建议时使用的表达方式，虽然也含有不作也行的语气，但是通常表示如果不那样做，就会导致不好的结果，后面用的でしょう则语气比～ほうがいいです柔和，是委婉提出建议的说法。</p><p>とくに仕事の場であった相手には，個人的な質問は避けたほうがいいでしょう。</p><p>＊栄養があるものをたくさん食べたほうがいいでしょう。</p></li><li><p>～か，～か，～：同时并列若干项的疑问句，只能用~か的形式并列：</p><p>​結婚しているかどうか、給料はいくらか、歳はいくつかなどは，普通は聞きません。</p><p>​飛行機のチケットは買ったか、ホテルの部屋は予約したか確認してください。</p><p>​昨日どこへ行ったか、誰と会ったか、何をしたかなど，色々聞かられました。（被询问）</p></li><li><p>口语中一般称*年齢为年，日语汉字有时写作歳。</p><p>​結婚しているかどうか、給料はいくらか、年はいくつかなどは普通は聞きません。</p><p>​私は兄と歳が　＊離れています。</p><p>​彼とは　あまり歳が　離れていません。</p><p>但是，当和数字一起表示年龄时，只能用歳，不能用年。年还可以构成年を取ります、＊年寄り等表达方式。</p><p>​母は最近年を取って、目が悪くなりました。</p><p>​お年寄りには席を＊譲りましょう。</p></li><li><p><strong>いくら～ても～</strong>：无论如何努力，但即使那样也还是.. 表示同样意思的还有：<strong>いかに～ても、＊どんなに～ても、どれだけ～ても，</strong>いかに～ても较正式，多用于书面语。</p><p>​いくら丁寧な言葉であいさつしても，怖い顔をしていては，相手にいい印象をえる<strong>ことは</strong>できません。</p><p><strong>一般来讲是动词原形+ことができます，但是否定的话，助词可以改为 は 强调。</strong></p><p>比如：日本に行くことができます。能够去日本。</p><p>行くことはできません。</p><p><strong>原形是 怖い顔をしている　这里的ている表示状态。而ている的て形 是 ていて。</strong></p><p><strong>いくら</strong>早く答え<strong>ても</strong>「間違いが<strong>あれば</strong>」合格できません。　ある的假定形，即ば形，如果有..</p><p>​この店では<strong>いくら</strong>料理を食べ<strong>ても</strong>1000円です。</p><p>​<strong>どんなに</strong>遅くなっ<strong>ても</strong>大丈夫です。</p><p>​<strong>いかに</strong>フランス語がうまく<strong>ても</strong>、フランス人には及びません。（及びます，およびます）</p><p>​どれだけ考えても、いい＊案が見つかりません。（見つかります，找到，发现）</p></li><li><p>こわお顔をして：表情形容词+顔をする是表示面部表情的表达方式，顔をする还可以和表示情感的动词一起使用，如びっくりした<strong>ような</strong>顔をする。＊あきれた顔をして等。</p><p><strong>【ような】其实源于【～ようだ】，用于根据感觉的判断。</strong></p><p>​<strong>【びっくりする】，副词【びっくり】+【する】</strong></p><p>　<strong>【した】是【する】的过去式。</strong></p><p>いくら丁寧な言葉であいさつしても，<strong>怖い顔をして</strong>いては，相手にいい印象を与えることはできません。</p><p>彼女は私を見ると、びっくりしたような<strong>顔をしました</strong>。</p><p><strong>ようだ 是助动词，这里表示说话人一种委婉的推测，</strong></p><p><strong>判断，“好像，仿佛”的意思、后接名词改为</strong> <a href="https://docs.google.com/document/d/1l_ZreTaSpfFiniwh1Niq7zZ9Ao7WotmHtmUsOEERvjE/edit#bookmark=id.1vwsoa6k8gnl"><strong>ような。</strong></a></p></li><li><p>～ては／では：AてはB，出现不良情况A就会出现B的情况或状态，这里B使用消极评价的内容，接续方式是动词て形+ては，形容词て形+ては，名词+では。会话中有时把ては说成ちゃあ，では说成じゃあ。</p><p>​いくら丁寧な言葉であいさつしても、怖い顔をしていては、相手にいい印象を与えることはできません。</p><p>​あんな人が教師では、学生がかわいそうです。</p><p>​交通がこんなに不便ではお客さんは来ないでしょう。</p><p>​こんなに給料が安くては困ります。（困ります、为难，难办）</p><p>​そんな大きな声を出しては，*近所迷惑です。</p><p>​メンバーがそろわなくては、出発できません。</p></li><li><p>気持ちがこもっています：こもります，意思是充满而不外露。</p><p>​気持ちがこもっているかどうかは、予想以上に相手に伝わって<strong>しまう</strong>ものです。<strong>（しまいます基本形）</strong></p><p>​手作りのお弁当には、お母さんの真心がこもっていますよ。</p></li></ol><p>   此外，<strong>こもります是自动词，对应的他动词是*こめます</strong>，表达方式是気持ちを込めます、思いを込めます等。</p><p>   ​<strong>彼ら</strong>は結婚のお祝いの気持ちをこめて歌を歌いました。</p><p>   ​遠く離れた家族への思いをこめて手紙を書きました。</p><ol><li><p>～以上に：动词基本形或た形＋以上に、名词＋以上に具有比较的意义。表示超出了作为基准事物的量或范围，常用于书面语，是 比较正式的表达方式，<strong>前接动词基本形时，主句不可以使用过去形式。</strong></p><p>気持ちがこもっているかどうかは、予想以上に相手に伝わってしまうものです。</p><p>私たちが予想する以上に人が集まったらどうしましょうか。</p><p>私たちが予想した以上に人が集まりました。　　<strong>X　私たちが予想する以上に人が集まりました。</strong></p><p>上海は想像以上に近代化が進んでいます。</p><p>田中さんもまじめですが、山田さんは田中さん以上にまじめです。　（まじめ，真面目，认真）</p></li><li><p>AはBものです[性质]：表示A本质上具有B的性质，由此也衍生出A应当是B的意思（理所应当），B使用动词、一类形容词的基本形及二类形容词+な的形式。</p><p>表示本质时，否定形式为~ない＋ものです；表示理所应当时，否定形式为ものではありません，ものではないです。</p><p>口语当中有时也使用～もんじゃないです的形式；</p><p>気持ちがこもっているかどうかは、予想以上に相手に伝わってしまう<strong>ものです。</strong></p><p>山の天気は変わりやすいものです。</p><p>人の心は分からないものです。</p><p>遅れる時は相手に連絡するものです。    </p><p>そんな失礼な　ことは言う　ものではありません。</p><p>小句简体形+ものです：可以表示说话人的感慨事物的本质，以及理所当然的事情，还可以表示回顾过去，到底属于哪种用法，需要根据上下文判断，表示回顾时：た形+ものです。</p><p>時間の＊経つのは早いものですね。</p><p>赤ん坊はよく泣くものですね。</p><p>子供の時、よく川で遊んだものです。</p><p>新入社員の時、よく林部長と飲みに行ったものです。</p></li></ol><p>【课文】あいさつの時の礼儀</p><p>日本人同士があいさつする時は，普通お辞儀をします。中国ではあいさつをする時，握手をする【のが|「小句（动词简体形）」＋の　＋は　「形」です：动词小句后＋の使其名词化】普通ですが，日本人は握手よりもお辞儀をするのが一般的です。お辞儀をする時は腰から上を前のほうに傾けます。お辞儀の角度【に|这里的に 表示：在……场合下;还记得   ~に（は）~（が）あります  这个句型吗？这里的に 表示一种范围，场合等等，表示存在的场合，不仅适用于具体事物，也可以用于描述抽象的概念。】は、首を曲げるだけの軽い【もの|这两个もの原意是<code>东西</code>，这里指代前面的お辞儀の角度，在句中的翻译可以比较灵活。】から　深く頭を下げる【もの|这两个もの原意是<code>东西</code>，这里指代前面的お辞儀の角度，在句中的翻译可以比较灵活。】まで　色々あります。普通、初対面の時【に|に，时间状语】は、深く頭を下げて大変なお辞儀をします。</p><p>这句话可以这样分解：<br>首を曲げるだけの軽いもの  から   深く頭を下げるもの  まで、いろいろあります。</p><p>【首を曲げるだけ】仅仅弯曲颈部<br>【軽いもの】轻微的角度</p><p>这两个名词短语之间，用【の】连接，因为【だけ】这时做名词来看待</p><p>仕事で初対面の人に会った時は　名刺を出します。名刺の出し方と受け取り方【に|提示存在；】も決まりがあります。相手が目上の時は、まず自分から先に名刺を出して深くお辞儀をし、次に相手の名刺お辞儀をしながら受け取ります。出す時も受け取る時も両手を使うほうが丁寧です。</p><p>話す内容【に|提示对象】も気を付けなければなりません。初対面の時は個人的な【こと|这里的こと，理解为：个人的事情】を聞かない【の|の，将前面的小句名词化】が普通です。特に仕事の場で出会った相手【には|这里的 に 是表示提示动作的对象的用法：对…；于…；对于…；は表示强调的语气；】個人的な質問は避けたほうがいいでしょう。結婚しているかどうか、給料はいくらか、歳はいくかなどは、普通は聞きません。</p><p>大事な【のは|“の”是一个形式体言，将前面的句子体言化，变成一个名词，然后用“は”提示句子的主题。因为“大事”是一个形容动词，所以接续名词词性的“の”，用“な”来连接。】、相手に不快感を与えない【こと|和句末的“こと”形式体言也是呼应的关系。直接理解就是：“重大的事情是……事情。”】です。いくら丁寧な言葉で挨拶しても、怖い顔をしていては、相手にいい印象を与えることはできません。【気持ちがこもっているかどうかは、予想以上に相手に伝わってしまうものです。|AはBものです：A具有B的性质、理所应当A是B的衍生意思。】</p>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> 日语 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日语 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>神领物流项目介绍</title>
      <link href="/posts/b19e60c9/"/>
      <url>/posts/b19e60c9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><p><img src="logo.png" alt="logo"></p><h4 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h4><blockquote><p>物流项目体系包含四个端：管理后台、用户端、司机端以及快递员端</p></blockquote><h4 id="项目展示"><a href="#项目展示" class="headerlink" title="项目展示"></a>项目展示</h4><p><img src="admin.gif" alt="大屏"></p><h4 id="移动端展示"><a href="#移动端展示" class="headerlink" title="移动端展示"></a>移动端展示</h4><div style="display: flex; text-align: right;">  <img src="siji.gif" alt="司机界面" style="width: 200px; height: auto; display: inline-block; margin: 0 10px;">  <img src="kuaidiyuan.gif" alt="快递员界面" style="width: 200px; height: auto; display: inline-block; margin: 0 10px;">  <img src="yonghuduan.gif" alt="用户界面" style="width: 200px; height: auto; display: inline-block; margin: 0 10px;"></div><h3 id="神领物流-管理后台（PC端）"><a href="#神领物流-管理后台（PC端）" class="headerlink" title="神领物流 - 管理后台（PC端）"></a>神领物流 - 管理后台（PC端）</h3><h4 id="项目简介-1"><a href="#项目简介-1" class="headerlink" title="项目简介"></a>项目简介</h4><p>管理后台：该后台包括了从收到订单开始，通过仓库拣货发货，再通过分拨进行运输、末端配送，然后进行考核、结算等功能</p><h4 id="项目迭代日志："><a href="#项目迭代日志：" class="headerlink" title="项目迭代日志："></a>项目迭代日志：</h4><ul><li>v1 - 涉及主流程<ul><li>后台管理端包含：<ul><li>基础数据数据<ul><li>车型管理</li><li>车辆管理</li><li>司机管理</li><li>排班管理</li><li>运费管理</li></ul></li><li>营业部管理<ul><li>快递员管理</li><li>快递作业管理</li><li>机构作业管理</li><li>机构管理</li><li>货品类型管理</li></ul></li><li>业务管理<ul><li>订单管理</li><li>运单管理</li></ul></li><li>调度管理<ul><li>运输任务管理</li><li>线路管理</li></ul></li></ul></li></ul></li></ul><h4 id="技术栈"><a href="#技术栈" class="headerlink" title="技术栈"></a>技术栈</h4><p>vue2+vuex+axios</p><h4 id="外网展示"><a href="#外网展示" class="headerlink" title="外网展示"></a>外网展示</h4><blockquote><p>部署说明：目前是 git 上传代码后在 gitlab 上自动部署</p><ul><li><a href="https://youruilin.github.io/shenlingwuliu/">https://youruilin.github.io/shenlingwuliu/</a></li></ul></blockquote><h4 id="开发环境"><a href="#开发环境" class="headerlink" title="开发环境"></a>开发环境</h4><ul><li>windows 版本 windows 10 企业版</li><li>开发工具 vscode</li><li>node 版本 v14.19.1</li><li>npm 版本 v6.14.16</li></ul><h4 id="运行程序"><a href="#运行程序" class="headerlink" title="运行程序"></a>运行程序</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">1. 安装依赖包</span><br><span class="line"></span><br><span class="line">npm i --registry=https://registry.npm.taobao.org</span><br><span class="line"></span><br><span class="line">2. 运行程序</span><br><span class="line"></span><br><span class="line">npm run dev</span><br><span class="line"></span><br><span class="line">3. 浏览器打开</span><br><span class="line"></span><br><span class="line">http://localhost:9528/</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="工程结构解析"><a href="#工程结构解析" class="headerlink" title="工程结构解析"></a>工程结构解析</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">├── public                     # 静态资源 (会被直接复制)</span><br><span class="line">│   │── favicon.ico            # favicon图标</span><br><span class="line">│   │── manifest.json          # PWA 配置文件</span><br><span class="line">│   │── img                    # 静态图片存放</span><br><span class="line">│   └── index.html             # html模板</span><br><span class="line">├── src                        # 源代码</span><br><span class="line">│   ├── api                    # 所有请求</span><br><span class="line">│   ├── assets                 # 主题 字体等静态资源 (由 webpack 处理加载)</span><br><span class="line">│   ├── components             # 全局组件</span><br><span class="line">│   ├── icons                  # svg 图标</span><br><span class="line">│   ├── layout                 # 全局布局</span><br><span class="line">│   ├── router                 # 路由</span><br><span class="line">│   ├── store                  # 全局 vuex store</span><br><span class="line">│   ├── styles                 # 全局样式</span><br><span class="line">│   ├── utils                  # 全局方法</span><br><span class="line">│   ├── views                  # 所有页面</span><br><span class="line">│   └── ├── branches           # 货品类型管理，机构管理，机构作业范围，快递作业管理，快递员管理（营业部管理）</span><br><span class="line">│       ├── dashboard           # 首页（）</span><br><span class="line">│       ├── login               # 菜品管理、添加菜品</span><br><span class="line">│       ├── order-manage        # 订单管理</span><br><span class="line">│       ├── transit             # 车型管理，车辆管理，司机管理，排班管理，运费管理（基础数据管理）</span><br><span class="line">│       ├── transport           # 运输任务管理，线路管理（调度管理）</span><br><span class="line">│       ├── waybill             # 运单管理</span><br><span class="line">│       └── 404.vue            # 404报错页面</span><br><span class="line">│   ├── App.vue                # 入口页面</span><br><span class="line">│   ├── main.js                # 入口文件 加载组件 初始化等</span><br><span class="line">│   ├── permission.ts          # 权限管理</span><br><span class="line">│   └── shims-vue.d.ts         # 模块注入</span><br><span class="line">├── dist                       # 打包文件夹（可删除重新打包）</span><br><span class="line">├── tests                      # 测试</span><br><span class="line">├── .circleci/                 # 自动化 CI 配置</span><br><span class="line">├── .browserslistrc            # browserslistrc 配置文件 (用于支持 Autoprefixer)</span><br><span class="line">├── .editorconfig              # 编辑相关配置</span><br><span class="line">├── .env.xxx                   # 环境变量配置</span><br><span class="line">├── .eslintrc.js               # eslint 配置</span><br><span class="line">├── babel.config.js            # babel-loader 配置</span><br><span class="line">├── cypress.json               # e2e 测试配置</span><br><span class="line">├── jest.config.js             # jest 单元测试配置</span><br><span class="line">├── package.json               # package.json 依赖</span><br><span class="line">├── postcss.config.js          # postcss 配置</span><br><span class="line">├── tsconfig.json              # typescript 配置</span><br><span class="line">└── vue.config.js              # vue-cli 配置</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="涉及到第三方库"><a href="#涉及到第三方库" class="headerlink" title="涉及到第三方库"></a>涉及到第三方库</h4><ul><li>[vue-baidu-map] (<a href="https://dafrok.github.io/vue-baidu-map/#/zh/guide/painting">https://dafrok.github.io/vue-baidu-map/#/zh/guide/painting</a>)</li><li>[vue-treeselect:] (<a href="https://www.vue-treeselect.cn/">https://www.vue-treeselect.cn/</a>)</li><li>[element] (<a href="https://element.eleme.cn/#/zh-CN/">https://element.eleme.cn/#/zh-CN/</a>)</li></ul><h4 id="文档参考"><a href="#文档参考" class="headerlink" title="文档参考"></a>文档参考</h4><ul><li>vue[<a href="https://cn.vuejs.org/v2/guide/">https://cn.vuejs.org/v2/guide/</a>]</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ec2使用docker部署lychee图床全过程记录</title>
      <link href="/posts/7f37c772/"/>
      <url>/posts/7f37c772/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><h2 id="首先，官网的docker部署配置如下："><a href="#首先，官网的docker部署配置如下：" class="headerlink" title="首先，官网的docker部署配置如下："></a>首先，官网的docker部署配置如下：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">--name=lychee \</span><br><span class="line">-v /host_path/lychee/conf:/conf \</span><br><span class="line">-v /host_path/lychee/uploads:/uploads \</span><br><span class="line">-v /host_path/lychee/sym:/sym \</span><br><span class="line">-e PUID=1000 \</span><br><span class="line">-e PGID=1000 \</span><br><span class="line">-e PHP_TZ=America/New_York \</span><br><span class="line">-e TIMEZONE=America/New_York \</span><br><span class="line">-e DB_CONNECTION=mysql \</span><br><span class="line">-e DB_HOST=mariadb \</span><br><span class="line">-e DB_PORT=3306 \</span><br><span class="line">-e DB_DATABASE=lychee \</span><br><span class="line">-e DB_USERNAME=user \</span><br><span class="line">-e DB_PASSWORD=password \</span><br><span class="line">-p 90:80 \</span><br><span class="line">--net network_name \</span><br><span class="line">--link db_name \</span><br><span class="line">lycheeorg/lychee</span><br></pre></td></tr></table></figure><p>在 1GB 内存的 EC2 免费版实例上同时运行 <strong>MySQL、Node.js + Express 后端 API</strong>，再加上使用 Docker 部署 <strong>Lychee + MySQL</strong>，内存负载可能会非常高，甚至导致 OOM（Out of Memory）错误，进程被系统强制终止。</p><p>正如大家所知道的那样 mysql 比较吃内存，如果docker当中再添加mysql，那会原本就不富裕的1g内存ec2实例雪上加霜，因此采取下面的方案-使用原本已经安装好的docker外部的mysql（当然去创建一个lychee表是要的）：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name=lychee \</span><br><span class="line">  -v /opt/docker/lychee/conf:/conf \</span><br><span class="line">  -v /opt/docker/lychee/uploads:/uploads \</span><br><span class="line">  -v /opt/docker/lychee/sym:/sym \</span><br><span class="line">  -e PUID=1000 \</span><br><span class="line">  -e PGID=1000 \</span><br><span class="line">  -e PHP_TZ=America/New_York \</span><br><span class="line">  -e TIMEZONE=America/New_York \</span><br><span class="line">  -e DB_CONNECTION=mysql \</span><br><span class="line">  -e DB_HOST=35.164.210.202 \</span><br><span class="line">  -e DB_PORT=3306 \</span><br><span class="line">  -e DB_DATABASE=lychee \</span><br><span class="line">  -e DB_USERNAME=iooio \</span><br><span class="line">  -e DB_PASSWORD=5320di \</span><br><span class="line">  -e APP_URL=https://lychee.iooio.cn \  # 这里有个大坑！！ 已填平，后期会发布</span><br><span class="line">  -e APP_FORCE_HTTPS=true \</span><br><span class="line">  -e TRUSTED_PROXIES=35.164.210.202 \</span><br><span class="line">  -p 90:80 \</span><br><span class="line">  lycheeorg/lychee</span><br></pre></td></tr></table></figure><p>其中，-p 90:80 不能少一个，否则会导致lychee部署后不显示图片（what？），别问我是怎么知道的。</p><details class="folding-tag" ><summary> 填坑 </summary>              <div class='content'>              <p>实际上，因为过了太久，有点忘了是什么坑，0.0</p><p>大约么跟资源加载有关，也许是根本无法访问，也许是资源加载有点啥问题。</p><p>以下内容来自 chatgpt:</p><p>根据我对 Lychee（或类似 PHP Laravel 项目）和 Docker 环境的了解，下面是几个<strong>常见的“坑”</strong>，其中很可能是你遇到的：</p><hr><p>✅ <strong>1. APP_URL 必须与你访问服务时使用的地址完全一致</strong></p><p>如果你使用 <code>APP_URL=https://lychee.iooio.cn</code>，但实际通过 <code>http://localhost</code> 或者 <code>http://ip:port</code> 访问，Lychee 或 Laravel 会因为域名不匹配而导致：</p><ul><li>OAuth 或登录跳转失败（特别是使用了第三方登录）</li><li>CSRF Token 无效（<strong>重点问题！</strong>）</li><li>重定向路径错误</li><li>图片、静态资源加载异常</li><li>HTTPS 强制跳转死循环</li><li>后台页面加载样式混乱等</li></ul><p>✅ <strong>2. 如果你配置了 HTTPS 但反向代理没设置 <code>X-Forwarded-Proto</code>，会无限重定向</strong></p><p>这个问题 <strong>尤其容易被忽略</strong>：</p><ul><li>Lychee/Laravel 会自动检测 <code>APP_URL</code> 的协议（http/https）</li><li>如果你设的是 <code>https</code>，但 Nginx 没传 <code>X-Forwarded-Proto: https</code>，容器内部只识别为 HTTP，于是会跳 HTTPS，反之亦然，造成：</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ERR_TOO_MANY_REDIRECTS</span><br></pre></td></tr></table></figure><p>🛠 解决方法：</p><p>在 Nginx 反向代理配置中加入：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">proxy_set_header X-Forwarded-Proto $scheme;</span><br></pre></td></tr></table></figure><hr><h3 id="✅-3-一些缓存（如-Laravel-的-config-缓存）没有清除"><a href="#✅-3-一些缓存（如-Laravel-的-config-缓存）没有清除" class="headerlink" title="✅ 3. 一些缓存（如 Laravel 的 config 缓存）没有清除"></a>✅ <strong>3. 一些缓存（如 Laravel 的 config 缓存）没有清除</strong></h3><p>当你修改了 <code>.env</code> 或 APP_URL 后，必须重建容器或清除缓存，否则设置无效：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bash复制编辑php artisan config:clear</span><br><span class="line">php artisan cache:clear</span><br><span class="line">php artisan route:clear</span><br><span class="line">php artisan view:clear</span><br></pre></td></tr></table></figure><p>但在 Docker 中，你通常要这样做：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker exec -it lychee php artisan config:clear</span><br></pre></td></tr></table></figure><hr><p>✅ <strong>4. 使用 <code>https://</code> 协议时，证书必须有效，否则浏览器直接拒绝访问资源</strong></p><p>如果你用了自签名证书或证书配置错误，浏览器会拦截请求，表现为：</p><ul><li>页面样式不加载</li><li>图片无法显示</li><li>控制台报错 <code>Mixed Content</code> 或 <code>SSL_ERROR</code></li></ul><hr><p>✅ <strong>5. 多容器部署时，APP_URL 写错地址导致服务间通信异常</strong></p><p>比如后台服务尝试访问 API，但 APP_URL 填成了对外地址（<code>lychee.iooio.cn</code>），而不是内部通信用的地址，导致：</p><ul><li>后台报错</li><li>API 无法调用</li></ul><hr><p>✅ <strong>结论（建议你现在确认）</strong>：</p><p>检查这几点：</p><div class="table-container"><table><thead><tr><th>项目</th><th>检查内容</th></tr></thead><tbody><tr><td>APP_URL</td><td>是否与实际访问地址完全一致（含协议 https）</td></tr><tr><td>Nginx</td><td>是否有 <code>proxy_set_header X-Forwarded-Proto $scheme;</code></td></tr><tr><td>Docker</td><td>是否重建容器 / 清除 Laravel 缓存</td></tr><tr><td>浏览器</td><td>是否报 Mixed Content 或证书无效</td></tr><tr><td>网络</td><td>是否用了 Cloudflare 等代理服务，造成跳转异常</td></tr></tbody></table></div>              </div>            </details><p>这里插播一下，EC2 免费实例默认 <strong>无 SWAP</strong>，可以手动增加：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo fallocate -l 1G /swapfile</span><br><span class="line">sudo chmod 600 /swapfile</span><br><span class="line">sudo mkswap /swapfile</span><br><span class="line">sudo swapon /swapfile</span><br><span class="line">echo &#x27;/swapfile none swap sw 0 0&#x27; | sudo tee -a /etc/fstab</span><br></pre></td></tr></table></figure><p>这里看似简单，实则一点也不难，很快搞定。</p><p>docker 常用命令如下：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看所有（包括已停止）的容器</span></span><br><span class="line">docker ps -a</span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行指定容器</span></span><br><span class="line">docker start lychee</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止容器</span></span><br><span class="line">docker stop lychee</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除容器</span></span><br><span class="line">docker <span class="built_in">rm</span> lychee</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除所有镜像</span></span><br><span class="line">docker rmi $(docker images -q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除所有数据卷</span></span><br><span class="line">docker volume prune</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除所有自定义网络（注意：不会删除默认网络）</span></span><br><span class="line">docker network prune</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="接下来，一起配置一下nginx反向代理"><a href="#接下来，一起配置一下nginx反向代理" class="headerlink" title="接下来，一起配置一下nginx反向代理"></a>接下来，一起配置一下nginx反向代理</h2><h2 id="📌-1-确保-Nginx-已安装"><a href="#📌-1-确保-Nginx-已安装" class="headerlink" title="📌 1. 确保 Nginx 已安装"></a><strong>📌 1. 确保 Nginx 已安装</strong></h2><p>如果你还没有安装 Nginx，可以执行：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install nginx -y</span><br></pre></td></tr></table></figure><p>然后启动并设置开机自启：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl start nginx</span><br><span class="line">sudo systemctl enable nginx</span><br></pre></td></tr></table></figure><hr><h2 id="📌-2-获取-Lychee-容器的-IP-或端口"><a href="#📌-2-获取-Lychee-容器的-IP-或端口" class="headerlink" title="📌 2. 获取 Lychee 容器的 IP 或端口"></a><strong>📌 2. 获取 Lychee 容器的 IP 或端口</strong></h2><p>如果 Lychee 运行在 Docker 中，你需要找到它的<strong>内部 IP 或端口</strong>。</p><p><strong>1：检查 Docker 容器的端口</strong></p><p>执行：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure><p>输出示例：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CONTAINER ID   IMAGE              COMMAND                  CREATED       STATUS                 PORTS                               NAMES</span><br><span class="line">40f57733218b   lycheeorg/lychee   &quot;/entrypoint.sh nginx&quot;   4 hours ago   Up 3 hours (healthy)   0.0.0.0:90-&gt;80/tcp, :::90-&gt;80/tcp   lychee</span><br></pre></td></tr></table></figure><p>这表示：</p><ul><li><strong>Lychee 运行在容器(NAMES) <code>lychee</code></strong></li><li>宿主机 <strong>90 端口</strong> 映射到 <strong>容器的 80 端口</strong></li></ul><p>如果你的 Lychee 没有暴露端口，可以检查 IP。</p><p><strong>2：获取 Docker 内部 IP</strong></p><p>如果你使用了 Docker 网络（<code>bridge</code> 模式），可以获取容器 IP：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker inspect -f &#x27;&#123;&#123;range.NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;&#x27; lychee</span><br></pre></td></tr></table></figure><p>返回实例：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker inspect -f &#x27;&#123;&#123;range.NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;&#x27; lychee</span><br><span class="line">172.17.0.2</span><br></pre></td></tr></table></figure><p>假设返回 <code>172.17.0.2</code>，说明 Lychee 在 <strong><code>172.17.0.2:80</code></strong>。</p><hr><h2 id="📌-3-创建一个新的-Nginx-配置文件"><a href="#📌-3-创建一个新的-Nginx-配置文件" class="headerlink" title="📌 3. 创建一个新的 Nginx 配置文件"></a><strong>📌 3. 创建一个新的 Nginx 配置文件</strong></h2><p>你可以在 <code>/etc/nginx/sites-available/</code> 下创建一个新的配置文件，比如 <code>lychee.conf</code>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nano /etc/nginx/sites-available/lychee.conf</span><br></pre></td></tr></table></figure><p><strong>配置文件内容（HTTP 版本，稍后配置 HTTPS）</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name yourdomain.com;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://localhost:90;  # 如果 Lychee 运行在 90 端口</span><br><span class="line">        proxy_set_header Host $host;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><details class="folding-tag" ><summary> 额外配置 - nginx 对文件大小的默认限制 </summary>              <div class='content'>              <p>默认情况下，Nginx 对文件上传的大小是没有限制的，通常默认大小是 1MB（如果没有明确设置）。为了避免文件上传时遇到 <code>413 Request Entity Too Large</code> 错误，你可以手动添加这个配置。</p><p>在 Nginx 中，<code>client_max_body_size</code> 参数通常会放在 <code>http</code> 配置块、<code>server</code> 配置块或者 <code>location</code> 配置块中。默认情况下，Nginx 没有设置文件大小限制，所以可能是其他地方的配置导致了文件上传限制。</p><p>添加 <code>client_max_body_size</code> 参数</p><p>你可以在 <code>nginx.conf</code> 中的 <code>http</code> 配置块，或者你的网站相关的 <code>server</code> 或 <code>location</code> 配置块中加入这个参数。</p><ol><li><p>在 <code>http</code> 配置块中添加</p><p>找到 <code>http</code> 配置块，并在里面添加 <code>client_max_body_size</code>，例如：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    sendfile on;</span><br><span class="line">    tcp_nopush on;</span><br><span class="line">    types_hash_max_size 2048;</span><br><span class="line"></span><br><span class="line">    # 增加上传文件大小限制</span><br><span class="line">    client_max_body_size 100M;  # 设置为100MB，或根据你的需求进行调整</span><br><span class="line"></span><br><span class="line">    # 其他配置...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ol><li><p>在 <code>server</code> 配置块中添加</p><p>你也可以将它放在 <code>server</code> 配置块中，特别是如果你只想限制某个特定站点或虚拟主机的上传大小：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name example.com;</span><br><span class="line"></span><br><span class="line">    # 增加上传文件大小限制</span><br><span class="line">    client_max_body_size 100M;</span><br><span class="line"></span><br><span class="line">    # 其他配置...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ol><li><p>在 <code>location</code> 配置块中添加</p><p>如果你只想对某个特定路径或 <code>location</code> 进行限制，也可以在相应的 <code>location</code> 配置中设置：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">location /upload &#123;</span><br><span class="line">    client_max_body_size 100M;</span><br><span class="line">    # 其他配置...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>完整示例：</p><p>假设你希望在整个网站上都能支持上传更大的文件，可以将 <code>client_max_body_size</code> 加入 <code>http</code> 配置块：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    sendfile on;</span><br><span class="line">    tcp_nopush on;</span><br><span class="line">    types_hash_max_size 2048;</span><br><span class="line"></span><br><span class="line">    client_max_body_size 100M;  # 设置为100MB</span><br><span class="line"></span><br><span class="line">    include /etc/nginx/mime.types;</span><br><span class="line">    default_type application/octet-stream;</span><br><span class="line">    log_format main &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">                      &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">                      &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class="line">    access_log /var/log/nginx/access.log main;</span><br><span class="line"></span><br><span class="line">    include /etc/nginx/conf.d/*.conf;</span><br><span class="line">    include /etc/nginx/sites-enabled/*;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>重新加载 Nginx 配置：</p><p>修改配置文件后，记得检查配置是否正确，并重启 Nginx 使更改生效。</p><ol><li><p>检查 Nginx 配置是否正确：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nginx -t</span><br></pre></td></tr></table></figure></li><li><p>重启 Nginx：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl restart nginx</span><br></pre></td></tr></table></figure></li></ol><p>或者：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo service nginx restart</span><br></pre></td></tr></table></figure><p>通过这些设置，你应该能够解决 <code>413 Request Entity Too Large</code> 错误。</p>              </div>            </details><p>💡 <strong>如果 Lychee 运行在 Docker 内部 IP（比如 <code>172.17.0.2</code>），请修改：</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">proxy_pass http://172.17.0.2:80;</span><br></pre></td></tr></table></figure><details class="folding-tag" ><summary> 关于内外端口 </summary>              <div class='content'>              <p>解释：</p><p>Docker 容器运行时，可以选择是否将容器的端口映射到宿主机的端口。没有进行端口映射的容器只能在容器内进行访问，外部的服务或用户无法通过宿主机的 IP 地址或端口直接访问到容器内的服务。</p><p>例如，下面的命令仅在容器内启动服务，没有将端口映射到宿主机：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d --name=lychee lycheeorg/lychee</span><br></pre></td></tr></table></figure><p>在这种情况下，容器内的 Lychee 服务可能运行在 80 端口，但外部无法直接访问它。</p><p>端口映射：</p><p>如果你希望外部能够访问容器中的服务，必须进行 <strong>端口映射</strong>。通过 <code>-p</code> 参数来实现：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d --name=lychee -p 90:80 lycheeorg/lychee</span><br></pre></td></tr></table></figure><p>在这个例子中，容器的 80 端口映射到宿主机的 90 端口。这样，外部可以通过宿主机的 IP 地址和端口 90 来访问容器内的 Lychee 服务。</p><p>总结：</p><ul><li><strong>没有端口映射</strong>：服务仅能在容器内访问，外部无法访问。</li><li><strong>有端口映射</strong>：容器内的服务可以通过宿主机的 IP 地址和映射的端口访问。</li></ul><p>如果你希望从外部访问 Lychee 服务，必须将端口映射到宿主机。</p>              </div>            </details><hr><h2 id="📌-4-启用新的-Nginx-配置"><a href="#📌-4-启用新的-Nginx-配置" class="headerlink" title="📌 4. 启用新的 Nginx 配置"></a><strong>📌 4. 启用新的 Nginx 配置</strong></h2><h3 id="创建软链接"><a href="#创建软链接" class="headerlink" title="创建软链接"></a><strong>创建软链接</strong></h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo ln -s /etc/nginx/sites-available/lychee.conf /etc/nginx/sites-enabled/</span><br></pre></td></tr></table></figure><p>这条命令的作用是<strong>创建一个符号链接（软链接）</strong>，用于<strong>启用 Nginx 的站点配置</strong>。</p><details class="folding-tag" ><summary> 点击查看详情 - 为什么创建软连接 </summary>              <div class='content'>              <p><strong>📌 详细解释</strong></p><ul><li><strong><code>ln -s</code></strong>：创建符号链接（软链接）。</li><li><strong><code>/etc/nginx/sites-available/lychee.conf</code></strong>：Lychee 的 Nginx 配置文件，存放在 <code>sites-available</code> 目录中（仅存储，不默认启用）。</li><li><strong><code>/etc/nginx/sites-enabled/</code></strong>：Nginx 会自动加载 <code>sites-enabled</code> 目录下的所有配置文件。</li></ul><p><strong>作用</strong>： ✅ <code>sites-available</code> 目录存放所有 Nginx 配置文件，但默认不会生效。<br> ✅ <code>sites-enabled</code> 目录中的文件才会被 Nginx 识别并启用。<br> ✅ <code>ln -s</code> 让 <code>lychee.conf</code> 在 <code>sites-enabled</code> 里有一个“快捷方式”，Nginx 读取它，就能启用 Lychee 的反向代理配置。</p><hr><p><strong>📌 为什么要用符号链接？</strong></p><ul><li><p><strong>管理方便</strong>：你可以在 <code>sites-available</code> 里集中管理所有站点配置，启用/禁用只需创建或删除软链接，不用改动原配置。</p></li><li><p>快速启用/禁用站点</p><ul><li><p>禁用 Lychee 站点（但不删除配置）：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo rm /etc/nginx/sites-enabled/lychee.conf</span><br><span class="line">sudo systemctl reload nginx</span><br></pre></td></tr></table></figure></li><li><p>再次启用：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo ln -s /etc/nginx/sites-available/lychee.conf /etc/nginx/sites-enabled/</span><br><span class="line">sudo systemctl reload nginx</span><br></pre></td></tr></table></figure></li></ul></li></ul><p><strong>📝 需要注意</strong>：<br> 执行 <code>ln -s</code> 之后，建议运行：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nginx -t</span><br></pre></td></tr></table></figure><p>如果返回 <strong>syntax is ok</strong>，再重启 Nginx：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl restart nginx</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="测试-Nginx-配置"><a href="#测试-Nginx-配置" class="headerlink" title="测试 Nginx 配置"></a><strong>测试 Nginx 配置</strong></h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nginx -t</span><br></pre></td></tr></table></figure><p>如果没有错误，重启 Nginx：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl restart nginx</span><br></pre></td></tr></table></figure><h3 id="测试-HTTP-访问"><a href="#测试-HTTP-访问" class="headerlink" title="测试 HTTP 访问"></a><strong>测试 HTTP 访问</strong></h3><p>在浏览器输入：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://yourdomain.com</span><br></pre></td></tr></table></figure><p>如果页面正常打开，说明反向代理成功！</p><h2 id="📌-5-启用-HTTPS（使用-Let’s-Encrypt）"><a href="#📌-5-启用-HTTPS（使用-Let’s-Encrypt）" class="headerlink" title="📌 5. 启用 HTTPS（使用 Let’s Encrypt）"></a><strong>📌 5. 启用 HTTPS（使用 Let’s Encrypt）</strong></h2><p>现在，我们使用 Certbot 申请 SSL 证书。</p><h3 id="安装-Certbot"><a href="#安装-Certbot" class="headerlink" title="安装 Certbot"></a><strong>安装 Certbot</strong></h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt install certbot python3-certbot-nginx -y</span><br></pre></td></tr></table></figure><h3 id="申请证书"><a href="#申请证书" class="headerlink" title="申请证书"></a><strong>申请证书</strong></h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo certbot --nginx -d yourdomain.com</span><br></pre></td></tr></table></figure><p>Certbot 会自动： ✅ 申请 <strong><code>fullchain.pem</code></strong> 证书<br> ✅ 修改 <strong>Nginx 配置</strong>，启用 HTTPS<br> ✅ 重启 <strong>Nginx</strong></p><p>如果成功，你会看到：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Congratulations! Your certificate and chain have been saved at:</span><br><span class="line">/etc/letsencrypt/live/yourdomain.com/fullchain.pem</span><br></pre></td></tr></table></figure><details class="folding-tag" ><summary> 我记得还有一个命令，可以为所有配置文件中的域名自动配置证书 </summary>              <div class='content'>              <p>如果你想为所有配置文件中已配置的 <strong>域名</strong> 自动申请 SSL 证书，可以使用以下命令：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo certbot --nginx</span><br></pre></td></tr></table></figure><h3 id="📌-详细解释"><a href="#📌-详细解释" class="headerlink" title="📌 详细解释"></a><strong>📌 详细解释</strong></h3><ul><li><strong><code>sudo certbot --nginx</code></strong>：这个命令会自动扫描 <strong>Nginx 配置文件</strong> 中的所有域名，并为它们申请 SSL 证书。Certbot 会自动为配置文件中的每个域名配置 SSL，并自动更新 Nginx 配置启用 HTTPS。</li><li><strong><code>-d</code></strong>：如果你希望指定单独的域名，可以使用 <code>-d yourdomain.com</code>。但如果你希望 <strong>所有</strong> 配置文件中列出的域名都可以自动申请证书，<code>--nginx</code> 就足够了，它会自动识别 Nginx 配置中的域名。</li></ul><h3 id="📌-步骤"><a href="#📌-步骤" class="headerlink" title="📌 步骤"></a><strong>📌 步骤</strong></h3><ol><li><p>运行命令：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo certbot --nginx</span><br></pre></td></tr></table></figure></li><li><p>Certbot 会自动扫描 Nginx 的配置文件并列出所有找到的域名。你会看到类似这样的提示：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Which names would you like to activate HTTPS for?</span><br></pre></td></tr></table></figure></li><li><p>输入要为其启用 HTTPS 的域名，或选择 <strong>所有</strong> 域名。</p></li><li><p>Certbot 会自动申请证书并为所有选定的域名配置 HTTPS。</p></li></ol><h3 id="📌-Certbot-的工作流程"><a href="#📌-Certbot-的工作流程" class="headerlink" title="📌 Certbot 的工作流程"></a><strong>📌 Certbot 的工作流程</strong></h3><ol><li>Certbot 会扫描 Nginx 配置文件，找出所有列出的域名。</li><li>它会为这些域名自动申请 Let’s Encrypt 的免费 SSL 证书。</li><li>然后 Certbot 会更新 Nginx 配置文件，启用 SSL，重启 Nginx，使得新证书生效。</li></ol><h3 id="📌-自动续期"><a href="#📌-自动续期" class="headerlink" title="📌 自动续期"></a><strong>📌 自动续期</strong></h3><p>完成上述操作后，Certbot 会设置好自动续期机制，无需手动干预。</p><p>如果你希望确保自动续期工作正常，可以执行：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo certbot renew --dry-run</span><br></pre></td></tr></table></figure><p>这会模拟续期过程并确保一切正常。</p><hr><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a><strong>总结</strong></h3><p>使用 <code>sudo certbot --nginx</code> 命令，可以为 <strong>所有 Nginx 配置文件中列出的域名</strong> 自动申请并配置 SSL 证书。这是一个方便的方式，特别是当你有多个域名需要配置时。</p>              </div>            </details><hr><h2 id="📌-6-确保-HTTPS-访问生效"><a href="#📌-6-确保-HTTPS-访问生效" class="headerlink" title="📌 6. 确保 HTTPS 访问生效"></a><strong>📌 6. 确保 HTTPS 访问生效</strong></h2><p>你可以手动检查 <code>lychee.conf</code>（Certbot 会自动修改它）：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nano /etc/nginx/sites-available/lychee.conf</span><br></pre></td></tr></table></figure><p>应该包含类似的 HTTPS 配置：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 443 ssl;</span><br><span class="line">    server_name yourdomain.com;</span><br><span class="line"></span><br><span class="line">    ssl_certificate /etc/letsencrypt/live/yourdomain.com/fullchain.pem;</span><br><span class="line">    ssl_certificate_key /etc/letsencrypt/live/yourdomain.com/privkey.pem;</span><br><span class="line"></span><br><span class="line">    ssl_protocols TLSv1.2 TLSv1.3;</span><br><span class="line">    ssl_ciphers HIGH:!aNULL:!MD5;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:8080;</span><br><span class="line">        proxy_set_header Host $host;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name yourdomain.com;</span><br><span class="line">    return 301 https://$host$request_uri;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>💡 <strong>这里的 301 重定向会将 HTTP 访问强制跳转到 HTTPS。</strong></p><p><strong>最后，重启 Nginx：</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl restart nginx</span><br></pre></td></tr></table></figure><hr><h2 id="📌-7-设置自动续期"><a href="#📌-7-设置自动续期" class="headerlink" title="📌 7. 设置自动续期"></a><strong>📌 7. 设置自动续期</strong></h2><p>Let’s Encrypt 证书有效期为 <strong>90 天</strong>，你可以使用以下命令测试自动续期：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo certbot renew --dry-run</span><br></pre></td></tr></table></figure><p>如果没问题，就可以定期自动更新：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo crontab -e</span><br></pre></td></tr></table></figure><p>添加：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0 3 * * * certbot renew --quiet &amp;&amp; systemctl reload nginx</span><br></pre></td></tr></table></figure><p>ps：手动运行 Certbot 续期命令来测试是否会为新域名自动续期：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo certbot renew --dry-run</span><br></pre></td></tr></table></figure><p>这个命令真的很好用，实测之前配置过自动续期的，新添加的域名也会同样自动续期。</p><details class="folding-tag" ><summary> 这是一个定时任务 - 点击查看详情 </summary>              <div class='content'>              <p>这条命令是一个<strong>定时任务（Cron job）</strong>，它的作用是 <strong>每天凌晨 3 点自动检查并续期</strong> SSL 证书，并且在续期成功后重新加载 Nginx 配置。具体来说：</p><h3 id="📌-详细解释"><a href="#📌-详细解释" class="headerlink" title="📌 详细解释"></a><strong>📌 详细解释</strong></h3><ol><li><strong><code>0 3 \* \* \*</code></strong>：这是 Cron 的时间设置部分，表示：<ul><li><code>0</code>：分钟，指在每小时的第 0 分钟。</li><li><code>3</code>：小时，指每天凌晨 3 点。</li><li><code>* * *</code>：分别表示日期、月份、星期，<code>*</code> 代表任意值。所以这部分表示每天的 3 点。</li></ul></li><li><strong><code>certbot renew --quiet</code></strong>：<ul><li><code>certbot renew</code>：用于检查并自动续期 SSL 证书。</li><li><code>--quiet</code>：表示只输出必要的信息，避免显示过多的日志，减少不必要的输出。</li></ul></li><li><strong><code>&amp;&amp;</code></strong>：表示“<strong>如果前一个命令成功</strong>，则执行后面的命令”。</li><li><strong><code>systemctl reload nginx</code></strong>：<ul><li><code>systemctl reload nginx</code>：重新加载 Nginx 配置，使得新续期的证书生效。</li></ul></li></ol><hr><h3 id="📌-整体作用"><a href="#📌-整体作用" class="headerlink" title="📌 整体作用"></a><strong>📌 整体作用</strong></h3><p>这条命令的作用是 <strong>每天自动检测 SSL 证书是否需要续期</strong>，如果需要，<code>certbot</code> 会自动完成续期操作，并且 <strong>重新加载 Nginx 配置</strong> 使得新的证书生效。</p><hr><h3 id="📌-如何添加-Cron-任务"><a href="#📌-如何添加-Cron-任务" class="headerlink" title="📌 如何添加 Cron 任务"></a><strong>📌 如何添加 Cron 任务</strong></h3><p>要确保每天自动执行这个任务，你需要将这条命令添加到 Cron 表中。具体步骤：</p><ol><li><p>打开 Cron 表：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo crontab -e</span><br></pre></td></tr></table></figure></li><li><p>在文件的末尾添加：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0 3 * * * certbot renew --quiet &amp;&amp; systemctl reload nginx</span><br></pre></td></tr></table></figure></li><li><p>保存并退出编辑器（通常是按 <code>Ctrl + X</code>，然后按 <code>Y</code> 确认保存）。</p></li></ol><hr><h3 id="📌-测试-Cron-任务"><a href="#📌-测试-Cron-任务" class="headerlink" title="📌 测试 Cron 任务"></a><strong>📌 测试 Cron 任务</strong></h3><p>你可以通过以下命令手动运行 <code>certbot renew</code>，测试是否能正确续期：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo certbot renew --dry-run</span><br></pre></td></tr></table></figure><p>如果没有问题，表示证书续期工作正常，Cron 任务也会顺利执行。</p><hr><h3 id="📌-额外注意"><a href="#📌-额外注意" class="headerlink" title="📌 额外注意"></a><strong>📌 额外注意</strong></h3><ul><li><p><strong>证书有效期</strong>：Let’s Encrypt 的证书有效期是 90 天，所以定期续期非常重要。</p></li><li><p>Cron 的日志</p><p>：如果你想查看 Cron 任务的执行日志，可以在 </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/var/log/syslog</span><br></pre></td></tr></table></figure><p> 中查找与 Cron 相关的日志：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">grep CRON /var/log/syslog</span><br></pre></td></tr></table></figure></li></ul>              </div>            </details><h2 id="📌-8-访问网站测试-HTTPS"><a href="#📌-8-访问网站测试-HTTPS" class="headerlink" title="📌 8. 访问网站测试 HTTPS"></a><strong>📌 8. 访问网站测试 HTTPS</strong></h2><p>在浏览器输入：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">arduino</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制编辑</span><br><span class="line">https://yourdomain.com</span><br></pre></td></tr></table></figure><p>如果能看到 Lychee 并且是 HTTPS 🔒，说明一切配置成功！</p><hr><h2 id="📌-9-总结"><a href="#📌-9-总结" class="headerlink" title="📌 9. 总结"></a><strong>📌 9. 总结</strong></h2><p>1️⃣ <strong>检查 Lychee 的 Docker 端口/IP</strong><br> 2️⃣ <strong>创建新的 Nginx 配置文件 <code>/etc/nginx/sites-available/lychee.conf</code></strong><br> 3️⃣ <strong>测试 HTTP 反向代理是否成功</strong><br> 4️⃣ <strong>使用 Certbot 申请 SSL 证书，启用 HTTPS</strong><br> 5️⃣ <strong>重启 Nginx，确保 HTTPS 访问正常</strong><br> 6️⃣ <strong>配置自动续期，避免证书过期</strong></p><p>现在，你的 Lychee 就可以<strong>通过 Nginx 反向代理，并使用 HTTPS 访问</strong>！</p>]]></content>
      
      
      
        <tags>
            
            <tag> 图床 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端脚手架开发全过程实现（一）</title>
      <link href="/posts/79ec503/"/>
      <url>/posts/79ec503/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><h1 id="站在前端研发的视角，分析开发脚手架的必要性"><a href="#站在前端研发的视角，分析开发脚手架的必要性" class="headerlink" title="站在前端研发的视角，分析开发脚手架的必要性"></a>站在前端研发的视角，分析开发脚手架的必要性</h1><h2 id="研发效能"><a href="#研发效能" class="headerlink" title="研发效能"></a>研发效能</h2><p>脚手架的核心目标是：<strong>提升前端研发效能</strong></p><p>大厂研发架构图：</p><p><img src="大厂研发架构图.png" alt="第二周大厂研发架构图"></p><h2 id="脚手架核心价值"><a href="#脚手架核心价值" class="headerlink" title="脚手架核心价值"></a>脚手架核心价值</h2><p>将研发过程：</p><ul><li>自动化：项目重复代码拷贝/git操作/发布上线操作</li><li>标准化：项目创建/git flow/发布流程/回滚流程</li><li>数据化：研发过程系统化、数据化，使得研发过程可量化</li></ul><h2 id="和自动化构建工具的区别"><a href="#和自动化构建工具的区别" class="headerlink" title="和自动化构建工具的区别"></a>和自动化构建工具的区别</h2><p>问题：Jenkins、Travis等自动化构建工具已经比较成熟了，为什么还需要自研脚手架？</p><ul><li>不满足需求：Jenkins、Travis通常在git hooks中触发，需要在服务端执行（仅仅只能覆盖云构建端的操作），无法覆盖研发人员本地的功能，如：创建项目自动化，本地git操作自动化等</li><li>定制复杂：Jenkins、Travis定制过程需要开发插件，其过程较为复杂，需要使用java语言，对前端同学不够友好</li></ul><h2 id="从使用角度理解什么是脚手架"><a href="#从使用角度理解什么是脚手架" class="headerlink" title="从使用角度理解什么是脚手架"></a>从使用角度理解什么是脚手架</h2><h3 id="脚手架简介"><a href="#脚手架简介" class="headerlink" title="脚手架简介"></a>脚手架简介</h3><p>脚手架本质是一个操作系统的客户端，它通过命令执行，比如：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vue create vue-test-app</span><br></pre></td></tr></table></figure><p>上面命令由3个部分组成：</p><ul><li>主命令：<code>vue</code></li><li>command：<code>create</code></li><li>command的params：<code>vue-test-app</code></li></ul><p>他表示创建一个vue的项目，项目的名称为<code>vue-test-app</code>，以上是一个较为简单的脚手架命令，但实际场景往往更加复杂，比如：</p><p>当前目录已经有文件了，我们需要覆盖当前目录下的文件，强制进行安装<code>vue</code>项目，此时我们就可以输入</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vue create vue-test-app --force</span><br></pre></td></tr></table></figure><p>这里的<code>--force</code>叫做option，用来辅助脚手架确定在特定场景下用户的选择（可以理解为配置）。还有一种场景：</p><p>通过<code>vue create</code>创建项目时，会自动执行<code>npm install</code>帮用户安装依赖，如果我们希望使用淘宝源来安装，可以使用命令：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vue create vue-test-app --force -r https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure><p>这里的<code>-r</code>也叫做option，它与<code>--force</code>不同的是它使用<code>-</code>，并且使用了简写，这里的<code>-r</code>也可以替换成<code>--registry</code>，如果不知道<code>vue create</code>支持的所有options，可以使用：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vue create --help</span><br></pre></td></tr></table></figure><p><code>-r https://registry.npm.taobao.org</code>后面的<code>https://registry.npm.taobao.org</code>成为option的param，其实<code>--force</code>可以理解为：<code>--force true</code>，简写为：<code>--force</code>或<code>-f</code></p><h3 id="脚手架执行原理"><a href="#脚手架执行原理" class="headerlink" title="脚手架执行原理"></a>脚手架执行原理</h3><p><img src="脚手架执行原理.png" alt="第二周脚手架执行原理"></p><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">脚手架的执行原理</button><button type="button" class="tab">windows 环境下的步骤拆分</button></div><div class="tab-contents"><div class="tab-item-content active"><ul><li>在终端输入<code>vue create vue-test-app</code></li><li>终端解析出<code>vue</code>命令</li><li>终端在环境变量中找到<code>vue</code>命令</li><li>终端根据<code>vue</code>命令链接到实际文件<code>vue.js</code></li><li>终端利用<code>node</code>执行<code>vue.js</code></li><li><code>vue.js</code>解析command/options</li><li><code>vue.js</code>执行command/options</li><li>执行完毕，退出执行</li></ul></div><div class="tab-item-content"><ul><li><p>使用where vue 而不是 which vue 从系统的环境变量中查找 vue 文件</p></li><li><p>vue 文件不再以软连接的形式关联具体的 vue.js 文件，而是：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">#!<span class="regexp">/bin/</span>sh</span><br><span class="line">basedir=$(dirname <span class="string">&quot;$(echo &quot;</span>$0<span class="string">&quot; | sed -e &#x27;s,\\,/,g&#x27;)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">`uname`</span> <span class="keyword">in</span></span><br><span class="line">    *<span class="variable constant_">CYGWIN</span>*|*<span class="variable constant_">MINGW</span>*|*<span class="variable constant_">MSYS</span>*) basedir=<span class="string">`cygpath -w &quot;$basedir&quot;`</span>;;</span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -x <span class="string">&quot;$basedir/node&quot;</span> ]; then</span><br><span class="line">  exec <span class="string">&quot;$basedir/node&quot;</span>  <span class="string">&quot;$basedir/node_modules/@vue/cli/bin/vue.js&quot;</span> <span class="string">&quot;$@&quot;</span></span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">  exec node  <span class="string">&quot;$basedir/node_modules/@vue/cli/bin/vue.js&quot;</span> <span class="string">&quot;$@&quot;</span></span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p>这是一个用于执行 Vue CLI 命令的启动脚本。这个脚本用于在不同操作系统环境（例如 Windows 和类 Unix 系统）下找到并执行 Vue CLI 的主程序。</p></li><li><p>当你在命令行中运行 vue 命令时，这个脚本将被调用，并根据不同的操作系统环境选择正确的 node 执行环境，确保 Vue CLI 正常运行。</p></li></ul></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="从应用角度看如何开发一个脚手架"><a href="#从应用角度看如何开发一个脚手架" class="headerlink" title="从应用角度看如何开发一个脚手架"></a>从应用角度看如何开发一个脚手架</h2><p>这里以<code>vue-cli</code>为例：</p><ul><li>开发<code>npm</code>项目，该项目中应包含一个<code>bin/vue.js</code>文件，并将这个项目发布到<code>npm</code></li><li>将<code>npm</code>项目安装到<code>node</code>的<code>lib/node_modules</code></li><li>在<code>node</code>的<code>bin</code>目录下配置<code>vue</code>软连接指向<code>lib/node_modules/@vue/cli/bin/vue.js</code></li></ul><p>这样我们在执行<code>vue</code>命令的时候就可以找到<code>vue.js</code>进行执行</p><h3 id="疑问解答"><a href="#疑问解答" class="headerlink" title="疑问解答"></a>疑问解答</h3><h4 id="为什么全局安装-vue-cli后会添加的命令为vue？"><a href="#为什么全局安装-vue-cli后会添加的命令为vue？" class="headerlink" title="为什么全局安装@vue/cli后会添加的命令为vue？"></a>为什么全局安装<code>@vue/cli</code>后会添加的命令为<code>vue</code>？</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install -g @vue/cli</span><br></pre></td></tr></table></figure><p>答：在<code>/usr/local/lib/node_modules/@vue/cli</code>文件夹下的<code>package.json</code>的</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;bin&quot;:&#123;</span><br><span class="line">  &quot;vue&quot;: &quot;bin/vue.js&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个软连接的名称就是<code>vue</code>，所以添加后的命令为<code>vue</code></p><h4 id="全局安装-vue-cli时发生了什么？"><a href="#全局安装-vue-cli时发生了什么？" class="headerlink" title="全局安装@vue/cli时发生了什么？"></a>全局安装<code>@vue/cli</code>时发生了什么？</h4><p>答：先把<code>@vue/cli</code>下载到<code>/usr/local/lib/node_modules</code>中，然后根据<code>@vue/cli</code>下的<code>package.json</code>，根据<code>bin</code>中的定义去<code>/usr/local/bin/</code>下去定义<code>@vue/cli</code>的软连接<code>vue</code></p><h4 id="执行vue命令时发生了什么？为什么vue指向一个js文件，我们却可以直接通过vue命令去执行它？"><a href="#执行vue命令时发生了什么？为什么vue指向一个js文件，我们却可以直接通过vue命令去执行它？" class="headerlink" title="执行vue命令时发生了什么？为什么vue指向一个js文件，我们却可以直接通过vue命令去执行它？"></a>执行<code>vue</code>命令时发生了什么？为什么<code>vue</code>指向一个<code>js</code>文件，我们却可以直接通过<code>vue</code>命令去执行它？</h4><p>答：1.终端在环境变量中找<code>vue</code>指令（相当于<code>which vue</code>命令），看有没有被注册，未注册则返回<code>command not found</code>,注册了则去找vue指令软连接指向的地址<code>/usr/local/lib/node_modules/@vue/cli/bin/vue.js</code>，去执行<code>vue.js</code>文件中的代码</p><p> 2.因为这个<code>js</code>文件的顶部写了<code>#!/usr/bin/env node</code>,标识在环境变量中查找<code>node</code>，告诉系统使用<code>node</code>去执行这个<code>js</code>文件</p><h3 id="脚手架原理进阶"><a href="#脚手架原理进阶" class="headerlink" title="脚手架原理进阶"></a>脚手架原理进阶</h3><h4 id="为什么说脚手架本质是操作系统的客户端？它和我们在PC上安装的应用-软件有什么区别？"><a href="#为什么说脚手架本质是操作系统的客户端？它和我们在PC上安装的应用-软件有什么区别？" class="headerlink" title="为什么说脚手架本质是操作系统的客户端？它和我们在PC上安装的应用/软件有什么区别？"></a>为什么说脚手架本质是操作系统的客户端？它和我们在PC上安装的应用/软件有什么区别？</h4><p>1.node在window中是一个node.exe，在Mac中是一个可执行文件（node*）,因为node是操作系统的一个客户端，脚手架的本质是通过node去执行js文件，所以也可以说脚手架的本质是操作系统的客户端。</p><p>2.本质来说没有区别，PC安装的应用只是提供了一个GUI，脚手架是通过命令的形式</p><h4 id="如何为node脚手架命令创建别名？"><a href="#如何为node脚手架命令创建别名？" class="headerlink" title="如何为node脚手架命令创建别名？"></a>如何为node脚手架命令创建别名？</h4><p>进入<code>/usr/local/bin</code>目录</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ln -s ./imooc-test-cai imooc-test-cai2</span><br></pre></td></tr></table></figure><p><img src="node脚手架命令创建别名.png" alt="第二周node脚手架命令创建别名"></p><h4 id="描述脚手架命令执行的全过程。"><a href="#描述脚手架命令执行的全过程。" class="headerlink" title="描述脚手架命令执行的全过程。"></a>描述脚手架命令执行的全过程。</h4><p><img src="脚手架执行过程.png" alt="第二周脚手架执行过程"></p><h2 id="脚手架开发流程"><a href="#脚手架开发流程" class="headerlink" title="脚手架开发流程"></a>脚手架开发流程</h2><h3 id="开发流程"><a href="#开发流程" class="headerlink" title="开发流程"></a>开发流程</h3><ul><li><p>创建<code>npm</code>项目</p></li><li><p>创建脚手架入口文件，最上方添加：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/usr/bin/env node</span><br></pre></td></tr></table></figure></li><li><p>配置package.json，添加bin属性</p></li><li><p>编写脚手架代码</p></li><li><p>将脚手架发布到npm</p></li></ul><h3 id="使用流程"><a href="#使用流程" class="headerlink" title="使用流程"></a>使用流程</h3><ul><li><p>安装脚手架</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install -g your-own-cli</span><br></pre></td></tr></table></figure></li><li><p>使用脚手架</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">your-own-cli</span><br></pre></td></tr></table></figure></li></ul><h3 id="脚手架开发难点解析"><a href="#脚手架开发难点解析" class="headerlink" title="脚手架开发难点解析"></a>脚手架开发难点解析</h3><ul><li><p>分包：将复杂的系统拆分成若干个模块</p></li><li><p>命令注册：例</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vue create</span><br><span class="line">vue add</span><br><span class="line">vue invoke</span><br></pre></td></tr></table></figure></li><li><p>参数解析：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vue command [options] &lt;params&gt;</span><br></pre></td></tr></table></figure><ul><li><p>options全称：<code>--version</code>、<code>--help</code></p></li><li><p>options简写：<code>-V</code>、<code>-h</code></p></li><li><p>带params的options：<code>--path /Users/caimengxin/Desktop/vue-test</code></p></li><li><p>帮助文档：</p><ul><li>global help<ul><li>Usage</li><li>Options</li><li>Commands</li></ul></li></ul><p>示例：<code>vue</code>的帮助信息：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Usage: vue &lt;command&gt; [options]</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -V, --version                              output the version number</span><br><span class="line">  -h, --help                                 output usage information</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  create [options] &lt;app-name&gt;                create a new project powered by vue-cli-service</span><br><span class="line">  add [options] &lt;plugin&gt; [pluginOptions]     install a plugin and invoke its generator in an already created project</span><br><span class="line">  invoke [options] &lt;plugin&gt; [pluginOptions]  invoke the generator of a plugin in an already created project</span><br><span class="line">  inspect [options] [paths...]               inspect the webpack config in a project with vue-cli-service</span><br><span class="line">  serve [options] [entry]                    serve a .js or .vue file in development mode with zero config</span><br><span class="line">  build [options] [entry]                    build a .js or .vue file in production mode with zero config</span><br><span class="line">  ui [options]                               start and open the vue-cli ui</span><br><span class="line">  init [options] &lt;template&gt; &lt;app-name&gt;       generate a project from a remote template (legacy API, requires @vue/cli-init)</span><br><span class="line">  config [options] [value]                   inspect and modify the config</span><br><span class="line">  outdated [options]                         (experimental) check for outdated vue cli service / plugins</span><br><span class="line">  upgrade [options] [plugin-name]            (experimental) upgrade vue cli service / plugins</span><br><span class="line">  migrate [options] [plugin-name]            (experimental) run migrator for an already-installed cli plugin</span><br><span class="line">  info                                       print debugging information about your environment</span><br><span class="line"></span><br><span class="line">  Run vue &lt;command&gt; --help for detailed usage of given command.</span><br></pre></td></tr></table></figure></li></ul></li></ul><p>还有很多，比如：</p><ul><li>命令行交互</li><li>日志打印</li><li>命令行文字变色</li><li>网络通信：HTTP、WebSocket</li><li>文件处理</li></ul><p>等等……</p><h2 id="脚手架本地link标准流程"><a href="#脚手架本地link标准流程" class="headerlink" title="脚手架本地link标准流程"></a>脚手架本地link标准流程</h2><p>链接本地脚手架：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd your-cli-dir</span><br><span class="line">npm link</span><br><span class="line"></span><br><span class="line">// 取消链接时，执行 npm unlink</span><br></pre></td></tr></table></figure><p><code>npm link</code> 是 <code>npm</code> 提供的一个命令，用于在本地开发环境中创建一个全局软链接（symbolic link），让你可以在不同项目中共享本地开发的 npm 包，而不需要每次都重新安装或发布到 npm 仓库。</p><p>执行原理：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env node</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> lib = <span class="built_in">require</span>(<span class="string">&#x27;iooio-test-lib&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(lib.<span class="title function_">sum</span>(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行npm link，将当前目录下的bin文件夹下的index.js文件软链到全局</span></span><br><span class="line"><span class="comment">// 原理如下：</span></span><br><span class="line"><span class="comment">// 1. npm link命令会在全局node/bin目录下创建一个软链接，iooio-test =&gt; 指向本地node_modules/iooio-test/bin/index.js</span></span><br><span class="line"><span class="comment">// 2. 全局node/bin目录下创建的软链接 iooio-test，实际上是指向了本地node_modules/iooio-test/bin/index.js文件</span></span><br><span class="line"><span class="comment">// 3. 这样，就可以在全局使用iooio-test命令了</span></span><br><span class="line"><span class="comment">// 这时，修改bin/index.js文件，例如添加三个感叹号，控制台是实时更新的</span></span><br><span class="line"><span class="comment">// 方便本地调试</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Hello, world!开发脚手架!!!===&#x27;</span>);</span><br></pre></td></tr></table></figure><p>链接本地库文件：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd your-lib-dir</span><br><span class="line">npm link</span><br><span class="line">cd your-cli-dir</span><br><span class="line">npm link your-lib</span><br></pre></td></tr></table></figure><p>这两条命令的作用是 <strong>在本地项目中共享未发布的 npm 包</strong>，主要用于 CLI 工具开发，或在多个项目中调试共享库。</p><p>其中：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd your-lib-dir</span><br><span class="line">npm link</span><br></pre></td></tr></table></figure><p>这条命令会：</p><p>在全局 npm 目录（通常是 C:\Users\youruilin\AppData\Roaming\npm\node_modules 或 /usr/local/lib/node_modules）下创建一个指向 your-lib-dir 的 软链接。<br>这样，your-lib 就被 全局注册 了，你可以在其他地方 npm link your-lib 来使用它，而不需要 npm install。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd your-cli-dir</span><br><span class="line">npm link your-lib</span><br></pre></td></tr></table></figure><p>这条命令会：</p><p>在 your-cli-dir/node_modules 目录下创建一个指向全局 your-lib 的软链接。<br>使 your-cli 在本地开发时可以像正式安装 your-lib 一样使用它，但 your-lib 实际上是直接引用了 your-lib-dir 里的代码。</p><p>注意，这时无需回到脚手架的 package.json 中增加如下字段：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;iooio-test-lib&quot;: &quot;^1.0.0&quot;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>因为全局已经建立了完整的软链。现在，脚手架 和本地库文件已经在本地关联了，可以在 your-lib 里修改代码，并在 your-cli 里立即生效，而不需要重新 npm install。</p><p>本地调试完毕后，就可以执行   npm publish 将库文件进行上传。</p><p>取消链接本地库文件：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 取消库文件的 link</span></span><br><span class="line">cd your-lib-dir</span><br><span class="line">npm unlink</span><br><span class="line"></span><br><span class="line"><span class="comment">// 取消脚手架中对本地库文件的 link</span></span><br><span class="line">cd your-cli-dir</span><br><span class="line">npm unlink your-lib</span><br><span class="line"># 如之前的软连接不存在 （取消本地库文件链接时错误执行了：npm remove -g your-lib）</span><br><span class="line"># 会提示报错, 需要先执行 npm link your-lib</span><br><span class="line"># 然后再执行 npm unlink your-lib</span><br><span class="line"></span><br><span class="line"><span class="comment">// 现在，可以从远程拉取远程库文件到本地了</span></span><br><span class="line">npm install -S your-lib</span><br></pre></td></tr></table></figure><p>理解<code>npm link</code>：</p><ul><li><code>npm link your-lib</code>：将当前项目中的<code>node_modules</code>下指定的库文件链接到<code>node</code>全局<code>node_modules</code>下的库文件</li><li><code>npm link</code>：将当前项目链接到<code>node</code>全局<code>node_modules</code>中作为一个库文件，并解析<code>bin</code>配置创建可执行文件</li></ul><p>理解<code>npm unlink</code>：</p><ul><li><code>npm unlink</code>：将当前项目从<code>node</code>全局<code>node_modules</code>中移除</li><li><code>npm unlink your-lib</code>：将当前项目中的库文件依赖移除</li></ul><h2 id="原生脚手架开发痛点分析"><a href="#原生脚手架开发痛点分析" class="headerlink" title="原生脚手架开发痛点分析"></a>原生脚手架开发痛点分析</h2><ul><li>痛点一：重复操作<ul><li>多Package本地link</li><li>多Package依赖安装</li><li>多Package单元测试</li><li>多Package代码提交</li><li>多Package代码发布</li></ul></li><li>痛点二：版本一致性<ul><li>发布时版本一致性</li><li>发布后相互依赖版本升级</li></ul></li></ul><p><strong>package越多，管理复杂度越高</strong></p><h2 id="Lerna简介"><a href="#Lerna简介" class="headerlink" title="Lerna简介"></a>Lerna简介</h2><blockquote><p>Lerna is a tool that optimizes the workflow around managing multi-package repositories with git and npm.</p></blockquote><p>Lerna是一个优化基于git+npm的多package项目的管理工具</p><h3 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h3><ul><li>大幅减少重复操作</li><li>提升操作的标准化</li></ul><blockquote><p>Lerna是架构优化的产物，它揭示了一个架构真理：项目复杂度提升后，就需要对项目进行架构优化。架构优化的主要目标往往都是以效能为核心。</p></blockquote><h3 id="官网"><a href="#官网" class="headerlink" title="官网"></a>官网</h3><p>官网：<a href="https://lerna.js.org/">https://lerna.js.org/</a></p><h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><p>使用Lerna管理的大型项目：</p><ul><li>babel：<a href="https://github.com/babel/babel">https://github.com/babel/babel</a></li><li>vue-cli：<a href="https://github.com/vuejs/vue-cli">https://github.com/vuejs/vue-cli</a></li><li>create-react-app：<a href="https://github.com/facebook/create-react-app">https://github.com/facebook/create-react-app</a></li></ul><h3 id="lerna开发脚手架流程（重点）"><a href="#lerna开发脚手架流程（重点）" class="headerlink" title="lerna开发脚手架流程（重点）"></a>lerna开发脚手架流程（重点）</h3><p><img src="lerna开发脚手架流程.png" alt="第二周lerna开发脚手架流程"></p><h3 id="Lern使用细节（重点）"><a href="#Lern使用细节（重点）" class="headerlink" title="Lern使用细节（重点）"></a>Lern使用细节（重点）</h3><ul><li><p><code>lerna init</code>:</p><p>会自动完成<code>git</code>初始化，但不会创建<code>.gitignore</code>文件，这个必须要手动添加，否则会将<code>node_modules</code>目录都上传到<code>git</code>，如果<code>node_modules</code>已经加入到<code>git stage</code>，可使用：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git reset HEAD &lt;file&gt;</span><br></pre></td></tr></table></figure><p>执行<code>unstage</code>操作，如果文件已经被<code>git</code>监听到变更，可使用：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git checkout -- &lt;filename&gt;</span><br></pre></td></tr></table></figure><p>将变更作废，记得在执行操作之前将文件加入：<code>.gitignore</code></p></li><li><p><code>lerna add</code>：</p><ul><li>第一个参数：添加npm包名</li><li>第二个参数：本地package的路径</li><li>选项：<ul><li><code>--dev</code>：将依赖安装到<code>devDependencies</code>，不加时安装到<code>dependencies</code></li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lerna add &lt;package&gt; [loc] --dev</span><br></pre></td></tr></table></figure></li><li><p><code>lerna link</code>：</p><p>如果未发布上线，需要手动将依赖添加到<code>package.json</code>，再执行<code>npm link</code></p></li><li><p><code>lerna clean</code>：</p><p>只会删除<code>node_modules</code>，不会删除<code>package.json</code>中的依赖</p></li><li><p><code>lerna exec</code>和<code>lerna run</code>：</p><p><code>--scope</code>属性后添加的是包名，而不是<code>package</code>的路径，这点和<code>lerna add</code>用法不同</p></li><li><p><code>lerna publish</code></p><ul><li>发布时会自动执行：<code>git add package-lock.json</code>，所以package-lock.json不要加入<code>.gitignore</code>文件</li><li>先创建远程仓库，并且同步一次master分支</li><li>执行<code>lerna publish</code>前先完成<code>npm login</code></li><li>如果发布的npm包名为：<code>@xxx/yyy</code>的格式，需要先在npm注册名为：xxx的organization，否则可能会提交不成功</li><li>发布到<code>npm group</code>时默认为private，所以我们需要手动在<code>package.json</code>中添加如下设置</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;publishConfig&quot;:&#123;</span><br><span class="line">  &quot;access&quot;:&quot;public&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="yargs使用"><a href="#yargs使用" class="headerlink" title="yargs使用"></a>yargs使用</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#! /usr/bin/env node</span><br><span class="line"></span><br><span class="line">const yargs = require(&#x27;yargs&#x27;)</span><br><span class="line">const dedent = require(&#x27;dedent&#x27;)</span><br><span class="line">const pkg = require(&#x27;../package.json&#x27;)</span><br><span class="line"></span><br><span class="line">const cli = yargs()</span><br><span class="line">const argv = process.argv.slice(2)</span><br><span class="line">const context = &#123;</span><br><span class="line">  imoocVersion: pkg.version</span><br><span class="line">&#125;</span><br><span class="line">cli</span><br><span class="line">    // 配置 第一行的使用提示</span><br><span class="line">  .usage(&#x27;Usage: imooc-cli-cai [command] &lt;options&gt;&#x27;)</span><br><span class="line">    // 配置 提示用户脚手架最少要接收一个命令</span><br><span class="line">  .demandCommand(1,&#x27;A command is required. Pass --help to see all available commands and options.&#x27;)</span><br><span class="line">    // 配置 命令输入错误或者没有此命令的时候可以根据输入推荐合适的命令</span><br><span class="line">  .recommendCommands()</span><br><span class="line">    // 配置 命令错误时执行的方法</span><br><span class="line">  .fail((err,msg)=&gt;&#123;</span><br><span class="line">    console.log(err)</span><br><span class="line">  &#125;)</span><br><span class="line">     // 配置 help和version的别名</span><br><span class="line">  .alias(&#x27;v&#x27;,&#x27;version&#x27;)</span><br><span class="line">  .alias(&#x27;h&#x27;,&#x27;help&#x27;)</span><br><span class="line">    // 配置 终端宽度</span><br><span class="line">  .wrap(cli.terminalWidth())</span><br><span class="line">    // 配置 尾部的提示文字</span><br><span class="line">  .epilogue(dedent`</span><br><span class="line">      when a command fails,all logs are written to lerna-debug.log in the current working directory.</span><br><span class="line"></span><br><span class="line">      For more information,find our manual at https://github.com/lerna/lerna</span><br><span class="line">    `)</span><br><span class="line">    // 配置 debug命令</span><br><span class="line">    .options(&#123;</span><br><span class="line">      debug:&#123;</span><br><span class="line">        type: &quot;boolean&quot;,</span><br><span class="line">        describe: &quot;Bootstrap debug mode&quot;,</span><br><span class="line">        alias: &quot;d&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    // 配置 registry命令</span><br><span class="line">    .option(&#x27;registry&#x27;,&#123;</span><br><span class="line">      type: &quot;string&quot;,</span><br><span class="line">      describe: &quot;Define global registry&quot;,</span><br><span class="line">      alias: &#x27;r&#x27;</span><br><span class="line">    &#125;)</span><br><span class="line">    // 配置 分组</span><br><span class="line">    .group([&#x27;debug&#x27;],&#x27;Dev Options&#x27;)</span><br><span class="line">    .group([&#x27;registry&#x27;],&#x27;Extra Options&#x27;)</span><br><span class="line">    // 配置 命令，当执行 init [name] 命令的时候一系列的行为</span><br><span class="line">    .command(&#x27;init [name]&#x27;, &#x27;Do init a project&#x27;,(yargs)=&gt;&#123;</span><br><span class="line">      yargs</span><br><span class="line">        .option(&#x27;name&#x27;,&#123;</span><br><span class="line">          type: &#x27;string&#x27;,</span><br><span class="line">          describe: &#x27;Name of a project&#x27;,</span><br><span class="line">          alias: &#x27;n&#x27;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,(argv)=&gt;&#123;</span><br><span class="line">      console.log(argv)</span><br><span class="line">    &#125;)</span><br><span class="line">    // 配置 命令的第二种方法</span><br><span class="line">    .command(&#123;</span><br><span class="line">      command: &#x27;list&#x27;,</span><br><span class="line">      aliases: [&#x27;ls&#x27;,&#x27;ll&#x27;,&#x27;la&#x27;],</span><br><span class="line">      describe: &#x27;List local packages&#x27;,</span><br><span class="line">      builder:(yargs)=&gt;&#123;&#125;,</span><br><span class="line">      handler: (argv)=&gt;&#123;</span><br><span class="line">        console.log(argv)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    // 配置 严格模式，最后一行提示命令错误，如：无法识别的选项：lis</span><br><span class="line">  .strict()</span><br><span class="line">     // 解析参数</span><br><span class="line">  .parse(argv,context)</span><br></pre></td></tr></table></figure><h2 id="lerna原理（还未深入理解）"><a href="#lerna原理（还未深入理解）" class="headerlink" title="lerna原理（还未深入理解）"></a>lerna原理（还未深入理解）</h2><ul><li>通过import-local来优先调用本地lerna命令</li><li>通过Yargs初始化脚手架，然后注册全局属性，再注册命令，最后通过parse方法解析参数</li><li>lerna命令注册时需要传入build和handler两个函数，build用来注册命令专属的options，handler用来处理命令的业务逻辑</li><li>lerna通过配置npm本地依赖的方式进行本地开发，具体写法是在package.json中写入：file:your-locale-module-path,在lerna publish的时候会自动替换路径</li></ul><h2 id="这一周的从4-8到最后有很多不理解的地方，需要学习了node之后再深入学习"><a href="#这一周的从4-8到最后有很多不理解的地方，需要学习了node之后再深入学习" class="headerlink" title="这一周的从4-8到最后有很多不理解的地方，需要学习了node之后再深入学习"></a>这一周的从4-8到最后有很多不理解的地方，需要学习了node之后再深入学习</h2>]]></content>
      
      
      
        <tags>
            
            <tag> 前端脚手架 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL零基础入门之从青铜到钻石</title>
      <link href="/posts/3d08e747/"/>
      <url>/posts/3d08e747/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><h2 id="3-1-SQL的概念"><a href="#3-1-SQL的概念" class="headerlink" title="3.1 SQL的概念"></a>3.1 SQL的概念</h2><h2 id="3-1-SQL的概念-1"><a href="#3-1-SQL的概念-1" class="headerlink" title="3.1 SQL的概念"></a>3.1 SQL的概念</h2><h3 id="3-1-1-什么是SQL"><a href="#3-1-1-什么是SQL" class="headerlink" title="3.1.1 什么是SQL"></a>3.1.1 什么是SQL</h3><p> 结构化查询语言(Structured Query Language)简称SQL,SQL语句就是对数据库进行操作的一种语言。</p><h3 id="3-1-2-SQL作用"><a href="#3-1-2-SQL作用" class="headerlink" title="3.1.2 SQL作用"></a>3.1.2 SQL作用</h3><p> 通过SQL语句我们可以方便的操作数据库中的数据库、表、数据。<br> SQL是数据库管理系统都需要遵循的规范。不同的数据库生产厂商都支持SQL语句，但都有特有内容。<br><img src="5fb38da70001613a04450195.png" alt="图片描述"></p><h3 id="3-1-3-SQL语句分类"><a href="#3-1-3-SQL语句分类" class="headerlink" title="3.1.3 SQL语句分类"></a>3.1.3 SQL语句分类</h3><ol><li>DDL(Data Definition Language)数据定义语言<br>用来定义数据库对象：数据库，表，列等。关键字：create, drop,alter等</li><li>DML(Data Manipulation Language)数据操作语言<br>用来对数据库中表的数据进行增删改。关键字：insert, delete, update等</li><li>DQL(Data Query Language)数据查询语言<br>用来查询数据库中表的记录(数据)。关键字：select, where等</li><li>DCL(Data Control Language)数据控制语言(了解)<br>用来定义数据库的访问权限和安全级别，及创建用户。关键字：GRANT， REVOKE等</li></ol><h2 id="3-2-SQL通用语法"><a href="#3-2-SQL通用语法" class="headerlink" title="3.2 SQL通用语法"></a>3.2 SQL通用语法</h2><ol><li><p>SQL语句可以单行或多行书写，以分号结尾。</p></li><li><p>可使用空格和缩进来增强语句的可读性。</p></li><li><p>MySQL数据库的SQL语句不区分大小写，关键字建议使用大写。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM student;</span><br><span class="line">select * from student;</span><br><span class="line">SELECT * FROM student;</span><br></pre></td></tr></table></figure></li></ol><h2 id="3-3-DDL语句"><a href="#3-3-DDL语句" class="headerlink" title="3.3 DDL语句"></a>3.3 DDL语句</h2><p>DDL(Data Definition Language)数据定义语言<br>用来定义数据库对象：数据库，表，列等。关键字：create, drop,alter等</p><h3 id="3-3-1-DDL操作数据库"><a href="#3-3-1-DDL操作数据库" class="headerlink" title="3.3.1 DDL操作数据库"></a>3.3.1 DDL操作数据库</h3><h4 id="3-3-1-1-创建数据库"><a href="#3-3-1-1-创建数据库" class="headerlink" title="3.3.1.1 创建数据库"></a>3.3.1.1 创建数据库</h4><ol><li>直接创建数据库<br><code>CREATE DATABASE 数据库名;</code></li><li>判断是否存在并创建数据库<br><code>CREATE DATABASE IF NOT EXISTS 数据库名;</code></li><li>创建数据库并指定字符集(编码表)<br><code>CREATE DATABASE 数据库名 CHARACTER SET 字符集;</code></li><li>具体操作：</li></ol><ul><li><p>直接创建数据库db1</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE DATABASE db1;</span><br></pre></td></tr></table></figure><p>image-20200903093635240</p></li><li><p>判断是否存在并创建数据库db2</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE DATABASE IF NOT EXISTS db2;</span><br></pre></td></tr></table></figure></li></ul><p><img src="5fb399020001dfd406790147.png" alt="image-20200903093748558.png"></p><ul><li><p>创建数据库并指定字符集为gbk</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE DATABASE db3 CHARACTER SET gbk;</span><br></pre></td></tr></table></figure></li></ul><p><img src="5fb399dc0001f90407960083.png" alt="图片描述"></p><h4 id="3-3-1-2-查看数据库"><a href="#3-3-1-2-查看数据库" class="headerlink" title="3.3.1.2 查看数据库"></a>3.3.1.2 查看数据库</h4><ol><li>查看所有的数据库<br><code>SHOW DATABASES;</code><br><img src="5fb399f500010a7809530462.png" alt="图片描述"></li><li>查看某个数据库的定义信息<br><code>SHOW CREATE DATABASE 数据库名;</code><br><img src="5fb39a4100014cdc15510206.png" alt="图片描述"></li></ol><h4 id="3-3-1-3-修改数据库"><a href="#3-3-1-3-修改数据库" class="headerlink" title="3.3.1.3 修改数据库"></a>3.3.1.3 修改数据库</h4><p>修改数据库字符集格式</p><p><code>ALTER DATABASE 数据库名 DEFAULT CHARACTER SET 字符集;</code></p><p>具体操作：</p><ul><li><p>将db3数据库的字符集改成utf8</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ALTER DATABASE db3 DEFAULT CHARACTER SET utf8;</span><br></pre></td></tr></table></figure></li></ul><p><img src="5fb39a620001446616660364.png" alt="图片描述"></p><h4 id="3-3-1-4-删除数据库"><a href="#3-3-1-4-删除数据库" class="headerlink" title="3.3.1.4 删除数据库"></a>3.3.1.4 删除数据库</h4><p><code>DROP DATABASE 数据库名;</code></p><p>具体操作：</p><ul><li><p>删除db2数据库</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DROP DATABASE db2;</span><br></pre></td></tr></table></figure></li></ul><p><img src="5fb39a820001b82607580840.png" alt="图片描述"></p><h4 id="3-3-1-5-使用数据库"><a href="#3-3-1-5-使用数据库" class="headerlink" title="3.3.1.5 使用数据库"></a>3.3.1.5 使用数据库</h4><ol><li>查看正在使用的数据库<br><code>SELECT DATABASE();</code></li><li>使用/切换数据库<br><code>USE 数据库名;</code></li></ol><p>具体操作：</p><ul><li><p>查看正在使用的数据库</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT DATABASE();</span><br></pre></td></tr></table></figure></li></ul><p><img src="5fb39a9900010d3205940287.png" alt="图片描述"></p><ul><li><p>使用db1数据库</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">USE db1;</span><br></pre></td></tr></table></figure></li></ul><p><img src="5fb39ab50001582206100476.png" alt="图片描述"></p><h3 id="3-3-2-DDL操作表"><a href="#3-3-2-DDL操作表" class="headerlink" title="3.3.2 DDL操作表"></a>3.3.2 DDL操作表</h3><p>><strong>前提先使用某个数据库</strong></p><p>作者：好帮手慕阿莹</p><p>链接：<a href="https://www.imooc.com/article/312463">https://www.imooc.com/article/312463</a></p><p>来源：慕课网</p><p>本文原创发布于慕课网 ，转载请注明出处，谢谢合作</p><h4 id="3-3-2-1-创建表"><a href="#3-3-2-1-创建表" class="headerlink" title="3.3.2.1 创建表"></a>3.3.2.1 创建表</h4><p>表的结构与excel相似</p><p><img src="5fb39ad10001bffa03520158.png" alt="image-20200903101514367.png"></p><p>语法：</p><p><code>CREATE TABLE 表名 (字段名1 字段类型1, 字段名2 字段类型2…);</code></p><p>关键字说明：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE -- 表示创建</span><br><span class="line">TABLE -- 表示创建一张表</span><br></pre></td></tr></table></figure><p>建议写成如下格式:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE 表名 (</span><br><span class="line">字段名1 字段类型1, </span><br><span class="line">字段名2 字段类型2</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><strong>MySQL数据类型</strong><br>MySQL中的我们常使用的数据类型如下：</p><div class="table-container"><table><thead><tr><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>int</td><td>整型</td></tr><tr><td>double</td><td>浮点型</td></tr><tr><td>varchar</td><td>字符串型</td></tr><tr><td>data</td><td>日期类型：yyyy-MM-dd</td></tr></tbody></table></div><p>详细的数据类型如下(不建议详细阅读！)</p><div class="table-container"><table><thead><tr><th>分类</th><th>类型名称</th><th>说明</th></tr></thead><tbody><tr><td>整数类型</td><td>tinyInt</td><td>很小的整数</td></tr><tr><td></td><td>smallint</td><td>小的整数</td></tr><tr><td></td><td>mediumint</td><td>中等大小的整数</td></tr><tr><td></td><td>int(integer)</td><td>普通大小的整数</td></tr><tr><td>小数类型</td><td>float</td><td>单精度浮点数</td></tr><tr><td></td><td>double</td><td>双精度浮点数</td></tr><tr><td></td><td>decimal（m,d）</td><td>压缩严格的定点数</td></tr><tr><td>日期类型</td><td>year</td><td>YYYY 1901~2155</td></tr><tr><td></td><td>time</td><td>HH:MM:SS -838:59:59~838:59:59</td></tr><tr><td></td><td>date</td><td>YYYY-MM-DD 1000-01-01~9999-12-3</td></tr><tr><td></td><td>datetime</td><td>YYYY-MM-DD HH:MM:SS 1000-01-01 00:00:00~ 9999-12-31 23:59:59</td></tr><tr><td></td><td>timestamp</td><td>YYYY-MM-DD HH:MM:SS 19700101 00:00:01 UTC~2038-01-19 03:14:07UTC</td></tr><tr><td>文本、二进制类型</td><td>CHAR(M)</td><td>M为0~255之间的整数</td></tr><tr><td></td><td>VARCHAR(M)</td><td>M为0~65535之间的整数</td></tr><tr><td></td><td>TINYBLOB</td><td>允许长度0~255字节</td></tr><tr><td></td><td>BLOB</td><td>允许长度0~65535字节</td></tr><tr><td></td><td>MEDIUMBLOB</td><td>允许长度0~167772150字节</td></tr><tr><td></td><td>LONGBLOB</td><td>允许长度0~4294967295字节</td></tr><tr><td></td><td>TINYTEXT</td><td>允许长度0~255字节</td></tr><tr><td></td><td>TEXT</td><td>允许长度0~65535字节</td></tr><tr><td></td><td>MEDIUMTEXT</td><td>允许长度0~167772150字节</td></tr><tr><td></td><td>LONGTEXT</td><td>允许长度0~4294967295字节</td></tr><tr><td></td><td>VARBINARY(M)</td><td>允许长度0~M个字节的变长字节字符串</td></tr><tr><td></td><td>BINARY(M)</td><td>允许长度0~M个字节的定长字节字符串</td></tr></tbody></table></div><p>具体操作:</p><p>创建student表包含id,name,birthday字段</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE student (</span><br><span class="line">      id INT,</span><br><span class="line">      name VARCHAR(20),</span><br><span class="line">      birthday DATE</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><img src="5fb39b060001971209460085.png" alt="image-20200903102210042.png"></p><h4 id="3-3-2-2-查看表"><a href="#3-3-2-2-查看表" class="headerlink" title="3.3.2.2 查看表"></a>3.3.2.2 查看表</h4><ol><li>查看某个数据库中的所有表<br><code>SHOW TABLES;</code><br><img src="5fb39b3e0001045c04900207.png" alt="图片描述"></li><li>查看表结构<br><code>DESC 表名;</code><br><img src="5fb39b53000143b108810265.png" alt="图片描述"></li><li>查看创建表的SQL语句<br><code>SHOW CREATE TABLE 表名;</code><br><img src="5fb39b6c00010e4313280439.png" alt="图片描述"></li></ol><h4 id="3-3-2-3-快速创建一个表结构相同的表"><a href="#3-3-2-3-快速创建一个表结构相同的表" class="headerlink" title="3.3.2.3 快速创建一个表结构相同的表"></a>3.3.2.3 快速创建一个表结构相同的表</h4><p><code>CREATE TABLE 新表名 LIKE 旧表名;</code></p><p>具体操作：</p><ul><li><p>创建s1表，s1表结构和student表结构相同</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE s1 LIKE student;</span><br></pre></td></tr></table></figure></li></ul><p><img src="5fb39b87000167e607180334.png" alt="图片描述"></p><p><img src="5fb39b9d0001d0a410790549.png" alt="图片描述"></p><h4 id="3-3-2-4-删除表"><a href="#3-3-2-4-删除表" class="headerlink" title="3.3.2.4 删除表"></a>3.3.2.4 删除表</h4><ol><li>直接删除表<br><code>DROP TABLE 表名;</code><br><img src="5fb39bbf00018d4708170664.png" alt="图片描述"></li><li>判断表是否存在并删除表<br><code>DROP TABLE IF EXISTS 表名;</code><br><img src="5fb39bd50001fe4408640427.png" alt="图片描述"></li></ol><h4 id="3-3-2-5-修改表结构"><a href="#3-3-2-5-修改表结构" class="headerlink" title="3.3.2.5 修改表结构"></a>3.3.2.5 修改表结构</h4><blockquote><p>修改表结构使用不是很频繁，只需要了解，等需要使用的时候再回来查即可</p></blockquote><ol><li><p>添加表列<br><code>ALTER TABLE 表名 ADD 列名 类型;</code></p><p>具体操作：</p><ul><li><p>为学生表添加一个新的字段remark,类型为varchar(20)</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ALTER TABLE student ADD remark VARCHAR(20);</span><br></pre></td></tr></table></figure></li></ul></li></ol><p><img src="5fb39c0300014dc510410673.png" alt="图片描述"></p><ol><li><p>修改列类型<br><code>ALTER TABLE 表名 MODIFY列名 新的类型;</code><br>具体操作：</p><ul><li><p>将student表中的remark字段的改成varchar(100)</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ALTER TABLE student MODIFY remark VARCHAR(100);</span><br></pre></td></tr></table></figure></li></ul><p><img src="5fb39c4200011f5c10540709.png" alt="图片描述"></p></li><li><p>修改列名<br><code>ALTER TABLE 表名 CHANGE 旧列名 新列名 类型;</code><br>具体操作：</p><ul><li><p>将student表中的remark字段名改成intro，类型varchar(30)</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ALTER TABLE student CHANGE remark intro varchar(30);</span><br></pre></td></tr></table></figure></li></ul><p><img src="5fb39c870001f90311130708.png" alt="图片描述"></p></li><li><p>删除列<br><code>ALTER TABLE 表名 DROP 列名;</code><br>具体操作：</p><ul><li><p>删除student表中的字段intro</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ALTER TABLE student DROP intro;</span><br></pre></td></tr></table></figure></li></ul></li></ol><p><img src="5fb39c9d00015ba911390689.png" alt="图片描述"></p><ol><li><p>修改表名<br><code>RENAME TABLE 表名 TO 新表名;</code><br>具体操作：</p><ul><li><p>将学生表student改名成student2</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">RENAME TABLE student TO student2;</span><br></pre></td></tr></table></figure></li></ul></li></ol><p><img src="5fb39cb40001f8e506850661.png" alt="图片描述"></p><ol><li><p>修改字符集<br><code>ALTER TABLE 表名 character set 字符集;</code><br>具体操作：</p><ul><li><p>将sutden2表的编码修改成gbk</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ALTER TABLE student2 character set gbk;</span><br></pre></td></tr></table></figure><p><img src="5fb39cc800015fea14090834.png" alt="image-20200903104239208.png"></p></li></ul></li></ol><h2 id="3-4-DML语句"><a href="#3-4-DML语句" class="headerlink" title="3.4 DML语句"></a>3.4 DML语句</h2><p>DML(Data Manipulation Language)数据操作语言<br>用来对数据库中表的数据进行增删改。关键字：insert, delete, update等</p><h3 id="3-4-1-插入记录"><a href="#3-4-1-插入记录" class="headerlink" title="3.4.1 插入记录"></a>3.4.1 插入记录</h3><ol><li><p>关键字说明</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT INTO 表名 – 表示往哪张表中添加数据</span><br><span class="line">(字段名1, 字段名2, …)  --  要给哪些字段设置值</span><br><span class="line">VALUES (值1, 值2, …); -- 设置具体的值</span><br></pre></td></tr></table></figure></li><li><p>注意</p><blockquote><ul><li>值与字段必须对应，个数相同，类型相同</li><li>值的数据大小必须在字段的长度范围内</li><li>除了数值类型外，其它的字段类型的值必须使用引号引起。（建议单引号）</li><li>如果要插入空值，可以不写字段，或者插入null</li></ul></blockquote></li></ol><h4 id="3-4-1-1-插入全部字段"><a href="#3-4-1-1-插入全部字段" class="headerlink" title="3.4.1.1 插入全部字段"></a>3.4.1.1 插入全部字段</h4><ul><li>所有的字段名都写出来<br><code>INSERT INTO 表名 (字段名1, 字段名2, 字段名3…) VALUES (值1, 值2, 值3);</code></li><li>不写字段名<br><code>INSERT INTO 表名 VALUES (值1, 值2, 值3…);</code></li></ul><h4 id="3-4-1-2-插入部分数据"><a href="#3-4-1-2-插入部分数据" class="headerlink" title="3.4.1.2 插入部分数据"></a>3.4.1.2 插入部分数据</h4><p><code>INSERT INTO 表名 (字段名1, 字段名2, ...) VALUES (值1, 值2, ...);</code><br>没有添加数据的字段会使用NULL</p><p>具体操作:</p><p>创建db2数据库，并使用。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE DATABASE db2;</span><br><span class="line">USE db2;</span><br></pre></td></tr></table></figure><p>创建完整学生信息表，包括学员的id，姓名，年龄，性别，家庭地址，电话号码，生日，数学成绩，英语成绩</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE  student(</span><br><span class="line">id int,</span><br><span class="line">    name varchar(20),</span><br><span class="line">    age int,</span><br><span class="line">    sex char(1),</span><br><span class="line">    address varchar(200),</span><br><span class="line">    phone varchar(20),</span><br><span class="line">    birthday date,</span><br><span class="line">    math double,</span><br><span class="line">    english double</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>插入部分数据，往学生表中添加 id, name, age, sex,address数据</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT INTO student (id,name,age,sex,address)values(1,&#x27;张三&#x27;,19,&#x27;男&#x27;,&#x27;北京市&#x27;);</span><br></pre></td></tr></table></figure><p> 提示：使用SELECT * FROM 表名；测试是否插入成功<br><img src="5fb39cf100012c1211730206.png" alt="图片描述"></p><ul><li><p>向表中插入所有字段</p><ul><li>所有的字段名都写出来</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT INTO student(id,name,age,sex,address,phone,birthday,math,english)values(2,&#x27;小美&#x27;,18,&#x27;女&#x27;,&#x27;上海市&#x27;,&#x27;18888888888&#x27;,&#x27;2011-12-12&#x27;,65.5,99.2);</span><br></pre></td></tr></table></figure><p><img src="5fb39d0500018b6a16820336.png" alt="image-20200903111849009.png"></p><ul><li>不写字段名</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT INTO student values(3,&#x27;小明&#x27;,27,&#x27;男&#x27;,&#x27;深圳市&#x27;,&#x27;13333333333&#x27;,&#x27;2000-11-06&#x27;,95.5,92);</span><br></pre></td></tr></table></figure></li></ul><p><img src="5fb39d46000147c115270351.png" alt="图片描述"></p><h4 id="3-4-1-3-蠕虫复制"><a href="#3-4-1-3-蠕虫复制" class="headerlink" title="3.4.1.3 蠕虫复制"></a>3.4.1.3 蠕虫复制</h4><p>什么是蠕虫复制：在已有的数据基础之上，将原来的数据进行复制，插入到对应的表中<br>语法格式：<code>INSERT INTO 表名1 SELECT * FROM 表名2;</code><br>作用:将<code>表名2</code>中的数据复制到<code>表名1</code>中</p><p>具体操作:</p><ul><li>创建student2表，student2结构和student表结构一样</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE student LIKE student2;</span><br></pre></td></tr></table></figure><ul><li>将student表中的数据添加到student2表中</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT INTO student SELECT * FROM student2;</span><br></pre></td></tr></table></figure><p><img src="5fb39d620001994a12210383.png" alt="图片描述"></p><p>注意：如果只想复制student表中name,age字段数据到student2表中使用如下格式</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT INTO student2(name,age) SELECT name,age FROM student;</span><br></pre></td></tr></table></figure><p><img src="5fb39d8e00014e3114280479.png" alt="图片描述"></p><h3 id="3-4-2-更新表记录"><a href="#3-4-2-更新表记录" class="headerlink" title="3.4.2 更新表记录"></a>3.4.2 更新表记录</h3><ol><li><p>不带条件修改数据<br><code>UPDATE 表名 SET 字段名=值;</code></p></li><li><p>带条件修改数据<br><code>UPDATE 表名 SET 字段名=值 WHERE 字段名=值;</code></p></li><li><p>关键字说明</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UPDATE: 修改数据</span><br><span class="line">SET: 修改哪些字段</span><br><span class="line">WHERE: 指定条件</span><br></pre></td></tr></table></figure></li><li><p>具体操作：</p><ul><li><p>不带条件修改数据，将所有的性别改成女</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UPDATE student SET sex=&#x27;女&#x27;;</span><br></pre></td></tr></table></figure></li></ul></li></ol><p><img src="5fb39df900013ace13590638.png" alt="图片描述"></p><ul><li><p>带条件修改数据，将id号为2的学生性别改成男</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UPDATE student SET sex=&#x27;男&#x27; WHERE id=2;</span><br></pre></td></tr></table></figure></li></ul><p><img src="5fb39e1d00014f1913180651.png" alt="图片描述"></p><ul><li><p>一次修改多个列，把id为3的学生，年龄改成26岁，address改成北京</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UPDATE student SET age=26, address=&#x27;北京&#x27; WHERE id=3;</span><br></pre></td></tr></table></figure></li></ul><p><img src="5fb39e35000123d314380654.png" alt="图片描述"></p><h3 id="3-4-3-删除表记录"><a href="#3-4-3-删除表记录" class="headerlink" title="3.4.3 删除表记录"></a>3.4.3 删除表记录</h3><ol><li><p>不带条件删除数据<br><code>DELETE FROM 表名;</code></p></li><li><p>带条件删除数据<br><code>DELETE FROM 表名 WHERE 字段名=值;</code></p></li><li><p>具体操作：</p><ul><li><p>带条件删除数据，删除id为3的记录</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DELETE FROM student WHERE id=3;</span><br></pre></td></tr></table></figure></li></ul></li></ol><p><img src="5fb39e5500015aac13550602.png" alt="图片描述"></p><ul><li><p>不带条件删除数据,删除表中的所有数据</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DELETE FROM student;</span><br></pre></td></tr></table></figure></li></ul><p><img src="5fb39e710001184b13460417.png" alt="图片描述"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">truncate删除表记录</span><br><span class="line">`TRUNCATE TABLE 表名;`</span><br></pre></td></tr></table></figure><p>truncate和delete的区别：</p><ul><li>delete是将表中的数据一条一条删除</li><li>truncate是将整个表摧毁，重新创建一个新的表,新的表结构和原来表结构一模一样<br><img src="5fb39ef000019c7812420512.png" alt="图片描述"></li></ul><h2 id="3-5-DQL"><a href="#3-5-DQL" class="headerlink" title="3.5 DQL"></a>3.5 DQL</h2><p>DQL(Data Query Language)数据查询语言<br>用来查询数据库中表的记录(数据)。关键字：select, where等</p><p>>注意：查询不会对数据库中的数据进行修改.只是一种显示数据的方式</p><h3 id="3-5-1-简单查询"><a href="#3-5-1-简单查询" class="headerlink" title="3.5.1 简单查询"></a>3.5.1 简单查询</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">--为 student准备数据</span><br><span class="line">INSERT INTO student values(1,&#x27;闫妮&#x27;,43,&#x27;女&#x27;,&#x27;北京市&#x27;,&#x27;12222222222&#x27;,&#x27;2019-02-12&#x27;,92.5,88);</span><br><span class="line">INSERT INTO student values(2,&#x27;郭富城&#x27;,21,&#x27;男&#x27;,&#x27;上海市&#x27;,&#x27;1666666666&#x27;,&#x27;2018-06-06&#x27;,97.5,65.5);</span><br><span class="line">INSERT INTO student values(3,&#x27;赵丽颖&#x27;,44,&#x27;女&#x27;,&#x27;深圳市&#x27;,&#x27;13333333333&#x27;,&#x27;2012-07-15&#x27;,42.5,74.5);</span><br><span class="line">INSERT INTO student values(4,&#x27;张学友&#x27;,34,&#x27;男&#x27;,&#x27;杭州市&#x27;,&#x27;17777777777&#x27;,&#x27;2013-11-17&#x27;,69,65);</span><br><span class="line">INSERT INTO student values(5,&#x27;成龙&#x27;,51,&#x27;男&#x27;,&#x27;哈尔滨市&#x27;,&#x27;15555555555&#x27;,&#x27;2005-10-12&#x27;,88,97);</span><br><span class="line">INSERT INTO student values(6,&#x27;刘德华&#x27;,57,&#x27;男&#x27;,&#x27;盘锦市&#x27;,&#x27;19999999999&#x27;,&#x27;2015-11-11&#x27;,74.5,92.5);</span><br><span class="line">INSERT INTO student values(7,&#x27;马伊琍&#x27;,42,&#x27;女&#x27;,&#x27;长沙市&#x27;,&#x27;18888888888&#x27;,&#x27;2008-03-26&#x27;,86.5,71.5);</span><br><span class="line">INSERT INTO student values(8,&#x27;黎明&#x27;,49,&#x27;男&#x27;,&#x27;昆明市&#x27;,&#x27;11111111111&#x27;,&#x27;2000-09-14&#x27;,77.5,60);</span><br></pre></td></tr></table></figure><h4 id="3-5-1-1-查询表所有数据"><a href="#3-5-1-1-查询表所有数据" class="headerlink" title="3.5.1.1 查询表所有数据"></a>3.5.1.1 查询表所有数据</h4><ol><li><p>使用<em>表示所有列<br>`SELECT </em> FROM 表名;`<br>具体操作：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM student;</span><br></pre></td></tr></table></figure></li></ol><p><img src="5fb39f4f0001256114020389.png" alt="图片描述"></p><ol><li><p>写出查询每列的名称<br><code>SELECT 字段名1, 字段名2, 字段名3, ... FROM 表名;</code><br>具体操作：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT id,name,age,sex,address,phone,birthday,math,english FROM student;</span><br></pre></td></tr></table></figure></li></ol><p><img src="5fb39f6b00010cd512770414.png" alt="图片描述"></p><h4 id="3-5-1-2-查询指定列"><a href="#3-5-1-2-查询指定列" class="headerlink" title="3.5.1.2 查询指定列"></a>3.5.1.2 查询指定列</h4><p>查询指定列的数据,多个列之间以逗号分隔<br><code>SELECT 字段名1, 字段名2... FROM 表名;</code></p><p>具体操作：<br>查询student表中的name 和 age 列</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT NAME, age FROM student;</span><br></pre></td></tr></table></figure><p><img src="5fb39f7e00015a8907350413.png" alt="图片描述"></p><h4 id="3-5-1-3-别名查询"><a href="#3-5-1-3-别名查询" class="headerlink" title="3.5.1.3 别名查询"></a>3.5.1.3 别名查询</h4><ol><li><p>查询时给列、表指定别名需要使用AS关键字</p></li><li><p>使用别名的好处是方便观看和处理查询到的数据<br><code>SELECT 字段名1 AS 别名, 字段名2 AS 别名... FROM 表名;</code><br>注意：AS可以省略不写</p></li><li><p>具体操作：</p><ul><li>查询sudent表中name 和 age 列，name列的别名为”姓名”，age列的别名为”年龄”</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT NAME AS 姓名, age AS 年龄 FROM student;</span><br></pre></td></tr></table></figure></li></ol><p><img src="5fb39f92000132a211620399.png" alt="图片描述"></p><h4 id="3-5-1-4-清除重复值"><a href="#3-5-1-4-清除重复值" class="headerlink" title="3.5.1.4 清除重复值"></a>3.5.1.4 清除重复值</h4><ol><li><p>查询指定列并且结果不出现重复数据<br><code>SELECT DISTINCT 字段名 FROM 表名;</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">--补充数据</span><br><span class="line">INSERT INTO student values(9,&#x27;黎明&#x27;,49,&#x27;女&#x27;,&#x27;锦州市&#x27;,&#x27;14444444444&#x27;,&#x27;2000-06-18&#x27;,73.5,69);</span><br><span class="line">INSERT INTO student values(10,&#x27;黎明&#x27;,31,&#x27;女&#x27;,&#x27;重庆市&#x27;,&#x27;10000000000&#x27;,&#x27;2010-05-23&#x27;,63.5,88);</span><br></pre></td></tr></table></figure></li><li><p>具体操作：</p><ul><li>查询name，age列并且结果不出现重复name</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT DISTINCT NAME, age FROM student;</span><br></pre></td></tr></table></figure></li></ol><p><img src="5fb39fa5000192f013840893.png" alt="图片描述"></p><h4 id="3-5-1-5-查询结果参与运算"><a href="#3-5-1-5-查询结果参与运算" class="headerlink" title="3.5.1.5 查询结果参与运算"></a>3.5.1.5 查询结果参与运算</h4><ol><li>某列数据和固定值运算<br><code>SELECT 列名1 + 固定值 FROM 表名;</code></li><li>某列数据和其他列数据参与运算<br><code>SELECT 列名1 + 列名2 FROM 表名;</code></li></ol><blockquote><p>注意: 参与运算的必须是数值类型</p></blockquote><ol><li>需求：<ul><li>查询的时候将数学和英语的成绩相加</li><li>让学员的年龄增加10岁</li></ul></li><li>实现：</li></ol><ul><li><p>查询math + english的和</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT math + english FROM student;</span><br></pre></td></tr></table></figure></li></ul><p><img src="5fb39fb90001f42006290466.png" alt="图片描述"></p><p>>结果确实将每条记录的math和english相加，但是效果不好看</p><ul><li><p>查询math + english的和使用别名”总成绩”</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT math + english 总成绩 FROM student;</span><br></pre></td></tr></table></figure></li></ul><p><img src="5fb3a1420001c83f08100460.png" alt="image-20200903141837433.png"></p><ul><li><p>查询所有列与math + english的和并使用别名”总成绩”</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT *, math + english 总成绩 FROM student;</span><br></pre></td></tr></table></figure><p><img src="5fb3a1b700011d2e13750450.png" alt="图片描述"></p></li><li><p>查询姓名、年龄，将每个人的年龄增加10岁</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT name, age + 10 FROM student;</span><br></pre></td></tr></table></figure></li></ul><p><img src="5fb3a1cc000103b607810471.png" alt="图片描述"></p><h3 id="3-5-2-Navicat连接工具的使用"><a href="#3-5-2-Navicat连接工具的使用" class="headerlink" title="3.5.2 Navicat连接工具的使用"></a>3.5.2 Navicat连接工具的使用</h3><hr><h4 id="3-5-2-1为什么使用Navicat"><a href="#3-5-2-1为什么使用Navicat" class="headerlink" title="3.5.2.1为什么使用Navicat"></a>3.5.2.1为什么使用Navicat</h4><p>Navicat是一套快速、可靠并价格相当便宜的<a href="https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86/10509024">数据库管理</a>工具，专为简化数据库的管理及降低系统管理成本而设。它的设计符合<a href="https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E5%91%98/1216449">数据库管理员</a>、开发人员及中小企业的需要。Navicat 是以直觉化的<a href="https://baike.baidu.com/item/%E5%9B%BE%E5%BD%A2%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2/3352324">图形用户界面</a>而建的，让你可以以安全并且简单的方式创建、组织、访问并共用信息。</p><h4 id="3-5-2-2Navicat的安装"><a href="#3-5-2-2Navicat的安装" class="headerlink" title="3.5.2.2Navicat的安装"></a>3.5.2.2Navicat的安装</h4><p>1.双击运行Navicat程序<br><img src="5fb3a1f60001e0af06420048.png" alt="图片描述"></p><p>2.点击下一步<br><img src="5fb3a21f0001803304990387.png" alt="图片描述"></p><p>3.勾选我同意，点击下一步<br><img src="5fb3a2330001f88305000384.png" alt="图片描述"></p><p>4.选择安装目录后，点击下一步<br><img src="5fb3a246000134f604970383.png" alt="图片描述"></p><p>5.点击下一步<br><img src="5fb3a2610001a69304960382.png" alt="图片描述"></p><p>6.点击下一步</p><p><img src="5fb3a2760001739504940380.png" alt="图片描述"></p><p>7.点击安装<br><img src="5fb3a288000144d004930388.png" alt="图片描述"></p><p>8.等待安装完毕<br><img src="5fb3a2990001bd2304930385.png" alt="图片描述"></p><p>9.点击完成即可<br><img src="5fb3a2ac0001a94604970379.png" alt="图片描述"><br>10.主页面点击连接选择MySQL</p><p><img src="5fb3af960001706009600668.png" alt="a5"></p><p>11.填写连接名称以及密码信息</p><p><img src="5fb3afe8000199fc09590665.png" alt="a6"></p><p>12.数据库正常登录</p><p><img src="5fb3affa0001795c09380666.png" alt="a2"></p><h4 id="3-5-2-3Navicat完成hero表"><a href="#3-5-2-3Navicat完成hero表" class="headerlink" title="3.5.2.3Navicat完成hero表"></a>3.5.2.3Navicat完成hero表</h4><p>1.创建db数据库</p><p>2.使用db数据库</p><p>3.创建hero表，表中包括：id，name，age, sex，location，life，magic，is_hot,grounding_date,max_score 字段</p><p>4.添加一条数据，对数据进行增删改操作</p><h3 id="3-5-3-条件查询"><a href="#3-5-3-条件查询" class="headerlink" title="3.5.3 条件查询"></a>3.5.3 条件查询</h3><p>前面我们的查询都是将所有数据都查询出来，但是有时候我们只想获取到<code>满足条件</code>的数据<br>语法格式：<code>SELECT 字段名 FROM 表名 WHERE 条件;</code><br>流程：取出表中的每条数据，满足条件的记录就返回，不满足条件的记录不返回</p><h4 id="3-5-3-1-准备数据"><a href="#3-5-3-1-准备数据" class="headerlink" title="3.5.3.1 准备数据"></a>3.5.3.1 准备数据</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">--准备数据</span><br><span class="line">INSERT into hero values(1,&#x27;亚瑟&#x27;,35,&#x27;男&#x27;,320,&#x27;战士&#x27;,3000,0,1,&#x27;2017-05-14&#x27;,14.2);</span><br><span class="line">INSERT into hero values(2,&#x27;阿珂&#x27;,19,&#x27;女&#x27;,470,&#x27;刺客&#x27;,1500,1100,0,&#x27;2019-06-11&#x27;,15.6);</span><br><span class="line">INSERT into hero values(3,&#x27;老夫子&#x27;,75,&#x27;男&#x27;,430,&#x27;战士&#x27;,2500,0,1,&#x27;2016-11-18&#x27;,17.7);</span><br><span class="line">INSERT into hero values(4,&#x27;吕布&#x27;,40,&#x27;男&#x27;,500,&#x27;战士&#x27;,2700,1000,1,&#x27;2015-04-22&#x27;,12.2);</span><br><span class="line">INSERT into hero values(5,&#x27;甄姬&#x27;,27,&#x27;女&#x27;,210,&#x27;法师&#x27;,1400,1900,0,&#x27;2018-06-06&#x27;,13.1);</span><br><span class="line">INSERT into hero values(6,&#x27;虞姬&#x27;,25,&#x27;女&#x27;,370,&#x27;射手&#x27;,1600,1200,1,&#x27;2013-02-24&#x27;,11.2);</span><br><span class="line">INSERT into hero values(7,&#x27;德玛西亚&#x27;,35,&#x27;男&#x27;,220,&#x27;战士&#x27;,3900,1500,1,&#x27;2011-02-14&#x27;,11.2);</span><br><span class="line">INSERT into hero values(8,&#x27;孙尚香&#x27;,24,&#x27;女&#x27;,260,&#x27;射手&#x27;,1300,900,0,&#x27;2020-03-12&#x27;,9.2);</span><br><span class="line">INSERT into hero values(9,&#x27;孙策&#x27;,39,&#x27;男&#x27;,280,&#x27;战士&#x27;,3200,1100,1,&#x27;2016-07-14&#x27;,16.7);</span><br><span class="line">INSERT into hero values(10,&#x27;孙悟空&#x27;,32,&#x27;男&#x27;,460,&#x27;战士&#x27;,2900,1300,0,&#x27;2013-02-11&#x27;,17.2);</span><br><span class="line">INSERT into hero values(11,&#x27;公孙策&#x27;,37,&#x27;男&#x27;,210,&#x27;法师&#x27;,2200,700,1,&#x27;2019-09-16&#x27;,11.4);</span><br><span class="line">INSERT into hero values(12,&#x27;土行孙&#x27;,22,&#x27;男&#x27;,195,&#x27;刺客&#x27;,1400,1700,1,&#x27;2013-02-16&#x27;,12.4);</span><br><span class="line">INSERT into hero values(13,&#x27;后裔&#x27;,39,&#x27;男&#x27;,420,&#x27;射手&#x27;,780,700,0,&#x27;2019-01-19&#x27;,NULL);</span><br></pre></td></tr></table></figure><h4 id="3-5-3-2-比较运算符"><a href="#3-5-3-2-比较运算符" class="headerlink" title="3.5.3.2 比较运算符"></a>3.5.3.2 比较运算符</h4><p><code>&gt;</code>大于<br><code>&lt;</code>小于<br><code>&lt;=</code>小于等于<br><code>&gt;=</code>大于等于<br><code>=</code>等于<br><code>&lt;&gt;</code>、<code>!=</code>不等于<br>具体操作：</p><ul><li>查询攻击大于350的英雄</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM hero where attack&amp;gt;350;</span><br></pre></td></tr></table></figure><p><img src="5fb3b0820001f28a11530209.png" alt="图片描述"></p><ul><li>查询评分小于12的英雄</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM hero WHERE max_score&amp;lt;12;</span><br></pre></td></tr></table></figure><p><img src="5fb3b093000161c312000142.png" alt="图片描述"></p><ul><li>查询定位为射手的英雄</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM hero WHERE location=&#x27;射手&#x27;;</span><br></pre></td></tr></table></figure><p><img src="5fb3b0a40001d08611590109.png" alt="图片描述"></p><ul><li>查询不是热门的英雄 1：热门 0：非热门</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM hero WHERE is_hot&amp;lt;&amp;gt;1;</span><br><span class="line">SELECT * FROM hero WHERE is_hot!=1;</span><br></pre></td></tr></table></figure><p><img src="5fb3b0b60001c72b11670168.png" alt="图片描述"></p><h4 id="3-5-3-3-逻辑运算符"><a href="#3-5-3-3-逻辑运算符" class="headerlink" title="3.5.3.3 逻辑运算符"></a>3.5.3.3 逻辑运算符</h4><p><code>and</code> 多个条件同时满足<br><code>or</code> 多个条件其中一个满足<br><code>not</code> 不满足</p><p>具体操作：</p><ul><li>查询age大于35且生命值大于2500的英雄(两个条件同时满足)</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM hero WHERE age&amp;gt;35 AND life&amp;gt;2500;</span><br></pre></td></tr></table></figure><p><img src="5fb3b0c60001ae4611690099.png" alt="图片描述"></p><ul><li>查询age大于35或评分小于10的英雄(两个条件其中一个满足)</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM hero WHERE age&amp;gt;35 OR max_score&amp;lt;10;</span><br></pre></td></tr></table></figure><p><img src="5fb3b0d80001344e11450202.png" alt="图片描述"></p><ul><li>查询id是1或3或5的英雄</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM hero WHERE id=1 OR id=3 OR id=5;</span><br></pre></td></tr></table></figure><p><img src="5fb3b0eb00016da611710136.png" alt="image-20200903163159331"></p><p>in关键字<br>语法格式：<code>SELECT 字段名 FROM 表名 WHERE 字段 in (数据1, 数据2...);</code><br><code>in</code>里面的每个数据都会作为一次条件，只要满足条件的就会显示</p><p>具体操作：</p><ul><li>查询id是1或3或5的英雄</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM hero WHERE id in(1,3,5);</span><br></pre></td></tr></table></figure><p><img src="5fb3b12800014bd511550137.png" alt="image-20200903163237121.png"></p><ul><li>查询id不是1或3或5的英雄</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM hero WHERE id not in(1,3,5);</span><br></pre></td></tr></table></figure><p><img src="5fb3b14600010aad11300296.png" alt="image-20200903163302481.png"></p><h4 id="3-5-3-4-范围"><a href="#3-5-3-4-范围" class="headerlink" title="3.5.3.4 范围"></a>3.5.3.4 范围</h4><p><code>BETWEEN 值1 AND 值2</code> 表示从值1到值2范围，包头又包尾<br>比如：<code>age BETWEEN 35 AND 70</code><br>相当于： <code>age&amp;gt;=35 &amp;amp;&amp;amp; age&amp;lt;=70</code></p><p>具体操作：</p><ul><li>查询英雄上架日期大于等于2013-01-01小于等于2017-01-01之间的英雄</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM hero WHERE grounding_date BETWEEN &#x27;2013-01-01&#x27; AND &#x27;2017-01-01&#x27;;</span><br><span class="line">SELECT * FROM hero WHERE grounding_date &amp;gt;=&#x27;2013-01-01&#x27;  AND grounding_date&amp;lt;=&#x27;2017-01-01&#x27;;</span><br></pre></td></tr></table></figure><p><img src="5fb3b165000179be11740208.png" alt="image-20200903163627243"></p><h4 id="3-5-3-5-like"><a href="#3-5-3-5-like" class="headerlink" title="3.5.3.5 like"></a>3.5.3.5 like</h4><p><code>LIKE</code>表示模糊查询<br><code>SELECT * FROM 表名 WHERE 字段名 LIKE &#39;通配符字符串&#39;;</code><br>满足<code>通配符字符串</code>规则的数据就会显示出来</p><p>MySQL通配符有两个：<br><code>%</code>: 表示0个或多个字符(任意个字符)<br><code>_</code>: 表示一个字符</p><p>具体操作：</p><ul><li>查询姓孙的英雄</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM hero WHERE name LIKE &#x27;孙%&#x27;;</span><br></pre></td></tr></table></figure><p><img src="5fb3b17b00015a7411550142.png" alt="image-20200903164033800"></p><ul><li>查询姓名中包含’孙’字的英雄</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM hero WHERE name LIKE &#x27;%孙%&#x27;;</span><br></pre></td></tr></table></figure><p><img src="5fb3b18c0001182611100207.png" alt="图片描述"></p><ul><li>查询姓孙，且姓名有三个字的英雄</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM hero WHERE name LIKE &#x27;孙__&#x27;;</span><br></pre></td></tr></table></figure><p><img src="5fb3b19c0001588512180098.png" alt="image-20200903164309312"></p><h4 id="3-5-3-6-排序"><a href="#3-5-3-6-排序" class="headerlink" title="3.5.3.6 排序"></a>3.5.3.6 排序</h4><p>通过<code>ORDER BY</code>子句，可以将查询出的结果进行排序(排序只是显示方式，不会影响数据库中数据的顺序)</p><p>语法：<code>SELECT 字段名 FROM 表名 WHERE 字段=值 ORDER BY 字段名 [ASC|DESC];</code><br>ASC: 升序, 默认是升序<br>DESC: 降序</p><h5 id="3-5-3-6-1-单列排序"><a href="#3-5-3-6-1-单列排序" class="headerlink" title="3.5.3.6.1 单列排序"></a>3.5.3.6.1 单列排序</h5><p>单列排序就是使用一个字段排序</p><p>具体操作：</p><ul><li>查询年龄小于等于35岁的英雄，按照年龄升序排列</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM hero WHERE age&amp;lt;=35 ORDER BY age ASC;</span><br></pre></td></tr></table></figure><p><img src="5fb3b1b50001762313740327.png" alt="image-20200903164819347"></p><h5 id="3-5-3-6-2-组合排序"><a href="#3-5-3-6-2-组合排序" class="headerlink" title="3.5.3.6.2 组合排序"></a>3.5.3.6.2 组合排序</h5><p>组合排序就是先按第一个字段进行排序，如果第一个字段相同，才按第二个字段进行排序，依次类推。<br>上面的例子中，年龄是有相同的。当年龄相同再使用其他字段进行排序<br><code>SELECT 字段名 FROM 表名 WHERE 字段=值 ORDER BY 字段名1 [ASC|DESC], 字段名2 [ASC|DESC];</code></p><p>具体操作：</p><ul><li>查询年龄小于等于35岁的英雄，按照年龄升序排列，如果年龄相同按照生命的降序排列</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM hero WHERE age&amp;lt;=35 ORDER BY age ASC,life desc;</span><br></pre></td></tr></table></figure><p><img src="5fb3b1cc0001707712880309.png" alt="image-20200903165038235"></p><h4 id="3-5-3-7-聚合函数"><a href="#3-5-3-7-聚合函数" class="headerlink" title="3.5.3.7 聚合函数"></a>3.5.3.7 聚合函数</h4><p>之前我们做的查询都是横向查询，它们都是根据条件一行一行的进行判断，而使用聚合函数查询是纵向查询，它是对一列的值进行计算，然后返回一个结果值。另外聚合函数会忽略空值</p><p>五个聚合函数：<br><code>count</code>： 统计指定列记录数，记录为NULL的不统计<br><code>sum</code>： 计算指定列的数值和，如果不是数值类型，那么计算结果为0<br><code>max</code>： 计算指定列的最大值<br><code>min</code>： 计算指定列的最小值<br><code>avg</code>： 计算指定列的平均值，如果不是数值类型，那么计算结果为0</p><p>聚合函数的使用：写在 SQL语句<code>SELECT</code>后 <code>字段名</code>的地方<br><code>SELECT 字段名... FROM 表名;</code><br><code>SELECT COUNT(age) FROM 表名;</code></p><p>具体操作：</p><ul><li>查询英雄总数</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT COUNT(max_score) FROM hero</span><br></pre></td></tr></table></figure><p><img src="5fb47cf50001ca1b11990494.png" alt="图片描述"></p><p>我们发现对于NULL的记录不会统计<br>只要使用全部字段作为衡量标准既不会有遗漏的错误统计出现</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT COUNT(*) FROM hero</span><br></pre></td></tr></table></figure><p><img src="5fb47d1e000182f001980097.png" alt="图片描述"></p><ul><li>查询年龄大于40的总数</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT COUNT(*) FROM hero WHERE age&amp;gt;35;</span><br></pre></td></tr></table></figure><p><img src="5fb47d340001be5501920078.png" alt="图片描述"></p><ul><li>查询所用英雄的总评分</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT SUM(max_score) FROM hero</span><br></pre></td></tr></table></figure><p><img src="5fb47d460001c70002870088.png" alt="图片描述"></p><ul><li>查询英雄评分的平均分</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT AVG(max_score) FROM hero</span><br></pre></td></tr></table></figure><p><img src="5fb47d5600014ab202140074.png" alt="图片描述"></p><ul><li>查询英雄评分的最高分</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT MAX(max_score) FROM hero</span><br></pre></td></tr></table></figure><p><img src="5fb47d6c0001794602350085.png" alt="图片描述"></p><ul><li>查询英雄评分的最低分</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT MIN(max_score) FROM hero</span><br></pre></td></tr></table></figure><p><img src="5fb47d7d0001389102210124.png" alt="图片描述"></p><h4 id="3-5-3-8-分组"><a href="#3-5-3-8-分组" class="headerlink" title="3.5.3.8 分组"></a>3.5.3.8 分组</h4><p>分组查询是指使用 <code>GROUP BY</code>语句对查询信息进行分组，<code>相同数据作为一组</code><br><code>SELECT 字段1,字段2... FROM 表名 GROUP BY 分组字段 [HAVING 条件];</code></p><p>GROUP BY怎么分组的？<strong>将分组字段结果中相同内容作为一组</strong><br><img src="5fb47d8f0001ec8c17460637.png" alt="图片描述"></p><p><code>SELECT * FROM heroGROUP BY sex;</code></p><p>这句话会将sex相同的数据作为一组，但是会返回每组的第一条，没有任何意义<br><img src="5fb47da60001e69918000714.png" alt="图片描述"></p><p><img src="5fb47db900014ba511140112.png" alt="图片描述"></p><p>分组的目的就是为了统计，一般分组会跟聚合函数一起使用。</p><p>分组后聚合函数的作用？不是操作所有数据，而是操作一组数据。<br><code>SELECT SUM(life) FROM hero GROUP BY sex</code><br>效果如下：<br><img src="5fb47dce000186c201410106.png" alt="图片描述"></p><blockquote><p>注意事项：当我们使用某个字段分组,在查询的时候也需要将这个字段查询出来,否则看不到数据属于哪组的</p><ul><li>查询的时候写入分组字段即可<br><img src="5fb47e690001426a02080106.png" alt="图片描述"></li></ul></blockquote><p><strong>练习：</strong></p><ul><li>查询年龄小于30岁的人,按性别分组,统计每组的人数</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.先过滤掉年龄小于25岁的人。2.再分组。3.最后统计每组的人数</span><br><span class="line">SELECT sex,count(*) FROM hero WHERE age&amp;lt;30 GROUP BY sex;</span><br></pre></td></tr></table></figure><p><img src="5fb47e820001126602010110.png" alt="图片描述"></p><p><strong>思考：</strong></p><ul><li><p>查询年龄大于25岁的人,按性别分组,统计每组的人数,并只显示性别人数大于2的数据</p><p>有很多同学可能会将SQL语句写出这样:<br><code>SELECT sex,count(*) FROM hero WHERE age&amp;lt;30 GROUP BY sex WHERE COUNT(*)&amp;gt;2;;</code></p></li></ul><p>>注意: 并只显示性别人数&gt;2的数据属于分组后的条件,对于分组后的条件需要使用<code>having</code>子句</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT sex,count(*) FROM hero WHERE age&amp;lt;30 GROUP BY sex HAVING COUNT(*)&amp;gt;2;</span><br><span class="line">只有分组后人数大于2的`女`这组数据显示出来</span><br></pre></td></tr></table></figure><p><img src="5fb47e9e0001468710270696.png" alt="图片描述"></p><blockquote><p>having与where的区别</p><ul><li>having是在分组后对数据进行过滤.</li><li>where是在分组前对数据进行过滤</li><li>having后面可以使用聚合函数</li><li>where后面不可以使用聚合函数</li></ul></blockquote><h4 id="3-5-3-9-limit语句"><a href="#3-5-3-9-limit语句" class="headerlink" title="3.5.3.9 limit语句"></a>3.5.3.9 limit语句</h4><p><code>LIMIT</code>是<code>限制</code>的意思，所以<code>LIMIT</code>的作用就是限制查询记录的条数。<br><code>SELECT *|字段列表 [as 别名] FROM 表名 [WHERE子句] [GROUP BY子句][HAVING子句][ORDER BY子句][LIMIT子句];</code><br>思考：limit子句为什么排在最后？<br>因为前面所有的限制条件都处理完了，只剩下显示多少条记录的问题了！</p><p><strong>LIMIT语法格式</strong>：<br><code>LIMIT offset,length; 或者limit length;</code><br><code>offset</code>是指偏移量，可以认为是跳过的记录数量，默认为0<br><code>length</code>是指需要显示的总记录数</p><p>具体步骤：</p><ul><li>查询hero表中数据，从第三条开始显示，显示6条</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">我们可以认为跳过前面2条，取6条数据</span><br><span class="line">SELECT * FROM student3 LIMIT 2,6;</span><br></pre></td></tr></table></figure><p><img src="5fb47ed8000145de10450429.png" alt="图片描述"></p><p><strong>LIMIT的使用场景</strong>：分页<br>比如我们登录京东，淘宝，返回的商品信息可能有几万条，不是一次全部显示出来。是一页显示固定的条数。<br>假设我们一每页显示5条记录的方式来分页，SQL语句如下：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-- 每页显示5条</span><br><span class="line">-- 第一页： LIMIT 0,5;跳过0条，显示5条</span><br><span class="line">-- 第二页： LIMIT 5,5;  跳过5条，显示5条</span><br><span class="line">-- 第三页： LIMIT 10,5; 跳过10条，显示5条</span><br><span class="line">SELECT * FROM hero LIMIT 0,5;</span><br><span class="line">SELECT * FROM hero LIMIT 5,5;</span><br><span class="line">SELECT * FROM hero LIMIT 10,5;</span><br></pre></td></tr></table></figure><p><img src="5fb47eec0001021808350428.png" alt="图片描述"></p><blockquote><p><strong>注意</strong>：</p><ul><li>如果第一个参数是0可以简写：<br><code>SELECT * FROM student3 LIMIT 0,5;</code><br><code>SELECT * FROM student3 LIMIT 5;</code></li><li>LIMIT 10，5; – 不够5条，有多少显示多少</li></ul></blockquote><h1 id="第4章-数据库约束"><a href="#第4章-数据库约束" class="headerlink" title="第4章 数据库约束"></a>第4章 数据库约束</h1><p>对表中的数据进行进一步的限制，保证数据的<strong>正确性</strong>、<strong>有效性</strong>和<strong>完整性</strong>。<br><strong>约束种类</strong>：</p><ul><li><code>PRIMARY KEY</code>: 主键</li><li><code>UNIQUE</code>: 唯一</li><li><code>NOT NULL</code>: 非空</li><li><code>DEFAULT</code>: 默认</li><li><code>FOREIGN KEY</code>: 外键</li></ul><h2 id="4-1主键"><a href="#4-1主键" class="headerlink" title="4.1主键"></a>4.1主键</h2><h3 id="4-1-1-主键的作用"><a href="#4-1-1-主键的作用" class="headerlink" title="4.1.1 主键的作用"></a>4.1.1 主键的作用</h3><p><strong>用来唯一标识一条记录</strong>，每个表都应该有一个主键，并且每个表只能有一个主键。<br>有些记录的 name,age,sex 字段的值都一样时,那么就没法区分这些数据,造成数据库的记录不唯一,这样就不方便管理数据<br><img src="5fb4800700013b1a09650072.png" alt="图片描述"></p><p><img src="5fb480190001d36b10090070.png" alt="图片描述"></p><p><strong>哪个字段应该作为表的主键？</strong><br> 通常不用业务字段作为主键，单独给每张表设计一个id的字段，把id作为主键。主键是给数据库和程序使用的，不是给最终的客户使用的。所以主键有没有含义没有关系，只要不重复，非空就行。</p><h3 id="4-1-2-创建主键"><a href="#4-1-2-创建主键" class="headerlink" title="4.1.2 创建主键"></a>4.1.2 创建主键</h3><p>主键：<code>PRIMARY KEY</code><br><strong>主键的特点</strong>：</p><ul><li>主键必须包含唯一的值</li><li>主键列不能包含NULL值</li></ul><p><strong>创建主键方式</strong>：</p><p><strong>在创建表的时候给字段添加主键</strong><br><code>字段名 字段类型 PRIMARY KEY</code></p><p>具体操作：</p><ul><li>创建英雄表hero1, 包含字段(id, name, age)将id做为主键</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE hero1(</span><br><span class="line">id int PRIMARY Key,</span><br><span class="line">name varchar(20),</span><br><span class="line">age int</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><img src="5fb4802c0001c5bf06800122.png" alt="图片描述"></p><ul><li>添加数据</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT INTO hero1 (id, NAME) VALUES (1, &#x27;盾山&#x27;);</span><br><span class="line">INSERT INTO hero1 (id, NAME) VALUES (2, &#x27;梦琪&#x27;);</span><br><span class="line">INSERT INTO hero1 (id, NAME) VALUES (3, &#x27;鲁班&#x27;);</span><br><span class="line">INSERT INTO hero1 (id, NAME) VALUES (4, &#x27;白起&#x27;);</span><br></pre></td></tr></table></figure><ul><li>插入重复的主键值</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-- 主键是唯一的不能重复：Duplicate entry &#x27;1&#x27; for key &#x27;PRIMARY&#x27;</span><br><span class="line">INSERT INTO hero1 (id, NAME) VALUES (1, &#x27;盾山&#x27;);</span><br></pre></td></tr></table></figure><ul><li>插入NULL的主键值</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-- 主键是不能为空的：Column &#x27;id&#x27; cannot be null</span><br><span class="line">INSERT INTO hero1 (id, NAME) VALUES (NULL, &#x27;蔡文姬&#x27;);</span><br></pre></td></tr></table></figure><h3 id="4-1-3-删除主键"><a href="#4-1-3-删除主键" class="headerlink" title="4.1.3 删除主键"></a>4.1.3 删除主键</h3><p><code>ALTER TABLE 表名 DROP PRIMARY KEY;</code></p><p>具体操作：</p><ul><li>删除hero1表的主键</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ALTER TABLE hero1 DROP PRIMARY KEY;</span><br></pre></td></tr></table></figure><p><img src="5fb480410001c25d06960164.png" alt="图片描述"></p><h3 id="4-1-4-主键自增"><a href="#4-1-4-主键自增" class="headerlink" title="4.1.4 主键自增"></a>4.1.4 主键自增</h3><p> 主键如果让我们自己添加很有可能重复,我们通常希望在每次插入新记录时,数据库自动生成主键字段的值<br><code>AUTO_INCREMENT</code> 表示自动增长(字段类型必须是整数类型)</p><p>具体操作：</p><ul><li>创建英雄表hero2, 包含字段(id, name, age)将id做为主键并自动增长</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE hero2(</span><br><span class="line">id int PRIMARY Key AUTO_INCREMENT,</span><br><span class="line">name varchar(20),</span><br><span class="line">age int</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>插入数据</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-- 主键默认从1开始自动增长</span><br><span class="line">INSERT INTO hero2 (NAME, age) VALUES (&#x27;猪八戒&#x27;, 22);</span><br><span class="line">INSERT INTO hero2 (NAME, age) VALUES (&#x27;关羽&#x27;, 26);</span><br><span class="line">INSERT INTO hero2 (NAME, age) VALUES (&#x27;诸葛亮&#x27;, 25);</span><br><span class="line">INSERT INTO hero2 (NAME, age) VALUES (&#x27;孙膑&#x27;, 20);</span><br></pre></td></tr></table></figure><p><img src="5fb4805700018ccf03290170.png" alt="图片描述"></p><p>扩展<br>默认地AUTO_INCREMENT 的开始值是1，如果希望修改起始值,请使用下列SQL语法<br><code>ALTER TABLE 表名 AUTO_INCREMENT=起始值;</code><br><img src="5fb48068000184d003410220.png" alt="图片描述"></p><p>DELETE和TRUNCATE的区别</p><ul><li>DELETE 删除表中的数据，但不重置AUTO_INCREMENT的值。</li><li>TRUNCATE 摧毁表，重建表，AUTO_INCREMENT重置为1</li></ul><h2 id="4-2-唯一"><a href="#4-2-唯一" class="headerlink" title="4.2 唯一"></a>4.2 唯一</h2><p>在这张表中这个字段的值不能重复</p><h3 id="4-2-1-唯一约束的基本格式"><a href="#4-2-1-唯一约束的基本格式" class="headerlink" title="4.2.1 唯一约束的基本格式"></a>4.2.1 唯一约束的基本格式</h3><p><code>字段名 字段类型 UNIQUE</code></p><h3 id="4-2-2-实现唯一约束"><a href="#4-2-2-实现唯一约束" class="headerlink" title="4.2.2 实现唯一约束"></a>4.2.2 实现唯一约束</h3><p>具体步骤：</p><ul><li>创建英雄表hero3, 包含字段(id, name),name这一列设置唯一约束,不能出现同名的英雄</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE hero3 (</span><br><span class="line">id INT,</span><br><span class="line">NAME VARCHAR(20) UNIQUE</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>添加一个英雄</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT INTO hero3 VALUES (1, &#x27;貂蝉&#x27;);</span><br><span class="line">INSERT INTO hero3 VALUES (2, &#x27;西施&#x27;);</span><br><span class="line">INSERT INTO hero3 VALUES (3, &#x27;王昭君&#x27;);</span><br><span class="line">INSERT INTO hero3 VALUES (4, &#x27;杨玉环&#x27;);</span><br><span class="line"></span><br><span class="line">-- 插入相同的名字出现name重复: Duplicate entry &#x27;貂蝉&#x27; for key &#x27;name&#x27;</span><br><span class="line">INSERT INTO hero3 VALUES (5, &#x27;貂蝉&#x27;);</span><br><span class="line"></span><br><span class="line">-- 出现多个null的时候会怎样？因为null是没有值，所以不存在重复的问题</span><br><span class="line">INSERT INTO hero3 VALUES (5, NULL);</span><br><span class="line">INSERT INTO hero3 VALUES (6, NULL);</span><br></pre></td></tr></table></figure><h2 id="4-3-非空"><a href="#4-3-非空" class="headerlink" title="4.3 非空"></a>4.3 非空</h2><p>这个字段必须设置值,不能是NULL</p><h3 id="4-3-1-非空约束的基本语法格式"><a href="#4-3-1-非空约束的基本语法格式" class="headerlink" title="4.3.1 非空约束的基本语法格式"></a>4.3.1 非空约束的基本语法格式</h3><p><code>字段名 字段类型 NOT NULL</code></p><p>具体操作：</p><ul><li>创建表英雄表hero4, 包含字段(id,name,gender)其中name不能为NULL</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE hero4 (</span><br><span class="line">id INT,</span><br><span class="line">NAME VARCHAR(20) NOT NULL,</span><br><span class="line">gender CHAR(2)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>添加一条完整的记录</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT INTO hero4 VALUES (1, &#x27;扁鹊&#x27;, &#x27;男&#x27;);</span><br><span class="line">INSERT INTO hero4 VALUES (2, &#x27;镜&#x27;, &#x27;男&#x27;);</span><br><span class="line">INSERT INTO hero4 VALUES (3, &#x27;恺&#x27;, &#x27;男&#x27;);</span><br><span class="line">INSERT INTO hero4 VALUES (4, &#x27;貂蝉&#x27;, &#x27;男&#x27;);</span><br><span class="line"></span><br><span class="line">-- 姓名不赋值出现姓名不能为null: Column &#x27;name&#x27; cannot be null</span><br><span class="line">INSERT INTO hero4 VALUES (5, NULL, &#x27;男&#x27;);</span><br></pre></td></tr></table></figure><h3 id="4-3-2-默认值"><a href="#4-3-2-默认值" class="headerlink" title="4.3.2 默认值"></a>4.3.2 默认值</h3><p>往表中添加数据时,如果不指定这个字段的数据,就使用默认值</p><p>默认值格式<br><code>字段名 字段类型 DEFAULT 默认值</code></p><p>具体步骤：</p><ul><li>创建一个英雄表 hero5，包含字段(id,name,location)， 默认的定位是射手</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE hero5 (</span><br><span class="line">id INT,</span><br><span class="line">NAME VARCHAR(20),</span><br><span class="line">location VARCHAR(50) DEFAULT &#x27;射手&#x27;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>添加一条记录,使用默认地址</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT INTO hero5 (id, NAME) VALUES (1, &#x27;后羿&#x27;);</span><br></pre></td></tr></table></figure><p><img src="5fb480820001cc9206280177.png" alt="图片描述"></p><p><img src="5fb48091000125a302850077.png" alt="图片描述"></p><ul><li>添加一条记录,不使用默认地址</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT INTO hero5 VALUES (2, &#x27;兰陵王&#x27;, &#x27;刺客&#x27;);</span><br></pre></td></tr></table></figure><p><img src="5fb480a10001056d02910124.png" alt="图片描述"></p>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>aws ec2 实例部署后端api全过程</title>
      <link href="/posts/f6c3f30c/"/>
      <url>/posts/f6c3f30c/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><h2 id="1-执行初始化命令"><a href="#1-执行初始化命令" class="headerlink" title="1. 执行初始化命令"></a>1. 执行初始化命令</h2><p>密钥文件夹下，使用 pawershell  </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 使用 SSH 连接到你的 EC2 实例</span><br><span class="line">ssh -i america_ele.pem ubuntu@35.94.43.44</span><br><span class="line"></span><br><span class="line"># 更新系统包</span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt upgrade</span><br><span class="line"></span><br><span class="line">// 安装 nvm</span><br><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.3/install.sh | bash</span><br><span class="line">// 安装完成后，按照输出的提示重启终端，或者手动运行以下命令来加载 nvm：</span><br><span class="line">source ~/.bashrc</span><br><span class="line"></span><br><span class="line">nvm --version</span><br><span class="line">nvm install 18  # 安装 Node.js 18.x 版本</span><br><span class="line"></span><br><span class="line">// 在 EC2 上安装 MySQL 数据库：</span><br><span class="line">sudo apt install mysql-server</span><br><span class="line"></span><br><span class="line">// 启动</span><br><span class="line">sudo systemctl start mysql</span><br><span class="line">// 开机自启</span><br><span class="line">sudo systemctl enable mysql</span><br></pre></td></tr></table></figure><h2 id="2-然后，到这里喝杯水"><a href="#2-然后，到这里喝杯水" class="headerlink" title="2. 然后，到这里喝杯水.."></a>2. 然后，到这里喝杯水..</h2><p>开始初始化数据库</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 执行初始化</span><br><span class="line">sudo mysql_secure_installation</span><br></pre></td></tr></table></figure><ol><li><p>ubuntu@ip-172-31-30-64:~$ sudo mysql_secure_installation</p><p>Securing the MySQL server deployment.</p><p>Connecting to MySQL using a blank password.</p><p>VALIDATE PASSWORD COMPONENT can be used to test passwords<br>and improve security. It checks the strength of password<br>and allows the users to set only those passwords which are<br>secure enough. Would you like to setup VALIDATE PASSWORD component?</p><p>Press y|Y for Yes, any other key for No: n</p><p>在执行 <code>mysql_secure_installation</code> 时，系统询问是否要设置 <strong>VALIDATE PASSWORD</strong> 组件，它用于测试密码强度并确保用户设置足够安全的密码。</p><p>你可以根据需要选择：</p><ul><li>按 <code>y</code> 或 <code>Y</code> 以启用密码强度验证，这样会强制用户设置强密码。</li><li>按任何其他键（如 <code>n</code> 或 <code>N</code>）以跳过密码强度验证，允许设置任何密码。</li></ul></li><li><p>By default, a MySQL installation has an anonymous user,<br>allowing anyone to log into MySQL without having to have<br>a user account created for them. This is intended only for<br>testing, and to make the installation go a bit smoother.<br>You should remove them before moving into a production<br>environment.</p><p>Remove anonymous users? (Press y|Y for Yes, any other key for No) :y</p><p>你可以根据以下两种选择进行操作：</p><ul><li><strong>按 y 或 Y</strong> 删除匿名用户，这将增强 MySQL 的安全性，避免未经授权的用户访问。</li><li><strong>按其他键</strong> （如 <code>n</code> 或 <code>N</code>）保留匿名用户，但不推荐在生产环境中使用这种配置。</li></ul><p>建议选择 <strong>删除匿名用户</strong>（按 <code>y</code>），以确保 MySQL 的安全性。</p></li><li><p>Normally, root should only be allowed to connect from<br>‘localhost’. This ensures that someone cannot guess at<br>the root password from the network.</p><p>Disallow root login remotely? (Press y|Y for Yes, any other key for No) :y</p><p>你可以根据以下两种选择进行操作：</p><ul><li><strong>按 y 或 Y</strong> 禁止 root 用户远程登录，这样只有在本地机器上才可以使用 root 用户登录 MySQL，增强安全性。</li><li><strong>按其他键</strong> （如 <code>n</code> 或 <code>N</code>）允许 root 用户远程登录，但这种做法会增加远程攻击的风险，通常不推荐。</li></ul><p>建议选择 <strong>禁止 root 用户远程登录</strong>（按 <code>y</code>），以提高安全性。如果需要远程访问，可以创建一个普通用户并授予适当的权限。</p></li><li><p>By default, MySQL comes with a database named ‘test’ that<br>anyone can access. This is also intended only for testing,<br>and should be removed before moving into a production<br>environment.</p><p>Remove test database and access to it? (Press y|Y for Yes, any other key for No) :y</p><p>你可以选择以下操作：</p><ul><li><strong>按 y 或 Y</strong> 删除 <code>test</code> 数据库以及访问权限，这样可以避免不必要的安全风险。</li><li><strong>按其他键</strong> （如 <code>n</code> 或 <code>N</code>）保留 <code>test</code> 数据库，但不推荐在生产环境中使用该数据库。</li></ul><p>建议选择 <strong>删除 test 数据库</strong>（按 <code>y</code>），以增强数据库的安全性。</p></li><li><p>Reloading the privilege tables will ensure that all changes</p><p>made so far will take effect immediately.</p><p>Reload privilege tables now? (Press y|Y for Yes, any other key for No) : y</p><p>这个提示是在询问你是否要 <strong>刷新权限表</strong>，以确保之前的更改（如删除 <code>test</code> 数据库、删除匿名用户等）立即生效。</p><p>建议你按 <strong>y 或 Y</strong> 来刷新权限表，这样所有更改将立即生效。</p><p>如果你选择 <strong>按 n 或 N</strong>，更改将不会立即生效，直到下次 MySQL 服务重启或刷新权限表。</p><p>为了确保更改生效，最好选择 <strong>刷新权限表</strong>（按 <code>y</code>）。</p></li></ol><p>设置root密码并创建一个新用户</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 设置 root 密码并登录</span><br><span class="line">sudo mysql -u root -p</span><br><span class="line"></span><br><span class="line">// 创建新用户&amp;设置权限</span><br><span class="line">CREATE USER &#x27;newuser&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;your_password&#x27;;</span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO &#x27;newuser&#x27;@&#x27;%&#x27; WITH GRANT OPTION;</span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure><p>然后，使用新用户远程连接 ec2 数据库，记得去安全组放开3306端口。</p><p>最后，编辑Mysql配置文件：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nano /etc/mysql/mysql.conf.d/mysqld.cnf</span><br></pre></td></tr></table></figure><p><strong>修改配置</strong>：<br>在配置文件中找到 <code>bind-address</code> 配置项，确保它设置为 <code>0.0.0.0</code>，表示允许来自任何 IP 地址的连接。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 重启Mysql 服务</span><br><span class="line">sudo systemctl restart mysql</span><br></pre></td></tr></table></figure><p>接下来，就可以使用新用户通过命令行或workbench远程连接啦！</p><h2 id="3-在-EC2-实例中生成-SSH-密钥对"><a href="#3-在-EC2-实例中生成-SSH-密钥对" class="headerlink" title="3. 在 EC2 实例中生成 SSH 密钥对"></a>3. 在 EC2 实例中生成 SSH 密钥对</h2><ol><li><p>使用 <code>ssh-keygen</code> 命令来生成一个新的 SSH 密钥对。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -b 4096 -C &quot;youruilin@gmail.com&quot;</span><br></pre></td></tr></table></figure><p>解释：</p><ul><li><code>-t rsa</code>：表示使用 RSA 算法。</li><li><code>-b 4096</code>：设置密钥长度为 4096 位。</li><li><code>-C &quot;your_email@example.com&quot;</code>：为密钥添加注释（通常是您的邮箱地址）。</li></ul></li><li><p>系统会提示您选择密钥保存的路径：<br>默认情况下，密钥会保存到 <code>~/.ssh/id_rsa</code>，如果您希望使用默认路径，可以直接按 <strong>Enter</strong>。</p></li><li><p>提示您设置密钥的密码（可选）：<br>如果您不希望设置密码保护，可以直接按 <strong>Enter</strong> 跳过。</p></li><li><p>完成后，SSH 密钥对将被生成，并保存在 <code>~/.ssh/</code> 目录中。此时，您应该会看到两个文件：</p><ul><li><code>id_rsa</code>（私钥）</li><li><code>id_rsa.pub</code>（公钥）</li></ul></li><li><p>使用 <code>cat</code> 命令查看公钥内容，并复制它。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure><p>输出的内容应该是以 <code>ssh-rsa</code> 开头的一串字符串。将这串字符串复制下来。</p></li><li><p>将公钥添加到GitHub</p><p>登录到你的 GitHub 账户，进入 <strong>Settings</strong> -&gt; <strong>SSH and GPG keys</strong> -&gt; <strong>New SSH key</strong>，然后粘贴你刚刚复制的公钥，保存即可。</p></li><li><p>测试链接</p><p>公钥添加到 GitHub 后，可以通过以下命令测试 SSH 连接：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure></li></ol><h2 id="4-部署-Node-js-Express-后端-API-项目"><a href="#4-部署-Node-js-Express-后端-API-项目" class="headerlink" title="4. 部署 Node.js + Express 后端 API 项目"></a>4. 部署 Node.js + Express 后端 API 项目</h2><ol><li><p>可以直接从 GitHub 克隆代码：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 创建目录</span><br><span class="line">sudo mkdir -p /var/www/shuangzhao-api-project</span><br><span class="line"># 可以给当前用户（例如 ubuntu）设置适当的权限：</span><br><span class="line">sudo chown -R ubuntu:ubuntu /var/www/shuangzhao-api-project</span><br><span class="line"></span><br><span class="line">cd /var/www/shuangzhao-api-project</span><br><span class="line">git clone git@github.com:youruilin/shuangzhaoServerApi.git</span><br></pre></td></tr></table></figure></li><li><p>安装项目依赖</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd your-project-folder</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure></li><li><p>配置环境变量</p><p>项目根目录创建 .env 用于存储环境变量</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">touch .env</span><br><span class="line"></span><br><span class="line">// 编辑 .env</span><br><span class="line">nano .env  # 或者使用其他编辑器</span><br><span class="line"></span><br><span class="line">DB_HOST=localhost</span><br><span class="line">DB_USER=iooio</span><br><span class="line">DB_PASSWORD=5320di</span><br><span class="line"></span><br><span class="line"># 需要特别注意，尽量核对ai助手生成的代码片段</span><br><span class="line">DB_NAME=shuangzhao_iooio  # 这里名字搞错了我次奥，</span><br><span class="line">JWT_SECRET_KEY=iooio</span><br></pre></td></tr></table></figure></li><li><p>使用 pm2 来管理 Node.js 应用</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install pm2 -g #安装pm2 -g</span><br><span class="line"></span><br><span class="line"># 根目录下启动 Node.js 应用</span><br><span class="line">pm2 start app.js --name &quot;shuangzhao_api&quot;</span><br><span class="line"></span><br><span class="line"># 设置开机自启，这将输出一条命令，复制并执行这条命令以设置开机自启。</span><br><span class="line">pm2 startup</span><br><span class="line"></span><br><span class="line"># 然后，使用以下命令来保存当前的进程列表：</span><br><span class="line">pm2 save</span><br></pre></td></tr></table></figure><p>其中 <code>--name</code> 参数是可选的，它指定了该进程的名称，方便你管理多个进程。如果不指定名称，pm2 会自动给进程命名为 <code>app.js</code>。</p></li></ol><h2 id="5-配置-Nginx-反向代理"><a href="#5-配置-Nginx-反向代理" class="headerlink" title="5. 配置 Nginx 反向代理"></a>5. 配置 Nginx 反向代理</h2><p>在生产环境中，你通常会使用 <strong>Nginx</strong> 来处理请求，并将它们转发到你的 Node.js 应用（反向代理）。</p><p>安装&amp;配置 Nginx:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt install nginx</span><br><span class="line"></span><br><span class="line"># 编辑配置文件</span><br><span class="line">sudo nano /etc/nginx/sites-available/default</span><br></pre></td></tr></table></figure><p>或者，可以通过 vscode Remote 插件，远程连接 ec2 进行配置文件编辑：</p><p> <strong>打开命令面板</strong></p><ul><li>按 <code>F1</code> 或 <code>Ctrl+Shift+P</code> 打开命令面板。</li></ul><ol><li><strong>连接到远程主机</strong></li></ol><ul><li>在命令面板中输入 <code>Remote-SSH: Connect to Host...</code> 并选择该选项。</li><li>如果是第一次使用，你会看到一个对话框提示选择或输入远程主机地址。</li></ul><ol><li><strong>输入 SSH 连接信息</strong></li></ol><ul><li><p>在弹出的输入框中，输入如下格式的连接信息：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh ubuntu@35.94.43.44 -i C:/Users/youruilin/Desktop/0317/code/aws/keys/america_ele.pem</span><br></pre></td></tr></table></figure><ul><li><code>ubuntu</code> 是默认的 EC2 实例用户名（如果是 Amazon Linux 实例，则可能是 <code>ec2-user</code>）。</li><li><code>&lt;EC2_PUBLIC_IP&gt;</code> 是你 EC2 实例的公有 IP 地址。</li><li><code>/path/to/your-key.pem</code> 是你在创建 EC2 实例时下载的私钥文件的路径，使用绝对路径。</li></ul><p>或者，可以使用ssh配置文件，方便后续连接：</p><p>打开终端并编辑 <code>~/.ssh/config</code> 文件（如果文件不存在，可以创建一个）：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Host 35.94.43.44</span><br><span class="line">  HostName 35.94.43.44</span><br><span class="line">  User ubuntu</span><br><span class="line">  IdentityFile C:/Users/youruilin/Desktop/0317/code/aws/keys/america_ele.pem</span><br></pre></td></tr></table></figure></li></ul><ol><li><strong>选择连接方式</strong></li></ol><ul><li>如果是第一次连接，VS Code 会提示你选择连接方式。选择正确的身份验证方式（使用密钥文件）。</li><li>输入完信息后，VS Code 会自动连接到 EC2 实例。</li></ul><ol><li><strong>编辑远程文件</strong></li></ol><p>连接成功后，你会看到 VS Code 显示 “已连接到远程主机”。然后：</p><ul><li><p>打开文件浏览器（左侧的文件图标），点击 <strong>“Open Folder”</strong>。</p></li><li><p>输入 <code>/etc/nginx</code> 或其他你想编辑的路径。</p></li><li><p>选择并打开你要编辑的文件（例如 <code>/etc/nginx/sites-available/default</code>）。</p></li></ul>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 终端执行：sudo nano /etc/nginx/sites-available/default</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">  listen 80;</span><br><span class="line">  server_name your-domain.com;  # 你的域名，等绑定后使用</span><br><span class="line"></span><br><span class="line">  # 前端静态资源的配置</span><br><span class="line">  location / &#123;</span><br><span class="line">    root /var/www/frontend;  # 前端项目部署的路径</span><br><span class="line">    try_files $uri /index.html;  # 确保 SPA 路由不受影响</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  # API 请求的代理配置</span><br><span class="line">  location /api/ &#123;</span><br><span class="line">    proxy_pass http://localhost:3007;  # 后端 API 运行在 3000 端口</span><br><span class="line">    proxy_http_version 1.1;</span><br><span class="line">    proxy_set_header Upgrade $http_upgrade;</span><br><span class="line">    proxy_set_header Connection &#x27;upgrade&#x27;;</span><br><span class="line">    proxy_set_header Host $host;</span><br><span class="line">    proxy_cache_bypass $http_upgrade;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li><p><strong>保存并重载 Nginx</strong></p><p>编辑文件后，保存它。你可以在 VS Code 的集成终端中输入以下命令来重载 Nginx 配置：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl reload nginx</span><br></pre></td></tr></table></figure></li></ol><h2 id="6-到此，基本是进入了尾声"><a href="#6-到此，基本是进入了尾声" class="headerlink" title="6. 到此，基本是进入了尾声"></a>6. 到此，基本是进入了尾声</h2><p>接下来，可以去域名代理商那里，为ec2的公网ip添加一条解析记录。</p><p>然后，可以分别测试域名和公网的访问是否正常。</p><h2 id="7-填坑记录"><a href="#7-填坑记录" class="headerlink" title="7. 填坑记录"></a>7. 填坑记录</h2><p>在生产环境部署时，使用环境变量来动态设置 API 地址是一种非常常见的做法，尤其是当你的应用需要在多个环境（如开发、测试、生产等）中运行时。这种方式可以确保你不需要手动更改代码，而是根据部署环境自动调整配置。</p><p>在项目根目录下，创建一个 <code>.env.production</code> 文件。该文件用于生产环境的配置。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">VITE_API_URL=https://aws_ele.iooio.cn/api</span><br></pre></td></tr></table></figure><p>然后，/src/utils/request</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 从环境变量获取 API 地址</span><br><span class="line">const baseURL = import.meta.env.VITE_API_URL || &#x27;/api&#x27;  // 如果没有配置环境变量，则默认为相对路径</span><br></pre></td></tr></table></figure><p>这样，<code>axios</code> 请求的 <code>baseURL</code> 就会根据环境变量的值动态设置。</p><ul><li>在生产环境（如 <code>.env.production</code> 中配置的地址）下，<code>baseURL</code> 会设置为 <code>https://aws_ele.iooio.cn/api</code>。</li></ul><p>要留意的是：</p><p><strong>从 HTTPS 页面请求 HTTP 资源：</strong> 如果你的网站是通过 HTTPS 协议提供服务的（即，使用了 <code>https://yourdomain.com</code>），但你尝试请求的资源是通过 HTTP 协议提供的（如 <code>http://aws_ele.iooio.cn/api/login/code</code>），浏览器会阻止这种行为。这是为了保护用户的安全，避免潜在的中间人攻击。</p><p><strong>API 地址协议不匹配：</strong> 在你的前端页面中，如果你使用 HTTPS（例如：<code>https://youruilin.github.io</code>），而你的 API 请求地址是通过 HTTP（如 <code>http://aws_ele.iooio.cn</code>），这就导致了 <code>Mixed Content</code> 错误。</p><p>其实说的是一回事。</p><p>所以接下来，还需要完成最后一步：</p><p>为了让后端 API 服务支持 HTTPS，需要配置 Nginx 和 SSL 证书。我们将使用免费的 <strong>Let’s Encrypt</strong> SSL 证书来启用 HTTPS。以下是详细的步骤：</p><h2 id="8-为后端项目配置ssl证书"><a href="#8-为后端项目配置ssl证书" class="headerlink" title="8. 为后端项目配置ssl证书"></a>8. 为后端项目配置ssl证书</h2><ol><li><p>安装 Certbot和Nginx 插件</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt install certbot python3-certbot-nginx</span><br></pre></td></tr></table></figure></li><li><p>现在，你已经安装了 Certbot，可以使用它来获取 SSL 证书。执行以下命令：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo certbot --nginx</span><br></pre></td></tr></table></figure></li><li><p>填坑：关于域名中的下划线（<code>_</code>）的问题。</p><p>这同时也是，为什么上一步没有自动识别域名的原因，尽管 nginx 配置文件中已经指定了域名。</p><p>HTTP 协议本身并不禁止使用下划线，但 HTTPS 协议（以及更多的标准和安全协议）要求域名符合严格的规范。具体来说：</p><ul><li><strong>HTTP</strong> 协议：理论上允许域名中包含下划线（<code>_</code>），但这并不符合域名的标准，且不推荐这样做。</li><li><strong>HTTPS</strong> 协议：因为 HTTPS 需要经过证书验证，域名必须符合 DNS 的规范，而根据 RFC 1035 和其他相关标准，域名不能包含下划线。因此，Let’s Encrypt 等证书颁发机构不会为包含下划线的域名颁发 SSL 证书。</li></ul><p>所以，即便在 HTTP 中 <code>aws_ele.iooio.cn</code> 可以访问，使用 HTTPS 时会遇到问题，不能生成证书。为了支持 HTTPS 访问，你需要将域名中的下划线（<code>_</code>）替换为合法字符，比如破折号（<code>-</code>），然后重新配置证书。</p></li><li><p>执行以下代码，设置证书自动续期</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo certbot renew --dry-run</span><br></pre></td></tr></table></figure></li></ol><h2 id="9-关于-fetch-引入本地-json-文件的一些实践"><a href="#9-关于-fetch-引入本地-json-文件的一些实践" class="headerlink" title="9. 关于 fetch 引入本地 json 文件的一些实践"></a>9. 关于 fetch 引入本地 json 文件的一些实践</h2><p>在项目demo阶段，有可能需要预先将项目构建好静态部署进行测试（炫耀），这种情况下原本fetch引入的本地数据路径需要根据项目环境来设置一个环境变量，用于区分向您处于开发阶段还是部署上线阶段，原本的fetch请求方式为：</p><p><a href="/posts/4def2cdb/#5-补充-fetch-加载本地资源、与部署后加载静态资源的路径问题">写在这里了</a></p><h2 id="100-test"><a href="#100-test" class="headerlink" title="100 . test"></a>100 . test</h2><p>test</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>职务履历书_zh</title>
      <link href="/posts/8a2804d3/"/>
      <url>/posts/8a2804d3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><h2 id="1-基本情報"><a href="#1-基本情報" class="headerlink" title="1.基本情報"></a>1.基本情報</h2><table border="1">  <tr>    <td>氏名</td>    <td>遊 瑞林（ゆう すいりん）</td>  </tr>  <tr>    <td>生年月日</td>    <td>1992年1月1日</td>  </tr>  <tr>    <td>国籍</td>    <td>中国</td>  </tr>  <tr>    <td>現住所</td>    <td>中国 山東省 菏沢市 定陶区 楊店社区</td>  </tr>  <tr>    <td>Eメール</td>    <td>youruilin@gmail.com</td>  </tr>  <tr>    <td>携帯電話</td>    <td>+86-170-2130-6666</td>  </tr>  <tr>    <td>学歴</td>    <td>学士（生命科学専攻）</td>  </tr>  <tr>    <td>言語</td>    <td>      <ul>        <li>中国語（母国語）</li>        <li>日本語（JLPT N2相当）</li>        <li>英語（日常会話レベル）</li>      </ul>    </td>  </tr>  <tr>    <td>資格</td>    <td>普通自動車運転免許証</td>  </tr></table><h2 id="2-業界志望理由"><a href="#2-業界志望理由" class="headerlink" title="2. 業界志望理由"></a><strong>2. 業界志望理由</strong></h2><p>从小时候起，我就注意到那些图案精致、设计美观的游戏机卡片虽然备受追捧，但在真正被游戏机读取之前，人们并不确定它是否真的是一款优秀的游戏。这让我意识到，无论是产品还是服务，（（第一印象往往在用户心中占据至关重要的地位））。这种观察伴随我成长，也让我对设计产生了浓厚的兴趣。</p><p>从最初的平面设计，到后来的网页设计与开发，我的职业生涯始终与设计紧密相连。然而，随着经验的积累，我逐渐意识到，（（我的热情并不仅仅停留在视觉效果的呈现上，而是更关注人与软件之间的交互逻辑））。（（我热衷于通过设计将信息高效、优雅地传递给用户，确保每一次交互都能带来流畅且愉悦的体验））。</p><p>我希望将这份热爱倾注在我真正感兴趣且愿意为之付出的领域——用户体验设计与交互设计。通过不断探索与创新，我期待能够为用户创造更直观、更人性化的产品体验，同时为行业带来更多价值。</p><h2 id="3-学歴"><a href="#3-学歴" class="headerlink" title="3. 学歴"></a><strong>3. 学歴</strong></h2><ul><li><strong>2015年6月</strong>：煙台大学（中国） 生命科学専攻 卒業</li></ul><h2 id="4-職歴"><a href="#4-職歴" class="headerlink" title="4. 職歴"></a><strong>4. 職歴</strong></h2><table border="1" style="border-collapse: collapse; width: 100%; text-align: center;">  <tr>    <th style="padding: 10px; background-color: #f2f2f2;" colspan="2">朝阳私塾有限公司（中国）</th>  </tr>  <tr>    <td style="padding: 10px;">【职位】</td>    <td style="padding: 10px;">网页设计师 / 前端工程师</td>  </tr>  <tr>    <td style="padding: 10px;">【工作期间】</td>    <td style="padding: 10px;">2015年6月～2022年6月</td>  </tr>  <tr>    <td style="padding: 10px;">【职责】</td>    <td style="padding: 10px;">      企业宣传设计的策划与制作<br>      企业品牌的创意设计<br>      网站设计与实现<br>      前端开发（HTML, CSS, JavaScript, Vue.js）    </td>  </tr>  <tr>    <td style="padding: 10px;">【成就】</td>    <td style="padding: 10px;">      构建了提升企业品牌形象的网站，并为每年技术外包费用的减少做出了贡献<br>      实现了针对移动设备优化的响应式设计<br>      兼顾设计与编码，提供一致的用户体验    </td>  </tr>  <tr>    <th style="padding: 10px; background-color: #f2f2f2;" colspan="2">独立设计师&企业e化顾问</th>  </tr>  <tr>    <td style="padding: 10px;">【职位】</td>    <td style="padding: 10px;">网页开发/全栈开发</td>  </tr>  <tr>    <td style="padding: 10px;">【工作期间】</td>    <td style="padding: 10px;">2022年6月～至今</td>  </tr>  <tr>    <td style="padding: 10px;">【职责】</td>    <td style="padding: 10px;">      中小企业的网站设计、开发和部署<br>      包括但不限于企业静态网页、电子商城、移动端应用程序    </td>  </tr>  <tr>    <td style="padding: 10px;">【成就】</td>    <td style="padding: 10px;">      为企业电子化信息展示、业务逻辑的开发与部署提供一站式的解决方案    </td>  </tr></table><h2 id="5-技能・スキル"><a href="#5-技能・スキル" class="headerlink" title="5. 技能・スキル"></a><strong>5. 技能・スキル</strong></h2><table border="1" style="border-collapse: collapse; width: 100%; text-align: center;">  <tr>    <th style="padding: 10px; background-color: #f2f2f2;">类别</th>    <th style="padding: 10px; background-color: #f2f2f2;">技能</th>  </tr>  <tr>    <td style="padding: 10px;">【前端开发】</td>    <td style="padding: 10px;">      HTML, CSS, JavaScript, Vue.js<br>      移动端适配网站开发（响应式设计）<br>      实现 SPA（单页面应用）    </td>  </tr>  <tr>    <td style="padding: 10px;">【后端开发】</td>    <td style="padding: 10px;">      使用 Node.js + Express + MySQL 进行后端 API 开发    </td>  </tr>  <tr>    <td style="padding: 10px;">【云服务与部署】</td>    <td style="padding: 10px;">      使用 AWS、阿里云等云服务进行项目部署    </td>  </tr>  <tr>    <td style="padding: 10px;">【设计】</td>    <td style="padding: 10px;">      运用平面设计知识优化 UI/UX 设计<br>      根据品牌形象进行创意制作    </td>  </tr>  <tr>    <td style="padding: 10px;">【语言能力】</td>    <td style="padding: 10px;">      中文（母语）<br>      日语（JLPT N2 级别）<br>      英语（日常会话水平）    </td>  </tr></table><h2 id="6-自己PR"><a href="#6-自己PR" class="headerlink" title="6. 自己PR"></a><strong>6. 自己PR</strong></h2><p>我注重细节，始终追求卓越的质量。在设计和网站制作过程中，我认为通过精心打磨每一个细节，可以为用户提供更好的体验。</p><p>此外，我对新技术充满好奇心，不仅学习了前端知识，还掌握了后端技术，逐步发展为一个接近全栈的开发者。我有使用 AWS 和阿里云等云平台进行部署的经验，能够独立完成一整套网页开发工作。</p><p>目前，我的妻子计划前往日本攻读博士学位，而我也希望在日本建立自己的职业生涯。因此，我开始准备日本的求职活动，并首次制作了职务履历和个人作品集，可能还不够完善，但希望您能理解。</p><p>关于日语，我半年前开始利用业余时间系统的学习日语，我有信心在25年拿到n1或n2的等级证书，但无论如何，赴日从事互联网工作的初期，日语口语会是我的一个明显不足之处，所以我尽可能在利用在中国的时间打好日语基础。</p><p>最后，恳请您给与必要的关照。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 转职 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端vue3项目的GitHub工作流配置</title>
      <link href="/posts/4def2cdb/"/>
      <url>/posts/4def2cdb/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><h2 id="1-创建工作流文件"><a href="#1-创建工作流文件" class="headerlink" title="1. 创建工作流文件"></a>1. 创建工作流文件</h2><p>项目根目录创建<code>.github/workflows/deploy.yml</code></p><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">GitHub</span> <span class="string">Pages</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">main</span></span><br><span class="line">  <span class="attr">pull_request:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">deploy:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-22.04</span></span><br><span class="line">    <span class="attr">permissions:</span></span><br><span class="line">      <span class="attr">contents:</span> <span class="string">write</span></span><br><span class="line">    <span class="attr">concurrency:</span></span><br><span class="line">      <span class="attr">group:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.workflow</span> <span class="string">&#125;&#125;-$&#123;&#123;</span> <span class="string">github.ref</span> <span class="string">&#125;&#125;</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v3</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Node</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-node@v3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&#x27;18&#x27;</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Cache</span> <span class="string">dependencies</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/cache@v3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">~/.npm</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">$&#123;&#123;</span> <span class="string">runner.os</span> <span class="string">&#125;&#125;-node-$&#123;&#123;</span> <span class="string">hashFiles(&#x27;**/package-lock.json&#x27;)</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">restore-keys:</span> <span class="string">|</span></span><br><span class="line"><span class="string">            $&#123;&#123; runner.os &#125;&#125;-node-</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">npm</span> <span class="string">install</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">build</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span> <span class="string">to</span> <span class="string">GitHub</span> <span class="string">Pages</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">peaceiris/actions-gh-pages@v3</span></span><br><span class="line">        <span class="attr">if:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.ref</span> <span class="string">==</span> <span class="string">&#x27;refs/heads/main&#x27;</span> <span class="string">&#125;&#125;</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">github_token:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITHUB_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">publish_dir:</span> <span class="string">./dist</span>  <span class="comment"># 确保这里指向构建后的目录</span></span><br></pre></td></tr></table></figure><p>工作流中，配置了：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">on:</span><br><span class="line">  push:</span><br><span class="line">    branches:</span><br><span class="line">      - main</span><br><span class="line">  pull_request:</span><br><span class="line">    branches:</span><br><span class="line">      - main</span><br></pre></td></tr></table></figure><p><strong>两种触发方式所执行的是同一个工作流</strong>，但是它们的触发时机不同，取决于你配置的 <code>on</code> 部分的内容。</p><p>这意味着：</p><ul><li><strong>push 触发</strong>：当你将代码推送到 <code>main</code> 分支时，工作流会运行。</li><li><strong>pull_request 触发</strong>：当有 PR 提交到 <code>main</code> 分支时，工作流会运行。</li></ul><p>这两种事件都触发同一个工作流的执行。<strong>但是，它们的触发时机和目的不同</strong>：</p><ul><li><strong>push</strong> 事件：通常用于 <strong>代码推送后</strong> 的自动化过程，例如构建、部署、发布等。当你将代码推送到 <code>main</code> 分支时，自动触发工作流中的相关步骤（比如构建静态页面并部署到 GitHub Pages）。</li><li><strong>pull_request</strong> 事件：用于 <strong>PR 创建、更新时</strong> 的自动化检查过程，通常是用于 <strong>测试和审查</strong>。例如，你可以在 PR 被创建或更新时运行测试，确保代码在合并之前没有问题。</li></ul><h2 id="2-base-路径问题"><a href="#2-base-路径问题" class="headerlink" title="2.base 路径问题"></a>2.base 路径问题</h2><p>默认情况下，Vite 会使用 <code>/</code> 作为资源的基础路径。这样会有以下几个结果，特别是在你部署到 GitHub Pages 或类似的静态资源托管平台时：</p><h3 id="1-开发环境中的行为："><a href="#1-开发环境中的行为：" class="headerlink" title="1. 开发环境中的行为："></a>1. <strong>开发环境中的行为</strong>：</h3><p>在本地开发时（运行 <code>vite</code> 开发服务器），默认的 <code>base</code> 是 <code>/</code>，这意味着：</p><ul><li>静态资源（如 CSS、JS、图片等）的路径将从 <strong>根路径</strong> <code>/</code> 开始。</li><li>这在开发环境中通常不会有问题，因为开发服务器会根据 <code>/</code> 路径来正确解析静态资源。</li></ul><h3 id="2-生产环境中的行为："><a href="#2-生产环境中的行为：" class="headerlink" title="2. 生产环境中的行为："></a>2. <strong>生产环境中的行为</strong>：</h3><p>当你在生产环境中（如部署到 GitHub Pages）没有设置 <code>base</code> 时，静态资源的路径也默认是 <code>/</code>。然而，GitHub Pages 将项目部署在一个 <strong>子路径</strong> 下（如 <code>https://yourusername.github.io/your-repo/</code>），这就导致了以下问题：</p><ul><li>静态资源的路径仍然是基于根路径 <code>/</code>，例如 <code>https://yourusername.github.io/app/css/style.css</code>。</li><li><strong>错误的资源路径</strong>：在 GitHub Pages 上，资源的实际路径应该是 <code>https://yourusername.github.io/your-repo/css/style.css</code>，即它需要从 <code>/your-repo/</code> 开始，但因为没有设置 <code>base</code>，它尝试从根路径 <code>/</code> 加载资源，这会导致 404 错误。</li></ul><h3 id="3-如何影响-GitHub-Pages-部署："><a href="#3-如何影响-GitHub-Pages-部署：" class="headerlink" title="3. 如何影响 GitHub Pages 部署："></a>3. <strong>如何影响 GitHub Pages 部署</strong>：</h3><p>如果你不设置 <code>base</code>，并直接将生成的文件部署到 GitHub Pages 的 <code>gh-pages</code> 分支，GitHub Pages 会尝试从根路径 <code>/</code> 加载静态资源，而不是从 <code>/your-repo/</code> 路径加载。这导致了静态资源无法正确加载，页面样式、脚本等都可能出现问题，页面可能会显示为空白或者报错。</p><h3 id="4-总结："><a href="#4-总结：" class="headerlink" title="4. 总结："></a>4. <strong>总结</strong>：</h3><ul><li><strong>开发环境</strong>：没有设置 <code>base</code>，开发时没有问题，因为它会从 <code>/</code> 路径加载资源。</li><li><strong>生产环境</strong>（部署到 GitHub Pages 等）：没有设置 <code>base</code>，静态资源的路径会错误地指向根路径 <code>/</code>，而不是子路径（如 <code>/your-repo/</code>），这会导致资源加载失败，页面样式、JS 可能无法正确显示。</li></ul><p>注意下方第14行：</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// vite.config.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; fileURLToPath, <span class="variable constant_">URL</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;node:url&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vueJsx <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue-jsx&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Pages</span> <span class="keyword">from</span> <span class="string">&#x27;vite-plugin-pages&#x27;</span></span><br><span class="line"><span class="comment">// @ts-expect-error: eslint plugin does not have type definitions</span></span><br><span class="line"><span class="keyword">import</span> eslint <span class="keyword">from</span> <span class="string">&#x27;vite-plugin-eslint&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Components</span> <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">VantResolver</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/resolvers&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vite.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">base</span>: process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&#x27;production&#x27;</span> ? <span class="string">&#x27;/vue3-ts-shuangzhao/&#x27;</span> : <span class="string">&#x27;/&#x27;</span>, <span class="comment">// 设置根路径</span></span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title function_">vue</span>(),</span><br><span class="line">    <span class="title function_">vueJsx</span>(),</span><br><span class="line">    <span class="title function_">eslint</span>(),</span><br><span class="line">    <span class="title class_">Pages</span>(&#123;</span><br><span class="line">      <span class="comment">// 指定路由文件的目录</span></span><br><span class="line">      <span class="attr">dirs</span>: <span class="string">&#x27;src/views&#x27;</span>,</span><br><span class="line">      <span class="comment">// 可以自定义路由生成规则</span></span><br><span class="line">      <span class="attr">extensions</span>: [<span class="string">&#x27;vue&#x27;</span>], <span class="comment">// 仅识别 .vue 文件</span></span><br><span class="line">      <span class="attr">exclude</span>: [<span class="string">&#x27;**/components/**&#x27;</span>] <span class="comment">// 排除特定目录</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="title class_">Components</span>(&#123;</span><br><span class="line">      <span class="attr">resolvers</span>: [<span class="title class_">VantResolver</span>()]</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">css</span>: &#123;</span><br><span class="line">    <span class="attr">preprocessorOptions</span>: &#123;</span><br><span class="line">      <span class="attr">scss</span>: &#123;</span><br><span class="line">        <span class="attr">api</span>: <span class="string">&#x27;modern-compiler&#x27;</span> <span class="comment">// or &quot;modern&quot;, &quot;legacy&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">server</span>: &#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&#x27;0.0.0.0&#x27;</span>,</span><br><span class="line">    <span class="attr">port</span>: <span class="number">5173</span>,</span><br><span class="line">    <span class="attr">open</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">proxy</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;/api&#x27;</span>: <span class="string">&#x27;http://127.0.0.1:3007&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">cors</span>: <span class="literal">true</span> <span class="comment">// 在开发阶段不需要手动设置服务器端的 CORS 头信息即可进行跨域请求，节省时间。</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">resolve</span>: &#123;</span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: <span class="title function_">fileURLToPath</span>(<span class="keyword">new</span> <span class="title function_">URL</span>(<span class="string">&#x27;./src&#x27;</span>, <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="5-补充-fetch-加载本地资源、与部署后加载静态资源的路径问题"><a href="#5-补充-fetch-加载本地资源、与部署后加载静态资源的路径问题" class="headerlink" title="5. 补充 fetch 加载本地资源、与部署后加载静态资源的路径问题"></a>5. 补充 fetch 加载本地资源、与部署后加载静态资源的路径问题</h3><p>如果你的 <code>fetch</code> 数据文件存储在前端项目中（而不是后端项目），并且你希望在<strong>本地开发环境</strong>和<strong>构建部署后</strong>都能通过 <code>fetch</code> 访问这些数据文件，以下是具体的解决方案和最佳实践：</p><details class="folding-tag" ><summary> 这是ai-给的方案点击查看详情 </summary>              <div class='content'>              <p><strong>最佳方案：将数据文件放在 public 目录</strong></p><p>将数据文件放在前端项目的 <code>public</code> 目录中，这样无论是在开发环境还是构建部署后，都可以通过相同的路径访问这些文件。</p><hr><p><strong>具体步骤</strong></p><ol><li><strong>将数据文件放在 public 目录</strong></li></ol><p>将你的数据文件（如 <code>data.json</code>）移动到 <code>public</code> 目录中。构建工具（如 Create React App、Vue CLI 等）会将 <code>public</code> 目录中的文件直接复制到构建输出目录中，而不会对它们进行处理。</p><ul><li><p><strong>文件结构</strong>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">your-project/</span><br><span class="line">├── public/</span><br><span class="line">│   └── data.json</span><br><span class="line">├── src/</span><br><span class="line">│   └── App.js</span><br><span class="line">└── package.json</span><br></pre></td></tr></table></figure></li><li><p><strong>优点</strong>：</p><ul><li>数据文件在开发环境和生产环境中都可以通过相同的路径访问。</li><li>无需额外配置 Webpack 或构建工具。</li></ul></li></ul><hr><ol><li><strong>在代码中使用绝对路径访问数据</strong></li></ol><p>在代码中，使用绝对路径（以 <code>/</code> 开头）访问 <code>public</code> 目录中的数据文件。</p><ul><li><p><strong>示例代码</strong>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fetch(&#x27;/data.json&#x27;)</span><br><span class="line">  .then(response =&gt; response.json())</span><br><span class="line">  .then(data =&gt; console.log(data))</span><br><span class="line">  .catch(error =&gt; console.error(&#x27;Error fetching data:&#x27;, error));</span><br></pre></td></tr></table></figure></li><li><p><strong>解释</strong>：</p><ul><li>在开发环境中，<code>/data.json</code> 会指向 <code>http://localhost:3000/data.json</code>。</li><li>在构建部署后，<code>/data.json</code> 会指向静态文件服务器的根目录下的 <code>data.json</code>。</li></ul></li></ul><hr><ol><li><strong>本地开发环境</strong></li></ol><p>在本地开发环境中，数据文件可以通过开发服务器的根路径访问。</p><ul><li>在代码中，<code>fetch(&#39;/data.json&#39;)</code> 会自动指向 <code>http://localhost:3000/data.json</code>。</li></ul><hr><ol><li><strong>构建和部署</strong></li></ol><p>在构建和部署后，数据文件会被复制到构建输出目录中，并通过相同的路径访问。</p><ul><li><p><strong>构建项目</strong>：</p><p>构建完成后，数据文件会被复制到构建输出目录（如 <code>public</code> ）中。</p></li><li><p><strong>部署</strong>：<br>将构建输出目录部署到静态文件服务器（如 Nginx、Apache 或 GitHub Pages）。</p></li><li><p><strong>访问数据</strong>：<br>在部署后的页面中，<code>fetch(&#39;/data.json&#39;)</code> 会自动指向静态文件服务器的根目录下的 <code>data.json</code>。</p></li></ul><hr><ol><li><strong>处理路径问题（如果需要子路径）</strong></li></ol><p>如果你的项目部署在子路径下（如 <code>https://your-domain.com/your-app/</code>），需要调整路径以确保 <code>fetch</code> 请求正确指向数据文件。</p><ul><li><p><strong>使用环境变量动态设置路径</strong>：<br>在 <code>.env.production</code> 文件中配置子路径：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">VITE_PUBLIC_URL=/shuangzhao-vue3-ts</span><br></pre></td></tr></table></figure></li><li><p><strong>在代码中使用 process.env.PUBLIC_URL</strong>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fetch(`$&#123;process.env.PUBLIC_URL&#125;/data.json`)</span><br><span class="line">  .then(response =&gt; response.json())</span><br><span class="line">  .then(data =&gt; console.log(data))</span><br><span class="line">  .catch(error =&gt; console.error(&#x27;Error fetching data:&#x27;, error));</span><br></pre></td></tr></table></figure></li><li><p><strong>解释</strong>：</p><ul><li>在开发环境中，<code>process.env.PUBLIC_URL</code> 为空，路径为 <code>/data.json</code>。</li><li>在构建部署后，路径为 <code>/your-app/data.json</code>。</li></ul></li></ul><hr><ol><li><strong>检查构建输出</strong></li></ol><p>确保数据文件被正确复制到构建输出目录中。构建完成后，检查输出目录（如 <code>public</code>）中是否存在数据文件。</p><ul><li><strong>示例</strong>：<ul><li>如果使用 Create React App，构建输出目录是 <code>build</code>。</li><li>如果使用 Vue CLI，构建输出目录是 <code>dist</code>。</li></ul></li><li><strong>检查步骤</strong>：<ol><li>运行构建命令（如 <code>npm run build</code>）。</li><li>打开构建输出目录，检查是否存在数据文件。</li><li>如果数据文件不存在，检查构建配置是否正确。</li></ol></li></ul><hr><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a><strong>总结</strong></h3><p>通过将数据文件放在 <code>public</code> 目录，并使用绝对路径访问，可以确保无论是在本地开发环境还是构建部署后，都能通过 <code>fetch</code> 获取数据。具体步骤如下：</p><ol><li>将数据文件放在 <code>public</code> 目录。</li><li>在代码中使用绝对路径（如 <code>/data.json</code>）访问数据。</li><li>在本地开发环境中，通过开发服务器访问数据。</li><li>在构建部署后，通过静态文件服务器访问数据。</li></ol><p>这种方法简单、直接，且无需额外配置，适合大多数场景。如果你的项目部署在子路径下，可以通过环境变量动态设置路径。</p>              </div>            </details><details class="folding-tag" ><summary> 这是根据实战总结的 </summary>              <div class='content'>              <p>可以在utils中封装一个专用fetch组件：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const fetchWithBaseUrl = url =&gt; &#123;</span><br><span class="line">  // 获取环境变量中的 VITE_PUBLIC_URL</span><br><span class="line">  // 默认值为空，代表根路径（开发环境）</span><br><span class="line">  // 小坑：必须为空字符串，不可以为 &#x27;/&#x27;，否则 / 会抵消前项目的 localhpst 路径</span><br><span class="line">  const baseUrl = import.meta.env.VITE_PUBLIC_URL</span><br><span class="line"></span><br><span class="line">  // 拼接完整的请求路径</span><br><span class="line">  const fullUrl = `$&#123;baseUrl&#125;$&#123;url&#125;`</span><br><span class="line"></span><br><span class="line">  // 调用原生的 fetch 方法</span><br><span class="line">  return fetch(fullUrl)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default fetchWithBaseUrl</span><br></pre></td></tr></table></figure><p>以上代码中最重要的一个注意点，在根目录分别创建了 .env.production 和 .env/development：</p><ul><li><code>.env.production</code>中：VITE_PUBLIC_URL=/vue3-ts-shuangzhao</li><li><code>.env.development</code>中：VITE_PUBLIC_URL=’ ‘ ，这里必须为一个空字符串，否则，’/‘ 将抵消 localhost地址</li></ul><p>根据这个现象推测，fetch 函数是自动拼接拼接传入的路径字符串，VITE_PUBLIC_URL=’/‘，意味着在传入的参数前增加了一个 ‘/‘，会导致字符串拼接时，如果传入参数以/开头，如’/data’，会导致拼接后的路径被多加了一个’/‘，成为’//data’。</p>              </div>            </details><p>这里带领自己复习一下：</p><details class="folding-tag" ><summary> 用法区别 </summary>              <div class='content'>              <ol><li><strong>单个 /（相对当前网站根目录）</strong></li></ol><ul><li><p><code>/path/to/resource</code> 表示 <strong>相对于当前网站的根目录</strong> 解析路径。</p></li><li><p>例如，在 </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://example.com/app/</span><br></pre></td></tr></table></figure><p> 页面：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fetch(&#x27;/data/banner.json&#x27;)</span><br></pre></td></tr></table></figure><p>解析后请求的是：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://example.com/data/banner.json</span><br></pre></td></tr></table></figure><p>（注意 <code>/</code> 代表根目录，而不是当前路径 <code>app/</code>）</p></li></ul><hr><ol><li><strong>双斜杠 //（协议相对 URL）</strong></li></ol><ul><li><p><code>//example.com/path/to/resource</code> 表示 <strong>协议相对 URL</strong>，它会使用当前页面的协议（<code>http</code> 或 <code>https</code>）。</p></li><li><p>例如，在 </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://example.com/app/</span><br></pre></td></tr></table></figure><p> 页面：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fetch(&#x27;//cdn.example.com/data/banner.json&#x27;)</span><br></pre></td></tr></table></figure><p>解析后请求的是：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://cdn.example.com/data/banner.json</span><br></pre></td></tr></table></figure><p>（它继承了当前页面的 <code>https</code> 协议）</p></li><li><p>如果当前页面是 </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://example.com/app/</span><br></pre></td></tr></table></figure><p>，那么 </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//cdn.example.com/data/banner.json</span><br></pre></td></tr></table></figure><p> 解析为：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://cdn.example.com/data/banner.json</span><br></pre></td></tr></table></figure></li></ul><hr><ol><li><strong>完整 URL</strong></li></ol><ul><li><code>https://example.com/path/to/resource</code> 代表完整的绝对路径，<strong>不会受到当前页面 URL 影响</strong>。</li></ul><hr><p>什么时候用 <code>//</code>？</p><ul><li><strong>适用于 CDN 资源或跨域请求</strong>，但你希望它自动匹配当前协议。</li><li>例如，网页可能会在 <code>http://</code> 或 <code>https://</code> 下运行，而 <code>//</code> 可确保资源请求使用相同协议，避免“混合内容”警告。</li></ul><hr><p>什么时候避免 <code>//</code>？</p><ul><li><p>如果 <code>VITE_PUBLIC_URL = //api.example.com</code></p><p>，则拼接路径时会导致 </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fetch(&#x27;//api.example.com/data&#x27;)</span><br></pre></td></tr></table></figure><p>，这实际上会变成：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">arduino</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制编辑</span><br><span class="line">https://api.example.com/data （在 https 站点上）</span><br></pre></td></tr></table></figure><p>但如果 <code>VITE_PUBLIC_URL = /</code>，则拼接的 <code>/data</code> 是相对路径，不涉及跨域问题。</p></li></ul><hr><p>结论：</p><ul><li><code>/path</code> 👉 <strong>当前网站根目录的相对路径</strong></li><li><code>//example.com/path</code> 👉 <strong>继承当前协议的完整 URL</strong></li><li><code>http://example.com/path</code> 👉 <strong>完整 URL，不依赖当前页面协议</strong></li></ul>              </div>            </details><h2 id="3-导航守卫中的更改"><a href="#3-导航守卫中的更改" class="headerlink" title="3.导航守卫中的更改"></a>3.导航守卫中的更改</h2><p>路由守卫中也需要考虑该前缀。否则，<code>to.path</code> 和 <code>next()</code> 中的路径可能会与实际访问的路径不匹配，从而导致路由跳转失败或跳转到错误的页面。</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> generatedRoutes <span class="keyword">from</span> <span class="string">&#x27;virtual:generated-pages&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; userStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores/user&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 在这里声明 basePath</span></span><br><span class="line"><span class="keyword">const</span> basePath = <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">MODE</span> === <span class="string">&#x27;production&#x27;</span> ? <span class="string">&#x27;/vue3-ts-shuangzhao/&#x27;</span> : <span class="string">&#x27;/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  ...generatedRoutes,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/:pathMatch(.*)*&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;not-found&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/404.vue&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(basePath), <span class="comment">// 这里填上 basePath</span></span><br><span class="line">  routes</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 增加全局导航守卫</span></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> store = <span class="title function_">userStore</span>()</span><br><span class="line">  <span class="comment">// 验证token</span></span><br><span class="line">  <span class="keyword">if</span> (store.<span class="property">token</span>) &#123;</span><br><span class="line">    <span class="comment">// 检查是否为首页路径，如果是则跳转到 /task</span></span><br><span class="line">    <span class="keyword">if</span> (to.<span class="property">path</span> === <span class="string">&#x27;/&#x27;</span>) &#123;</span><br><span class="line">      <span class="title function_">next</span>(<span class="string">&#x27;/task&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">next</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      to.<span class="property">path</span> === <span class="string">&#x27;/login&#x27;</span> ||</span><br><span class="line">      to.<span class="property">path</span> === <span class="string">&#x27;/login/ServiceAgree&#x27;</span> ||</span><br><span class="line">      to.<span class="property">path</span> === <span class="string">&#x27;/login/PrivatePolicy&#x27;</span></span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="title function_">next</span>()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">next</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure><h2 id="4-学习了一个新技能"><a href="#4-学习了一个新技能" class="headerlink" title="4. 学习了一个新技能"></a>4. 学习了一个新技能</h2><p>因为使用了插件，基于文件系统自动生成路由，因此当初创建了一些列空白的.vue文件，而在项目生产阶段，进行打包部署时，严格的打包检查会提示空白文件，因此需要一个 js 脚本来为空白的 .vue 文件进行预填充。</p><p>项目根目录创建一个 js 文件，如：fill-empty-vue-files.js</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span></span><br><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; fileURLToPath &#125; <span class="keyword">from</span> <span class="string">&#x27;url&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取当前脚本文件的路径并设置 src 目录路径</span></span><br><span class="line"><span class="keyword">const</span> currentDir = <span class="title function_">fileURLToPath</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>)</span><br><span class="line"><span class="keyword">const</span> vueDir = path.<span class="title function_">resolve</span>(path.<span class="title function_">dirname</span>(currentDir), <span class="string">&#x27;src&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 扫描文件夹中的所有 .vue 文件</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">scanVueFiles</span> = dir =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> files = fs.<span class="title function_">readdirSync</span>(dir)</span><br><span class="line">  files.<span class="title function_">forEach</span>(<span class="function"><span class="params">file</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> filePath = path.<span class="title function_">join</span>(dir, file)</span><br><span class="line">    <span class="keyword">const</span> stat = fs.<span class="title function_">statSync</span>(filePath)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果是文件夹，则递归扫描</span></span><br><span class="line">    <span class="keyword">if</span> (stat.<span class="title function_">isDirectory</span>()) &#123;</span><br><span class="line">      <span class="title function_">scanVueFiles</span>(filePath)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (file.<span class="title function_">endsWith</span>(<span class="string">&#x27;.vue&#x27;</span>)) &#123;</span><br><span class="line">      <span class="title function_">processVueFile</span>(filePath)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理每个 Vue 文件</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">processVueFile</span> = filePath =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> content = fs.<span class="title function_">readFileSync</span>(filePath, <span class="string">&#x27;utf-8&#x27;</span>).<span class="title function_">trim</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 如果文件为空，填充基本模板</span></span><br><span class="line">  <span class="keyword">if</span> (content === <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Filling empty Vue file: <span class="subst">$&#123;filePath&#125;</span>`</span>)</span><br><span class="line">    <span class="keyword">const</span> templateContent = <span class="string">`</span></span><br><span class="line"><span class="string">&lt;script setup&gt;</span></span><br><span class="line"><span class="string">import &#123; ref, onMounted &#125; from &#x27;vue&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// 定义一个 ref 变量来存储文件路径</span></span><br><span class="line"><span class="string">const filePath = ref(&#x27;&#x27;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// 使用 onMounted 钩子获取文件路径</span></span><br><span class="line"><span class="string">onMounted(() =&gt; &#123;</span></span><br><span class="line"><span class="string">  // 通过 import.meta.url 获取当前文件的路径</span></span><br><span class="line"><span class="string">  filePath.value = import.meta.url</span></span><br><span class="line"><span class="string">&#125;)</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;template&gt;</span></span><br><span class="line"><span class="string">  &lt;div&gt;&#123;&#123; filePath &#125;&#125;&lt;/div&gt;</span></span><br><span class="line"><span class="string">  &lt;!-- 显示文件路径 --&gt;</span></span><br><span class="line"><span class="string">&lt;/template&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;style lang=&quot;scss&quot; scoped&gt;</span></span><br><span class="line"><span class="string">/* 你可以在这里添加样式 */</span></span><br><span class="line"><span class="string">&lt;/style&gt;</span></span><br><span class="line"><span class="string">  \n`</span></span><br><span class="line">    fs.<span class="title function_">writeFileSync</span>(filePath, templateContent.<span class="title function_">trim</span>(), <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 扫描并填充 Vue 文件</span></span><br><span class="line"><span class="title function_">scanVueFiles</span>(vueDir)</span><br></pre></td></tr></table></figure><p>然后，终端执行 node fill-empty-vue-files.js，现在可以暂时打包项目了 /</p><h2 id="5-vite-plugin-eslint-插件的类型声明问题"><a href="#5-vite-plugin-eslint-插件的类型声明问题" class="headerlink" title="5. vite-plugin-eslint 插件的类型声明问题"></a>5. vite-plugin-eslint 插件的类型声明问题</h2><p>前面整理过 vite-plugin-eslint 插件的基本情况，这里不再重复啦。</p><p>很奇怪，本地构建时并没有有关于该插件的类型错误提示，但是工作流部署，却一直报错，试了n多方法，最终vscode快速修改给秒速度解决了  /</p><p>直接在引入文件前加上这一句：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; fileURLToPath, URL &#125; from &#x27;node:url&#x27;</span><br><span class="line">import &#123; defineConfig &#125; from &#x27;vite&#x27;</span><br><span class="line">import vue from &#x27;@vitejs/plugin-vue&#x27;</span><br><span class="line">import vueJsx from &#x27;@vitejs/plugin-vue-jsx&#x27;</span><br><span class="line">import Pages from &#x27;vite-plugin-pages&#x27;</span><br><span class="line">// @ts-expect-error: eslint plugin does not have type definitions</span><br><span class="line">import eslint from &#x27;vite-plugin-eslint&#x27;</span><br><span class="line">import Components from &#x27;unplugin-vue-components/vite&#x27;</span><br><span class="line">import &#123; VantResolver &#125; from &#x27;unplugin-vue-components/resolvers&#x27;</span><br></pre></td></tr></table></figure><ol><li><code>// @ts-expect-error: eslint plugin does not have type definitions</code></li></ol><ul><li>这是一个 TypeScript 的注释，用于告诉 TypeScript 编译器：接下来的代码会有一个类型错误，但这是预期的，因此不需要报错。</li><li>具体来说，<code>vite-plugin-eslint</code> 这个插件可能没有提供 TypeScript 的类型定义文件（即 <code>.d.ts</code> 文件），因此 TypeScript 无法推断它的类型，会报类型错误。通过 <code>@ts-expect-error</code>，开发者明确表示这个错误是已知的，并且可以忽略。</li></ul><ol><li><code>import eslint from &#39;vite-plugin-eslint&#39;</code></li></ol><ul><li>这是一个 ES Module 的导入语句，用于从 <code>vite-plugin-eslint</code> 包中导入默认导出（<code>default export</code>）。</li><li><code>vite-plugin-eslint</code> 是一个 Vite 插件，用于在 Vite 项目中集成 ESLint。ESLint 是一个 JavaScript/TypeScript 的代码检查工具，用于发现代码中的潜在问题并保持代码风格一致。</li><li>通过这个导入语句，开发者可以在 Vite 配置中使用这个插件。</li></ul><h2 id="6-关于-base-设置后的一个细节"><a href="#6-关于-base-设置后的一个细节" class="headerlink" title="6. 关于 base 设置后的一个细节"></a>6. 关于 base 设置后的一个细节</h2><p>工作流部署静态页面后，进入页面，在页面中点击跳转至其他页面，可以正常跳转，但是在浏览器直接输入该页面路由地址 ，却报404。</p><h3 id="问题分析："><a href="#问题分析：" class="headerlink" title="问题分析："></a>问题分析：</h3><ol><li><strong>Vue Router 使用 history 模式：</strong><ul><li>在使用 <code>createWebHistory</code> 模式时，Vue Router 会使用 <strong>HTML5 history API</strong>，这意味着路由是基于浏览器的地址栏路径进行管理的，而不是使用传统的哈希（<code>#</code>）模式。</li><li>当您通过点击跳转到不同的页面时，路由器会通过 JavaScript 捕捉到这些路由并渲染相应的页面内容。</li></ul></li><li><strong>页面直接访问时出现 404 错误：</strong><ul><li>当您在浏览器的地址栏直接输入某个页面的 URL（比如 <code>/login</code> 或 <code>/task</code>）时，浏览器会向服务器发出请求，直接访问该路径。</li><li>由于服务器并不知道如何处理这个路径，它会返回一个 <code>404</code> 错误。特别是在 GitHub Pages 或类似的静态文件托管服务中，服务器没有对应的路由处理逻辑来为这些路径提供内容。</li></ul></li><li><strong>静态页面部署的限制：</strong><ul><li>现代前端框架（如 Vue.js）依赖 JavaScript 来动态渲染页面，但静态托管服务（如 GitHub Pages）通常不会处理 SPA 的路由。因此，直接输入路由时，服务器无法返回相应的 HTML 文件，而是返回 404 错误。</li></ul></li></ol><h3 id="解决方案："><a href="#解决方案：" class="headerlink" title="解决方案："></a>解决方案：</h3><p>为了解决这个问题，您可以采取以下两种方法：</p><ol><li><strong>确保服务器的所有路由都指向 index.html（SPA 解决方案）</strong></li></ol><p>由于您的项目是单页应用（SPA），所有路径最终都应该返回 <code>index.html</code>，然后由前端的 Vue Router 处理实际的页面渲染。为此，您需要配置一个 <strong>404 重定向</strong> 或 <strong>路径重写</strong>，将所有未找到的路径都指向 <code>index.html</code>。</p><ol><li><strong>GitHub Pages</strong> 的工作原理是它只会返回静态资源，但它并不会自动处理 Vue Router 的路径重定向。为了解决这个问题，可以通过以下方式实现：</li></ol><ul><li><p>在 <code>public</code> 目录下创建一个 <code>.nojekyll</code> 文件（如果不存在）。</p></li><li><p>在 <code>public</code> 目录下创建一个 <code>404.html</code> 文件，并让它重定向到 <code>index.html</code>。以下是 <code>404.html</code> 的内容示例：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;refresh&quot; content=&quot;0; url=/&quot; /&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;p&gt;Page not found. Redirecting to &lt;a href=&quot;/&quot;&gt;home&lt;/a&gt;...&lt;/p&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li><li><p>这会将所有 404 错误自动重定向到首页，Vue Router 会接管路由处理，确保页面渲染正确。</p></li></ul><h4 id="2-使用-Hash-模式（不推荐，但简单）"><a href="#2-使用-Hash-模式（不推荐，但简单）" class="headerlink" title="2. 使用 Hash 模式（不推荐，但简单）"></a>2. <strong>使用 Hash 模式（不推荐，但简单）</strong></h4><p>另一种方法是切换到 <strong>hash模式</strong>（默认情况下，Vue Router 使用的是 <code>history</code> 模式），这样就不会依赖服务器的路径，而是依赖 URL 的哈希部分（例如 <code>/#/login</code>）。这样可以避免直接访问页面时返回 404 错误。</p><p>修改 <code>router/index.ts</code> 中的代码：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; createRouter, createWebHashHistory &#125; from &#x27;vue-router&#x27;;</span><br><span class="line"></span><br><span class="line">const router = createRouter(&#123;</span><br><span class="line">  history: createWebHashHistory(),  // 使用 hash 模式</span><br><span class="line">  routes</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>使用哈希模式后，URL 会变成类似 <code>https://youruilin.github.io/vue3-ts-shuangzhao/#/login</code>，这样就不会依赖服务器的路径处理，避免了 404 错误。</p><h3 id="推荐的解决方法："><a href="#推荐的解决方法：" class="headerlink" title="推荐的解决方法："></a>推荐的解决方法：</h3><p>由于您是使用 Vue 3 和 Vite，推荐 <strong>使用第一种方案</strong>，即让服务器始终返回 <code>index.html</code>，然后由 Vue Router 来处理路径。</p><ul><li>在生产环境中，使用 <code>createWebHistory(basePath)</code> 配置 Vue Router 并确保服务器处理路径时始终返回 <code>index.html</code>，让 Vue Router 在客户端接管路由。</li><li>对于 GitHub Pages，您可以通过创建 <code>404.html</code> 文件来实现路径重定向。</li></ul><h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><ul><li><strong>使用 history 模式时</strong>，直接输入路径会导致 404 错误，因为服务器没有相应的路由处理。这时需要设置服务器将所有请求指向 <code>index.html</code>。</li><li><strong>使用 GitHub Pages 部署时</strong>，确保设置了 404 页面来重定向到 <code>index.html</code>，然后由 Vue Router 来处理实际的路由渲染。</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> git 工作流 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ec-mallプロジェクトの特徴</title>
      <link href="/posts/46134a4b/"/>
      <url>/posts/46134a4b/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><h2 id="项目亮点"><a href="#项目亮点" class="headerlink" title="项目亮点"></a>项目亮点</h2><p>本次实战主要分为以下几个模块：</p><h3 id="01-项目介绍"><a href="#01-项目介绍" class="headerlink" title="01-项目介绍"></a>01-项目介绍</h3><p>小兔鲜儿</p><ul><li>电商发展十余年，是个成熟的模式，小兔鲜儿是B2C电商平台，综合品类平台</li><li>平台理念：（品质）新鲜、（价格）亲民、（物流）快捷</li><li>参考竞品：网易严选、京东</li></ul><p>开发物料</p><ul><li>接口文档 <a href="https://link.juejin.cn?target=http%3A%2F%2Fzhoushugang.gitee.io%2Ferabbit-client-pc-document%2Fapi.html">zhoushugang.gitee.io/erabbit-cli…</a></li><li>参考网站 <a href="https://link.juejin.cn?target=http%3A%2F%2Ferabbit.itheima.net%2F%23%2F">erabbit.itheima.net/#/</a></li></ul><p>目标功能</p><ul><li>首页，分类，搜索，商品详情，登录（第三方），购物车，收货地址，结算，支付（支付宝）</li><li>形成一个购买功能功能闭环</li></ul><h3 id="02-技术选型"><a href="#02-技术选型" class="headerlink" title="02-技术选型"></a>02-技术选型</h3><p>Vue全家桶：</p><ul><li>Vue3 前端框架</li><li>Vue-router 前端路由</li><li>Vuex 状态管理</li><li>Vue-cli 脚手架</li></ul><p>第三方库：</p><ul><li>axios 接口请求</li><li>vuex-persistedstate  状态持久化</li><li>@vueuse/core 组合API工具库</li><li>dayjs 日期处理</li><li>vee-validate</li></ul><p>自研组件库</p><ul><li>erabbit-ui  </li><li>如果是UI风格高度定制，可以尝试独立一套组件UI</li><li>如果是后台，优先考虑使用现有组件库。</li></ul><p><strong>总结：</strong></p><ul><li>项目所有功能采用Composition API 编写，解决电商常见业务逻辑。</li></ul><h2 id="顶部导航模块"><a href="#顶部导航模块" class="headerlink" title="顶部导航模块"></a>顶部导航模块</h2><p><img src="444.gif" alt="4"></p><p>需求：</p><ol><li>顶部导航开始不显示</li><li>等页面滑到主导航栏，这个<strong>新顶部导航栏滑动下拉显示</strong>，并且改为固定定位</li><li>等页面滑到上面，新顶部导航栏隐藏</li></ol><h2 id="图片切换模块"><a href="#图片切换模块" class="headerlink" title="图片切换模块"></a>图片切换模块</h2><p><img src="111.gif" alt="1"></p><h2 id="放大镜效果"><a href="#放大镜效果" class="headerlink" title="放大镜效果"></a>放大镜效果</h2><p><img src="555.gif" alt="5"></p><p>业务分析：</p><p>①：鼠标经过对应小盒子，左侧中等盒子显示对应中等图片</p><p>②： 鼠标经过中盒子，右侧会显示放大镜效果的大盒子</p><p>③： 黑色遮罩盒子跟着鼠标来移动</p><p>④： 鼠标在中等盒子上移动，大盒子的图片跟着显示对应位置</p><p>思路分析：</p><p>①：鼠标经过小盒子，左侧中等盒子显示对应中等图片</p><ol><li>获取对应的元素</li><li>采取事件委托的形式，监听鼠标经过小盒子里面的图片， 注意此时需要使用 <code>mouseover</code> 事件，因为需要事件冒泡触发small </li><li>让鼠标经过小图片的爸爸li盒子，添加类，其余的li移除类（注意先移除，后添加）</li><li>鼠标经过小图片，可以拿到小图片的src， 可以做两件事<ul><li>让中等盒子的图片换成这个 这个小图片的src</li><li>让大盒子的背景图片，也换成这个小图片的 src （稍后做）</li></ul></li></ol><p>②： 鼠标经过中等盒子，右侧大盒子显示</p><ol><li><p>用到鼠标经过和离开，鼠标经过中盒子，大盒子 利用 display 来显示和隐藏</p></li><li><p>鼠标离开不会立马消失，而是有200ms的延时，用户体验更好，所以尽量使用定时器做个延时 setTimeout</p></li><li><p>显示和隐藏也尽量定义一个函数，因为鼠标经过离开中等盒子，会显示隐藏，同时，<strong>鼠标经过大盒子，也会显示和隐藏</strong></p></li><li><p>给大盒子里面的背景图片一个默认的第一张图片</p><p>​</p></li></ol><p>③： 黑色遮罩盒子跟着鼠标来移动</p><ol><li><p>先做鼠标经过 中等盒子，显示隐藏 黑色遮罩 的盒子</p></li><li><p>让黑色遮罩跟着鼠标来走, 需要用到鼠标移动事件  mousemove  </p></li><li><p>让黑色盒子的移动的核心思想：不断把鼠标在中等盒子内的坐标给黑色遮罩层 let  top 值，这样遮罩层就可以跟着移动了</p><ul><li><p>需求</p><ul><li>我们要的是 鼠标在 中等盒子内的坐标， 没有办法直接得到</li><li>得到1：  鼠标在页面中的坐标</li><li>得到2：  中等盒子在页面中的坐标</li></ul></li><li><p>算法</p><ul><li>得到鼠标在页面中的坐标    利用事件对象的  pageX  </li><li>得到middle中等盒子在页面中的坐标   middle.getBoundingClientRect()</li><li>鼠标在middle 盒子里面的坐标   =   鼠标在页面中的坐标  -   middle 中等盒子的坐标</li><li>黑色遮罩层不断得到       鼠标在middle 盒子中的坐标 就可以移动起来了</li></ul><blockquote><p>注意 y坐标特殊，需要减去 页面被卷去的头部 </p><p>为什么不用 box.offsetLet 和 box.offsetTop  因为这俩属性跟带有定位的父级有关系，很容被父级影响，而getBoundingClientRect() 不受定位的父元素的影响</p></blockquote></li><li><p>限定遮罩的盒子只能在middle 内部移动，需要添加判断</p><ul><li>限定水平方向 大于等于0 并且小于等于 400</li><li>限定垂直方向 大于等于0 并且小于等于 400</li></ul></li><li><p>遮罩盒子移动的坐标： </p><ul><li>声明一个 mx 作为移动的距离</li><li>水平坐标 x 如果 小于等于100 ，则移动的距离 mx 就是  0  不应该移动</li><li>水平坐标 如果 大于等于100 并且小于300，移动的距离就是  mx - 100 （100是遮罩盒子自身宽度的一半）</li><li>水平坐标 如果 大于等于300，移动的距离就是  mx   就是200  不应该在移动了</li><li>其实我们发现水平移动， 就在 100 ~ 200 之间移动的</li><li>垂直同理</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> mx = <span class="number">0</span>, my = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (x &lt;= <span class="number">100</span>) mx = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> (x &gt; <span class="number">100</span> &amp;&amp; x &lt; <span class="number">300</span>) mx = x - <span class="number">100</span></span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">300</span>) mx = <span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (y &lt;= <span class="number">100</span>) my = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> (y &gt; <span class="number">100</span> &amp;&amp; y &lt; <span class="number">300</span>) my = y - <span class="number">100</span></span><br><span class="line"><span class="keyword">if</span> (y &gt;= <span class="number">300</span>) my = <span class="number">200</span></span><br></pre></td></tr></table></figure><ul><li>大盒子图片移动的计算方法：<ul><li>中等盒子是 400px  大盒子 是 800px 的图片</li><li>中等盒子移动1px， 大盒子就应该移动2px， 只不过是负值</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">large.<span class="property">style</span>.<span class="property">backgroundPositionX</span> = - <span class="number">2</span> * mx + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">large.<span class="property">style</span>.<span class="property">backgroundPositionY</span> = - <span class="number">2</span> * my + <span class="string">&#x27;px&#x27;</span></span><br></pre></td></tr></table></figure><p>放大镜完整代码：</p><p>​</p></li></ol><h2 id="其他模块"><a href="#其他模块" class="headerlink" title="其他模块"></a>其他模块</h2><h3 id="点击模块"><a href="#点击模块" class="headerlink" title="点击模块"></a>点击模块</h3><p><img src="666.gif" alt=""></p><h3 id="tab栏切换模块"><a href="#tab栏切换模块" class="headerlink" title="tab栏切换模块"></a>tab栏切换模块</h3><p><img src="777.gif" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> 转职 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>平面设计の作品</title>
      <link href="/posts/fcf85f6e/"/>
      <url>/posts/fcf85f6e/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><p>这是以往平面设计作品</p>]]></content>
      
      
      
        <tags>
            
            <tag> 转职 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>职务履历书</title>
      <link href="/posts/68f7786d/"/>
      <url>/posts/68f7786d/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><p>1.基本情報</p><table border="1">  <tr>    <td>氏名</td>    <td>遊 瑞林（ゆう すいりん）</td>  </tr>  <tr>    <td>生年月日</td>    <td>1992年1月1日</td>  </tr>  <tr>    <td>国籍</td>    <td>中国</td>  </tr>  <tr>    <td>現住所</td>    <td>中国 山東省 菏沢市 定陶区 楊店社区</td>  </tr>  <tr>    <td>Eメール</td>    <td>youruilin@gmail.com</td>  </tr>  <tr>    <td>携帯電話</td>    <td>+86-170-2130-6666</td>  </tr>  <tr>    <td>学歴</td>    <td>学士（生命科学専攻）</td>  </tr>  <tr>    <td>言語</td>    <td>      <ul>        <li>中国語（母国語）</li>        <li>日本語（JLPT N2相当）</li>        <li>英語（日常会話レベル）</li>      </ul>    </td>  </tr>  <tr>    <td>資格</td>    <td>普通自動車運転免許証</td>  </tr></table><hr><p><strong>2. 業界志望理由</strong></p><p>幼い頃から、デザインが精巧で美しいゲーム機のカードは人気があるものの、実際にゲーム機で読み込まれるまでは、それが本当に良いゲームかどうかはわからないということに気づきました。これを通じて、（（製品やサービスにおいて第一印象がユーザーの心の中で非常に重要な役割を果たすことを実感しました））。この気づきは私の成長とともに続き、デザインに対する強い興味を持つようになりました。</p><p>最初はグラフィックデザインから始まり、その後ウェブデザインや開発に携わる中で、私のキャリアは常にデザインと密接に関わってきました。しかし、経験を重ねるうちに、私の情熱は（（単に見た目の美しさだけではなく、人とソフトウェアとの間のインタラクションロジックにこそある））ことに気づきました。私は、情報を効率的かつエレガントにユーザーに伝え、すべてのインタラクションがスムーズで楽しい体験を提供できるようにすることに強い関心を持っています。</p><p>この情熱を、私が心から興味を持ち、力を注ぎたい分野——（（ユーザーエクスペリエンスデザインとインタラクションデザイン））——に注ぎたいと考えています。絶えず探求と革新を続け、ユーザーにとってより直感的で人間味のあるプロダクト体験を創造し、業界にさらなる価値を提供することを目指しています。</p><hr><p><strong>3. 学歴</strong></p><ul><li><strong>2015年6月</strong>：煙台大学（中国） 生命科学専攻 卒業</li></ul><hr><p><strong>4. 職歴</strong></p><table border="1" style="border-collapse: collapse; width: 100%; text-align: center;">  <tr>    <th style="padding: 10px; background-color: #f2f2f2;" colspan="2">朝阳私塾株式会社（中国）</th>  </tr>  <tr>    <td style="padding: 10px;">【職位】</td>    <td style="padding: 10px;">ウェブデザイナー / フロントエンドエンジニア</td>  </tr>  <tr>    <td style="padding: 10px;">【勤務期間】</td>    <td style="padding: 10px;">2015年6月～2022年6月</td>  </tr>  <tr>    <td style="padding: 10px;">【職務内容】</td>    <td style="padding: 10px;">      企業宣伝デザインの企画と制作<br>      企業ブランドのクリエイティブデザイン<br>      ウェブサイトのデザインと実装<br>      フロントエンド開発（HTML, CSS, JavaScript, Vue.js）    </td>  </tr>  <tr>    <td style="padding: 10px;">【実績】</td>    <td style="padding: 10px;">      企業ブランドイメージを向上させるウェブサイトの構築、年間技術アウトソーシング費用削減に貢献<br>      モバイルデバイス向けのレスポンシブデザインを実現<br>      デザインとコーディングを兼ね備え、一貫したユーザー体験を提供    </td>  </tr>  <tr>    <th style="padding: 10px; background-color: #f2f2f2;" colspan="2">独立デザイナー&企業e化コンサルタント</th>  </tr>  <tr>    <td style="padding: 10px;">【職位】</td>    <td style="padding: 10px;">ウェブ開発 / フルスタック開発</td>  </tr>  <tr>    <td style="padding: 10px;">【勤務期間】</td>    <td style="padding: 10px;">2022年6月～現在</td>  </tr>  <tr>    <td style="padding: 10px;">【職務内容】</td>    <td style="padding: 10px;">      中小企業のウェブサイト設計、開発、デプロイ<br>      企業の静的ウェブページ、電子商取引サイト、モバイルアプリケーションなどを含む    </td>  </tr>  <tr>    <td style="padding: 10px;">【実績】</td>    <td style="padding: 10px;">      企業の電子化情報展示と業務ロジックの開発・デプロイを一貫したソリューションとして提供    </td>  </tr></table><hr><p><strong>5. 技能・スキル</strong></p><table border="1" style="border-collapse: collapse; width: 100%; text-align: center;">  <tr>    <th style="padding: 10px; background-color: #f2f2f2;">カテゴリ</th>    <th style="padding: 10px; background-color: #f2f2f2;">スキル</th>  </tr>  <tr>    <td style="padding: 10px;">【フロントエンド開発】</td>    <td style="padding: 10px;">      HTML, CSS, JavaScript, Vue.js<br>      モバイル対応のウェブサイト開発（レスポンシブデザイン対応）<br>      SPA（シングルページアプリケーション）の実装    </td>  </tr>  <tr>    <td style="padding: 10px;">【バックエンド開発】</td>    <td style="padding: 10px;">      Node.js + Express + MySQL による簡単な API 開発    </td>  </tr>  <tr>    <td style="padding: 10px;">【クラウド・デプロイメント】</td>    <td style="padding: 10px;">      AWS, Aliyun などのクラウドサービスを活用したプロジェクトのデプロイ    </td>  </tr>  <tr>    <td style="padding: 10px;">【デザイン】</td>    <td style="padding: 10px;">      平面デザインの知識を活かした UI/UX デザインの最適化<br>      ブランドイメージに即したクリエイティブ制作    </td>  </tr>  <tr>    <td style="padding: 10px;">【語学力】</td>    <td style="padding: 10px;">      中国語（ネイティブ）<br>      日本語（JLPT N2 相当）<br>      英語（日常会話レベル）    </td>  </tr></table><hr><p><strong>6. 自己PR</strong></p><p>​    （（私は、細部にこだわりを持ち、徹底してクオリティを追求するタイプの人間です））。デザインやウェブサイト制作において、細かな部分まで丁寧に作り込むことで、ユーザーにより良い体験を提供できると考えております。</p><p>​    また、新しい技術に対する探究心が強く、（（フロントエンドだけでなくバックエンドの知識も習得し、フルスタックに近い形で開発を行っております））。AWS や Aliyun などのクラウドプラットフォームを活用したデプロイ経験もあり、一連のウェブ開発業務を独立して遂行することが可能です。</p><p>​    現在、私の妻が日本の大学院博士課程への進学を予定しており、私自身も日本でのキャリアを築きたいと考えております。今回、日本での就職活動に向けて初めて職務経歴書やポートフォリオを作成しておりますので、至らない点があるかもしれませんが、ご理解いただければ幸いです。</p><hr><p><strong>7. 資格</strong></p><ul><li>日本語能力試験（JLPT）N2（2025年取得予定）</li><li>普通自動車運転免許証</li></ul><hr><p><strong>8. 趣味・関心</strong></p><ul><li>デザインやアートに関する考察</li><li>ゆっくりとした時間の中で新しいアイデアを考えること</li><li>ゼロから何かを作り上げるプロセスを楽しむこと（イラスト制作など）</li></ul><hr><p>以上が、貴社への応募に際しての職務経歴書となります。<br>何卒よろしくお願い申し上げます。</p><p><strong>遊 瑞林（ゆう すいりん）</strong></p>]]></content>
      
      
      
        <tags>
            
            <tag> 转职 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在 Hexo 中使用 AI（Gemini Pro）生成文章摘要</title>
      <link href="/posts/3864ab/"/>
      <url>/posts/3864ab/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><p>我先来总结一下提要：</p><h2 id="首先部署Gemini服务"><a href="#首先部署Gemini服务" class="headerlink" title="首先部署Gemini服务"></a>首先部署Gemini服务</h2><p>进入 <a href="https://ai.google.dev/">https://ai.google.dev/</a> 跟随官网描述即可。</p><p><img src="https://image.baidu.com/search/down?url=https://gzw.sinaimg.cn/mw2000/0085UwQ9gy1hqvo3sf3vgj31hu0ywwnj.jpg" alt="img"></p><p>然后，可选配置中转服务</p><p>然后，安装 hexo-ai-summaries 插件 &amp; 配置</p><p>root/_config.yml</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo-ai-summaries:</span><br><span class="line">  enable: true</span><br><span class="line">  aiSummaryApi: https://article-zhaiyao.youruilin.workers.dev/v1/chat/completions</span><br><span class="line">  # 只在该日期后的文章上生成 摘要 按钮</span><br><span class="line">  generateAfterDate: 2024/05</span><br><span class="line">  # 文字数量限制 =&gt; String.length </span><br><span class="line">  maxToken: 300</span><br><span class="line">  prompt:</span><br><span class="line">    You are a highly skilled AI trained in language comprehension and summarization. I would like you to read the text delimited by triple quotes and summarize it into a concise abstract paragraph. Aim to retain the most important points, providing a coherent and readable summary that could help a person understand the main points of the discussion without needing to read the entire text. Please avoid unnecessary details or tangential points.</span><br><span class="line">    Only give me the output and nothing else. Do not wrap responses in quotes. Respond in the Japanese language.</span><br><span class="line">  geminiConfig:</span><br><span class="line">    model: gpt-4o</span><br><span class="line">    temperature: 0.7</span><br><span class="line">    headers: true</span><br><span class="line">  tagConfig:</span><br><span class="line">    title: .post-title</span><br><span class="line">    content: .post-content</span><br><span class="line">    toc: .toc-content</span><br><span class="line">  customHtml:</span><br><span class="line">    htmlFile: source/Gemini/gemini.html</span><br><span class="line">    styleFile: source/Gemini/gemini.css</span><br><span class="line">    jsFile: source/Gemini/gemini.js</span><br></pre></td></tr></table></figure><p>其中，原始文件生成在 public/hexo-ai-summaries 中，复制出来，其中 html 需要到插件文件夹中找到 html.tpl 文件，将其转换为 html 结构后复制出来，如上配置。</p><p>接下来就可以任意修改理想的样式，进行很大程度的自由定制啦！</p><p>关于自动执行</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 使用 requestAnimationFrame 确保在 DOM 渲染后执行</span><br><span class="line">document.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; &#123;</span><br><span class="line">  requestAnimationFrame(async () =&gt; &#123;</span><br><span class="line">    // 延迟执行 geminiAI，确保 DOM 元素已渲染完成</span><br><span class="line">    await geminiAI();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>requestAnimationFrame</code> 是一种浏览器提供的 API，它允许你将一个回调函数放入浏览器的下一次重绘周期中执行。它的主要目的是用于优化动画，使得动画的帧率和页面的渲染同步，从而提高性能和流畅度。</p><p>为什么使用 <code>requestAnimationFrame</code>？</p><p>当你希望延迟执行某个操作，尤其是在渲染相关的操作时，<code>requestAnimationFrame</code> 是比 <code>setTimeout</code> 更合适的选择，特别是在你需要确保操作在页面渲染的下一帧时执行。</p><p><code>requestAnimationFrame</code> 的好处包括：</p><ul><li><strong>性能优化</strong>：它会在浏览器的渲染周期中执行，不会导致不必要的页面重排和重绘，因此比 <code>setTimeout</code> 更高效。</li><li><strong>同步渲染</strong>：通过 <code>requestAnimationFrame</code>，操作可以与浏览器的渲染周期同步，从而避免卡顿或者不流畅的效果。</li><li><strong>避免意外的延迟</strong>：<code>setTimeout</code> 可以出现不准确的延迟时间，尤其是当页面忙于渲染或者其他操作时，而 <code>requestAnimationFrame</code> 是与页面渲染同步的。</li></ul><p>接下来需要优化的点：</p><ol><li>为 worker.js 中的apikey 添加环境变量，确保安全</li><li>继续解决前端页面加载后自动执行 Gemini 函数的问题，目前使用延时器暂时凑活（为fake流设置延时）</li><li>将 ai 摘要缓存到 cf</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ブログ周年の考察</title>
      <link href="/posts/26488bd1/"/>
      <url>/posts/26488bd1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><p>あっという間に新しいブログが安定して半年間運営されています。この半年間は、学びと共有の連続でしたが、決して順調ではなく、時には諦めの気持ちも湧きました。しかし、全体の過程を振り返ると、多くの成果を得ました。もっと多くの知識を得て、もっと多くの能力を身につけ、もっと多くの友人を得ました。</p><p>このような過程の中で、（（私は世界に対する認識がより深くなり、世界の運行規則をますます理解するようになりました。））</p><p>どんな環境や状態にいても、自分の人生の進行速度を絶えず進めることが、生活をより充実させ、楽しさで満たしてくれるのです。</p><p>今日は、最初に個人サイトを作成した時から今に至るまでの過程を振り返ってみました。</p><h2 id="夢の始まり"><a href="#夢の始まり" class="headerlink" title="夢の始まり"></a>夢の始まり</h2><p>最初にブログを作ろうと思ったのは、ある普通の夜、私の人生に影響を与える行動を起こしました。「自分のサイトを作ろう」と。</p><p>私はすでにHTML、CSS、JavaScriptなどのフロントエンド開発の知識を持っていましたが、個人ブログサイトはコンテンツ管理、ドキュメント解析、コメントシステムなどを含みます。また、バックエンド言語やデータベース、サーバーの運用、デプロイメントの学習も必要でした。それに加えて、パフォーマンスの最適化技術も学ばなければなりませんでした。全体として、ほぼ新しい分野でした。</p><p>（（私は平面デザイン出身で、ウェブ開発に転職したフロントエンドエンジニアです））。自学で転職し、働きながら学んでいたので、最初はコードも全く理解していない人間から、Git、サーバー、フロントエンドなど一連のことに（（何も知らなかった私にとっては、とても難しかったです））。</p><p>だから、最初にブログを作った理由は、学んだことを整理し、プロジェクトの開発ドキュメントをまとめることでした。また、これを通じて自分の影響力を高めたかったのです。デザイン業界に入るためにも、また仕事を探すためにも、これがきっと役立つと考えました。</p><p>実際、最初は（（非常に単純で、少し利益を感じる動機でした））です。</p><h2 id="再び選択"><a href="#再び選択" class="headerlink" title="再び選択"></a>再び選択</h2><p>自分の能力をはるかに超えることに直面すると、ほとんどの場合は諦めの気持ちが湧きます。（（しかし、だからこそ自分を挑戦し続けることで、自分を超える奇跡が起こるのです。））</p><p>人生の中で輝かしい瞬間はおそらく短いものが多く、努力や挫折の方が大部分を占めているのではないでしょうか。ウェブサイトを作ることも同様です。</p><p>予算がなかったため、最初は高いコストをかけて見通しのつかない実験的な目標を立てる気にはなれませんでした。だから、Hexoをブログとして選んだ理由もあります。</p><p>GitHub Pagesは完全に無料で、HexoのGitを使ってウェブページをGitHub Pagesにアップロードできるため、私は完全に無料で最初のウェブサイトを持つことができました。</p><h2 id="契機"><a href="#契機" class="headerlink" title="契機"></a>契機</h2><p>私は子供の頃から製品デザインに強い興味を持っていました。友達とゲーム機のカードを交換する際、絵柄が美しいカードが必ずしも良いゲーム体験を意味しないことに気付きましたが、それでもそれが最も魅力的な理由となっていました。その後、平面デザインを選び、UIデザイナーになることを決めました。私は自分の人生がデザインと切っても切れない関係にあると感じています。</p><p>UIデザインに従事した後、ネット上の多くのビデオやチュートリアルは3Dデザインやモデリングに重点を置いていることに気づきました。私は理工学の出身ですが、モデリングにはそれほど問題はありませんが、正直言って非常に退屈でした。（（私は、私の趣味は視覚効果の展示ではなく、もっとユーザーとソフトウェアとの間のインタラクションロジックにあるのかもしれないことに気づきました。））</p><p>伝えたい情報を（（効率よく、優雅にすべてのユーザーに伝えること））。</p><p>これが私が好きなこと、私の趣味かもしれません。この発見以来、（（私は“完璧なUIデザイナー”という幻想との戦いに悩むことはなくなりました））。モデリングやレンダリング、イラストを競い合うことを考えることはありません。</p><p>私はフォーラムで絵が得意な人たちをたくさん見てきましたし、素晴らしい絵画作品もたくさん見てきました。（（私は、何が良い絵やイラストなのか、どんな画像が必要かを知っていればそれで十分だと思います））。絵やモデリングを愛するデザイナーは世界にたくさんいます。適切な人に適切な仕事を任せることが大切だと思います。</p><p>私はもし3Dやイラストを数年学んでいたら、おそらく人々から「完璧なデザイナー」と見なされるでしょう。でもその「完璧なデザイナー」というのは、自分が好きではない仕事をしている可能性があります。</p><p>だから私は思います、（（この忙しい人生の中で、自分の好きなこと、興味があること、そして自分が支払う意欲がある方向にエネルギーを注ぐべきだと））。</p><p>ブログを自分の製品として作り上げ、磨いていきます。その過程で、自分のデザインがより正確に、私の望む形で実現できるよう、uniappを学び、モバイル端末のiOSとAndroidに対応させるようになりました。</p><h2 id="挫折に直面"><a href="#挫折に直面" class="headerlink" title="挫折に直面"></a>挫折に直面</h2><p>技術が進化する中で、私は技術の道には近道もあれば、抜け道もあることに気づきました。しかし、それは通常、バグを解決するための数え切れない夜を意味し、段階的な成果を得る前には全くうまくいかないこともあります。</p><p>Vueフレームワークの学習を始めて半年が経ち、最初のフロントエンド作品「スマートモール」を完成させました。しかし、プロジェクトが公開される直前にバックエンドのAPIサービスがダウンし、再び諦めそうになりました。</p><p>（（バックエンド開発とデータベース、これもまた私の能力を超える問題のように感じました））。</p><p>一方、ブログの方では、元のテーマの作者が更新を停止し、テーマが活気を失った時、ドメインを強制的に変更され、Butterflyテーマを変更したり、データベースを削除して再インストールするという一連の問題が発生しました（当時はGitを使えなかったので、バックアップはすべてコピー＆ペーストで行っていました）。次第に、最初の幻想は薄れていきました。今は、ブログを自分の日記として使うことに決めました。インターネット上で直面した問題とその解決方法を記録するためです。</p><p>前途が見えない状況では、ただ一歩一歩進んでいくしかありませんでした。ゼロから書き始めるわけではありませんが、基本的なロジックは理解しています。（（コードの修正から始めることができました））。</p><p>（（他人が公開してくれたコードの重要な部分を修正していくことができます））。そうすれば、私が望む効果を得ることができるからです。</p><p>だから本当に、（（ウェブサイトが自分の思い通りに構築できるかどうかは、決意と粘り強さにかかっています））。もちろん、デザイナーとして最大の困難は、頭の中で想像している表現方法が、技術的に実現できない場合に直面することです。</p><p>ほとんどの場合、ちょっとした問題を解決するのに数日かかることがあります。（（毎回、ちょっとした問題を何日間も寝ずに解決したときの喜びは、内面から湧き上がるものです。））</p><h2 id="積み重ね"><a href="#積み重ね" class="headerlink" title="積み重ね"></a>積み重ね</h2><p>現在ブログで使っているツールチップ機能は、私が4年前に書いたものです。その頃、私はウェブ開発の初心者で、日語の記事にマウスオーバーしたときに自動的に仮名を表示するツールチップを追加したいと思っていました。このツールチップ設計はすぐにできたもので、1時間くらいで完成しました。しかし、開発が全くわからなかった私には、このコードを書くだけで1週間以上かかりました。</p><p>当時の自分を振り返ると、バグを見つけるたびに百度で調べ、機能実現のために他人のコードをコピーして貼り付け、さらに修正していました。（（私の成長はインターネットのオープンソース精神に支えられてきたと思います。私は、顔も名前も知らない、多くの人々から指導やチュートリアル、コードを提供してもらいました。））</p><p>もしかすると、この瞬間から私にとってブログの意味が変わったのかもしれません。（（ブログはもはや、自分の影響力を高め、仕事を見つける手段としてのツールではなく、他者を助け、インターネットのオープン精神を広めるためのチャネルになったのです。））</p><p>おそらく、他の自媒体サイトでの流行の方が速いかもしれませんが、ブログを自分で作ると、コンテンツをいつでも修正でき、目立つために粉飾する必要もなく、フォロワーを増やすために気を使うこともなく、データや収益を気にすることもありません。</p><p>だから、最初は広告を入れようと思ったこともありましたが、後でそれを削除し、（（これがGoogle広告やウェブサイトアフィリエイト広告を入れなかった理由でもあります））。</p><p>これこそが、私が望んでいたこと、最も望んでいること、そしてそれを達成するために努力していることです。</p><p>だから、言うならば、すべての記事は自分に向けて書かれたものです。同じ問題に再び直面する未来の自分に向けて書かれたものです。そして、同じ問題に直面する他の人々にも向けて書かれたものです。もしかすると、他の人が私の記事を見て、私がブログに加えたちょっとした機能デザインや、快適な閲覧体験に感銘を受け、（（それが彼らにインスピレーションを与え、問題解決をもたらし、または私と同じように、彼ら自身の快適なウェブサイトを作り上げる手助けになればと思います））。</p><h2 id="再成長"><a href="#再成長" class="headerlink" title="再成長"></a>再成長</h2><p>ブログを製品としてデザインし、練習作を製品として作ることで、私は学校や仕事で学んだデザインとインタラクションに関する知識とスキルを最大限に活かしました。印象的なウェブサイトと製品を作り上げることができました。（（華やかな視覚的インパクトは少ないかもしれませんが、使ってみて最も快適に感じられるものの一つには違いありません））。</p><p>これは（（平面デザイナーからウェブデザイナー、そしてウェブ開発者への道のり））における茨の道でした。</p><p>無数のキーを叩いた手の中には、解決策を探し続けた無数の夜がありました（私はオンライン講座を受けたこともなく、グループで質問するのも効率が悪すぎました）。しかし、これらの経験を経て、私は自分が行った仕事やその背後にある運行規則に対して、より深い理解を持つようになり、真実により近づいていると感じています。</p><p>新しい2025年には、バックエンドAPIの作成やデータベース操作、サーバー運用について、ようやく運営ルールを理解できるようになりました。HTMLやCSSも非常に熟練して使いこなせるようになり、基本的なJavaScriptも難なく使いこなせます。データベースを誤って削除した後、半年近く滞っていたホームページも、ブログの2025年の到来を迎えるにあたり、再び（静的ウェブページ）として書き直しました。</p>]]></content>
      
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客周年的思考</title>
      <link href="/posts/373e5f8d/"/>
      <url>/posts/373e5f8d/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><p>转眼间新版博客已经稳定运行半年了，这半年不断的学习和分享，过程并不顺利，甚至也不是没有产生过放弃的念头，但回顾整个过程收获也有很多。收获了更多知识、收获了更多能力、收获了更多朋友。</p><p>在这样的过程当中，（（我对世界的认知产生了更深刻的看法，也更逐渐深入了解世界的运行规律。））</p><p>无论你处在什么环境、什么状态。保持自己人生进度不断推进，能让自己生活变得更加充实，且充满乐趣。</p><h2 id="梦开始"><a href="#梦开始" class="headerlink" title="梦开始"></a>梦开始</h2><p>回想自己最初创建博客的时候，一个平凡的晚上，做出了一个影响我这半年的举动。建一个属于自己的网站吧。</p><p>虽然我已经具备了html，css 和javascript等前端开发知识，但个人博客网站涉及到内容管理、文档解析、评论系统等。以及，需要学习后端语言和数据库，以及服务器与部署。此外，也需要学习性能优化技巧。总体来说，这几乎是一个新的领域。</p><p>（（我是一个平面设计出身，转型网页开发的前端工程师））。由于是自学转型，边工作、边学习，因此从最初一个不懂代码的人，对git、服务器、前端等等一系列（（都一无所知的人来说，太难了））。</p><p>所以最开始做博客的原因，是为了梳理学习成果和项目开发文档，并且我想借此提升自己的影响力，无论是进设计圈子还是找工作可能都对我会有更好的帮助。</p><p>其实这是个（（非常单纯的简单的有点利益感觉的动机））。</p><h2 id="再抉择"><a href="#再抉择" class="headerlink" title="再抉择"></a>再抉择</h2><p>当你遇见一件能力远超于自己的事情时，其实大多时候还是有过放弃的念头。（（但正是自己的不断挑战，才会有超越自己的奇迹。））</p><p>人生中精彩、闪耀大多可能只是短暂的，而努力、挫折可能占据大多数。做网站也是一样。</p><p>因为没有这方面的预算，最开始不想要更高的成本去搭建一个虚无缥缈、完全无法预计收益、实验性的目标。所以这也是我选择Hexo来作为博客的原因。</p><p>因为GitHubpage是完全免费的，通过Hexo的git将网页传输到githubpage，这样我就可以完全免费的拥有我的第一个网站了。</p><h2 id="契机"><a href="#契机" class="headerlink" title="契机"></a>契机</h2><p>我从很小的时候就对产品设计有浓厚的兴趣，在与其他小伙伴交换游戏机卡片时我就注意到，图案精美的卡片并不总是意味着好的游戏体验，但却往往成为它最抢手的原因之一。再到后来选择平面设计、准备从事UI设计师。我感觉我的整个人生道路都是与设计有着不解之缘。</p><p>当我从事UI设计后我发现，无论是网络上各种视频、教程，其实大多数都在渲染3D设计、建模等等。虽然我是理工方向出身，对于建模还是没什么太大问题，但是着实是枯燥乏味。（（我发现我的爱好可能不是在视觉效果的展现，更多的是在人与软件之间的交互逻辑））。</p><p>将需要的传达的信息（（高效优雅的传递给每一个用户））。</p><p>这个可能是我所喜爱的方面，也是我的爱好。自从发现这个之后，（（我不再纠结于与幻想的“完美UI设计师”之间的斗争））。不再考虑去卷建模渲染，卷插画绘画。</p><p>我在论坛见了太多绘画好的人了，我也见过太多优秀的绘画作品了。（（我觉得我只要知道，什么是好的绘画插画、我期望需要什么样的图片，这就够了））。这世上不缺热爱绘画和热爱建模的设计师，让合适的人去做合适的事情，这很合适。</p><p>我想象了一下我如果埋下头苦学几年3d、苦学几年插画。或许我就成为了一个在人们眼中“完美的设计师”，但这个“完美设计师”可能就是在干自己不热爱的工作。</p><p>所以我觉这熙熙攘攘的一生中，（（我要将我的热爱倾注在我感兴趣，我愿意付出的方向上））。</p><p>我将博客作为我的产品创造，去打磨。在我不断的思考过程中，为了我的设计能够更准确和我所期望的那样去实现，我又开始学习了uniapp以适应移动端 ios 和 Android 设备。</p><h2 id="遇挫折"><a href="#遇挫折" class="headerlink" title="遇挫折"></a>遇挫折</h2><p>随着技术的迭代，我发现技术这条路有捷径，有抄近路，但这通常也意味着无数个为了解决bug的日日夜夜，在取得阶段性的成果之前，甚至毫不顺利。</p><p>vue框架开发学习的前半年，也终于完成了我的第一款前端作品「智慧商城」。结果在项目即将上线之际，后端api服务挂了，这再一次让我产生了退意。</p><p>（（后端开发和数据库，似乎又是一个远超我能力的事情了））。</p><p>而另一边博客这里，在原来主题作者停更，主题失去活力的时候，我经历了被抢注域名被迫更换域名、更换butterfly主题、删库重新安装等等一系列坑（因为当时不会git，备份全靠复制粘贴）。我可能渐渐也被磨平了当初的幻想。只愿博客做一个自己的日记。记录下自己在互联网上发生的一些问题和解决方案。</p><p>在前途黑暗的情况下，只得步履蹒跚。虽然我不会从零开始写，但是最基本的逻辑还是懂的。（（我可以从修改代码开始做））。</p><p>我可以（（将别人开源分享的代码的关键部分进行修改））。这样的话就可以找到我所期望的效果了。</p><p>所以真的，（（一个网站能否够按你的想法去构建完全取决于你的决心和毅力））。当然对于一个设计师而言，最大的困难莫过于你脑海里都是期望的展现方式，而技术受限没办法实现。</p><p>而大多数时候解决一个小问题可能都需要几天的时间。（（每次一个小问题被自己的几天的熬夜努力攻克，那种喜悦真的从内而外的激动。））</p><h2 id="去积累"><a href="#去积累" class="headerlink" title="去积累"></a>去积累</h2><p>目前博客使用的tooltip功能，大概是我四年之前写的。那个时候的我，可以说是初学网页开发，为了在日语文章当中增加鼠标移入时，自动显示悬浮框提示假名。这个tooltip设计很快，也就一个来小时。但是对于开发一窍不通的我来说，这块光写代码就写了一个多星期。</p><p>回看当时的那段历程，每次写完发现一个bug的时候，都会去百度查；每次有一个功能实现需求，都需要查别人的代码，复制粘贴再去改。（（我觉得我的成长离不开互联网的开源开放精神。我得到了太多毫不认识和毫不相关的人的指教、教程和代码的帮助。））</p><p>可能这一刻我写博客的意义对我来说就变了。（（博客对我来说不再是一个试图增强自己影响力、试图更好找工作的工具和手段，它更多变成了能够帮助他人，传播互联网开放精神的渠道和媒介。））</p><p>可能流量远没有在自媒体网站上增长快，但自己做网站是可以随时修改内容、不用在意博眼球、求涨粉、不必在意数据、不必在意盈利。</p><p>所以我从最初考虑过插入公众号密码广告，后来移除掉并且（（这也是长期坚持没有插入影响浏览体验的Google广告等网站联盟广告的原因））。</p><p>这就是我所期望的，我所最期望的，我所愿意为之努力的平台。</p><p>所以说每一篇文章都是给自己写的，给未来再次遇到同样问题的自己写的，给未来与自己一样遇到同样问题的人写的。也许其他人看到我的文章、看到我为博客的一点点功能设计，看到令人愉悦的浏览体验，也能够（（为他们带来启发、带来问题的解决、或者和我一样构建出属于他们自己的令人舒适的网站））。</p><h2 id="再成长"><a href="#再成长" class="headerlink" title="再成长"></a>再成长</h2><p>将博客当作一个产品来设计，将自己的练习作品当作产品来做，我自认为充分的发挥了我在学校和工作时所学到的设计与交互的知识与技能。做出了令人印象深刻的网站和产品。（（也许没有那么多花哨的视觉张力，但是他们一定是你用起来最舒适的之一））。</p><p>这也是（（从一个平面设计师，到一个网页设计师、一个网页开发人员））的荆棘之路。</p><p>在这个无数次敲击键盘的双手中，是无数个挠头搜索解决方案的夜晚（我没有系统学过网课和群里询问，效率都太低了），但这些都经历过之后，你也一定对你所做的工作，所做的一切相关的运行规律有自己的理解，更接近真相的理解。</p><p>在新的2025年，我对编写后端Api+操作数据库方面、服务器运维方面终于有了运行规则方面的认知；对html、css写的也是非常熟练了；对一些基本的js也是轻松驾驭。在经历一次意外删库之后，停滞了大半年的主页在博客2025年来临之际也重写了（静态网页）。</p>]]></content>
      
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>wordpress快速搭建企业静态页面系列</title>
      <link href="/posts/ef40975d/"/>
      <url>/posts/ef40975d/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><p>要在 AWS 上的 Ubuntu 实例中运行 WordPress 项目，需要配置 LAMP 或 LEMP 堆栈。以下是详细的配置步骤：</p><h3 id="0-首先，ssh-链接远程虚拟机"><a href="#0-首先，ssh-链接远程虚拟机" class="headerlink" title="0. 首先，ssh 链接远程虚拟机"></a>0. 首先，ssh 链接远程虚拟机</h3><p>记得要携带创建实例时生成的密钥对</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh -i keys/america_aws.pem ubuntu@3.141.28.129</span><br></pre></td></tr></table></figure><h3 id="1-更新系统"><a href="#1-更新系统" class="headerlink" title="1. 更新系统"></a>1. 更新系统</h3><p>首先，确保你的系统是最新的。</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt update &amp;&amp; <span class="built_in">sudo</span> apt upgrade -y</span><br></pre></td></tr></table></figure><h3 id="2-安装-Apache-Web-服务器"><a href="#2-安装-Apache-Web-服务器" class="headerlink" title="2. 安装 Apache Web 服务器"></a>2. 安装 Apache Web 服务器</h3><p>WordPress 需要 Web 服务器来处理 HTTP 请求。安装 Apache：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install apache2 -y</span><br></pre></td></tr></table></figure><h3 id="3-安装-MySQL-数据库"><a href="#3-安装-MySQL-数据库" class="headerlink" title="3. 安装 MySQL 数据库"></a>3. 安装 MySQL 数据库</h3><p>WordPress 使用 MySQL 作为数据库。安装 MySQL：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install mysql-server -y</span><br></pre></td></tr></table></figure><p>安装完成后，运行以下命令配置 MySQL：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mysql_secure_installation</span><br></pre></td></tr></table></figure><p>你会被要求设置 root 密码并完成其他安全配置。</p><h3 id="4-创建-WordPress-数据库"><a href="#4-创建-WordPress-数据库" class="headerlink" title="4. 创建 WordPress 数据库"></a>4. 创建 WordPress 数据库</h3><p>登录 MySQL 并创建一个数据库供 WordPress 使用：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mysql -u root -p</span><br></pre></td></tr></table></figure><p>然后执行以下命令创建数据库和用户：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">CREATE DATABASE wordpress;</span><br><span class="line">CREATE USER <span class="string">&#x27;wp_user&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED BY <span class="string">&#x27;your_password&#x27;</span>;</span><br><span class="line">GRANT ALL PRIVILEGES ON wordpress.* TO <span class="string">&#x27;wp_user&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">FLUSH PRIVILEGES;</span><br><span class="line">EXIT;</span><br></pre></td></tr></table></figure><p>请将 <code>&#39;your_password&#39;</code> 替换为你希望为 WordPress 数据库用户设置的密码。</p><h3 id="5-安装-PHP-和所需扩展"><a href="#5-安装-PHP-和所需扩展" class="headerlink" title="5. 安装 PHP 和所需扩展"></a>5. 安装 PHP 和所需扩展</h3><p>WordPress 需要 PHP 支持。安装 PHP 和相关扩展：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install php libapache2-mod-php php-mysql php-xml php-gd php-curl php-mbstring php-xmlrpc php-zip php-soap -y</span><br></pre></td></tr></table></figure><h3 id="6-配置-Apache"><a href="#6-配置-Apache" class="headerlink" title="6. 配置 Apache"></a>6. 配置 Apache</h3><p>调整 Apache 配置以支持 WordPress：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> nano /etc/apache2/sites-available/000-default.conf</span><br></pre></td></tr></table></figure><p>找到 <code>&lt;VirtualHost *:80&gt;</code> 部分，修改为：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DocumentRoot /var/www/html</span><br><span class="line">&lt;Directory /var/www/html&gt;</span><br><span class="line">    AllowOverride All</span><br><span class="line">&lt;/Directory&gt;</span><br></pre></td></tr></table></figure><p>保存并退出编辑器（按 <code>Ctrl + X</code>，然后按 <code>Y</code> 确认保存）。</p><h3 id="7-启用-Apache-重写模块"><a href="#7-启用-Apache-重写模块" class="headerlink" title="7. 启用 Apache 重写模块"></a>7. 启用 Apache 重写模块</h3><p>WordPress 需要 Apache 的 mod_rewrite 模块来处理永久链接。启用它：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo a2enmod rewrite</span><br><span class="line">sudo systemctl restart apache2</span><br></pre></td></tr></table></figure><h3 id="8-下载并配置-WordPress"><a href="#8-下载并配置-WordPress" class="headerlink" title="8. 下载并配置 WordPress"></a>8. 下载并配置 WordPress</h3><p>进入 Apache Web 服务器的默认目录并下载 WordPress：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /var/www/html</span><br><span class="line">sudo wget https://wordpress.org/latest.tar.gz</span><br><span class="line">// 先执行前两行，然后解压后删除安装包</span><br><span class="line">sudo tar -xvzf latest.tar.gz</span><br><span class="line">sudo rm latest.tar.gz</span><br></pre></td></tr></table></figure><p>为 WordPress 创建合适的权限：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo chown -R www-data:www-data /var/www/html/wordpress</span><br></pre></td></tr></table></figure><h3 id="9-配置-WordPress"><a href="#9-配置-WordPress" class="headerlink" title="9. 配置 WordPress"></a>9. 配置 WordPress</h3><p>进入 <code>/var/www/html/wordpress</code> 目录，复制 WordPress 配置文件：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /var/www/html/wordpress</span><br><span class="line">sudo cp wp-config-sample.php wp-config.php</span><br></pre></td></tr></table></figure><p>编辑 <code>wp-config.php</code> 文件：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nano wp-config.php</span><br></pre></td></tr></table></figure><p>修改以下行：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">define( &#x27;DB_NAME&#x27;, &#x27;wordpress&#x27; );</span><br><span class="line">define( &#x27;DB_USER&#x27;, &#x27;wp_user&#x27; );</span><br><span class="line">define( &#x27;DB_PASSWORD&#x27;, &#x27;your_password&#x27; );</span><br><span class="line">define( &#x27;DB_HOST&#x27;, &#x27;localhost&#x27; );</span><br></pre></td></tr></table></figure><p>保存并退出编辑器。</p><h3 id="10-完成安装"><a href="#10-完成安装" class="headerlink" title="10. 完成安装"></a>10. 完成安装</h3><p>在浏览器中访问你的实例的 IP 地址，例如：<code>http://&lt;your-ec2-ip&gt;/wordpress</code>。你将看到 WordPress 安装向导，按照提示完成安装。</p><h3 id="11-设置防火墙（可选）"><a href="#11-设置防火墙（可选）" class="headerlink" title="11. 设置防火墙（可选）"></a>11. 设置防火墙（可选）</h3><p>如果你启用了防火墙，确保允许 HTTP 和 HTTPS 流量：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo ufw allow in &quot;Apache Full&quot;</span><br><span class="line">sudo ufw enable</span><br></pre></td></tr></table></figure><p>完成以上步骤后，你的 WordPress 网站应该可以在 AWS 实例上正常运行了。</p><p>输入：ip/wordpress 即可以进入安装页面</p>]]></content>
      
      
      
        <tags>
            
            <tag> wordpress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>双招项目后端api全过程实现（二）</title>
      <link href="/posts/1432cf2a/"/>
      <url>/posts/1432cf2a/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><div class="note blue no-icon flat"><p>双招项目后端api全过程实现系列</p><ol><li><a href="/posts/629f32c0/">双招项目后端api全过程实现（一）- 登录&amp;任务模块</a></li><li>双招项目后端api全过程实现（二）- 合约模块 ⇦当前位置🪂</li><li>双招项目后端api全过程实现（三）- 消息模块</li><li>双招项目后端api全过程实现（四）- 我的个人中心模块</li></ol></div><h2 id="1-创建数据库表"><a href="#1-创建数据库表" class="headerlink" title="1. 创建数据库表"></a>1. 创建数据库表</h2><ol><li><p>contract - 合约的核心数据存储表，包含合约的基本信息</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> contract (</span><br><span class="line">    contract_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT, <span class="comment">-- 合约唯一标识</span></span><br><span class="line">    contract_name <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,        <span class="comment">-- 合约名称</span></span><br><span class="line">    contract_type <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,         <span class="comment">-- 合约类型（如技术服务、外包等）</span></span><br><span class="line">    task_salary <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,        <span class="comment">-- 合约任务薪资或预算</span></span><br><span class="line">    start_cycle_time <span class="type">DATE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,             <span class="comment">-- 合约开始时间</span></span><br><span class="line">    end_cycle_time <span class="type">DATE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,               <span class="comment">-- 合约结束时间</span></span><br><span class="line">    settle_salary <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="number">0</span>,     <span class="comment">-- 已结算金额（默认为 0）</span></span><br><span class="line">    signing_time DATETIME <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,         <span class="comment">-- 签约时间</span></span><br><span class="line">    is_contract_type TINYINT <span class="keyword">NOT</span> <span class="keyword">NULL</span>,          <span class="comment">-- 合约状态类型（如：1=待确认，2=进行中，3=已完成）</span></span><br><span class="line">    task_ask TEXT,                              <span class="comment">-- 合约任务的详细要求</span></span><br><span class="line">    create_time DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>, <span class="comment">-- 创建时间</span></span><br><span class="line">    accounts <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,                <span class="comment">-- 创建该合约的用户 ID（外键，关联 users 表）</span></span><br><span class="line">    INDEX (accounts),                     <span class="comment">-- 索引：加速用户与合约的查询</span></span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (accounts) <span class="keyword">REFERENCES</span> users(accounts) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE <span class="comment">-- 外键关联（假设 users 表的主键是 user_id）</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br></pre></td></tr></table></figure><p>​</p></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>gitactions 实现自动化部署（三）</title>
      <link href="/posts/42cfc10a/"/>
      <url>/posts/42cfc10a/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><div class="note blue no-icon flat"><p>hexo + butterfly 个人博客 &amp; webstack 主题个人导航搭建全过程系列</p><ol><li><a href="/posts/d9146854/">hexo_blog の誕生 - 基础环境配置（一）</a></li><li>博客魔改（二）</li><li>gitactions 实现自动化部署（三）⇦当前位置🪂</li><li>独立开发tooltip遇到的实际问题（四）</li><li><a href="/posts/19af9b1f/">实现 github &amp; aliyun 双端部署（五）</a> </li><li>hexo_blog 多语言改造（六）</li></ol></div><div class="tag link"><a class="link-card" title="原文教程在此" href="https://akilar.top/posts/f752c86d/"><div class="left"><img src="https://akilar.top/img/siteicon/favicon.png"/></div><div class="right"><p class="text">原文教程在此</p><p class="url">https://akilar.top/posts/f752c86d/</p></div></a></div><p>附上经过我调整的工作流逻辑</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 当有改动推送到master分支时，启动Action</span><br><span class="line">name: 自动部署</span><br><span class="line"></span><br><span class="line">on:</span><br><span class="line">  push:</span><br><span class="line">    branches:</span><br><span class="line">      - main #2020年10月后github新建仓库默认分支改为main，注意更改</span><br><span class="line"></span><br><span class="line">  release:</span><br><span class="line">    types:</span><br><span class="line">      - published</span><br><span class="line"></span><br><span class="line">jobs:</span><br><span class="line">  deploy:</span><br><span class="line">    runs-on: ubuntu-latest</span><br><span class="line">    steps:</span><br><span class="line">    - name: 检查分支</span><br><span class="line">      uses: actions/checkout@v2</span><br><span class="line">      with:</span><br><span class="line">        fetch-depth: 0</span><br><span class="line">        ref: main #2020年10月后github新建仓库默认分支改为main，注意更改</span><br><span class="line"></span><br><span class="line">    - name: Restore file modification time 🕒</span><br><span class="line">      run: find source/_posts -name &#x27;*.md&#x27; | while read file; do touch -d &quot;$(git log -1 --format=&quot;@%ct&quot; &quot;$file&quot;)&quot; &quot;$file&quot;; done</span><br><span class="line"></span><br><span class="line">    - name: 安装 Node</span><br><span class="line">      uses: actions/setup-node@v1</span><br><span class="line">      with:</span><br><span class="line">        node-version: &quot;18.x&quot; #action使用的node版本，建议大版本和本地保持一致。可以在本地用node -v查询版本号。</span><br><span class="line"></span><br><span class="line">    - name: 安装 Hexo</span><br><span class="line">      run: |</span><br><span class="line">        export TZ=&#x27;Asia/Shanghai&#x27;</span><br><span class="line">        npm install hexo-cli -g</span><br><span class="line"></span><br><span class="line">    - name: 缓存 Hexo</span><br><span class="line">      uses: actions/cache@v3</span><br><span class="line">      id: cache</span><br><span class="line">      with:</span><br><span class="line">        path: node_modules</span><br><span class="line">        key: $&#123;&#123;runner.OS&#125;&#125;-$&#123;&#123;hashFiles(&#x27;**/package-lock.json&#x27;)&#125;&#125;</span><br><span class="line"></span><br><span class="line">    - name: 安装依赖</span><br><span class="line">      if: steps.cache.outputs.cache-hit != &#x27;true&#x27;</span><br><span class="line">      run: |</span><br><span class="line">        npm install --save</span><br><span class="line"></span><br><span class="line">    - name: 生成静态文件</span><br><span class="line">      run: |</span><br><span class="line">        hexo clean</span><br><span class="line">        hexo generate</span><br><span class="line"></span><br><span class="line">    - name: 部署 #此处main:main 指从本地的main分支提交到远程仓库的main分支，若远程仓库没有对应分支则新建一个 &#x27; git checkout -b main &#x27; 如有其他需要，可以根据自己的需求更改。</span><br><span class="line">      run: |</span><br><span class="line">        cd ./public</span><br><span class="line">        git init</span><br><span class="line">        git checkout -b main  # 创建并切换到 main 分支 这一行非常重要, 因为静态托管的仓库默认分支是 main</span><br><span class="line">        git config --global user.name &#x27;$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;&#x27;</span><br><span class="line">        git config --global user.email &#x27;$&#123;&#123; secrets.GITHUBEMAIL &#125;&#125;&#x27;</span><br><span class="line">        git add .</span><br><span class="line">        git commit -m &quot;$&#123;&#123; github.event.head_commit.message &#125;&#125; $(date +&quot;%Z %Y-%m-%d %A %H:%M:%S&quot;) Updated By Github Actions&quot;</span><br><span class="line">        git push --force --quiet &quot;https://$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;:$&#123;&#123; secrets.GITHUBTOKEN &#125;&#125;@github.com/$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;/$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;.github.io.git&quot; main:main</span><br></pre></td></tr></table></figure><p>直到 2025 年了，发现 github actions 执行自动部署后，导致 updated 时间戳出现异常，尝试了ai大模型给的各种无效建议之后，找到了下面的实战教程，领教了。</p><p>其中，新增了</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">jobs</span>:</span><br><span class="line">  <span class="attr">deploy</span>:</span><br><span class="line">    runs-<span class="attr">on</span>: ubuntu-latest</span><br><span class="line">    <span class="attr">steps</span>:</span><br><span class="line">    - <span class="attr">name</span>: 检查分支</span><br><span class="line">      <span class="attr">uses</span>: actions/checkout@v2</span><br><span class="line">      <span class="attr">with</span>:</span><br><span class="line">        fetch-<span class="attr">depth</span>: <span class="number">0</span> # 新增了这一行</span><br><span class="line">        <span class="attr">ref</span>: main </span><br><span class="line"># 以及，下面这两行</span><br><span class="line">    - <span class="attr">name</span>: <span class="title class_">Restore</span> file modification time 🕒</span><br><span class="line">      <span class="attr">run</span>: find source/_posts -name <span class="string">&#x27;*.md&#x27;</span> | <span class="keyword">while</span> read file; <span class="keyword">do</span> touch -d <span class="string">&quot;$(git log -1 --format=&quot;</span>@%ct<span class="string">&quot; &quot;</span>$file<span class="string">&quot;)&quot;</span> <span class="string">&quot;$file&quot;</span>; done</span><br></pre></td></tr></table></figure><p>这段工作流逻辑的目的是 <strong>恢复文件的修改时间</strong>，具体来看它是通过 <code>git</code> 的提交历史来为指定的文件设置修改时间。以下是逐步的分析：</p><h3 id="1-目标目录和文件过滤"><a href="#1-目标目录和文件过滤" class="headerlink" title="1. 目标目录和文件过滤"></a>1. 目标目录和文件过滤</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find source/_posts -name &#x27;*.md&#x27;</span><br></pre></td></tr></table></figure><ul><li><strong>find 命令</strong>：在目录 <code>source/_posts</code> 中查找所有扩展名为 <code>.md</code> 的 Markdown 文件。</li><li>这一步的作用是收集需要处理的文件列表。</li></ul><h3 id="2-循环处理每个文件"><a href="#2-循环处理每个文件" class="headerlink" title="2. 循环处理每个文件"></a>2. 循环处理每个文件</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">| while read file; do ...; done</span><br></pre></td></tr></table></figure><ul><li><strong>while read file</strong>：逐行读取 <code>find</code> 的输出，每次将一个文件路径存入 <code>file</code> 变量中。</li><li>目的是对找到的每个 <code>.md</code> 文件进行后续操作。</li></ul><h3 id="3-获取文件最后一次提交时间"><a href="#3-获取文件最后一次提交时间" class="headerlink" title="3. 获取文件最后一次提交时间"></a>3. 获取文件最后一次提交时间</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git log -1 --format=&quot;@%ct&quot; &quot;$file&quot;</span><br></pre></td></tr></table></figure><ul><li><code>git log</code> 命令<ul><li><code>-1</code>：仅获取最新的一条提交记录。</li><li><code>--format=&quot;@%ct&quot;</code>：使用自定义格式输出提交时间，<code>%ct</code> 是提交的 UNIX 时间戳，<code>@</code> 只是为了方便直接使用。</li><li><code>&quot;$file&quot;</code>：指定要查询的文件。</li></ul></li><li><strong>作用</strong>：提取该文件在 Git 仓库中最后一次被修改的时间戳。</li></ul><h3 id="4-更新文件的修改时间"><a href="#4-更新文件的修改时间" class="headerlink" title="4. 更新文件的修改时间"></a>4. 更新文件的修改时间</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">touch -d &quot;$(git log -1 --format=&quot;@%ct&quot; &quot;$file&quot;)&quot; &quot;$file&quot;</span><br></pre></td></tr></table></figure><ul><li><code>touch -d</code> 命令<ul><li><code>-d</code> 参数用于指定一个时间值，将文件的修改时间设置为该值。</li><li><code>$(git log -1 ...)</code>：通过子命令获取最后一次提交的时间戳。</li><li><code>&quot;$file&quot;</code>：更新对应文件的修改时间。</li></ul></li></ul><h3 id="综合逻辑"><a href="#综合逻辑" class="headerlink" title="综合逻辑"></a>综合逻辑</h3><ol><li>遍历 <code>source/_posts</code> 目录下所有的 <code>.md</code> 文件。</li><li>对每个文件，查询其在 Git 仓库中最后一次提交的时间。</li><li>使用 <code>touch</code> 命令将文件的修改时间更新为该提交时间。</li></ol><h3 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h3><p>这种做法常用于 Hexo 博客或者静态博客生成工具中，因为：</p><ul><li>文件的修改时间可能影响文章的排序（比如基于时间的文章列表）。</li><li>有时会因文件同步工具（如 Git 克隆或拷贝）丢失原始文件的修改时间，此时通过 Git 提交记录恢复可以确保正确的时间顺序。</li></ul><div class="tag link"><a class="link-card" title="参考了这里" href="https://blog.june-pj.cn/posts/5399e2e4/"><div class="left"><img src="https://img.june-pj.cn/img/avatar.webp"/></div><div class="right"><p class="text">参考了这里</p><p class="url">https://blog.june-pj.cn/posts/5399e2e4/</p></div></a></div>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>try...catch 和 Promise</title>
      <link href="/posts/7259d1a8/"/>
      <url>/posts/7259d1a8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><h2 id="复习-promise-的概念和用法"><a href="#复习-promise-的概念和用法" class="headerlink" title="复习 promise 的概念和用法"></a>复习 promise 的概念和用法</h2><p>今天、复习了promise的概念，而复习的过程中，重新认识了 try .. catch 工具的语法。</p><p><code>try...catch</code> 和 <code>Promise</code> 都是用于处理错误的工具，但它们的作用和使用场景略有不同。它们之间是有关系的，特别是在处理异步代码时，<code>try...catch</code> 可以与 <code>Promise</code> 结合使用，提供更强大的错误处理能力。</p><p>区别：</p><ol><li><strong>try…catch</strong>：主要用于捕获同步代码中的错误。当一个同步操作抛出错误时，<code>try...catch</code> 可以捕获并处理。</li><li><strong>Promise</strong>：主要用于处理异步操作的结果和错误。它提供了 <code>.catch()</code> 方法来处理 <code>Promise</code> 被拒绝时的错误。</li></ol><p>关系：</p><p><code>Promise</code> 和 <code>try...catch</code> 可以结合使用，尤其是在异步代码中。</p><ul><li><strong>同步错误</strong>：<code>try...catch</code> 可以捕获在 <code>Promise</code> 内部同步代码抛出的错误。</li><li><strong>异步错误</strong>：<code>Promise</code> 的 <code>.catch()</code> 方法用于捕获 <code>Promise</code> 内部异步操作的错误。</li></ul><h3 id="示例：结合使用-try-catch-和-Promise"><a href="#示例：结合使用-try-catch-和-Promise" class="headerlink" title="示例：结合使用 try...catch 和 Promise"></a>示例：结合使用 <code>try...catch</code> 和 <code>Promise</code></h3><h4 id="1-在-async-函数中使用-try…catch-捕获-Promise-错误"><a href="#1-在-async-函数中使用-try…catch-捕获-Promise-错误" class="headerlink" title="1. 在 async 函数中使用 try…catch 捕获 Promise 错误"></a>1. <strong>在 async 函数中使用 try…catch 捕获 Promise 错误</strong></h4><p>当使用 <code>async/await</code> 来处理 <code>Promise</code> 时，<code>try...catch</code> 可以用来捕获 <code>Promise</code> 中的错误。</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;https://api.example.com/data&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!response.<span class="property">ok</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;网络请求失败&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="comment">// 捕获 Promise 异常</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;发生错误:&#x27;</span>, error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在这个例子中，<code>await</code> 等待的 <code>fetch</code> 是一个 <code>Promise</code>，如果请求失败或者数据解析出错，<code>catch</code> 块会捕获到错误。</p><h4 id="2-处理同步错误和异步错误"><a href="#2-处理同步错误和异步错误" class="headerlink" title="2. 处理同步错误和异步错误"></a>2. <strong>处理同步错误和异步错误</strong></h4><p>你可以同时捕获同步错误和异步错误：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">riskyFunction</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;同步错误&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">asyncFunction</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&#x27;异步错误&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="title function_">riskyFunction</span>();  <span class="comment">// 捕获同步错误</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;同步错误:&#x27;</span>, error);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">handleAsync</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">asyncFunction</span>();  <span class="comment">// 捕获异步错误</span></span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;异步错误:&#x27;</span>, error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">handleAsync</span>();</span><br></pre></td></tr></table></figure><p>在这个例子中，<code>try...catch</code> 捕获了同步错误 <code>riskyFunction()</code> 中抛出的错误，而异步错误通过 <code>async/await</code> 和 <code>catch</code> 块捕获。</p><h4 id="3-使用-Promise-catch-处理异步错误"><a href="#3-使用-Promise-catch-处理异步错误" class="headerlink" title="3. 使用 Promise.catch() 处理异步错误"></a>3. <strong>使用 Promise.catch() 处理异步错误</strong></h4><p>如果没有使用 <code>async/await</code>，你可以通过 <code>.catch()</code> 来处理 <code>Promise</code> 错误：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">_, reject</span>) =&gt;</span> <span class="title function_">reject</span>(<span class="string">&#x27;Promise 错误&#x27;</span>))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;捕获到 Promise 错误:&#x27;</span>, error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>关键点：</p><ul><li><strong>同步代码</strong>：使用 <code>try...catch</code> 捕获同步代码中的错误。</li><li><strong>异步代码</strong>：使用 <code>Promise</code> 的 <code>.catch()</code> 或 <code>async/await</code> + <code>try...catch</code> 来捕获异步操作中的错误。</li></ul><p>总结：</p><ul><li><code>try...catch</code> 是用于捕获同步代码中的错误，<strong>与 Promise 的关系</strong>体现在异步代码处理上，特别是结合 <code>async/await</code> 使用时。</li><li>在异步代码中，<code>Promise</code> 会处理异步操作的错误，而 <code>try...catch</code> 用于捕获和处理同步操作的错误。</li><li>如果你在 <code>async</code> 函数中使用 <code>await</code>，你可以使用 <code>try...catch</code> 来捕获 <code>Promise</code> 被拒绝时的错误。</li></ul><h4 id="mysql2-promise-中的-Promise-功能"><a href="#mysql2-promise-中的-Promise-功能" class="headerlink" title="mysql2/promise 中的 Promise 功能"></a><strong>mysql2/promise 中的 Promise 功能</strong></h4><ol><li><strong>mysql2 库简介</strong>：<ul><li><code>mysql2</code> 是一个高性能、轻量级的 Node.js MySQL 客户端库，支持回调和 <code>Promise</code>。</li><li><code>mysql2/promise</code> 是 <code>mysql2</code> 的一个子模块，专门提供 <strong>Promise API</strong>。</li></ul></li><li><strong>为什么用 Promise？</strong><ul><li>数据库查询是异步操作，传统上用回调处理，可能导致「回调地狱」。</li><li><code>Promise</code> 或 <code>async/await</code> 的方式使代码更简洁、易读，且错误处理更方便。</li></ul></li><li><strong>作用</strong>：<ul><li>将数据库操作封装为 <code>Promise</code> 对象，使查询结果可以通过 <code>.then()</code> 或 <code>await</code> 获取。</li><li>如果数据库操作失败，返回一个被拒绝的 <code>Promise</code>，可以用 <code>.catch()</code> 或 <code>try...catch</code> 捕获错误。</li></ul></li></ol><hr><h3 id="代码解析"><a href="#代码解析" class="headerlink" title="代码解析"></a><strong>代码解析</strong></h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;mysql2/promise&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> db = mysql.<span class="title function_">createPool</span>(&#123;</span><br><span class="line">  <span class="attr">host</span>: <span class="string">&#x27;localhost&#x27;</span>,    <span class="comment">// 数据库地址</span></span><br><span class="line">  <span class="attr">user</span>: <span class="string">&#x27;root&#x27;</span>,         <span class="comment">// 数据库用户名</span></span><br><span class="line">  <span class="attr">password</span>: <span class="string">&#x27;admin123&#x27;</span>, <span class="comment">// 数据库密码</span></span><br><span class="line">  <span class="attr">database</span>: <span class="string">&#x27;shuangzhao_iooio&#x27;</span> <span class="comment">// 数据库名称</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = db;</span><br></pre></td></tr></table></figure><h4 id="具体含义："><a href="#具体含义：" class="headerlink" title="具体含义："></a><strong>具体含义：</strong></h4><ol><li><strong>require(‘mysql2/promise’)</strong>：<ul><li>导入 <code>mysql2</code> 的 <code>Promise API</code> 模块，所有数据库操作返回的结果都是 <code>Promise</code> 对象。</li></ul></li><li><strong>mysql.createPool()</strong>：<ul><li>创建一个连接池，允许多个数据库查询请求复用连接，提升性能。</li><li>返回一个连接池对象 <code>db</code>，这个对象中的方法（如 <code>db.query</code>）都是基于 <code>Promise</code> 的。</li></ul></li><li><strong>导出 db 对象</strong>：<ul><li>你可以在其他文件中引入这个模块，并使用 <code>async/await</code> 或 <code>.then()</code> 的方式进行数据库查询。</li></ul></li></ol><hr><h3 id="如何使用-Promise-的-API-操作数据库"><a href="#如何使用-Promise-的-API-操作数据库" class="headerlink" title="如何使用 Promise 的 API 操作数据库"></a><strong>如何使用 Promise 的 API 操作数据库</strong></h3><h4 id="使用-async-await："><a href="#使用-async-await：" class="headerlink" title="使用 async/await："></a>使用 <code>async/await</code>：</h4><p>这是最推荐的方式，代码更加简洁和直观。</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;./path_to_db_file&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getUsers</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> [rows, fields] = <span class="keyword">await</span> db.<span class="title function_">query</span>(<span class="string">&#x27;SELECT * FROM users&#x27;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;用户列表:&#x27;</span>, rows);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;查询失败:&#x27;</span>, error.<span class="property">message</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">getUsers</span>();</span><br></pre></td></tr></table></figure><h4 id="使用-then-和-catch："><a href="#使用-then-和-catch：" class="headerlink" title="使用 .then 和 .catch："></a>使用 <code>.then</code> 和 <code>.catch</code>：</h4><p>如果不想用 <code>async/await</code>，也可以用传统的 <code>Promise</code> 链。</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">const db <span class="operator">=</span> require(<span class="string">&#x27;./path_to_db_file&#x27;</span>);</span><br><span class="line"></span><br><span class="line">db.query(<span class="string">&#x27;SELECT * FROM users&#x27;</span>)</span><br><span class="line">  .<span class="keyword">then</span>(([<span class="keyword">rows</span>, fields]) <span class="operator">=</span><span class="operator">&gt;</span> &#123;</span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">&#x27;用户列表:&#x27;</span>, <span class="keyword">rows</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(error <span class="operator">=</span><span class="operator">&gt;</span> &#123;</span><br><span class="line">    console.error(<span class="string">&#x27;查询失败:&#x27;</span>, error.message);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><hr><h3 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a><strong>错误处理</strong></h3><p>无论是用 <code>async/await</code> 还是 <code>.then/.catch</code>，都可以捕获查询过程中的错误。例如：</p><ol><li><strong>数据库连接失败</strong>：如果连接信息（如 <code>host</code>、<code>user</code>、<code>password</code>）不正确，<code>Promise</code> 会被拒绝。</li><li><strong>SQL 查询语法错误</strong>：如果执行的 SQL 查询有语法错误，也会触发错误。</li></ol><h4 id="示例："><a href="#示例：" class="headerlink" title="示例："></a>示例：</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">faultyQuery</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> [result] = <span class="keyword">await</span> db.<span class="title function_">query</span>(<span class="string">&#x27;SELECT * FORM invalid_table&#x27;</span>); <span class="comment">// SQL 错误</span></span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;查询出错:&#x27;</span>, error.<span class="property">message</span>); <span class="comment">// 捕获并打印错误</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">faultyQuery</span>();</span><br></pre></td></tr></table></figure><hr><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a><strong>总结</strong></h2><p>在 <code>mysql2/promise</code> 中：</p><ul><li><code>Promise</code> 让异步数据库操作更加简洁。</li><li>通过 <code>async/await</code> 或 <code>.then/.catch</code> 获取查询结果或处理错误。</li><li>你的代码中 <code>mysql2/promise</code> 返回的是基于 <code>Promise</code> 的连接池对象 <code>db</code>，后续所有操作都会利用 <code>Promise</code> 的特性进行处理。</li></ul><p>这是现代化异步编程的标准方式，非常适合需要频繁与数据库交互的场景。</p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>移植安知鱼中控台</title>
      <link href="/posts/2d02f8e2/"/>
      <url>/posts/2d02f8e2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><h2 id="1-准备"><a href="#1-准备" class="headerlink" title="1.准备"></a>1.准备</h2><ol><li><p>theme/butterfly/layout/includes/anzhiyu/console.pug</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#console</span><br><span class="line">  .console-card-group-reward</span><br><span class="line">    ul.reward-all.console-card</span><br><span class="line">      each item in theme.reward.QR_code</span><br><span class="line">        li.reward-item</span><br><span class="line">          a(href=url_for(item.link || item.img), target=&#x27;_blank&#x27;)</span><br><span class="line">            img.post-qr-code-img(alt=item.text, src=url_for(item.img))</span><br><span class="line">          .post-qr-code-desc=item.text</span><br><span class="line">  .console-card-group</span><br><span class="line">    .console-card-group-left</span><br><span class="line">      !=partial(&#x27;includes/widget/card_newest_comment&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">    .console-card-group-right</span><br><span class="line">      .console-card.tags</span><br><span class="line">        .card-content</span><br><span class="line">          if theme.nav_music.enable &amp;&amp; theme.nav_music.console_widescreen_music</span><br><span class="line">            .author-content-item-tips 音乐</span><br><span class="line">            span.author-content-item-title 灵魂的碰撞💥</span><br><span class="line">          else </span><br><span class="line">            .author-content-item-tips 兴趣点</span><br><span class="line">            span.author-content-item-title 寻找你感兴趣的领域</span><br><span class="line">            !=partial(&#x27;includes/widget/card_console_tags&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      .console-card.history</span><br><span class="line">        .item-headline</span><br><span class="line">          i.anzhiyufont.anzhiyu-icon-box-archiv</span><br><span class="line">          span 文章</span><br><span class="line">        !=partial(&#x27;includes/widget/card_console_archives&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">  .button-group</span><br><span class="line">    if theme.darkmode.enable</span><br><span class="line">      .console-btn-item</span><br><span class="line">        a.darkmode_switchbutton(title=&#x27;显示模式切换&#x27;, href=&#x27;javascript:void(0);&#x27;)</span><br><span class="line">          i.anzhiyufont.anzhiyu-icon-moon</span><br><span class="line">    .console-btn-item#consoleHideAside(onclick=&#x27;anzhiyu.hideAsideBtn()&#x27;, title=&#x27;边栏显示控制&#x27;)</span><br><span class="line">      a.asideSwitch</span><br><span class="line">        i.anzhiyufont.anzhiyu-icon-arrows-left-right</span><br><span class="line">    if theme.comment_barrage_config.enable</span><br><span class="line">      .console-btn-item.on#consoleCommentBarrage(onclick=&#x27;anzhiyu.switchCommentBarrage()&#x27;, title=&#x27;热评开关&#x27;)</span><br><span class="line">        a.commentBarrage</span><br><span class="line">          i.anzhiyufont.anzhiyu-icon-message</span><br><span class="line">    if theme.nav_music.enable</span><br><span class="line">      .console-btn-item#consoleMusic(onclick=&#x27;anzhiyu.musicToggle()&#x27;, title=&#x27;音乐开关&#x27;)</span><br><span class="line">        a.music-switch</span><br><span class="line">          i.anzhiyufont.anzhiyu-icon-music</span><br><span class="line">    if theme.shortcutKey.enable</span><br><span class="line">      .console-btn-item#consoleKeyboard(onclick=&#x27;anzhiyu.keyboardToggle()&#x27;, title=&#x27;快捷键开关&#x27;)</span><br><span class="line">        a.keyboard-switch</span><br><span class="line">          i.anzhiyufont.anzhiyu-icon-keyboard</span><br><span class="line">  .console-mask(onclick=&#x27;anzhiyu.hideConsole()&#x27;, href=&#x27;javascript:void(0);&#x27;)</span><br></pre></td></tr></table></figure></li></ol><p>其中：第11行的引用，经对比，完全等价于 </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">!=partial(&#x27;includes/widget/card_tags&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br></pre></td></tr></table></figure><ol><li><p>css 样式</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#console</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100vw</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.3s</span> ease-out, color <span class="number">0s</span>;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#console-music-bg</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#console</span><span class="selector-class">.show</span>,</span><br><span class="line"><span class="selector-id">#console</span><span class="selector-class">.reward-show</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">pointer-events</span>: all;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#console</span><span class="selector-class">.reward-show</span> <span class="selector-class">.console-card-group</span> &#123;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#console</span> <span class="selector-class">.console-card-group</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">20px</span>);</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.3s</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">80%</span>;</span><br><span class="line">  <span class="attribute">max-height</span>: <span class="number">70%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#console</span><span class="selector-class">.show</span> <span class="selector-class">.console-card-group</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0px</span>);</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">transition-delay</span>: <span class="number">0.1s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#console</span> <span class="selector-class">.console-card-group-left</span> &#123;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">0.5rem</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">40%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#console</span> <span class="selector-class">.console-card-group-right</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">60%</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">min-width</span>: <span class="number">575px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#console</span> <span class="selector-class">.console-card</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--card-bg);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">border</span>: <span class="built_in">var</span>(--style-border);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--anzhiyu-shadow-border);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">40px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#console</span> <span class="selector-class">.console-card</span><span class="selector-class">.tags</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">172px</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#console</span> <span class="selector-class">.console-mask</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-maskbgdeep);</span><br><span class="line">  backdrop-<span class="attribute">filter</span>: <span class="built_in">saturate</span>(<span class="number">100%</span>) <span class="built_in">blur</span>(<span class="number">0px</span>);</span><br><span class="line">  -webkit-backdrop-<span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="number">0px</span>);</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100vw</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">z-index</span>: -<span class="number">1</span>;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.3s</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0px</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#console</span><span class="selector-class">.show</span> <span class="selector-class">.console-mask</span>,</span><br><span class="line"><span class="selector-id">#console</span><span class="selector-class">.reward-show</span> <span class="selector-class">.console-mask</span> &#123;</span><br><span class="line">  backdrop-<span class="attribute">filter</span>: <span class="built_in">saturate</span>(<span class="number">180%</span>) <span class="built_in">blur</span>(<span class="number">20px</span>);</span><br><span class="line">  -webkit-backdrop-<span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="number">20px</span>);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateZ</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#center-console</span><span class="selector-pseudo">:checked</span> + <span class="selector-tag">label</span> &#123;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0.5rem</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">31</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#center-console</span><span class="selector-pseudo">:checked</span> + <span class="selector-tag">label</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-main) <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#center-console</span><span class="selector-pseudo">:checked</span> + <span class="selector-tag">label</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">35px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">35px</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">z-index</span>: -<span class="number">1</span>;</span><br><span class="line">  <span class="attribute">top</span>: -<span class="number">6px</span>;</span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">6.3px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-fontcolor) <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#center-console</span><span class="selector-pseudo">:checked</span> + <span class="selector-tag">label</span><span class="selector-pseudo">:is</span>(<span class="selector-class">.widget</span>,</span><br><span class="line"><span class="selector-id">#center-console</span><span class="selector-pseudo">:checked</span> + <span class="selector-tag">label</span> <span class="selector-class">.widget</span><span class="selector-pseudo">:hover</span>) <span class="selector-tag">i</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--icon-size) / <span class="number">4.5</span>);</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-white) <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#center-console</span><span class="selector-pseudo">:checked</span> + <span class="selector-tag">label</span> <span class="selector-tag">i</span><span class="selector-class">.left</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">  -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">45deg</span>) <span class="meta">!important</span>;</span><br><span class="line">  -moz-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">45deg</span>) <span class="meta">!important</span>;</span><br><span class="line">  -o-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">45deg</span>) <span class="meta">!important</span>;</span><br><span class="line">  -ms-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">45deg</span>) <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">45deg</span>) <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#center-console</span><span class="selector-pseudo">:checked</span> + <span class="selector-tag">label</span> <span class="selector-tag">i</span><span class="selector-class">.center</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#center-console</span><span class="selector-pseudo">:checked</span> + <span class="selector-tag">label</span> <span class="selector-tag">i</span><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">  -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>) <span class="meta">!important</span>;</span><br><span class="line">  -moz-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>) <span class="meta">!important</span>;</span><br><span class="line">  -o-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>) <span class="meta">!important</span>;</span><br><span class="line">  -ms-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>) <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>) <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#center-console</span><span class="selector-pseudo">:checked</span> + <span class="selector-tag">label</span><span class="selector-pseudo">:is</span>(<span class="selector-class">.widget</span>,</span><br><span class="line"><span class="selector-id">#center-console</span><span class="selector-pseudo">:checked</span> + <span class="selector-tag">label</span> <span class="selector-class">.widget</span><span class="selector-pseudo">:hover</span>) <span class="selector-tag">i</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-black) <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>themes\butterfly\layout\includes\header\nav.pug 中，增加一个启用控制台的图标</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if theme.centerConsole.enable</span><br><span class="line">        input#center-console(type=&quot;checkbox&quot;)</span><br><span class="line">        label.widget(for=&quot;center-console&quot; title=_p(&quot;中控台&quot;) onclick=&quot;anzhiyu.switchConsole();&quot;)</span><br><span class="line">          i.left</span><br><span class="line">          i.widget.center</span><br><span class="line">          i.widget.right</span><br><span class="line"></span><br><span class="line">      !=partial(&#x27;includes/anzhiyu/console&#x27;, &#123;&#125;, &#123;cache:true&#125;)</span><br></pre></td></tr></table></figure></li></ol><details class="folding-tag" ><summary> 以上代码解读 - 点击查看详情 </summary>              <div class='content'>              <h3 id="逐行解读"><a href="#逐行解读" class="headerlink" title="逐行解读"></a><strong>逐行解读</strong></h3><h4 id="1-if-theme-centerConsole-enable"><a href="#1-if-theme-centerConsole-enable" class="headerlink" title="1. if theme.centerConsole.enable"></a><strong>1. if theme.centerConsole.enable</strong></h4><ul><li><p>功能</p><p>：</p><ul><li>检查 <code>theme.centerConsole.enable</code> 是否启用（布尔值）。</li><li>如果此配置项为 <code>true</code>，则渲染以下内容；否则，跳过该部分代码。</li></ul></li><li><p>上下文</p><p>：</p><ul><li><code>theme.centerConsole</code> 是在主题配置文件（如 <code>_config.yml</code>）中定义的选项，用于控制是否显示 “中控台” 功能。</li></ul></li></ul><hr><h4 id="2-input-center-console-type-”checkbox”"><a href="#2-input-center-console-type-”checkbox”" class="headerlink" title="2. input#center-console(type=”checkbox”)"></a><strong>2. input#center-console(type=”checkbox”)</strong></h4><ul><li><p>功能</p><p>：</p><ul><li>创建一个 HTML <code>&lt;input&gt;</code> 元素，类型为 <code>checkbox</code>，并为其指定了 <code>id=&quot;center-console&quot;</code>。</li></ul></li><li><p>作用</p><p>：</p><ul><li>该复选框可能用于显示或控制 “中控台” 的状态（如激活或禁用）。</li><li>在用户勾选或取消勾选时，浏览器会自动更改复选框的状态。</li></ul></li></ul><hr><h4 id="3-label-widget-for-”center-console”-title-p-“中控台”-onclick-”anzhiyu-switchConsole-”"><a href="#3-label-widget-for-”center-console”-title-p-“中控台”-onclick-”anzhiyu-switchConsole-”" class="headerlink" title="3. label.widget(for=”center-console” title=_p(“中控台”) onclick=”anzhiyu.switchConsole();”)"></a><strong>3. label.widget(for=”center-console” title=_p(“中控台”) onclick=”anzhiyu.switchConsole();”)</strong></h4><ul><li><p><strong>功能</strong>：</p><ul><li>创建一个 <code>&lt;label&gt;</code> 元素，关联到上方的复选框（通过 <code>for=&quot;center-console&quot;</code> 属性）。</li><li>标签的 <code>title</code> 属性通过 <code>_p(&quot;中控台&quot;)</code> 动态获取多语言翻译后的 “中控台” 文本。</li><li>当用户点击该标签时，会触发 <code>onclick</code> 中定义的 <code>anzhiyu.switchConsole()</code> 方法。</li></ul></li><li><p><strong>关键点</strong>：</p><ul><li><p><code>for=&quot;center-console&quot;</code></p><p>：</p><ul><li>绑定到复选框 <code>id=&quot;center-console&quot;</code>。</li><li>用户点击该标签时，相当于点击复选框本身。</li></ul></li><li><p><code>title=_p(&quot;中控台&quot;)</code></p><p>：</p><ul><li><code>_p</code> 是主题中用于多语言翻译的函数，通常从语言文件（如 <code>zh-Hans.yml</code>）中获取对应的翻译文本。</li></ul></li><li><p><code>onclick=&quot;anzhiyu.switchConsole();&quot;</code></p><p>：</p><ul><li>绑定了 JavaScript 方法 <code>anzhiyu.switchConsole()</code>，点击时触发 “中控台” 的切换功能。</li></ul></li></ul></li></ul>              </div>            </details><h2 id="2-然后"><a href="#2-然后" class="headerlink" title="2.然后"></a>2.然后</h2><ol><li><p>themes\butterfly\source\js\main.js 中</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> consoleEl = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;console&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> iooio = &#123;</span><br><span class="line">  <span class="comment">// 显示中控台</span></span><br><span class="line">  <span class="attr">showConsole</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    consoleEl.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;show&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//隐藏中控台</span></span><br><span class="line">  <span class="attr">hideConsole</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (consoleEl.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&quot;show&quot;</span>)) &#123;</span><br><span class="line">      <span class="comment">// 如果是一般控制台，就关闭一般控制台</span></span><br><span class="line">      consoleEl.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;show&quot;</span>);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">// 获取center-console元素</span></span><br><span class="line">    <span class="keyword">const</span> centerConsole = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;center-console&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查center-console是否被选中</span></span><br><span class="line">    <span class="keyword">if</span> (centerConsole.<span class="property">checked</span>) &#123;</span><br><span class="line">      <span class="comment">// 取消选中状态</span></span><br><span class="line">      centerConsole.<span class="property">checked</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​</p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>双招项目后端api全过程实现</title>
      <link href="/posts/629f32c0/"/>
      <url>/posts/629f32c0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><div class="note blue no-icon flat"><p>双招项目后端api全过程实现系列</p><ol><li>双招项目后端api全过程实现（一）- 登录&amp;任务模块  ⇦当前位置🪂</li><li><a href="/posts/1432cf2a">双招项目后端api全过程实现（二）- 合约模块</a> </li><li>双招项目后端api全过程实现（三）- 消息模块</li><li>双招项目后端api全过程实现（四）- 我的个人中心模块</li></ol></div><h2 id="1-初始化"><a href="#1-初始化" class="headerlink" title="1.初始化"></a>1.初始化</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p><strong>1.1创建项目：</strong></p><ol><li><p>新建 <code>api_server</code> 文件夹作为项目根目录，并在项目根目录中运行如下的命令，初始化包管理配置文件：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure></li><li><p>运行如下的命令，安装特定版本的 <code>express</code>：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pnpm i express@4.17.1</span><br></pre></td></tr></table></figure></li><li><p>在项目根目录中新建 <code>app.js</code> 作为整个项目的入口文件，并初始化如下的代码：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入 express 模块</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建 express 的服务器实例</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// write your code here...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用 app.listen 方法，指定端口号并启动web服务器</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3007</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;api server running at http://127.0.0.1:3007&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ol><p><strong>1.2配置 cors 跨域&amp;解析表单数据的中间件：</strong></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"># <span class="number">1.2</span><span class="number">.1</span>.首先安装</span><br><span class="line">pnpm i cors@<span class="number">2.8</span><span class="number">.5</span></span><br><span class="line"></span><br><span class="line">然后在 app.<span class="property">js</span> 中配置</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入 express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建 express 实例</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"># <span class="number">1.2</span><span class="number">.2</span>.配置 cors 跨域中间件</span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>())</span><br><span class="line"></span><br><span class="line"># <span class="number">1.2</span><span class="number">.3</span>.配置解析表单数据的中间件，仅能解析 application/x-www-form-urlencoded 类型的表单数据</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入并使用用户路由模块</span></span><br><span class="line"><span class="keyword">const</span> userRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/user&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, userRouter)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动服务器</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3007</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;服务器启动成功: http://127.0.0.1:3007&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><strong>1.3 初始化路由文件&amp;文件夹：</strong></p><ol><li><p>在项目根目录中，新建 <code>router</code> 文件夹，用来存放所有的<code>路由</code>模块</p><blockquote><p>路由模块中，只存放客户端的请求与处理函数之间的映射关系</p></blockquote></li><li><p>在项目根目录中，新建 <code>router_handler</code> 文件夹，用来存放所有的 <code>路由处理函数模块</code></p><blockquote><p>路由处理函数模块中，专门负责存放每个路由对应的处理函数</p></blockquote></li></ol><p><strong>1.4初始化路由模块：</strong></p><ol><li><p>在 <code>router</code> 文件夹中，新建 <code>user.js</code> 文件，作为用户的路由模块，并初始化代码如下：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入处理函数</span></span><br><span class="line"><span class="keyword">const</span> userHandler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/user&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册用户</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login/code&#x27;</span>, userHandler.<span class="property">regUser</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录接口</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>,userHandler.<span class="property">login</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure></li></ol><ol><li><p>初始化路由处理函数：<code>/api_server/router_handler/user.js</code></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 注册用户的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">regUser</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;reguser OK&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">login</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;login OK&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ol><li><p>在 <code>app.js</code> 中，导入并使用 <code>用户路由模块</code></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入并注册用户路由模块</span></span><br><span class="line"><span class="keyword">const</span> userRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/user&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, userRouter)</span><br></pre></td></tr></table></figure></li></ol>              </div>            </details><h2 id="2-创建-mysql-数据库"><a href="#2-创建-mysql-数据库" class="headerlink" title="2.创建 mysql 数据库"></a>2.创建 mysql 数据库</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>2.1 新建数据库&amp;表</p><p>在 MySQL Shell 中，你已经启动了交互式 Shell，所以不需要再次输入 <code>mysqlsh</code>进行启动。</p><p>下面是正确的步骤来连接到数据库：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">\sql</span><br><span class="line"></span><br><span class="line">// 端口号默认即为：3006</span><br><span class="line">\connect root@localhost</span><br><span class="line"></span><br><span class="line">// 输入密码后，即可以连接到数据库</span><br><span class="line"></span><br><span class="line">// 然后执行下面一行代码，创建数据库表</span><br><span class="line">CREATE DATABASE shuangzhao_iooio CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci</span><br><span class="line"></span><br><span class="line">其中：CHARACTER SET utf8mb4：指定数据库的字符集为 utf8mb4，支持完整的 Unicode，包括表情符号。</span><br><span class="line">COLLATE utf8mb4_general_ci：设置排序规则为不区分大小写的通用规则。</span><br><span class="line"></span><br><span class="line">// 然后设置默认数据库</span><br><span class="line">USE shuangzhao_iooio</span><br></pre></td></tr></table></figure><p>然后，根据项目要求创建数据库表；</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 创建用户信息表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY COMMENT <span class="string">&#x27;用户ID&#x27;</span>,</span><br><span class="line">    accounts <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户账号（手机号）&#x27;</span>,</span><br><span class="line">    user_name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户名&#x27;</span>,</span><br><span class="line">    sex TINYINT <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;性别（1: 男, 2: 女, 0: 未知）&#x27;</span>,</span><br><span class="line">    birthday <span class="type">DATE</span> COMMENT <span class="string">&#x27;出生日期&#x27;</span>,</span><br><span class="line">    pay_password <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;支付密码（加密存储）&#x27;</span>,</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;邮箱&#x27;</span>,</span><br><span class="line">    work_time <span class="type">DATE</span> COMMENT <span class="string">&#x27;参加工作时间&#x27;</span>,</span><br><span class="line">    head_img <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;头像URL&#x27;</span>,</span><br><span class="line">    idcard <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;身份证号码&#x27;</span>,</span><br><span class="line">    account_price <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;账户余额&#x27;</span>,</span><br><span class="line">    is_check TINYINT <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;审核状态（0: 未审核, 1: 已审核）&#x27;</span>,</span><br><span class="line">    it_enterprise TINYINT <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;是否为IT企业（1: 是, 0: 否）&#x27;</span>,</span><br><span class="line">    enterprise TINYINT <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;是否为企业用户（1: 是, 0: 否）&#x27;</span>,</span><br><span class="line">    manage TINYINT <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;是否为管理员（1: 是, 0: 否）&#x27;</span>,</span><br><span class="line">    token <span class="type">VARCHAR</span>(<span class="number">512</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;登录Token&#x27;</span>,</span><br><span class="line">    expire_time <span class="type">BIGINT</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;Token过期时间（时间戳）&#x27;</span>,</span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">    updated_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;更新时间&#x27;</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 COMMENT<span class="operator">=</span><span class="string">&#x27;用户信息表&#x27;</span>;</span><br></pre></td></tr></table></figure><ul><li>以上代码根据原始项目数据格式，由 chatgpt 快速生成，实际开发中需要做少许调整，例如增加 code 验证码，以及过期时间</li></ul><p>实际开发中，根据项目需求，需要对表结构进行修改，以下是增加 column 的方法示例</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tasklist </span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">COLUMN</span> head_img <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户头像链接地址&#x27;</span>;</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="3-为项目后端项目安装-mysql2-模块"><a href="#3-为项目后端项目安装-mysql2-模块" class="headerlink" title="3.为项目后端项目安装 mysql2 模块"></a>3.为项目后端项目安装 mysql2 模块</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <ol><li><p>执行以下命令，安装 mysql</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pnpm i mysql2</span><br></pre></td></tr></table></figure></li><li><p>在项目根目录中新建 <code>/db/index.js</code> 文件，在此自定义模块中创建数据库的连接对象：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入 mysql 模块</span></span><br><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;mysql2/promise&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建数据库连接对象</span></span><br><span class="line"><span class="keyword">const</span> db = mysql.<span class="title function_">createPool</span>(&#123;</span><br><span class="line">  <span class="attr">host</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">  <span class="attr">user</span>: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">  <span class="attr">password</span>: <span class="string">&#x27;admin123&#x27;</span>,</span><br><span class="line">  <span class="attr">database</span>: <span class="string">&#x27;shuangzhao_iooio&#x27;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向外共享 db 数据库连接对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = db</span><br></pre></td></tr></table></figure></li><li><p>这里需要特别注意，将来在查询数据库时，返回的结果较之前 mysql 有重大改变：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// mysql 响应结果</span></span><br><span class="line">[</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>, <span class="attr">accounts</span>: <span class="string">&#x27;abc123&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;Bob&#x27;</span>, <span class="attr">accounts</span>: <span class="string">&#x27;xyz456&#x27;</span> &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// mysql2 响应结果</span></span><br><span class="line">[</span><br><span class="line">    <span class="comment">// 查询结果：</span></span><br><span class="line">  [</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>, <span class="attr">accounts</span>: <span class="string">&#x27;abc123&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;Bob&#x27;</span>, <span class="attr">accounts</span>: <span class="string">&#x27;xyz456&#x27;</span> &#125;</span><br><span class="line">  ],</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 查询字段元数据：</span></span><br><span class="line">  [</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">&#x27;id&#x27;</span>, <span class="attr">type</span>: <span class="string">&#x27;int&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">&#x27;name&#x27;</span>, <span class="attr">type</span>: <span class="string">&#x27;varchar&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">&#x27;accounts&#x27;</span>, <span class="attr">type</span>: <span class="string">&#x27;varchar&#x27;</span> &#125;</span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 由此可以看出，想像 mysql 那时直接使用查询数据库返回的数据，那是不可能滴</span></span><br><span class="line"><span class="comment">// 在 mysql2 中，需要使用 const [results] = await db.query(sql, [id])  进行解构</span></span><br><span class="line"><span class="comment">//进而，拿到返回数组中的第一个响应结果，即查询结果</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol>              </div>            </details><h2 id="4-登录模块"><a href="#4-登录模块" class="headerlink" title="4.登录模块"></a>4.登录模块</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>1.发送验证码&amp;登录逻辑</p><p>路由处理函数：<code>/api_server/router_handler/user.js</code></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 在这里定义和用户相关的路由处理函数，供 /router/user.js 模块进行调用</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入数据库操作模块</span></span><br><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../db/index&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入 bcryptjs 加密模块</span></span><br><span class="line"><span class="keyword">const</span> bcrypt = <span class="built_in">require</span>(<span class="string">&#x27;bcryptjs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入生成 Token 的方法</span></span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入配置文件</span></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">&#x27;../config&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成随机验证码</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">generateCode</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="number">100000</span> + <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">900000</span>).<span class="title function_">toString</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">regUser</span> = <span class="keyword">async</span> (<span class="params">req, res</span>) =&gt; &#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="comment">// 获取客户端提交的数据</span></span><br><span class="line">  <span class="keyword">const</span> userInfo = req.<span class="property">body</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// if (!userInfo.accounts) &#123;</span></span><br><span class="line">  <span class="comment">//   // return res.send(&#123; status: 1, message: &#x27;手机号码不能为空！&#x27; &#125;);</span></span><br><span class="line">  <span class="comment">//   return res.cc(&#x27;手机号不能为空&#x27;,1)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> code = <span class="title function_">generateCode</span>() <span class="comment">// 生成 6 位随机验证码</span></span><br><span class="line">  <span class="keyword">const</span> codeExpiresAt = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>() + <span class="number">5</span> * <span class="number">60</span> * <span class="number">1000</span>) <span class="comment">// 验证码有效期 5 分钟</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> codeBcrypt = bcrypt.<span class="title function_">hashSync</span>(code, <span class="number">10</span>) <span class="comment">// 对验证码进行加密处理</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 查询是否存在相同手机号码的用户</span></span><br><span class="line">  <span class="keyword">const</span> sqlStr = <span class="string">&#x27;SELECT * FROM users WHERE accounts = ?&#x27;</span></span><br><span class="line">  <span class="keyword">const</span> rows = <span class="keyword">await</span> db.<span class="title function_">query</span>(sqlStr, userInfo.<span class="property">accounts</span>) <span class="comment">// 参数数组必须使用 [], 只有一个参数时可以省略</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 查询语句得到的是一个数组，如果数组长度大于 0，说明用户已存在</span></span><br><span class="line">  <span class="keyword">if</span> (rows.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// 如果用户已存在，更新验证码和过期时间</span></span><br><span class="line">    <span class="keyword">const</span> updateSql = <span class="string">&#x27;UPDATE users SET code = ?, code_expires_at = ? WHERE accounts = ?&#x27;</span></span><br><span class="line">    <span class="keyword">await</span> db.<span class="title function_">query</span>(updateSql, [codeBcrypt, codeExpiresAt, userInfo.<span class="property">accounts</span>])</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果用户不存在，插入新用户记录</span></span><br><span class="line">    <span class="keyword">const</span> insertSql = <span class="string">&#x27;INSERT INTO users (accounts, code, code_expires_at) VALUES (?, ?, ?)&#x27;</span></span><br><span class="line">    <span class="keyword">await</span> db.<span class="title function_">query</span>(insertSql, [userInfo.<span class="property">accounts</span>, codeBcrypt, codeExpiresAt])</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 返回验证码（开发阶段用，生产环境中不要返回验证码）</span></span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">code</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="attr">success</span>: <span class="string">&#x27;验证码已生成&#x27;</span>,</span><br><span class="line">    <span class="attr">result</span>: &#123;</span><br><span class="line">      <span class="attr">code</span>: code</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  <span class="comment">// res.status(500).send(&#123; status: 1, message: &#x27;服务器内部错误&#x27; &#125;);</span></span><br><span class="line">  res.<span class="title function_">cc</span>(error,<span class="number">500</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录的处理函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">login</span> = <span class="keyword">async</span> (<span class="params">req, res</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> userInfo = req.<span class="property">body</span> <span class="comment">// 获取用户提交的数据</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;userInfo:&#x27;</span>, userInfo)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. 验证输入</span></span><br><span class="line">    <span class="keyword">if</span> (!userInfo.<span class="property">code</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&quot;验证码不能为空！&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. 查询用户信息</span></span><br><span class="line">    <span class="keyword">const</span> sqlStr = <span class="string">&quot;SELECT * FROM users WHERE accounts = ?&quot;</span></span><br><span class="line">    <span class="keyword">const</span> [results] = <span class="keyword">await</span> db.<span class="title function_">query</span>(sqlStr, [userInfo.<span class="property">accounts</span>]) <span class="comment">// 确保 `db.query` 返回一个 Promise</span></span><br><span class="line">    <span class="keyword">if</span> (results.<span class="property">length</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&quot;没有查到用户信息！&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> user = results[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. 检查验证码是否正确</span></span><br><span class="line">    <span class="keyword">const</span> compareResult = bcrypt.<span class="title function_">compareSync</span>(userInfo.<span class="property">code</span>, user.<span class="property">code</span>)</span><br><span class="line">    <span class="keyword">if</span> (!compareResult) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&quot;验证码错误！&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. 检查验证码是否过期</span></span><br><span class="line">    <span class="keyword">const</span> now = <span class="title class_">Date</span>.<span class="title function_">now</span>()</span><br><span class="line">    <span class="keyword">if</span> (now &gt; user.<span class="property">code_expires_at</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&quot;验证码已过期，请重新获取！&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 生成 Token 字符串</span></span><br><span class="line">    user = &#123;...results[<span class="number">0</span>], <span class="attr">code</span>: <span class="string">&#x27;你猜&#x27;</span>, <span class="attr">code_expires_at</span>: <span class="string">&#x27;你猜&#x27;</span>, <span class="attr">head_img</span>: <span class="string">&#x27;你猜&#x27;</span>&#125;</span><br><span class="line">    <span class="comment">// 对信息加密</span></span><br><span class="line">    <span class="keyword">const</span> tokenStr = jwt.<span class="title function_">sign</span>(user, config.<span class="property">jwtSecretKey</span>, &#123; <span class="attr">expiresIn</span>: <span class="string">&#x27;30d&#x27;</span> &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5. 登录成功</span></span><br><span class="line">    res.<span class="title function_">send</span>(&#123;</span><br><span class="line">      <span class="attr">code</span>: <span class="number">200</span>,</span><br><span class="line">      <span class="attr">success</span>: <span class="string">&quot;ok&quot;</span>,</span><br><span class="line">      <span class="attr">result</span>: &#123;</span><br><span class="line">        <span class="attr">errCode</span>: <span class="number">200</span>,</span><br><span class="line">        <span class="attr">msg</span>: <span class="string">&quot;登录成功&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: &#123;</span><br><span class="line">          <span class="attr">user_info</span>: &#123;</span><br><span class="line">            <span class="attr">accounts</span>: user.<span class="property">accounts</span>,</span><br><span class="line">            <span class="attr">id</span>: user.<span class="property">id</span>,</span><br><span class="line">            <span class="attr">user_name</span>: user.<span class="property">user_name</span>,</span><br><span class="line">            <span class="attr">sex</span>: user.<span class="property">sex</span>,</span><br><span class="line">            <span class="attr">birthday</span>: user.<span class="property">birthday</span>,</span><br><span class="line">            <span class="attr">pay_password</span>: user.<span class="property">pay_password</span>,</span><br><span class="line">            <span class="attr">email</span>: user.<span class="property">email</span>,</span><br><span class="line">            <span class="attr">work_time</span>: user.<span class="property">work_time</span>,</span><br><span class="line">            <span class="attr">head_img</span>: user.<span class="property">head_img</span>,</span><br><span class="line">            <span class="attr">idcard</span>: user.<span class="property">idcard</span>,</span><br><span class="line">            <span class="attr">account_price</span>: user.<span class="property">account_price</span>,</span><br><span class="line">            <span class="attr">is_check</span>: user.<span class="property">is_check</span>,</span><br><span class="line">            <span class="attr">it_enterprise</span>: user.<span class="property">it_enterprise</span>,</span><br><span class="line">            <span class="attr">enterprise</span>: user.<span class="property">enterprise</span>,</span><br><span class="line">            <span class="attr">manage</span>: user.<span class="property">manage</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">token</span>: <span class="string">&quot;Bearer &quot;</span> + tokenStr,</span><br><span class="line">          <span class="attr">expireTime</span>: <span class="title class_">Date</span>.<span class="title function_">now</span>() + <span class="number">7</span> * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 7 天后的时间戳</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="comment">// 捕获异常</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(error)</span><br><span class="line">    res.<span class="title function_">cc</span>(<span class="string">&quot;服务器内部错误！&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123; regUser, login &#125;</span><br></pre></td></tr></table></figure><p>2.登录验证</p><p>3.阅读协议</p><ol><li>首先，创建数据库表</li></ol><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> protocols (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">    title <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    content TEXT,</span><br><span class="line">    isdelete TINYINT <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">    create_time DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    update_time DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    sort <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">    type <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入测试数据</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> protocols (title, content, isdelete, sort, type)</span><br><span class="line"><span class="keyword">VALUES</span> </span><br><span class="line">(<span class="string">&#x27;《用户协议》&#x27;</span>, <span class="string">&#x27;尊敬的用户：</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">在您成为IT企业服务注册用户，使用IT企业服务提供的服务之前，请您认真阅读IT企业服务《用户协议》（以下简称“协议”），更好地了解我们所提供的服务以及您享有的权利和承担的义务。您一旦开始使用IT企业服务服务，即表示您已经确认并接受了本文件中的全部条款。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">本协议系由您（以下简称“用户”或“您”）与北京北京驻场无忧科技有限公司（以下简称“IT企业服务”或“我们”）就IT企业服务公司提供的IT企业服务软件（以下简称“本平台”或“IT企业服务”）所订立的相关权利义务规范。请您在注册、使用IT企业服务之前，认真阅读以下条款。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">（温馨提示：为了您的合法权益不受损害，平台建议您在使用IT企业服务找工作前，仔细阅读《安全求职指南》，谨防各类求职陷阱。）</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">一、注册条款的接受</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">一旦您在注册页面点击或勾选“阅读并同意接受用户协议及隐私政策”相关内容后，即表示您已经阅读并且同意与IT企业服务公司达成协议，成为IT企业服务的用户，并接受本协议中的全部注册条款以及IT企业服务《隐私政策》和本平台内公布的其他专项协议或规则，包括但不限于IT企业服务《职位信息发布规则》《IT企业服务增值服务协议》（以下简称“本平台规则”）的所有条款的约束。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">二、用户注册条件</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. 申请注册成为IT企业服务的用户应同时满足下列全部条件：在注册之日以及此后使用IT企业服务服务期间必须以招聘和/或求职为目的；在注册之日必须年满16周岁以上。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. 为了更好地享有IT企业服务网络信息发布平台服务，用户应遵守IT企业服务注册机制的要求，向IT企业服务提供本人真实、准确、最新及完整的资料；如注册并认证成为招聘用户，应保证及时更新本人提供的“单位名称、职务或岗位信息、企业邮箱”等相关授权信息及材料，并确保前述授权的真实性；用户应保证其职务行为，包括但不限于发布招聘信息、与求职者沟通等均在使用本平台期间持续有效；通过认证的用户应保持其招聘账号与对应的授权单位具有唯一性。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3. 若用户提供任何错误、不实或不完整的资料，或IT企业服务有理由怀疑资料为错误、不实或不完整及违反用户注册条款的，或IT企业服务有理由怀疑其用户资料、言行等有悖于“严肃纯净的招聘APP”主题或违反《IT企业服务职位信息发布规则》的，IT企业服务有权修改用户的注册昵称、个人说明、发布的信息等，或暂停或终止该用户使用其账号，或暂停或终止提供IT企业服务提供的全部或部分服务。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">4. 若用户故意提供虚假的身份信息、公司信息进行注册，发布虚假招聘信息或者求职信息的，视为严重违反本协议，IT企业服务有权暂停或终止该用户账号并停止提供服务。虚假注册、发布虚假信息给IT企业服务造成经济、名誉等任何损失的，IT企业服务将追究该用户的法律责任。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">三、用户账号安全</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. 用户的账号遭到未获授权的使用，或者发生其他任何安全问题时，用户应立即通知IT企业服务。由于用户使用不当或者其他非因IT企业服务导致的账号、密码泄漏，进而导致其资料、信息泄漏的，由用户承担其不利后果。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. IT企业服务账号的所有权归IT企业服务公司所有，用户完成账号注册程序后，获得IT企业服务账号的使用权，且该使用权仅属于账号初始注册人。同时，用户不得赠与、借用、租用、转让或售卖IT企业服务账号或者以其他方式许可他人使用IT企业服务账号。其他人不得通过受赠、继承、承租、受让或者其他任何方式使用IT企业服务账号。如果我们发现或者有合理理由认为账号使用者并非账号初始注册人，为保障账号安全，我们有权立即暂停或终止向该注册账号提供服务，并有权永久禁用该账号。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3. 用户不得将账号主动告知第三方或提供给第三方进行使用，例如提供给第三方进行代为购买IT企业服务服务等。如因此造成其他用户隐私泄露或经济损失以及本平台损失的，用户应当承担全部责任。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">四、服务说明</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. 基于风控策略/安全风险/产品政策等的需要，IT企业服务可能要求部分用户补充提供材料（包括但不限于企业资质证明、承诺书、业务协议等），具体要求会在相关页面上做明确展示。如用户拒绝提供前述材料，IT企业服务有权视情况暂停或终止向该用户提供部分或全部服务。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. 为落实《网络招聘服务管理规定》的核验更新义务，IT企业服务可能会不定期对部分用户的企业地址、招聘授权等相关信息进行真实性审查以及更新核验(目前，该审核机制包括“环境认证”和“线下审核”)。审查过程中，用户应配合 IT企业服务工作人员补充相关资料(包括但不限于营业执照、资质证书/相关业务协议、授权书、被授权人身份证信息、租赁协议/水电费记录等)，并允许 IT企业服务工作人员对其企业 LOGO、办公环境进行审查及拍照备案(具体要求见网页说明或“小秘书”通知)。若用户拒绝，IT企业服务将视情况决定是否恢复该用户使用账号，或者暂停或终止为该用户提供部分或全部的招聘、求职服务。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3. 对于利用IT企业服务进行非法活动，或其言行（无论线上或者线下的）背离IT企业服务严肃招聘目的的，IT企业服务将严肃处理，包括将其列入黑名单、将其被投诉的情形公之于众、删除用户账号等处罚措施，给IT企业服务造成经济或者名誉等任何损失的，IT企业服务将追究其法律责任。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">4. IT企业服务有权通过拨打电话、发送短信或电子邮件等方式，告知用户IT企业服务服务相关的广告信息、促销等营销信息，以及邀请用户参与版本测试、用户体验反馈、回访等活动。除系统通知或重要信息外，用户可以通过IT企业服务提供的方式选择不接收上述信息。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">5. 为提高IT企业服务用户求职招聘的成功率和效率，IT企业服务公司可能会将IT企业服务用户的信息公开展示范围扩大至我们的第三方合作平台，因此，您在使用IT企业服务时，可能还会收到来自IT企业服务合作的其他平台上的注册用户向您开聊、联系电话、视频面试邀请等相关信息。在此期间，您可通过IT企业服务《隐私政策》了解我们如何保障您的个人信息的安全。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">6. 用户应通过本平台使用相关服务，未经许可，不得通过其他第三方工具或运营平台获取IT企业服务服务，包括但不限于通过第三方软件登录IT企业服务账号、发布职位、浏览职位、收发简历等。如因用户使用第三方软件导致相关信息泄漏的，IT企业服务不承担任何责任，且用户还应承担由此给IT企业服务造成的损失。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">五、有限责任条款</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. IT企业服务公司将尽力为用户提供提供安全、及时、准确、高质量的服务，但不保证一定能满足用户的要求和期望，也不保证服务不会中断，对服务的及时性、安全性、准确性都不作保证。除非另有约定，否则用户因无法使用IT企业服务服务，或使用服务未达到心理预期的，IT企业服务不承担责任。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. 对于用户通过IT企业服务公司提供的服务传送的内容，IT企业服务会尽合理努力按照国家有关规定严格审查，但无法完全控制经由软件/网站服务传送的内容，不保证内容的正确性、完整性或品质。因此用户在使用IT企业服务服务时，可能会接触到令人不快、不适当或令人厌恶的内容。在任何情况下，IT企业服务均不为用户经由软件/网站服务以张贴、发送电子邮件或其它方式传送的任何内容负责。但IT企业服务有权依法停止传输任何前述内容并采取相应行动，包括但不限于暂停用户使用软件/网站服务的全部或部分，保存有关记录，并根据国家法律法规、相关政策在必要时向有关机关报告并配合有关机关的行动。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3. 对于IT企业服务提供的各种第三方广告信息、链接、资讯等（如有），IT企业服务不保证其内容的正确性、合法性或可靠性，相关责任由广告主承担；并且，对于用户经由IT企业服务服务与广告主进行联系或商业往来，完全属于用户和广告主之间的行为，与IT企业服务无关。对于前述商业往来所产生的任何损害或损失，IT企业服务不承担任何责任。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">4. 对于用户上传的照片、资料、证件、视频、内容及图片等，IT企业服务已采用相关措施并已尽合理努力进行审核，但不保证其内容的正确性、合法性或可靠性，相关责任由上传上述内容的用户承担。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">5. 用户应对IT企业服务上的其他用户发布的内容自行加以判断，并承担因使用内容而引起的所有风险，包括但不限于因对内容的正确性、完整性或实用性的依赖而产生的风险。IT企业服务公司无法且不会对因前述风险而导致的任何损失或损害承担责任。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">6. 是否使用软件/网站服务下载或取得任何资料应由用户自行考虑并自负风险，因任何资料的下载而导致的用户电脑系统的任何损坏或数据丢失等后果，IT企业服务不承担任何责任。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">7. 对于IT企业服务公司在线上或线下策划、发起、组织或是承办的任何招聘相关的活动（包括但不限于收取费用以及完全公益的活动），IT企业服务不对上述招聘效果向用户作出任何保证或承诺，也不担保活动期间用户自身行为的合法性、合理性。由此产生的任何对于用户个人或者他人的人身或者是名誉以及其他损害，应由行为实施主体承担责任。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">8. 对于用户的投诉，IT企业服务将尽合理努力进行核实和处理，但不保证一定能满足投诉者的要求。IT企业服务有权决定是否向公众或向被投诉者公开投诉内容。对于投诉内容侵犯用户隐私权、名誉权等合法权益的，所有法律责任由投诉者承担，与IT企业服务无关。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">六、用户权利</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">     用户对于自己的个人信息享有以下权利：</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. 随时查询及请求阅览，但因极少数特殊情况（如被网站加入黑名单等）无法查询及提供阅览的除外；</span></span><br><span class="line"><span class="string">1. 随时查询及请求阅览，但因极少数特殊情况（如被网站加入黑名单等）无法查询及提供阅览的除外；</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. 随时请求补充或更正，但因极少数特殊情况（如网站或有关机关为司法程序保全证据等）无法补充或更正的除外；</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">七、用户应承诺其平台使用行为遵守以下规定</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. 本协议所称“平台使用”是指用户使用本平台服务所进行的任何行为，包括但不限于注册、登录、认证、查看开聊、账号管理、发布招聘信息、邀约面试以及其他通过IT企业服务账号在本平台所进行的一切行为。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. IT企业服务公司提醒用户在使用IT企业服务服务时，应遵守《中华人民共和国民法典》《中华人民共和国著作权法》《全国人民代表大会常务委员会关于维护互联网安全的决定》《中华人民共和国保守国家秘密法》《中华人民共和国电信条例》《中华人民共和国计算机信息系统安全保护条例》《中华人民共和国计算机信息网络国际联网管理暂行规定》《计算机信息系统国际联网保密管理规定》《互联网信息服务管理办法》《计算机信息网络国际联网安全保护管理办法》《互联网电子公告服务管理规定》《网络安全法》《中华人民共和国劳动法》《中华人民共和国劳动合同法》《网络信息内容生态治理规定》等相关中国法律法规的规定。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3. 在任何情况下，如果IT企业服务公司有理由认为用户使用IT企业服务服务过程中的任何行为，包括但不限于用户的任何言论和其它行为违反或可能违反上述法律和法规的任何规定，IT企业服务公司可在任何时候不经任何事先通知终止向该用户提供服务。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">4. 用户承诺在使用IT企业服务期间，遵守法律法规、社会主义制度、国家利益、公民合法权益、公共秩序、社会道德风尚和信息真实性等七条底线。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">5. 您理解并同意，本平台仅为用户提供招聘信息分享、传播及获取招聘、求职机会的平台，您必须为自己的注册、认证账号下的一切行为负责，包括您所发表的任何内容以及由此产生的任何后果。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">6. 用户使用本平台服务进行招聘或求职的，还应遵守IT企业服务《职位信息发布规则》。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">八、禁止用户利用IT企业服务从事下列行为</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">禁止用户在IT企业服务平台或利用IT企业服务提供的服务，制作、发送、复制、发布、传播违反国家相关法律法规、七条底线、九不准管理规定、本平台规则的信息、从事违反前述规定/规则的活动，主要表现为：</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. 反对宪法所确定的基本原则的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. 危害国家安全，泄露国家秘密，颠覆国家政权，破坏国家统一的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3. 损害国家荣誉和利益的；煽动民族仇恨、民族歧视、破坏民族团结的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">4. 破坏国家宗教政策，宣扬邪教和封建迷信的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">5. 散布谣言，扰乱社会秩序，破坏社会稳定的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">6. 散布淫秽、色情、赌博、暴力、凶杀、恐怖或者教唆犯罪的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">7. 侮辱或者诽谤他人，侵害他人合法权益的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">8. 含有虚假、有害、胁迫、侵害他人隐私、骚扰、侵害、中伤、粗俗、猥亵、或有悖道德、令人反感的内容的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">9. 含有中国法律、法规、规章、条例以及任何具有法律效力的规范所限制或禁止的其他内容的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">10. 使用IT企业服务服务的过程中，以任何方式危害求职者合法权益的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">11. 冒充任何人或机构，包含但不限于冒充IT企业服务工作人员或以虚伪不实的方式陈述或谎称与任何人或机构有关的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">12. 发布、传播侵犯任何人的肖像权、名誉权、隐私权、专利权、商标权、著作权、商业秘密的信息或言论的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">13. 将病毒或其它计算机代码、档案和程序，加以上载、张贴、发送电子邮件或以其它方式传送的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">14. 跟踪或以其它方式骚扰其他用户的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">15. 未经合法授权而截获、篡改、收集、储存或删除他人个人信息、电子邮件或其它数据资料，或将获知的此类资料用于任何非法或不正当目的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">16. 以任何方式干扰或企图干扰IT企业服务的任何产品、任何部分或功能的正常运行，或者制作、发布、传播上述工具、方法等。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">17. 未能按照本平台的流程、规则进行注册、认证或使用本服务的，违反本服务功能限制或运营策略，或采取任何措施规避前述流程、规则、限制或策略的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">18. 未经IT企业服务公司的许可使用插件、外挂或通过其他第三方工具、运营平台或任何服务接入本服务和相关系统的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">19. 利用IT企业服务账号或本平台服务从事，包括但不限于欺诈、传销、刷流量、好评、违法物品营销等任何违法兼职或犯罪活动的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">20. 仿冒、混淆他人账号昵称、头像、功能介绍或发布招聘内容等，或冒充、利用他人名义对外招聘的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">21. 未经IT企业服务公司的许可，以任何目的自行或授权、允许、协助任何第三人对平台内的任何信息内容进行非法获取，用于商业用途或其他任何目的。“非法获取”是指采用包括但不限于“”(spider)程序、爬虫程序、拟人程序等非真实用户或避开、破坏技术措施等非正常浏览的手段、方式，读取、复制、转存、获得数据和信息内容的行为。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">22. 为任何注册用户或非注册用户提供自动登录到本平台、代办或协助他人代办身份认证服务的或代售身份认证所需的相关材料或凭据等。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">23. 任何导致或可能导致IT企业服务公司与第三方产生纠纷、争议或诉讼的行为。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">九、特别规定</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. 用户如违反本协议第八条，IT企业服务有权在任何时候不经任何事先通知暂停或终止向该用户提供服务。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. 用户有下列行为或发布/散布/传播如下相关信息的，IT企业服务在发现或接到投诉后，有权采取冻结账号、升级认证或以其他方式暂停向该用户提供服务，并要求用户承担相应的损害赔偿责任：</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    （1）涉及广告（寻求合作）、传销或直销等内容</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    （2）涉及色情、淫秽内容</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    （3）涉及违法/政治敏感内容</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    （4）虚假信息，包括但不限于不真实的公司信息、薪资、身份、个人简历、职位信息等</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    （5）利用IT企业服务提供的服务索取他人隐私</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    （6）涉及人身攻击或其他侵害他人权益的内容</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    （7）未成年人工作信息</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    （8）招聘他人从事违法活动</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    （9）以培训费、服装费等名义骗取求职者财物</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    （10）骚扰其他用户</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    （11）不符合IT企业服务相关服务性质的信息，如鸡汤、段子、水贴等</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    （12）利用本平台可能存在的漏洞恶意充值直豆、获取道具等虚拟产品或服务</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    （13）在本平台以外的任何第三方平台（包括但不限于淘宝、闲鱼等）售卖道具等虚拟产品或服务的行为</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    （14）通过第三方平台或渠道（如淘宝店铺等）购买道具等虚拟产品或服务</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    （15）涉嫌拖欠/未按法律规定支付薪资/劳务报酬的，或涉嫌具有其他可能损害劳动者或劳务人员合法权益的。（涉及农民工或涉众的均属于“情节严重”）本平台有权对前述情形进行处置，相关判断方式包括但不限于因上述行为被列入相关政府部门“黑名单”、被多名用户举报投诉或被新闻媒体曝光等情形</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    （16）两位用户名下认证的账号，经系统判定为关联账号的，如其中一个账号因违法违规被冻结的，其他关联账号均将被同时冻结。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    （17）其他违反法律法规或国家政策以及损害IT企业服务及其合法用户之合法权益的行为</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3.       根据我国现行的法律法规等相关规定，如用户实施前述第（4）项“发布虚假信息”的，包括但不限于用户发布的职位信息与其实际招聘的职位不符的，如用户实际招聘的职位为“保险销售、信用卡销售、理财产品销售、地产中介或销售或劳务派遣”，与其发布的职位信息在内容、类型或其他方面并非一致或对应的甚至不存在，IT企业服务公司随时有权拒绝向该用户提供服务，并可采取其他处理措施，包括但不限于“永久性封禁账号”、“永久性将其设备号、手机号等相关信息冻结”或“永久性加入名单’”等。</span></span><br><span class="line"><span class="string">3.       根据我国现行的法律法规等相关规定，如用户实施前述第（4）项“发布虚假信息”的，包括但不限于用户发布的职位信息与其实际招聘的职位不符的，如用户实际招聘的职位为“保险销售、信用卡销售、理财产品销售、地产中介或销售或劳务派遣”，与其发布的职位信息在内容、类型或其他方面并非一致或对应的甚至不存在，IT企业服务公司随时有权拒绝向该用户提供服务，并可采取其他处理措施，包括但不限于“永久性封禁账号”、“永久性将其设备号、手机号等相关信息冻结”或“永久性加入名单’”等。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">十、隐私政策</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">IT企业服务依法保护用户个人信息和隐私信息。有关隐私政策的内容，详见IT企业服务《隐私政策》。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">十一、关于用户在IT企业服务的上传或张贴的内容</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. 用户在IT企业服务上传或张贴的内容（包括但不限于照片、文字、面试经历及心得评价等），视为用户授予IT企业服务公司及其关联公司免费、非独家的使用权，IT企业服务有权为展示、传播及推广前述张贴内容的目的，对上述内容进行复制、修改、出版等。该使用权持续至用户书面通知IT企业服务不得继续使用，且IT企业服务实际收到该等书面通知时止。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. 因用户上传或张贴的内容侵犯他人权利，而导致任何第三方向IT企业服务公司提出侵权或索赔要求的，用户应承担全部责任。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3. 任何第三方对于用户在IT企业服务的公开使用区域张贴的内容进行复制、修改、编辑、传播等行为的，该行为产生的法律后果和责任均由行为人承担，与IT企业服务无关。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">十二、关于面试聊天等即时通讯服务</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. 用户在接受IT企业服务提供与IT企业服务注册用户或IT企业服务关联方用户进行提在线开聊、邀约面试等即时通讯服务时，应当遵守法律法规、社会主义制度、国家利益、公民合法权益、公共秩序、社会道德风尚，并保证所传输的信息真实性等七条底线。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. 用户通过本平台与他人在线开聊、拨打电话以及视频面试等商务场景下产生的文字、语音及视频等形式的沟通信息，IT企业服务将会根据法律规定暂时存储，且仅用于投诉举报的处理、安全风控及离线暂存功能的实现。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3. IT企业服务对该信息的采集、传输及存储均会采取加密、防泄露等相关措施。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">4. 为保护其他用户隐私，您不得下载、传播或公开发布本条规定的其他用户通讯信息，如面试聊天记录等。如因此造成IT企业服务损失，或者侵害其他用户权益的，您应当承担违约责任或赔偿责任。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">十三、信息储存和限制</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">IT企业服务有权制定一般措施及限制，包含但不限于软件服务将保留的电子邮件、聊天信息、所张贴内容或其他上载内容的最长期间、每个账号可收发沟通讯息的最大数量及可收发的单个消息的大小。通过服务存储或传送之任何信息、通讯资料和其他内容，如被删除或未予储存，IT企业服务不承担任何责任。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">十四、结束服务</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">用户若反对任何注册条款的内容或对之后注册条款修改有异议，或对IT企业服务服务不满，用户有以下权利：不再使用IT企业服务服务；结束用户使用IT企业服务服务的资格；通知IT企业服务停止该用户的服务。结束用户服务的同时，用户使用IT企业服务服务的权利立即终止，IT企业服务不再对用户承担任何义务。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">十五、禁止商业行为</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. 用户同意不对IT企业服务提供的服务或服务的任何部分，进行复制、拷贝、出售、转售或用于任何其他商业目的。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. 禁止通过职位向应聘者收费，如有不实，我们将结束用户使用IT企业服务服务的资格。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">十六、违约责任</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. 用户使用虚假身份信息、公司信息进行注册，发布虚假招聘、求职信息，发布含有传销、色情、反动等严重违法内容，对外传播面试聊天等通讯记录等行为，视为严重违反本协议，应当承担给IT企业服务公司造成的经济损失和名誉损失。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. 因用户通过IT企业服务提供的服务提供、张贴或传送内容、违反本服务条款、或侵害他人任何合法权益而导致任何第三人对IT企业服务提出任何索赔或请求，用户应当赔偿IT企业服务或其他合作伙伴的损失，包括但不限于赔偿金额、律师费和合理的调查费用等。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3. 用户在投诉其他用户有违法行为或违反本注册条款情形时，投诉者应承担不实投诉所产生的全部法律责任。如侵犯他人的合法权益，投诉人应独立承担全部法律责任。如给IT企业服务造成损失的，投诉人应对IT企业服务承担相应的赔偿责任。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">十七、本协议条款的变更和修改</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">IT企业服务有权依法随时对本协议的任何条款进行变更和修改。一旦发生条款变动，我们将在IT企业服务软件内进行更新及提示，或将最新版本的《用户协议》以系统消息、弹框或邮件的形式发送给用户阅读及确认接收。用户如果不同意条款的修改，应主动停止使用IT企业服务或申请注销IT企业服务账号，如未使用的付费权益将在注销后清空。否则，如果用户继续使用用户账号，则视为用户已经接受本协议全部条款的修改。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">十八、不可抗力</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. “不可抗力”是指IT企业服务不能合理控制、不可预见或即使预见亦无法避免的事件，该事件妨碍、影响或延误IT企业服务根据本注册条款履行其全部或部分义务。该事件包括但不限于政府行为、自然灾害、、黑客袭击、电脑病毒、网络故障等。不可抗力可能导致IT企业服务无法访问、访问速度缓慢、存储数据丢失、用户个人信息泄漏等不利后果。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. 遭受不可抗力事件时，IT企业服务可中止履行本协议项下的义务直至不可抗力的影响消除为止，并且不因此承担违约责任；但应尽最大努力克服该事件，减轻其负面影响。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">十九、通知</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">IT企业服务向其用户发出的通知，将采用系统消息、弹窗、电子邮件或页面公告等形式。本《用户协议》的条款修改或其他事项变更时，IT企业服务可以以上述形式进行通知。</span></span><br><span class="line"><span class="string">&#x27;</span>, <span class="number">0</span>, <span class="number">50</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="5-定义一个全局中间件-res-cc"><a href="#5-定义一个全局中间件-res-cc" class="headerlink" title="5.定义一个全局中间件 res.cc"></a>5.定义一个全局中间件 res.cc</h2><details class="folding-tag" ><summary> 定义 res.cc 用于简化错误的响应逻辑 点击查看详情 </summary>              <div class='content'>              <p>首先在 app.js 中定义 res.cc 这个中间件</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 响应数据的中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="property">cc</span> = <span class="function">(<span class="params">err, status = <span class="number">1</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// status 默认值为 1，表示失败的情况</span></span><br><span class="line">    <span class="comment">// err 可能是一个 Error 对象，也可能时一个描述错误信息的字符串</span></span><br><span class="line">    res.<span class="title function_">send</span>(&#123;</span><br><span class="line">      status,</span><br><span class="line">      <span class="attr">message</span>: err <span class="keyword">instanceof</span> <span class="title class_">Error</span> ? err.<span class="property">message</span> : err</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>然后，在 处理函数中直接使用</p>  <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">exports</span>.<span class="property">regUser</span> = <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 获取客户端提交的数据</span></span><br><span class="line">    <span class="keyword">const</span> userInfo = req.<span class="property">body</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!userInfo.<span class="property">accounts</span>) &#123;</span><br><span class="line">      <span class="comment">// return res.send(&#123; status: 1, message: &#x27;手机号码不能为空！&#x27; &#125;);</span></span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;手机号不能为空&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> code = <span class="title function_">generateCode</span>(); <span class="comment">// 生成 6 位随机验证码</span></span><br><span class="line">    <span class="keyword">const</span> codeExpiresAt = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>() + <span class="number">5</span> * <span class="number">60</span> * <span class="number">1000</span>); <span class="comment">// 验证码有效期 5 分钟</span></span><br><span class="line"></span><br><span class="line">    codeBcrypt = bcrypt.<span class="title function_">hashSync</span>(code, <span class="number">10</span>); <span class="comment">// 对验证码进行加密处理</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查询是否存在相同手机号码的用户</span></span><br><span class="line">    <span class="keyword">const</span> sqlStr = <span class="string">&#x27;SELECT * FROM users WHERE accounts = ?&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> rows = <span class="keyword">await</span> db.<span class="title function_">query</span>(sqlStr, userInfo.<span class="property">accounts</span>); <span class="comment">// 参数数组必须使用 [], 只有一个参数时可以省略</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查询语句得到的是一个数组，如果数组长度大于 0，说明用户已存在</span></span><br><span class="line">    <span class="keyword">if</span> (rows.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">// 如果用户已存在，更新验证码和过期时间</span></span><br><span class="line">      <span class="keyword">const</span> updateSql = <span class="string">&#x27;UPDATE users SET code = ?, code_expires_at = ? WHERE accounts = ?&#x27;</span>;</span><br><span class="line">      <span class="keyword">await</span> db.<span class="title function_">query</span>(updateSql, [codeBcrypt, codeExpiresAt, userInfo.<span class="property">accounts</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 如果用户不存在，插入新用户记录</span></span><br><span class="line">      <span class="keyword">const</span> insertSql = <span class="string">&#x27;INSERT INTO users (accounts, code, code_expires_at) VALUES (?, ?, ?)&#x27;</span>;</span><br><span class="line">      <span class="keyword">await</span> db.<span class="title function_">query</span>(insertSql, [userInfo.<span class="property">accounts</span>, codeBcrypt, codeExpiresAt]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回验证码（开发阶段用，生产环境中不要返回验证码）</span></span><br><span class="line">    res.<span class="title function_">send</span>(&#123;</span><br><span class="line">      <span class="attr">code</span>: <span class="number">200</span>,</span><br><span class="line">      <span class="attr">success</span>: <span class="string">&#x27;验证码已生成&#x27;</span>,</span><br><span class="line">      <span class="attr">result</span>: &#123;</span><br><span class="line">        <span class="attr">code</span>: code,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    res.<span class="title function_">cc</span>(error,<span class="number">500</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>需要注意的是：</strong></p><p>代码已经使用了现代的 <code>async/await</code> 风格，避免了传统的回调函数。传统回调函数的用法如下：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, params, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="comment">// 处理错误</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(err);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 处理查询结果</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(results);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>而在使用 <code>Promise</code> 和 <code>async/await</code> 时，写法变成这样：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [rows] = <span class="keyword">await</span> db.<span class="title function_">query</span>(sql, params); <span class="comment">// `rows` 是查询结果</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(rows);</span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  res.<span class="title function_">cc</span>(error,<span class="number">500</span>) <span class="comment">// 处理错误</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>回调函数的本质已经由 <code>Promise</code> 替代</p><ul><li>在你的代码中，<code>db.query()</code> 是一个 <code>Promise</code>，通过 <code>await</code> 获取它的结果。</li><li>数据库操作完成后，返回的结果（或者错误）会自动传递给 <code>await</code> 或 <code>catch</code>，不需要显式地定义回调函数。</li></ul><p>操作数据库后的回调函数已经被隐式地替代为 <code>Promise</code> 的 <code>resolve</code> 和 <code>reject</code> 方法：</p><ul><li>如果查询成功，<code>Promise</code> 的结果会被赋值给 <code>rows</code>。</li><li>如果查询失败，错误会被抛出，进入 <code>catch</code> 块。</li></ul><p>总结</p><p>在现代 JavaScript 中，推荐使用 <code>Promise</code> 和 <code>async/await</code> 进行异步操作，因为它比传统的回调函数写法更简洁、更易读。如果你正在使用的是 <code>mysql2/promise</code> 模块，你的代码中不需要显式定义回调函数。</p><p>其实，严格来说，<strong>以上代码不是一个错误处理中间件</strong>，而是一个<strong>响应辅助中间件</strong>。它的主要作用是为 <code>res</code> 对象添加一个 <code>res.cc</code> 方法，用于统一处理成功或失败的响应消息。</p><p><strong>为什么不是错误处理中间件？</strong></p><ol><li><p><strong>错误处理中间件的定义</strong><br>错误处理中间件是专门用于捕获和处理请求处理过程中发生的错误的，它的函数签名和普通中间件不同：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err, req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 这才是错误处理中间件</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>错误处理中间件的第一个参数必须是 <code>err</code>，这个参数由 <code>next(error)</code> 传递过来，Express 会自动将错误传递给这样的中间件。</p><p><strong>名字不强制一致</strong>：<br><code>err</code> 是错误处理中间件中常见的约定，但你可以自由命名它。</p></li><li><p><strong>该中间件不接收 err 参数</strong><br>上面定义的 <code>res.cc</code> 是一个工具方法，用于格式化响应内容，它并没有处理通过 <code>next(error)</code> 抛出的错误。因此，<strong>这不能算作一个错误处理中间件</strong>。</p></li></ol><hr><p><strong>这个中间件的作用</strong></p><ol><li><strong>为 res 对象添加一个统一的响应方法 (res.cc)</strong><ul><li>成功的响应：<code>res.cc(&#39;操作成功&#39;, 0)</code></li><li>失败的响应：<code>res.cc(&#39;操作失败&#39;)</code> 或 <code>res.cc(new Error(&#39;错误信息&#39;))</code></li></ul></li><li><strong>简化了代码书写</strong><br>你可以通过 <code>res.cc</code> 快速发送 JSON 格式的响应，而不需要每次手动写 <code>res.send({ status, message })</code>。</li></ol>              </div>            </details><h2 id="6-全局错误中间件"><a href="#6-全局错误中间件" class="headerlink" title="6.全局错误中间件"></a>6.全局错误中间件</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>app.js 中，定义全局错误处理中间件</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 响应数据的中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="property">cc</span> = <span class="function">(<span class="params">err, status = <span class="number">1</span></span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(&#123;</span><br><span class="line">      status,</span><br><span class="line">      <span class="attr">message</span>: err <span class="keyword">instanceof</span> <span class="title class_">Error</span> ? err.<span class="property">message</span> : err,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局错误处理中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err, req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;捕获到错误:&#x27;</span>, err); <span class="comment">// 打印错误日志</span></span><br><span class="line">  res.<span class="title function_">cc</span>(err, <span class="number">500</span>); <span class="comment">// 使用 res.cc 统一返回错误信息</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>处理函数末尾，catch(error)</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">exports</span>.<span class="property">regUser</span> = <span class="title function_">async</span> (req, res, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 获取客户端提交的数据</span></span><br><span class="line">    <span class="keyword">const</span> userInfo = req.<span class="property">body</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!userInfo.<span class="property">accounts</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;手机号不能为空&#x27;</span>, <span class="number">1</span>); <span class="comment">// 使用 res.cc 返回错误</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 模拟生成验证码的逻辑</span></span><br><span class="line">    <span class="keyword">const</span> code = <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> codeExpiresAt = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>() + <span class="number">5</span> * <span class="number">60</span> * <span class="number">1000</span>); <span class="comment">// 验证码 5 分钟有效期</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 模拟数据库操作</span></span><br><span class="line">    <span class="keyword">const</span> sqlStr = <span class="string">&#x27;SELECT * FROM users WHERE accounts = ?&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> rows = <span class="keyword">await</span> db.<span class="title function_">query</span>(sqlStr, [userInfo.<span class="property">accounts</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (rows.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> updateSql = <span class="string">&#x27;UPDATE users SET code = ?, code_expires_at = ? WHERE accounts = ?&#x27;</span>;</span><br><span class="line">      <span class="keyword">await</span> db.<span class="title function_">query</span>(updateSql, [code, codeExpiresAt, userInfo.<span class="property">accounts</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> insertSql = <span class="string">&#x27;INSERT INTO users (accounts, code, code_expires_at) VALUES (?, ?, ?)&#x27;</span>;</span><br><span class="line">      <span class="keyword">await</span> db.<span class="title function_">query</span>(insertSql, [userInfo.<span class="property">accounts</span>, code, codeExpiresAt]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 成功返回响应</span></span><br><span class="line">    res.<span class="title function_">cc</span>(<span class="string">&#x27;验证码已发送&#x27;</span>, <span class="number">0</span>); <span class="comment">// 0 表示成功状态</span></span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="title function_">next</span>(error); <span class="comment">// 把错误交给全局错误处理中间件处理</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>什么时候用 res.cc？</strong></p><ul><li><p><strong>用于轻量级的错误响应：</strong><br>如果某些错误逻辑不需要传递到全局错误处理中间件（例如简单的业务校验失败），可以直接使用 <code>res.cc</code>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (!userInfo.accounts) &#123;</span><br><span class="line">  return res.cc(&#x27;手机号不能为空&#x27;, 1); // 不传递到错误处理中间件</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>用于不可恢复的错误：</strong><br>如果错误是不可恢复的、需要全局处理的，应该使用 <code>next(error)</code>，让全局错误处理中间件处理。</p></li><li><p>不可恢复的错误（<strong>irrecoverable errors</strong>）是指那些在发生时无法通过常规的错误处理或重试机制来恢复的错误。这些错误通常意味着应用程序的某些关键部分已经崩溃或无法继续运行，因此程序需要停止执行并返回给用户适当的错误信息。常见的不可恢复错误可能涉及系统级别的问题、程序的逻辑错误或无法处理的外部资源故障。</p></li></ul><p><strong>总结</strong></p><ol><li><strong>res.cc 是响应辅助中间件，而非错误处理中间件</strong>。它用于简化成功或失败的响应逻辑，统一返回格式。</li><li><strong>错误处理中间件需要显式接收 err 参数</strong>。如果在业务逻辑中调用 <code>next(error)</code>，Express 会自动将错误传递给第一个错误处理中间件。</li><li><strong>两者结合</strong>：<code>res.cc</code> 和全局错误处理中间件搭配使用，可以让代码既简洁又结构清晰，推荐这样做。</li></ol>              </div>            </details><h2 id="7-为项目配置-eslint"><a href="#7-为项目配置-eslint" class="headerlink" title="7. 为项目配置 eslint"></a>7. 为项目配置 eslint</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <ol><li><p>安装 &amp; 初始化</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pnpm npm install eslint</span><br><span class="line"></span><br><span class="line">npx eslint --init</span><br></pre></td></tr></table></figure></li><li><p>编辑<code>eslint.config.js</code>规则</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> globals <span class="keyword">from</span> <span class="string">&quot;globals&quot;</span></span><br><span class="line"><span class="keyword">import</span> pluginJs <span class="keyword">from</span> <span class="string">&quot;@eslint/js&quot;</span></span><br><span class="line"></span><br><span class="line"># rules 外层需要包一层对象</span><br><span class="line"></span><br><span class="line"><span class="comment">/** <span class="doctag">@type</span> &#123;<span class="type">import(&#x27;eslint&#x27;).Linter.Config[]</span>&#125; */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> [</span><br><span class="line">  &#123;<span class="attr">files</span>: [<span class="string">&quot;**/*.js&quot;</span>], <span class="attr">languageOptions</span>: &#123;<span class="attr">sourceType</span>: <span class="string">&quot;commonjs&quot;</span>&#125;&#125;,</span><br><span class="line">  &#123;<span class="attr">languageOptions</span>: &#123; <span class="attr">globals</span>: globals.<span class="property">browser</span> &#125;&#125;,</span><br><span class="line">  &#123;<span class="attr">rules</span>: &#123;</span><br><span class="line">    <span class="string">&quot;semi&quot;</span>: [<span class="string">&quot;error&quot;</span>, <span class="string">&quot;never&quot;</span>],</span><br><span class="line">  &#125;&#125;,</span><br><span class="line">  pluginJs.<span class="property">configs</span>.<span class="property">recommended</span>,</span><br><span class="line">  </span><br><span class="line">]</span><br></pre></td></tr></table></figure></li></ol><ol><li><p>详细说明 es6 和 commonjs 两个标准</p><p><code>module.exports = router</code> 和 <code>export default router</code> 的区别主要在于两者所属的模块系统和使用方式。它们分别属于 <strong>CommonJS</strong> 和 <strong>ES6 模块</strong> 两种模块规范。</p><hr><p> <strong>1. CommonJS 和 ES6 模块简介</strong></p><ul><li><strong>CommonJS</strong> 是 Node.js 默认的模块规范，使用 <code>require</code> 和 <code>module.exports</code>。</li><li><strong>ES6 模块</strong> 是 JavaScript 的现代模块系统，使用 <code>import</code> 和 <code>export</code>。</li></ul><hr><p> <strong>2. 区别分析</strong></p><p><strong>语法层面的区别</strong></p><ol><li><p><strong>CommonJS (module.exports)</strong></p><ul><li>使用 <code>module.exports</code> 导出。</li><li>使用 <code>require</code> 导入。</li></ul><p>示例：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导出文件（CommonJS）</span></span><br><span class="line"><span class="keyword">const</span> router = &#123;&#125;; <span class="comment">// 假设 router 是一个对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入文件</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">&#x27;./path/to/router&#x27;</span>);</span><br></pre></td></tr></table></figure></li></ol></li></ol><ol><li><p><strong>ES6 模块 (export default)</strong></p><ul><li>使用 <code>export default</code> 导出。</li><li>使用 <code>import</code> 导入。</li></ul><p>示例：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导出文件（ES6 模块）</span></span><br><span class="line"><span class="keyword">const</span> router = &#123;&#125;; <span class="comment">// 假设 router 是一个对象</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入文件</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./path/to/router&#x27;</span>;</span><br></pre></td></tr></table></figure></li></ol><hr><p><strong>运行时的区别</strong></p><ol><li><strong>CommonJS</strong><ul><li>模块在运行时加载，是同步的。</li><li><code>module.exports</code> 可以导出任何类型的值（对象、函数、数组、基本类型等）。</li><li>导入时，导出的是一个值的引用。</li></ul></li><li><strong>ES6 模块</strong><ul><li>模块在编译时解析，是静态的。</li><li><code>export default</code> 是 ES6 中默认导出方式，适用于一个模块导出一个主要功能。</li><li>导入时，支持 <code>import</code> 解构语法。</li><li>ES6 模块是严格模式，语法更现代。</li></ul></li></ol><hr><p><strong>项目中的区别</strong></p><ol><li><p><strong>兼容性</strong></p><ul><li><strong>Node.js 环境</strong>：Node.js 默认支持 CommonJS 模块。如果要使用 ES6 模块，需要将 <code>package.json</code> 的 <code>type</code> 设置为 <code>&quot;module&quot;</code>，或者使用 <code>.mjs</code> 文件扩展名。</li><li><strong>前端环境</strong>：现代前端工具（如 Webpack、Vite）对 ES6 模块有更好的支持。</li></ul></li><li><p><strong>导出多项功能</strong></p><ul><li><p>CommonJS 使用exports，可以导出多个成员：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">exports</span>.<span class="property">func1</span> = <span class="function">() =&gt;</span> &#123;&#125;;</span><br><span class="line"><span class="built_in">exports</span>.<span class="property">func2</span> = <span class="function">() =&gt;</span> &#123;&#125;;</span><br></pre></td></tr></table></figure></li><li><p>ES6 模块支持命名导出和默认导出：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">func1</span> = (<span class="params"></span>) =&gt; &#123;&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">func2</span> = (<span class="params"></span>) =&gt; &#123;&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure></li></ul></li></ol><ol><li><p><strong>使用习惯</strong></p><ul><li>CommonJS 更常用于后端（Node.js 项目）。</li><li>ES6 模块是现代 JavaScript 标准，前端项目和支持现代语法的后端项目更倾向于使用。</li></ul></li></ol><hr><p>   <strong>混用时的注意事项</strong></p><ol><li><p>如果一个模块使用 <code>module.exports</code> 导出，导入时不能直接用 <code>import</code>，需要借助 <code>createRequire</code> 或其他工具。</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRequire &#125; <span class="keyword">from</span> <span class="string">&#x27;module&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="built_in">require</span> = <span class="title function_">createRequire</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>);</span><br><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">&#x27;./path/to/router&#x27;</span>);</span><br></pre></td></tr></table></figure></li></ol><ol><li><p>如果一个模块使用 <code>export default</code> 导出，<code>require</code> 导入时会被包装在 <code>default</code> 属性中：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导出文件（ES6 模块）</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CommonJS 导入</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">&#x27;./path/to/router&#x27;</span>).<span class="property">default</span>;</span><br></pre></td></tr></table></figure></li></ol><hr><p>   <strong>总结</strong></p><div class="table-container"><table><thead><tr><th>特性</th><th><code>module.exports</code> (CommonJS)</th><th><code>export default</code> (ES6 模块)</th></tr></thead><tbody><tr><td>模块规范</td><td>CommonJS</td><td>ES6 模块</td></tr><tr><td>使用的导入方式</td><td><code>require()</code></td><td><code>import</code></td></tr><tr><td>支持环境</td><td>Node.js 默认支持</td><td>需设置 <code>&quot;type&quot;: &quot;module&quot;</code> 或 <code>.mjs</code> 文件</td></tr><tr><td>导入方式</td><td>直接导入值</td><td>默认导出直接导入，支持解构</td></tr><tr><td>运行时或编译时</td><td>运行时加载（同步）</td><td>编译时解析（静态）</td></tr><tr><td>灵活性</td><td>可导出单个或多个对象</td><td>默认导出一个主要内容，可同时命名导出多个</td></tr></tbody></table></div><p>如果你在使用现代工具链或构建前端应用，<strong>优先使用 ES6 模块</strong>；而在传统 Node.js 项目中，<strong>CommonJS 更加直接和兼容性好</strong>。</p>              </div>            </details><h2 id="8-表单验证-escook-express-joi"><a href="#8-表单验证-escook-express-joi" class="headerlink" title="8.  表单验证 @escook/express-joi"></a>8.  表单验证 @escook/express-joi</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <ol><li><p>安装</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pnpm i @escook/express-joi</span><br><span class="line"></span><br><span class="line">// 依赖</span><br><span class="line">pnpm i joi</span><br></pre></td></tr></table></figure></li></ol><ol><li><p>导入，<code>app.js</code></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入 express</span></span><br><span class="line"><span class="keyword">const</span>  express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建 express 实例</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入 Joi 模块</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Joi</span> = <span class="built_in">require</span>(<span class="string">&#x27;joi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 cors 跨域中间件</span></span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>())</span><br></pre></td></tr></table></figure></li></ol><ol><li><p>新建 /schema/user.js 用户信息验证规则模块，并初始化以下代码</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Joi</span> = <span class="built_in">require</span>(<span class="string">&#x27;joi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义手机号验证规则</span></span><br><span class="line"><span class="keyword">const</span> accounts = <span class="title class_">Joi</span>.<span class="title function_">string</span>().<span class="title function_">required</span>()</span><br><span class="line"><span class="keyword">const</span> code = <span class="title class_">Joi</span>.<span class="title function_">string</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义手机号码的验证规则</span></span><br><span class="line"><span class="keyword">const</span> reg_login_schema = &#123;</span><br><span class="line"><span class="attr">body</span>: &#123;</span><br><span class="line">accounts,</span><br><span class="line">code</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出 reg_login_schema</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123; reg_login_schema &#125;</span><br></pre></td></tr></table></figure></li></ol><ol><li><p>然后 ，在路由模块中使用</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Router</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = <span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入验证数据的中间件</span></span><br><span class="line"><span class="keyword">const</span> expressJoi = <span class="built_in">require</span>(<span class="string">&#x27;@escook/express-joi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入需要的验证规则对象</span></span><br><span class="line"><span class="keyword">const</span> &#123; reg_login_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/user&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入处理函数</span></span><br><span class="line"><span class="keyword">const</span> &#123; regUser, login &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/user&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册用户</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login/code&#x27;</span>, <span class="title function_">expressJoi</span>(reg_login_schema), regUser)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录接口</span></span><br><span class="line"><span class="comment">// 需要注意的是，多个路由共用验证规则时，要留意验证对象是否为必填</span></span><br><span class="line"><span class="comment">// 如果验证规则中没有某个数据的验证规则，但发起的请求中携带了该参数，则会导致 [Object: null prototype] 报错</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="title function_">expressJoi</span>(reg_login_schema), login)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出路由</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure></li></ol>              </div>            </details><h2 id="9-使用-fetch-加载本地json数据"><a href="#9-使用-fetch-加载本地json数据" class="headerlink" title="9. 使用 fetch 加载本地json数据"></a>9. 使用 fetch 加载本地json数据</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <ol><li><p>public文件夹下，创建data/*.json文件</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;list&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">15</span><span class="punctuation">,</span> </span><br><span class="line">  </span><br><span class="line">      <span class="attr">&quot;picture&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/data/img/banner-1.png&quot;</span><span class="punctuation">,</span> </span><br><span class="line">      </span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;it求职端2&quot;</span><span class="punctuation">,</span> </span><br><span class="line">      </span><br><span class="line">      <span class="attr">&quot;isdelete&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> </span><br><span class="line">      </span><br><span class="line">      <span class="attr">&quot;sort&quot;</span><span class="punctuation">:</span> <span class="number">50</span><span class="punctuation">,</span> </span><br><span class="line">      </span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span> </span><br><span class="line">      </span><br><span class="line">      <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://mobile.zcwytd.com/#/pages/login/choice/index&quot;</span><span class="punctuation">,</span> </span><br><span class="line">      </span><br><span class="line">      <span class="attr">&quot;create_time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2022-06-28T13:03:53.000Z&quot;</span><span class="punctuation">,</span> </span><br><span class="line">      </span><br><span class="line">      <span class="attr">&quot;update_time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2022-07-05T08:48:55.000Z&quot;</span> </span><br><span class="line">     </span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">16</span><span class="punctuation">,</span> </span><br><span class="line">      </span><br><span class="line">      <span class="attr">&quot;picture&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/data/img/banner-2.png&quot;</span><span class="punctuation">,</span> </span><br><span class="line">      </span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;it求职端1&quot;</span><span class="punctuation">,</span> </span><br><span class="line">      </span><br><span class="line">      <span class="attr">&quot;isdelete&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> </span><br><span class="line">      </span><br><span class="line">      <span class="attr">&quot;sort&quot;</span><span class="punctuation">:</span> <span class="number">50</span><span class="punctuation">,</span> </span><br><span class="line">      </span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span> </span><br><span class="line">      </span><br><span class="line">      <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://mobile.zcwytd.com/#/pages/login/choice/index&quot;</span><span class="punctuation">,</span> </span><br><span class="line">      </span><br><span class="line">      <span class="attr">&quot;create_time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2022-06-28T13:05:33.000Z&quot;</span><span class="punctuation">,</span> </span><br><span class="line">      </span><br><span class="line">      <span class="attr">&quot;update_time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2022-07-01T06:34:11.000Z&quot;</span> </span><br><span class="line">     </span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ol><ol><li><p>修改原vue文件中的api请求逻辑</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 这是接口请求函数：</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getBannerList</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 这里，原本是发起 api 请求</span></span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">bannerList</span>(&#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="number">2</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// 这里也很有意思, if (res) &#123;&#125; else&#123;当中, 推断了 res 为 false, 因此不再允许使用已在 api 接口中定义的返回数据类型&#125;</span></span><br><span class="line">  <span class="keyword">if</span> (res.<span class="property">list</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    store.<span class="title function_">setBannerList</span>(res.<span class="property">list</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">showToast</span>(res.<span class="property">msg</span> || <span class="string">&#x27;到这里出错啦&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>现在，我们已经在前端项目中准备好了json数据，可以直接使用 fetch 从本地获取</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">getBannerList</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 使用 fetch 从本地 JSON 文件加载数据</span></span><br><span class="line">    <span class="comment">// 假设文件在 public/data/banner.json</span></span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/data/banner.json&#x27;</span>) </span><br><span class="line">    <span class="keyword">if</span> (!response.<span class="property">ok</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;无法加载本地数据&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将 JSON 文件解析为对象</span></span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> response.<span class="title function_">json</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断并处理返回的数据</span></span><br><span class="line">    <span class="keyword">if</span> (res.<span class="property">list</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">      store.<span class="title function_">setBannerList</span>(res.<span class="property">list</span>) <span class="comment">// 假设 store 是一个全局状态管理对象</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">showToast</span>(res.<span class="property">msg</span> || <span class="string">&#x27;数据格式不正确，缺少 list 字段&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;加载本地 bannerList 数据失败:&#x27;</span>, error)</span><br><span class="line">    <span class="title function_">showToast</span>(<span class="string">&#x27;加载本地数据出错&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol>              </div>            </details><h2 id="10-开发阶段，向-mysql-数据库批量添加数据"><a href="#10-开发阶段，向-mysql-数据库批量添加数据" class="headerlink" title="10. 开发阶段，向 mysql 数据库批量添加数据"></a>10. 开发阶段，向 mysql 数据库批量添加数据</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>需求来了，前端项目demo需要的基础数据，需要批量添加到指定的数据库表当中</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="comment">// 首先，准备数据</span></span><br><span class="line">  <span class="keyword">const</span> taskList = [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;task_id&quot;</span>: <span class="number">33</span>, </span><br><span class="line">      <span class="string">&quot;task_name&quot;</span>: <span class="string">&quot;拯救喵星人&quot;</span>, </span><br><span class="line">      <span class="string">&quot;position_name&quot;</span>: <span class="string">&quot;前端开发&quot;</span>, </span><br><span class="line">      <span class="string">&quot;task_budget&quot;</span>: <span class="number">1</span>, </span><br><span class="line">      <span class="string">&quot;task_cycle&quot;</span>: <span class="number">60</span>, </span><br><span class="line">      <span class="string">&quot;service_mode&quot;</span>: <span class="string">&quot;驻场&quot;</span>, </span><br><span class="line">      <span class="string">&quot;task_ask&quot;</span>: <span class="string">&quot;救救孩子吧&quot;</span>, </span><br><span class="line">      <span class="string">&quot;task_grade&quot;</span>: <span class="string">&quot;初级&quot;</span>, </span><br><span class="line">      <span class="string">&quot;isdelete&quot;</span>: <span class="number">0</span>, </span><br><span class="line">      <span class="string">&quot;is_check&quot;</span>: <span class="number">1</span>, </span><br><span class="line">      <span class="string">&quot;company_name&quot;</span>: <span class="string">&quot;北京驻场无忧科技有限公司&quot;</span>, </span><br><span class="line">      <span class="string">&quot;city&quot;</span>: <span class="string">&quot;北京&quot;</span>, </span><br><span class="line">      <span class="string">&quot;area&quot;</span>: <span class="string">&quot;朝阳区&quot;</span>, </span><br><span class="line">      <span class="string">&quot;user_name&quot;</span>: <span class="literal">null</span>, </span><br><span class="line">      <span class="string">&quot;it_head&quot;</span>: <span class="literal">null</span>, </span><br><span class="line">      <span class="string">&quot;is_emergency&quot;</span>: <span class="number">1</span> </span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;task_id&quot;</span>: <span class="number">38</span>, </span><br><span class="line">        <span class="string">&quot;task_name&quot;</span>: <span class="string">&quot;金融行业app的一个小程序设计&quot;</span>, </span><br><span class="line">        <span class="string">&quot;position_name&quot;</span>: <span class="string">&quot;UI设计师&quot;</span>, </span><br><span class="line">        <span class="string">&quot;task_budget&quot;</span>: <span class="number">15000</span>, </span><br><span class="line">        <span class="string">&quot;task_cycle&quot;</span>: <span class="number">30</span>, </span><br><span class="line">        <span class="string">&quot;service_mode&quot;</span>: <span class="string">&quot;全职&quot;</span>, </span><br><span class="line">        <span class="string">&quot;task_ask&quot;</span>: <span class="string">&quot;金融行业的小程序设计，对ui界面要求很高，有完整的小程序开发者优先，能独立完成一整套小程序设计的流程，跟踪开发落地。&quot;</span>, </span><br><span class="line">        <span class="string">&quot;task_grade&quot;</span>: <span class="literal">null</span>, </span><br><span class="line">        <span class="string">&quot;isdelete&quot;</span>: <span class="number">0</span>, </span><br><span class="line">        <span class="string">&quot;is_check&quot;</span>: <span class="number">1</span>, </span><br><span class="line">        <span class="string">&quot;company_name&quot;</span>: <span class="string">&quot;北京驻场无忧科技有限公司&quot;</span>, </span><br><span class="line">        <span class="string">&quot;city&quot;</span>: <span class="string">&quot;北京&quot;</span>, </span><br><span class="line">        <span class="string">&quot;area&quot;</span>: <span class="string">&quot;朝阳区&quot;</span>, </span><br><span class="line">        <span class="string">&quot;user_name&quot;</span>: <span class="literal">null</span>, </span><br><span class="line">        <span class="string">&quot;it_head&quot;</span>: <span class="literal">null</span>, </span><br><span class="line">        <span class="string">&quot;is_emergency&quot;</span>: <span class="number">0</span> </span><br><span class="line">    &#125;,</span><br><span class="line">  ]</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 定义查询字符串和数据数组</span></span><br><span class="line">  <span class="keyword">const</span> sql = <span class="string">`</span></span><br><span class="line"><span class="string">  INSERT INTO taskList (</span></span><br><span class="line"><span class="string">    task_name,</span></span><br><span class="line"><span class="string">    position_name,</span></span><br><span class="line"><span class="string">    task_budget,</span></span><br><span class="line"><span class="string">    task_cycle,</span></span><br><span class="line"><span class="string">    service_mode,</span></span><br><span class="line"><span class="string">    task_ask,</span></span><br><span class="line"><span class="string">    task_grade,</span></span><br><span class="line"><span class="string">    isdelete,</span></span><br><span class="line"><span class="string">    is_check,</span></span><br><span class="line"><span class="string">    company_name,</span></span><br><span class="line"><span class="string">    city,</span></span><br><span class="line"><span class="string">    area,</span></span><br><span class="line"><span class="string">    user_name,</span></span><br><span class="line"><span class="string">    it_head,</span></span><br><span class="line"><span class="string">    is_emergency,</span></span><br><span class="line"><span class="string">    created_at,</span></span><br><span class="line"><span class="string">    updated_at</span></span><br><span class="line"><span class="string">  ) VALUES ?</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line">  <span class="comment">// 转换数据为批量插入格式</span></span><br><span class="line"><span class="keyword">const</span> values = taskList.<span class="title function_">map</span>(<span class="function"><span class="params">task</span> =&gt;</span> [</span><br><span class="line">  task.<span class="property">task_name</span>,</span><br><span class="line">  task.<span class="property">position_name</span>,</span><br><span class="line">  task.<span class="property">task_budget</span>,</span><br><span class="line">  task.<span class="property">task_cycle</span>,</span><br><span class="line">  task.<span class="property">service_mode</span>,</span><br><span class="line">  task.<span class="property">task_ask</span>,</span><br><span class="line">  task.<span class="property">task_grade</span>,</span><br><span class="line">  task.<span class="property">isdelete</span>,</span><br><span class="line">  task.<span class="property">is_check</span>,</span><br><span class="line">  task.<span class="property">company_name</span>,</span><br><span class="line">  task.<span class="property">city</span>,</span><br><span class="line">  task.<span class="property">area</span>,</span><br><span class="line">  task.<span class="property">user_name</span>,</span><br><span class="line">  task.<span class="property">it_head</span>,</span><br><span class="line">  task.<span class="property">is_emergency</span>,</span><br><span class="line">  task.<span class="property">created_at</span>,</span><br><span class="line">  task.<span class="property">updated_at</span></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行插入</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, [values], <span class="function">(<span class="params">err, result</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;批量插入数据失败:&#x27;</span>, err)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 这里插入成功的提示貌似没有打印出来，但是已经验证，数据是批量注入了</span></span><br><span class="line">  <span class="comment">// 后面类似的操作会特别留意原因</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;批量插入数据成功:&#x27;</span>, result)</span><br><span class="line">  db.<span class="title function_">end</span>() <span class="comment">// 关闭连接</span></span><br><span class="line">&#125;)</span><br><span class="line">&#125; <span class="keyword">catch</span>(error) &#123;</span><br><span class="line">  res.<span class="title function_">cc</span>(error,<span class="number">500</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="11-jwt-token-验证"><a href="#11-jwt-token-验证" class="headerlink" title="11. jwt-token 验证"></a>11. jwt-token 验证</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <ol><li><p>根据后端的 token 验证逻辑</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 一定要在路由之前，应用此中间件</span></span><br><span class="line"><span class="keyword">const</span> &#123; expressjwt &#125; = <span class="built_in">require</span>(<span class="string">&#x27;express-jwt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">&#x27;./config&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(</span><br><span class="line">  <span class="title function_">expressjwt</span>(&#123;</span><br><span class="line">    <span class="attr">secret</span>: config.<span class="property">jwtSecretKey</span>, <span class="comment">// 与生成 Token 时的密钥保持一致</span></span><br><span class="line">    <span class="attr">algorithms</span>: [<span class="string">&#x27;HS256&#x27;</span>], <span class="comment">// 确保算法与 Token 的签名方式匹配</span></span><br><span class="line">    <span class="attr">getToken</span>: <span class="function">(<span class="params">req</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 从 x-access-token 提取 Token</span></span><br><span class="line">      <span class="keyword">const</span> token = req.<span class="property">headers</span>[<span class="string">&#x27;x-access-token&#x27;</span>]</span><br><span class="line">      <span class="keyword">if</span> (token &amp;&amp; token.<span class="title function_">startsWith</span>(<span class="string">&#x27;Bearer &#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> token.<span class="title function_">slice</span>(<span class="number">7</span>) <span class="comment">// 去掉 &quot;Bearer &quot; 前缀</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;).<span class="title function_">unless</span>(&#123;</span><br><span class="line">    <span class="attr">path</span>: [<span class="regexp">/^\/api\/login(\/.*)?$/</span>] <span class="comment">// 豁免登录相关接口</span></span><br><span class="line">  &#125;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>前端必须按照后端显示指定的 getToken 方法来携带token</p></li><li><p>不显示的指定行不行？行！</p><p>在使用 <code>express-jwt</code> 时，<code>getToken</code> 方法 <strong>不是必须显式指定</strong> 的，但它有一个默认的行为。如果不显式提供 <code>getToken</code>，<code>express-jwt</code> 会按照以下默认逻辑来提取 Token：</p><hr><p><strong>默认行为</strong></p><p><code>express-jwt</code> 默认从以下位置提取 Token：</p><ol><li><p>Authorization Header</p><ul><li>默认从请求头 <code>Authorization</code> 提取。</li><li>要求格式为：<code>Bearer &lt;token&gt;</code>。</li><li>例如：<code>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR...</code></li></ul></li></ol><hr><p><strong>为什么要自定义 getToken？</strong></p><ol><li><strong>Token 来源不同</strong>:<ul><li>如果你的 Token <strong>不在 Authorization 头</strong>，而是放在其他地方（比如 <code>x-access-token</code> 或者 <code>cookie</code>），就需要通过 <code>getToken</code> 方法显式指定如何提取。</li></ul></li><li><strong>前缀不符合 Bearer 格式</strong>:<ul><li>如果你的 Token 没有 <code>Bearer</code>前缀，默认逻辑无法正确解析 Token，也需要自定义 <code>getToken</code>。</li></ul></li><li><strong>支持更多场景</strong>:<ul><li>比如同时支持 <code>Authorization</code> 和 <code>x-access-token</code> 两种提取方式，或者允许从请求体中提取 Token。</li></ul></li></ol><hr><p><strong>不显式指定的代码示例</strong></p><p>以下是只使用默认行为的代码：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(</span><br><span class="line">  <span class="title function_">expressjwt</span>(&#123;</span><br><span class="line">    <span class="attr">secret</span>: config.<span class="property">jwtSecretKey</span>,</span><br><span class="line">    <span class="attr">algorithms</span>: [<span class="string">&#x27;HS256&#x27;</span>]</span><br><span class="line">  &#125;).<span class="title function_">unless</span>(&#123;</span><br><span class="line">    <span class="attr">path</span>: [<span class="regexp">/^\/api\/login(\/.*)?$/</span>] <span class="comment">// 豁免登录相关接口</span></span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li><p>Token 提取方式</p><p>默认只从 <code>Authorization: Bearer &lt;token&gt;</code> 中提取。</p></li></ul><hr><p><strong>显式指定的必要性</strong></p><p>在如下的代码中，显式定义了 <code>getToken</code>：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">getToken</span>: <span class="function">(<span class="params">req</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> token = req.<span class="property">headers</span>[<span class="string">&#x27;x-access-token&#x27;</span>]; <span class="comment">// 自定义从 x-access-token 提取</span></span><br><span class="line">  <span class="keyword">if</span> (token &amp;&amp; token.<span class="title function_">startsWith</span>(<span class="string">&#x27;Bearer &#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> token.<span class="title function_">slice</span>(<span class="number">7</span>); <span class="comment">// 去掉 &quot;Bearer &quot; 前缀</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>使用了 <code>x-access-token</code> 来传递 Token，这不是默认行为。</li><li>如果不指定 <code>getToken</code>，<code>express-jwt</code> 会尝试从 <code>Authorization</code> 头提取，导致找不到 Token 的问题。</li></ul><hr><p><strong>结论</strong></p><ol><li><strong>不显式指定时</strong>，<code>express-jwt</code> 默认从 <code>Authorization: Bearer &lt;token&gt;</code> 中提取 Token。</li><li>如果你的 Token <strong>不在默认位置</strong>，或者格式不匹配，<strong>必须显式指定 getToken 方法</strong>。</li></ol></li></ol><p>​    ps: 关于错误级别中间件的一些细节试错</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 定义错误级别中间件</span></span><br><span class="line"><span class="comment">// 这里必须要有 next(), 否则会导致中间件无法正常工作</span></span><br><span class="line"><span class="comment">// 例如，使用 apifox 工具时，未能正确执行 res.cc(&#x27;身份认证失败！&#x27;)</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err, req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 数据验证失败</span></span><br><span class="line">  <span class="keyword">if</span> (err <span class="keyword">instanceof</span> <span class="title class_">Joi</span>.<span class="property">ValidationError</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line">  <span class="comment">// 身份认证失败</span></span><br><span class="line">  <span class="keyword">if</span> (err.<span class="property">name</span> === <span class="string">&#x27;UnauthorizedError&#x27;</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;身份认证失败！&#x27;</span>)</span><br><span class="line">  <span class="comment">// 未知错误</span></span><br><span class="line">  res.<span class="title function_">cc</span>(err)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(err)</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="12-温故知新，前端瀑布流加载数据的后端适配"><a href="#12-温故知新，前端瀑布流加载数据的后端适配" class="headerlink" title="12.温故知新，前端瀑布流加载数据的后端适配"></a>12.温故知新，前端瀑布流加载数据的后端适配</h2><details class="folding-tag" ><summary> 后端 api 设计 - 点击查看详情 </summary>              <div class='content'>              <ol><li><p>直接上代码</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入数据库操作模块</span></span><br><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../db/index&#x27;</span>)</span><br><span class="line">  </span><br><span class="line"><span class="keyword">const</span> <span class="title function_">taskAllList</span> = <span class="keyword">async</span> (<span class="params">req, res</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 从前端请求中提取参数</span></span><br><span class="line">    <span class="keyword">const</span> &#123; </span><br><span class="line">      position_name, </span><br><span class="line">      service_mode, </span><br><span class="line">      task_cycle, </span><br><span class="line">      pageNum = <span class="number">1</span>,</span><br><span class="line">      pageSize = <span class="number">10</span>,</span><br><span class="line">      city </span><br><span class="line">    &#125; = req.<span class="property">query</span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 基础查询语句</span></span><br><span class="line">    <span class="keyword">let</span> query = <span class="string">&#x27;SELECT * FROM tasklist WHERE isdelete = 0 AND is_check = 1&#x27;</span></span><br><span class="line">    <span class="keyword">const</span> params = []</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 根据参数动态构建查询条件</span></span><br><span class="line">    <span class="keyword">if</span> (city) &#123;</span><br><span class="line">      query += <span class="string">&#x27; AND city = ?&#x27;</span></span><br><span class="line">      params.<span class="title function_">push</span>(city)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (position_name) &#123;</span><br><span class="line">      query += <span class="string">&#x27; AND position_name = ?&#x27;</span></span><br><span class="line">      params.<span class="title function_">push</span>(position_name)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (service_mode) &#123;</span><br><span class="line">      query += <span class="string">&#x27; AND service_mode = ?&#x27;</span></span><br><span class="line">      params.<span class="title function_">push</span>(service_mode)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (task_cycle) &#123;</span><br><span class="line">      query += <span class="string">&#x27; AND task_cycle &lt;= ?&#x27;</span></span><br><span class="line">      params.<span class="title function_">push</span>(task_cycle)</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 添加排序条件（可选，视需求而定）</span></span><br><span class="line">    query += <span class="string">&#x27; ORDER BY created_at DESC&#x27;</span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 添加分页逻辑</span></span><br><span class="line">    <span class="keyword">const</span> offset = (pageNum - <span class="number">1</span>) * pageSize <span class="comment">// 计算偏移量</span></span><br><span class="line">    query += <span class="string">&#x27; LIMIT ? OFFSET ?&#x27;</span></span><br><span class="line">    params.<span class="title function_">push</span>(<span class="built_in">parseInt</span>(pageSize), <span class="built_in">parseInt</span>(offset))</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 执行 SQL 查询</span></span><br><span class="line">    <span class="keyword">const</span> [rows] = <span class="keyword">await</span> db.<span class="title function_">query</span>(query, params)</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 查询总数（不带分页条件的总记录数）</span></span><br><span class="line">    <span class="keyword">const</span> totalQuery = <span class="string">&#x27;SELECT COUNT(*) AS total FROM tasklist WHERE isdelete = 0 AND is_check = 1&#x27;</span></span><br><span class="line">    <span class="keyword">const</span> [totalResult] = <span class="keyword">await</span> db.<span class="title function_">query</span>(totalQuery,params)</span><br><span class="line">    <span class="keyword">const</span> total = totalResult[<span class="number">0</span>].<span class="property">total</span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 响应数据</span></span><br><span class="line">    res.<span class="title function_">send</span>(&#123;</span><br><span class="line">      <span class="attr">code</span>: <span class="number">200</span>,</span><br><span class="line">      <span class="attr">result</span>: &#123;</span><br><span class="line">        <span class="attr">records</span>: rows, <span class="comment">// 当前页的记录</span></span><br><span class="line">        <span class="attr">msg</span>: <span class="string">&#x27;查询任务列表成功！&#x27;</span>,</span><br><span class="line">        total, <span class="comment">// 总记录数</span></span><br><span class="line">        <span class="attr">page</span>: <span class="built_in">parseInt</span>(pageNum), <span class="comment">// 当前页码</span></span><br><span class="line">        <span class="attr">pageSize</span>: <span class="built_in">parseInt</span>(pageSize) <span class="comment">// 每页条数</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">   &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    res.<span class="title function_">cc</span>(e) <span class="comment">// 捕获并返回错误</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ol><li><strong>代码中的分页逻辑</strong></li></ol>   <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 分页相关参数</span></span><br><span class="line"><span class="keyword">const</span> offset = (pageNum - <span class="number">1</span>) * pageSize; <span class="comment">// 计算偏移量</span></span><br><span class="line">query += <span class="string">&#x27; LIMIT ? OFFSET ?&#x27;</span>;</span><br><span class="line">params.<span class="title function_">push</span>(<span class="built_in">parseInt</span>(pageSize), <span class="built_in">parseInt</span>(offset));</span><br></pre></td></tr></table></figure><ol><li><p><strong>参数定义：</strong></p><ul><li><code>pageNum</code>: 当前页码（从前端请求中传入，默认值为 <code>1</code>）。</li><li><code>pageSize</code>: 每页显示的记录条数（从前端请求中传入，默认值为 <code>10</code>）。</li><li><code>offset</code>: 偏移量，即查询从哪一条记录开始。</li></ul></li><li><p><strong>偏移量的计算：</strong></p><ul><li><p><strong>公式：</strong></p><p><img src="1736856432895.png" alt="计算偏移量"></p><ul><li><code>pageNum - 1</code>: 计算从第几页开始，第一页 <code>pageNum=1</code> 时，偏移量为 <code>0</code>。</li><li>乘以 <code>pageSize</code>: 确定要跳过的记录条数。</li></ul></li><li><p><strong>示例：</strong></p><ul><li>假设每页显示 10 条记录：<ul><li>第 1 页：<code>offset = (1 - 1) * 10 = 0</code>（从第 0 条记录开始）。</li><li>第 2 页：<code>offset = (2 - 1) * 10 = 10</code>（从第 10 条记录开始）。</li><li>第 3 页：<code>offset = (3 - 1) * 10 = 20</code>（从第 20 条记录开始）。</li></ul></li></ul></li></ul></li><li><p><strong>SQL 中的分页：</strong></p><ul><li><p><strong>LIMIT ?</strong>: 限制返回的记录条数，<code>pageSize</code> 决定每页的记录数量。</p></li><li><p><strong>OFFSET ?</strong>: 跳过指定数量的记录，<code>offset</code> 决定从哪一条记录开始。</p></li><li><p><strong>完整示例 SQL：</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> tasklist </span><br><span class="line"><span class="keyword">WHERE</span> isdelete <span class="operator">=</span> <span class="number">0</span> <span class="keyword">AND</span> is_check <span class="operator">=</span> <span class="number">1</span> </span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> created_at <span class="keyword">DESC</span> </span><br><span class="line">LIMIT <span class="number">10</span> <span class="keyword">OFFSET</span> <span class="number">20</span>;</span><br></pre></td></tr></table></figure><ul><li>每页显示 <code>10</code> 条记录，跳过前 <code>20</code> 条（即返回第 21~30 条记录）。</li></ul></li></ul></li></ol><hr><p>   <strong>查询总数（Total）逻辑</strong></p><p>   分页需要知道总记录数，以便前端计算分页按钮或判断是否加载更多数据。</p>   <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">const totalQuery <span class="operator">=</span> <span class="string">&#x27;SELECT COUNT(*) AS total FROM tasklist WHERE isdelete = 0 AND is_check = 1&#x27;</span>;</span><br><span class="line">const [totalResult] <span class="operator">=</span> await db.query(totalQuery);</span><br><span class="line">const total <span class="operator">=</span> totalResult[<span class="number">0</span>].total;</span><br></pre></td></tr></table></figure><ol><li><p><strong>SQL 查询解释：</strong></p><ul><li><strong>SELECT COUNT(*) AS total</strong>: 统计 <code>tasklist</code> 表中符合条件的总记录数。</li><li><strong>WHERE 条件</strong>: 只统计未被删除且已审核的记录。</li><li>不受 <code>LIMIT</code> 和 <code>OFFSET</code> 限制，返回的是完整数据集的记录总数。</li></ul></li><li><p><strong>结果意义：</strong></p><ul><li><p><code>total</code>: 总记录数，供前端分页使用。</p></li><li><p>前端可以用以下公式计算总页数：</p><p><img src="1736821427654.png" alt="计算总数"></p></li></ul></li></ol><hr><p>   <strong>分页的工作流程</strong></p><ol><li><strong>前端传参：</strong><ul><li>用户请求某一页数据，前端发送参数：<code>pageNum</code> 和 <code>pageSize</code>。</li></ul></li><li><strong>后端接收：</strong><ul><li>通过 <code>pageNum</code> 和 <code>pageSize</code> 计算 <code>offset</code>。</li><li>使用 <code>LIMIT</code> 和 <code>OFFSET</code> 限制返回的记录条数。</li></ul></li><li><strong>返回数据：</strong><ul><li>返回分页数据（<code>rows</code>）和总记录数（<code>total</code>）。</li><li>前端可以根据 <code>total</code> 决定是否还有更多数据。</li></ul></li></ol><hr><p>   <strong>注意事项</strong></p><ol><li><p><strong>性能优化：</strong></p><ul><li>当数据量很大时，直接使用 <code>OFFSET</code> 可能导致性能问题，因为数据库需要跳过大量数据。</li><li><strong>优化方法</strong>：通过索引字段（如 <code>id</code> 或 <code>created_at</code>）使用游标进行分页查询。</li></ul><p><strong>示例：</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> tasklist </span><br><span class="line"><span class="keyword">WHERE</span> isdelete <span class="operator">=</span> <span class="number">0</span> <span class="keyword">AND</span> is_check <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> id <span class="operator">&gt;</span> ? </span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> id <span class="keyword">ASC</span> </span><br><span class="line">LIMIT <span class="number">10</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>边界情况处理：</strong></p><ul><li><code>pageNum</code> 小于 1：将其修正为 <code>1</code>。</li><li><code>pageSize</code> 超过合理范围：设置最大值（如 <code>100</code>）。</li><li>总数为 <code>0</code> 时：返回空数据，并标记分页已完成。</li></ul></li></ol><hr><p>   <strong>总结</strong></p><p>   分页逻辑的核心是通过 <code>LIMIT</code> 和 <code>OFFSET</code> 控制查询范围，并通过计算偏移量确定从哪一条记录开始查询。通过统计总记录数，确保前端能够正确显示分页状态或终止加载更多的逻辑。</p>              </div>            </details><h2 id="13-按照范式标准，创建用户收藏表"><a href="#13-按照范式标准，创建用户收藏表" class="headerlink" title="13. 按照范式标准，创建用户收藏表"></a>13. 按照范式标准，创建用户收藏表</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <ol><li><p>首先，创建数据库表</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> task_favorites (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,        <span class="comment">-- 主键</span></span><br><span class="line">    accounts <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,                     <span class="comment">-- 用户ID（外键关联用户表）</span></span><br><span class="line">    task_id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,                     <span class="comment">-- 任务ID（外键关联任务表）</span></span><br><span class="line">    created_at DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>, <span class="comment">-- 收藏时间</span></span><br><span class="line">    <span class="keyword">UNIQUE</span> KEY (accounts, task_id),            <span class="comment">-- 用户和任务的唯一关系，防止重复收藏</span></span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (accounts) <span class="keyword">REFERENCES</span> users(accounts) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE, <span class="comment">-- 外键关联用户表</span></span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (task_id) <span class="keyword">REFERENCES</span> tasklist(task_id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE <span class="comment">-- 外键关联任务表</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>说明：</p><ul><li><code>user_id</code> 和 <code>task_id</code> 使用外键关联 <code>users</code> 表和 <code>tasklist</code> 表，保证数据的一致性。</li><li><code>UNIQUE KEY (user_id, task_id)</code> 防止同一用户对同一任务重复收藏。</li><li><code>ON DELETE CASCADE</code> 确保父表删除对应记录时，自动删除 <code>user_favorites</code> 表中相关的关联数据。</li></ul><p>外键关联任务表：</p><ul><li><p>在 <code>FOREIGN KEY (task_id) REFERENCES tasklist(id) ON DELETE CASCADE</code> 中：</p><p><strong>tasklist</strong>：表示外键所引用的目标表名称，即这里的 <code>tasklist</code> 是任务表。</p><p><strong>task_id</strong>：表示 <code>tasklist</code> 表中的主键（Primary Key）。它是目标表的列名称，用来唯一标识 <code>tasklist</code> 表中的每一行数据。</p></li><li><p>意义是确保<code>task_id</code>的值只能是<code>tasklist</code>表中<code>task_id</code>列中已经存在的值，从而维持数据的一致性和完整性。</p><p>如果尝试向<code>task_favorites</code>表中插入<code>tasklist</code>中不存在的<code>task_id</code>记录，就会报错..</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">ERROR <span class="number">1452</span> (<span class="number">23000</span>): Cannot <span class="keyword">add</span> <span class="keyword">or</span> <span class="keyword">update</span> a child <span class="type">row</span>: a <span class="keyword">foreign</span> key <span class="keyword">constraint</span> fails</span><br></pre></td></tr></table></figure></li></ul><p>创建外键关联任务表之前，需要做一些准备工作</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span> 为指定列创建索引</span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_accounts <span class="keyword">ON</span> users(accounts);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_task_id <span class="keyword">ON</span> tasklist(task_id);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>封装添加收藏关系的接口</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 任务收藏接口</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">taskFavorite</span> = <span class="keyword">async</span> (<span class="params">req, res</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; task_id &#125; = req.<span class="property">body</span> <span class="comment">// 从请求的查询参数中获取任务ID</span></span><br><span class="line">  <span class="keyword">const</span> &#123; accounts &#125; = req.<span class="property">auth</span> <span class="comment">// 从请求的认证信息中获取用户账户（user_id）</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 查询当前用户是否已收藏该任务</span></span><br><span class="line">    <span class="keyword">const</span> sql = <span class="string">&#x27;SELECT * FROM task_favorites WHERE accounts = ? AND task_id = ?&#x27;</span></span><br><span class="line">    <span class="keyword">const</span> [rows] = <span class="keyword">await</span> db.<span class="title function_">query</span>(sql, [accounts, task_id])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (rows.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">// 如果已收藏，则执行取消收藏</span></span><br><span class="line">      <span class="keyword">const</span> sqlDelete = <span class="string">&#x27;DELETE FROM task_favorites WHERE accounts = ? AND task_id = ?&#x27;</span></span><br><span class="line">      <span class="keyword">await</span> db.<span class="title function_">query</span>(sqlDelete, [accounts, task_id])</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 返回取消收藏的状态</span></span><br><span class="line">      res.<span class="title function_">send</span>(&#123;</span><br><span class="line">        <span class="attr">code</span>: <span class="number">200</span>,</span><br><span class="line">        <span class="attr">success</span>: <span class="string">&#x27;ok&#x27;</span>,</span><br><span class="line">        <span class="attr">result</span>: &#123;</span><br><span class="line">          <span class="attr">errCode</span>: <span class="number">200</span>,</span><br><span class="line">          <span class="attr">msg</span>: <span class="string">&#x27;已取消收藏&#x27;</span>,</span><br><span class="line">          <span class="attr">data</span>: &#123;</span><br><span class="line">            <span class="attr">status</span>: <span class="number">0</span> <span class="comment">// 收藏状态为 0，表示未收藏</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 如果未收藏，则执行添加收藏</span></span><br><span class="line">      <span class="keyword">const</span> sqlInsert = <span class="string">&#x27;INSERT INTO task_favorites (accounts, task_id) VALUES (?, ?)&#x27;</span></span><br><span class="line">      <span class="keyword">await</span> db.<span class="title function_">query</span>(sqlInsert, [accounts, task_id])</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 返回添加收藏的状态</span></span><br><span class="line">      res.<span class="title function_">send</span>(&#123;</span><br><span class="line">        <span class="attr">code</span>: <span class="number">200</span>,</span><br><span class="line">        <span class="attr">success</span>: <span class="string">&#x27;ok&#x27;</span>,</span><br><span class="line">        <span class="attr">result</span>: &#123;</span><br><span class="line">          <span class="attr">errCode</span>: <span class="number">200</span>,</span><br><span class="line">          <span class="attr">msg</span>: <span class="string">&#x27;已添加收藏&#x27;</span>,</span><br><span class="line">          <span class="attr">data</span>: &#123;</span><br><span class="line">            <span class="attr">status</span>: <span class="number">1</span> <span class="comment">// 收藏状态为 1，表示已收藏</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="comment">// 处理错误</span></span><br><span class="line">    res.<span class="title function_">cc</span>(err)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里需要注意一下，前端携带参数发起 post 请求，后端接收时，需要使用req.body进行接收，否则接收不到。</p></li></ol><details class="folding-tag" ><summary> 顺便说一下 </summary>              <div class='content'>              <ol><li><p>不同api请求方式的参数接收方式</p><p><strong>GET 请求</strong>：参数通过 URL 查询字符串（<code>req.query</code>）传递。</p><p><strong>POST 请求</strong>：参数通过请求体（<code>req.body</code>）传递。</p><p><strong>PUT 请求</strong>：参数通过请求体（<code>req.body</code>）传递，路径参数通过 <code>req.params</code> 获取。</p><p><strong>DELETE 请求</strong>：参数通常通过路径参数（<code>req.params</code>）传递，少量使用请求体。</p></li></ol><p><strong>特殊情况：POST 请求的 JSON 数据</strong></p><p>对于 <code>POST</code> 请求，如果发送的是 JSON 数据，后端需要使用中间件来解析请求体中的 JSON 数据。例如在 Express 中，使用 <code>express.json()</code> 来解析 JSON 数据。</p>              </div>            </details>              </div>            </details><h2 id="14-使用联合查询，合并需要返回的数据"><a href="#14-使用联合查询，合并需要返回的数据" class="headerlink" title="14.使用联合查询，合并需要返回的数据"></a>14.使用联合查询，合并需要返回的数据</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">首先从请求头中获取目标信息</button><button type="button" class="tab">编写联合查询逻辑</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>将从请求头中获取用户信息的逻辑设计为一个中间件</strong></p><p>在根目录创建 /utils/handleToken.js</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入配置文件</span></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">&#x27;../config&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleToken</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 从请求头的 &#x27;x-access-token&#x27; 中获取 token</span></span><br><span class="line">  <span class="keyword">let</span> token = req.<span class="property">headers</span>[<span class="string">&#x27;x-access-token&#x27;</span>] || req.<span class="property">headers</span>[<span class="string">&#x27;authorization&#x27;</span>] <span class="comment">// 支持两种方式获取 Token</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 如果存在 Token 且包含 &#x27;Bearer &#x27; 前缀</span></span><br><span class="line">  <span class="keyword">if</span> (token &amp;&amp; token.<span class="title function_">startsWith</span>(<span class="string">&#x27;Bearer &#x27;</span>)) &#123;</span><br><span class="line">    token = token.<span class="title function_">slice</span>(<span class="number">7</span>, token.<span class="property">length</span>) <span class="comment">// 移除 &#x27;Bearer &#x27; 前缀</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!token) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">send</span>(&#123; <span class="attr">code</span>: <span class="number">401</span>, <span class="attr">msg</span>: <span class="string">&#x27;缺少 token，认证失败&#x27;</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 替换为你的 JWT 密钥</span></span><br><span class="line">    <span class="keyword">const</span> decoded = jwt.<span class="title function_">verify</span>(token, config.<span class="property">jwtSecretKey</span>)</span><br><span class="line">    req.<span class="property">accounts</span> = decoded.<span class="property">accounts</span> <span class="comment">// 将解析出的用户信息存入 req 对象</span></span><br><span class="line">    <span class="title function_">next</span>() <span class="comment">// 继续处理请求</span></span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Token 验证失败:&#x27;</span>, err)</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">send</span>(&#123; <span class="attr">code</span>: <span class="number">401</span>, <span class="attr">msg</span>: <span class="string">&#x27;无效的 token&#x27;</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123; handleToken &#125;</span><br></pre></td></tr></table></figure><p>然后，在对应路由中添加该中间件</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Router</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = <span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; handleToken &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../utils/handleToken&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入处理函数</span></span><br><span class="line"><span class="keyword">const</span> &#123; taskAllList,taskDetail,hotSearch &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/task&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 挂载路由</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/task/taskAllList&#x27;</span>,taskAllList)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在请求任务详情之前验证 token</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/task/getTaskDetails&#x27;</span>,handleToken,taskDetail)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/position/public/getHotSeach&#x27;</span>,hotSearch)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出路由</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><p>然后，在处理逻辑中，就可以直接进行接收了  /</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> accounts = req.<span class="property">accounts</span></span><br></pre></td></tr></table></figure><p>其实吧，在 app.js 中，有如下一个中间件了解一下</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 一定要在路由之前，应用此中间件</span></span><br><span class="line"><span class="keyword">const</span> &#123; expressjwt &#125; = <span class="built_in">require</span>(<span class="string">&#x27;express-jwt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">&#x27;./config&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(</span><br><span class="line">  <span class="title function_">expressjwt</span>(&#123;</span><br><span class="line">    <span class="attr">secret</span>: config.<span class="property">jwtSecretKey</span>, <span class="comment">// 与生成 Token 时的密钥保持一致</span></span><br><span class="line">    <span class="attr">algorithms</span>: [<span class="string">&#x27;HS256&#x27;</span>], <span class="comment">// 确保算法与 Token 的签名方式匹配</span></span><br><span class="line">    <span class="attr">getToken</span>: <span class="function">(<span class="params">req</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 从 x-access-token 提取 Token</span></span><br><span class="line">      <span class="keyword">const</span> token = req.<span class="property">headers</span>[<span class="string">&#x27;x-access-token&#x27;</span>]</span><br><span class="line">      <span class="keyword">if</span> (token &amp;&amp; token.<span class="title function_">startsWith</span>(<span class="string">&#x27;Bearer &#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> token.<span class="title function_">slice</span>(<span class="number">7</span>) <span class="comment">// 去掉 &quot;Bearer &quot; 前缀</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;).<span class="title function_">unless</span>(&#123;</span><br><span class="line">    <span class="attr">path</span>: [<span class="regexp">/^\/api\/login(\/.*)?$/</span>] <span class="comment">// 豁免登录相关接口</span></span><br><span class="line">  &#125;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p> <code>express-jwt</code> 中间件在验证 Token 成功后，自动为当前请求对象 <code>req</code> 添加的一个属性，即req.auth。这个属性存储的是解析后的 JWT <strong>Payload</strong> 数据（也就是在生成 Token 时嵌入的用户信息），因此，可以对其进行解构以获取目标信息：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; accounts &#125; = req.<span class="property">auth</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p><strong>/router_handle/task.js</strong></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 任务详情接口</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">taskDetail</span> = <span class="keyword">async</span> (<span class="params">req, res</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 从中间件中接受解析出的 accounts</span></span><br><span class="line">    <span class="comment">// const accounts = req.accounts</span></span><br><span class="line">    <span class="comment">// 从请求参数中解构出来要查询的任务id</span></span><br><span class="line">    <span class="keyword">const</span> &#123; task_id &#125; = req.<span class="property">query</span></span><br><span class="line">    <span class="keyword">const</span> &#123; accounts &#125; = req.<span class="property">auth</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!accounts) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">send</span>(&#123; <span class="attr">code</span>: <span class="number">401</span>, <span class="attr">msg</span>: <span class="string">&#x27;用户未登录或无效 token&#x27;</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查询任务详情的SQL语句</span></span><br><span class="line">    <span class="keyword">const</span> sql = <span class="string">&#x27;SELECT * FROM tasklist WHERE task_id = ?&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行查询任务详情的SQL语句</span></span><br><span class="line">    <span class="keyword">const</span> [result] = <span class="keyword">await</span> db.<span class="title function_">query</span>(sql, task_id)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> taskDetail = result[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查询收藏关系的 sql 语句</span></span><br><span class="line">    <span class="keyword">const</span> sqlFavorite = <span class="string">&#x27;SELECT * FROM task_favorites WHERE accounts = ? AND task_id = ?&#x27;</span></span><br><span class="line">    <span class="comment">// 执行查询收藏关系</span></span><br><span class="line">    <span class="keyword">const</span> [favoriteResult] = <span class="keyword">await</span> db.<span class="title function_">query</span>(sqlFavorite, [accounts, task_id])</span><br><span class="line">    <span class="comment">// 根据查询结果，设置 status 值</span></span><br><span class="line">    <span class="keyword">const</span> status = favoriteResult.<span class="property">length</span> &gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span> <span class="comment">// 1 表示已收藏，0 表示未收藏</span></span><br><span class="line">    <span class="comment">// 响应查询结果</span></span><br><span class="line">    res.<span class="title function_">send</span>(&#123;</span><br><span class="line">      <span class="attr">code</span>: <span class="number">200</span>,</span><br><span class="line">      <span class="attr">result</span>: &#123;</span><br><span class="line">        <span class="attr">records</span>: [&#123;</span><br><span class="line">          ...taskDetail,</span><br><span class="line">          status</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">msg</span>: <span class="string">&#x27;查询任务详情成功！&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    res.<span class="title function_">cc</span>(e) <span class="comment">// 捕获并返回错误</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><h2 id="100-这里必须留一个小尾巴，否则，编辑软件会报错，后面视情况会寻找原因，大概率是编辑器原因！"><a href="#100-这里必须留一个小尾巴，否则，编辑软件会报错，后面视情况会寻找原因，大概率是编辑器原因！" class="headerlink" title="100. 这里必须留一个小尾巴，否则，编辑软件会报错，后面视情况会寻找原因，大概率是编辑器原因！"></a>100. 这里必须留一个小尾巴，否则，编辑软件会报错，后面视情况会寻找原因，大概率是编辑器原因！</h2><p>ttttt 不会错版了kugei</p>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 后端 </tag>
            
            <tag> api </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>大事件项目后端api全过程实现</title>
      <link href="/posts/2b6a0f4d/"/>
      <url>/posts/2b6a0f4d/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><h2 id="Headline"><a href="#Headline" class="headerlink" title="Headline"></a>Headline</h2><blockquote><p>大事件后台 API 项目，API 接口文档请参考 <a href="https://www.showdoc.cc/escook?page_id=3707158761215217">https://www.showdoc.cc/escook?page_id=3707158761215217</a></p></blockquote><h2 id="1-初始化"><a href="#1-初始化" class="headerlink" title="1. 初始化"></a>1. 初始化</h2><h3 id="1-1-创建项目"><a href="#1-1-创建项目" class="headerlink" title="1.1 创建项目"></a>1.1 创建项目</h3><ol><li>新建 <code>api_server</code> 文件夹作为项目根目录，并在项目根目录中运行如下的命令，初始化包管理配置文件：</li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure><ol><li>运行如下的命令，安装特定版本的 <code>express</code>：</li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i express@4.17.1</span><br></pre></td></tr></table></figure><ol><li>在项目根目录中新建 <code>app.js</code> 作为整个项目的入口文件，并初始化如下的代码：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入 express 模块</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建 express 的服务器实例</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// write your code here...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用 app.listen 方法，指定端口号并启动web服务器</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3007</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;api server running at http://127.0.0.1:3007&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="1-2-配置-cors-跨域"><a href="#1-2-配置-cors-跨域" class="headerlink" title="1.2 配置 cors 跨域"></a>1.2 配置 cors 跨域</h3><ol><li>运行如下的命令，安装 <code>cors</code> 中间件：</li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i cors@2.8.5</span><br></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 中导入并配置 <code>cors</code> 中间件：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入 cors 中间件</span></span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>)</span><br><span class="line"><span class="comment">// 将 cors 注册为全局中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>())</span><br></pre></td></tr></table></figure><h3 id="1-3-配置解析表单数据的中间件"><a href="#1-3-配置解析表单数据的中间件" class="headerlink" title="1.3 配置解析表单数据的中间件"></a>1.3 配置解析表单数据的中间件</h3><ol><li>通过如下的代码，配置解析 <code>application/x-www-form-urlencoded</code> 格式的表单数据的中间件：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br></pre></td></tr></table></figure><h3 id="1-4-初始化路由相关的文件夹"><a href="#1-4-初始化路由相关的文件夹" class="headerlink" title="1.4 初始化路由相关的文件夹"></a>1.4 初始化路由相关的文件夹</h3><ol><li><p>在项目根目录中，新建 <code>router</code> 文件夹，用来存放所有的<code>路由</code>模块</p><blockquote><p>路由模块中，只存放客户端的请求与处理函数之间的映射关系</p></blockquote></li><li><p>在项目根目录中，新建 <code>router_handler</code> 文件夹，用来存放所有的 <code>路由处理函数模块</code></p><blockquote><p>路由处理函数模块中，专门负责存放每个路由对应的处理函数</p></blockquote></li></ol><h3 id="1-5-初始化用户路由模块"><a href="#1-5-初始化用户路由模块" class="headerlink" title="1.5 初始化用户路由模块"></a>1.5 初始化用户路由模块</h3><ol><li>在 <code>router</code> 文件夹中，新建 <code>user.js</code> 文件，作为用户的路由模块，并初始化代码如下：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建路由对象</span></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册新用户</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/reguser&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;reguser OK&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;login OK&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将路由对象共享出去</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 中，导入并使用 <code>用户路由模块</code> ：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入并注册用户路由模块</span></span><br><span class="line"><span class="keyword">const</span> userRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/user&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, userRouter)</span><br></pre></td></tr></table></figure><h3 id="1-6-抽离用户路由模块中的处理函数"><a href="#1-6-抽离用户路由模块中的处理函数" class="headerlink" title="1.6 抽离用户路由模块中的处理函数"></a>1.6 抽离用户路由模块中的处理函数</h3><blockquote><p>目的：为了保证 <code>路由模块</code> 的纯粹性，所有的 <code>路由处理函数</code>，必须抽离到对应的 <code>路由处理函数模块</code> 中</p></blockquote><ol><li>在 <code>/router_handler/user.js</code> 中，使用 <code>exports</code> 对象，分别向外共享如下两个 <code>路由处理函数</code> ：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 在这里定义和用户相关的路由处理函数，供 /router/user.js 模块进行调用</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册用户的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">regUser</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;reguser OK&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">login</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;login OK&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>将 <code>/router/user.js</code> 中的代码修改为如下结构：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入用户路由处理函数模块</span></span><br><span class="line"><span class="keyword">const</span> userHandler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/user&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册新用户</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/reguser&#x27;</span>, userHandler.<span class="property">regUser</span>)</span><br><span class="line"><span class="comment">// 登录</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, userHandler.<span class="property">login</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><h2 id="2-登录注册"><a href="#2-登录注册" class="headerlink" title="2. 登录注册"></a>2. 登录注册</h2><h3 id="2-1-新建-ev-users-表"><a href="#2-1-新建-ev-users-表" class="headerlink" title="2.1 新建 ev_users 表"></a>2.1 新建 ev_users 表</h3><ol><li>在 <code>my_db_01</code> 数据库中，新建 <code>ev_users</code> 表如下：<br><img src="./images/1.jpg" alt="ev_users表结构"></li></ol><h3 id="2-2-安装并配置-mysql-模块"><a href="#2-2-安装并配置-mysql-模块" class="headerlink" title="2.2 安装并配置 mysql 模块"></a>2.2 安装并配置 mysql 模块</h3><blockquote><p>在 API 接口项目中，需要安装并配置 <code>mysql</code> 这个第三方模块，来连接和操作 MySQL 数据库</p></blockquote><ol><li>运行如下命令，安装 <code>mysql</code> 模块：</li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i mysql@2.18.1</span><br></pre></td></tr></table></figure><ol><li>在项目根目录中新建 <code>/db/index.js</code> 文件，在此自定义模块中创建数据库的连接对象：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入 mysql 模块</span></span><br><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建数据库连接对象</span></span><br><span class="line"><span class="keyword">const</span> db = mysql.<span class="title function_">createPool</span>(&#123;</span><br><span class="line">  <span class="attr">host</span>: <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">  <span class="attr">user</span>: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">  <span class="attr">password</span>: <span class="string">&#x27;admin123&#x27;</span>,</span><br><span class="line">  <span class="attr">database</span>: <span class="string">&#x27;my_db_01&#x27;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向外共享 db 数据库连接对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = db</span><br></pre></td></tr></table></figure><h3 id="2-3-注册"><a href="#2-3-注册" class="headerlink" title="2.3 注册"></a>2.3 注册</h3><h4 id="2-3-0-实现步骤"><a href="#2-3-0-实现步骤" class="headerlink" title="2.3.0 实现步骤"></a>2.3.0 实现步骤</h4><ol><li>检测表单数据是否合法</li><li>检测用户名是否被占用</li><li>对密码进行加密处理</li><li>插入新用户</li></ol><h4 id="2-3-1-检测表单数据是否合法"><a href="#2-3-1-检测表单数据是否合法" class="headerlink" title="2.3.1 检测表单数据是否合法"></a>2.3.1 检测表单数据是否合法</h4><ol><li>判断用户名和密码是否为空</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 接收表单数据</span></span><br><span class="line"><span class="keyword">const</span> userinfo = req.<span class="property">body</span></span><br><span class="line"><span class="comment">// 判断数据是否合法</span></span><br><span class="line"><span class="keyword">if</span> (!userinfo.<span class="property">username</span> || !userinfo.<span class="property">password</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">message</span>: <span class="string">&#x27;用户名或密码不能为空！&#x27;</span> &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-3-2-检测用户名是否被占用"><a href="#2-3-2-检测用户名是否被占用" class="headerlink" title="2.3.2 检测用户名是否被占用"></a>2.3.2 检测用户名是否被占用</h4><ol><li>导入数据库操作模块：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../db/index&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li>定义 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ev_users where username=?`</span></span><br></pre></td></tr></table></figure><ol><li>执行 SQL 语句并根据结果判断用户名是否被占用：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, [userinfo.<span class="property">username</span>], <span class="keyword">function</span> (<span class="params">err, results</span>) &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">message</span>: err.<span class="property">message</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 用户名被占用</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">message</span>: <span class="string">&#x27;用户名被占用，请更换其他用户名！&#x27;</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// <span class="doctag">TODO:</span> 用户名可用，继续后续流程...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="2-3-3-对密码进行加密处理"><a href="#2-3-3-对密码进行加密处理" class="headerlink" title="2.3.3 对密码进行加密处理"></a>2.3.3 对密码进行加密处理</h4><blockquote><p>为了保证密码的安全性，不建议在数据库以 <code>明文</code> 的形式保存用户密码，推荐对密码进行 <code>加密存储</code></p></blockquote><hr><p>在当前项目中，使用 <code>bcryptjs</code> 对用户密码进行加密，优点：</p><ul><li>加密之后的密码，<strong>无法被逆向破解</strong></li><li>同一明文密码多次加密，得到的<strong>加密结果各不相同</strong>，保证了安全性</li></ul><hr><ol><li>运行如下命令，安装指定版本的 <code>bcryptjs</code> ：</li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i bcryptjs@2.4.3</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/user.js</code> 中，导入 <code>bcryptjs</code> ：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> bcrypt = <span class="built_in">require</span>(<span class="string">&#x27;bcryptjs&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li>在注册用户的处理函数中，确认用户名可用之后，调用 <code>bcrypt.hashSync(明文密码, 随机盐的长度)</code> 方法，对用户的密码进行加密处理：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 对用户的密码,进行 bcrype 加密，返回值是加密之后的密码字符串</span></span><br><span class="line">userinfo.<span class="property">password</span> = bcrypt.<span class="title function_">hashSync</span>(userinfo.<span class="property">password</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure><h4 id="2-3-4-插入新用户"><a href="#2-3-4-插入新用户" class="headerlink" title="2.3.4 插入新用户"></a>2.3.4 插入新用户</h4><ol><li>定义插入用户的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;insert into ev_users set ?&#x27;</span></span><br></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行 SQL 语句，插入新用户：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, &#123; <span class="attr">username</span>: userinfo.<span class="property">username</span>, <span class="attr">password</span>: userinfo.<span class="property">password</span> &#125;, <span class="keyword">function</span> (<span class="params">err, results</span>) &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">message</span>: err.<span class="property">message</span> &#125;)</span><br><span class="line">  <span class="comment">// SQL 语句执行成功，但影响行数不为 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">message</span>: <span class="string">&#x27;注册用户失败，请稍后再试！&#x27;</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 注册成功</span></span><br><span class="line">  res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">0</span>, <span class="attr">message</span>: <span class="string">&#x27;注册成功！&#x27;</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="2-4-优化-res-send-代码"><a href="#2-4-优化-res-send-代码" class="headerlink" title="2.4 优化 res.send() 代码"></a>2.4 优化 res.send() 代码</h3><blockquote><p>在处理函数中，需要多次调用 <code>res.send()</code> 向客户端响应 <code>处理失败</code> 的结果，为了简化代码，可以手动封装一个 res.cc() 函数</p></blockquote><ol><li>在 <code>app.js</code> 中，所有路由之前，声明一个全局中间件，为 res 对象挂载一个 <code>res.cc()</code> 函数 ：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 响应数据的中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  <span class="comment">// status = 0 为成功； status = 1 为失败； 默认将 status 的值设置为 1，方便处理失败的情况</span></span><br><span class="line">  res.<span class="property">cc</span> = <span class="keyword">function</span> (<span class="params">err, status = <span class="number">1</span></span>) &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(&#123;</span><br><span class="line">      <span class="comment">// 状态</span></span><br><span class="line">      status,</span><br><span class="line">      <span class="comment">// 状态描述，判断 err 是 错误对象 还是 字符串</span></span><br><span class="line">      <span class="attr">message</span>: err <span class="keyword">instanceof</span> <span class="title class_">Error</span> ? err.<span class="property">message</span> : err,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="2-5-优化表单数据验证"><a href="#2-5-优化表单数据验证" class="headerlink" title="2.5 优化表单数据验证"></a>2.5 优化表单数据验证</h3><blockquote><p>表单验证的原则：前端验证为辅，后端验证为主，后端<strong>永远不要相信</strong>前端提交过来的<strong>任何内容</strong></p></blockquote><p>在实际开发中，前后端都需要对表单的数据进行合法性的验证，而且，<strong>后端做为数据合法性验证的最后一个关口</strong>，在拦截非法数据方面，起到了至关重要的作用。</p><p>单纯的使用 <code>if...else...</code> 的形式对数据合法性进行验证，效率低下、出错率高、维护性差。因此，推荐使用<strong>第三方数据验证模块</strong>，来降低出错率、提高验证的效率与可维护性，<strong>让后端程序员把更多的精力放在核心业务逻辑的处理上</strong>。</p><ol><li>安装 <code>@hapi/joi</code> 包，为表单中携带的每个数据项，定义验证规则：</li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install @hapi/joi@17.1.0</span><br></pre></td></tr></table></figure><ol><li>安装 <code>@escook/express-joi</code> 中间件，来实现自动对表单数据进行验证的功能：</li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i @escook/express-joi</span><br></pre></td></tr></table></figure><ol><li>新建 <code>/schema/user.js</code> 用户信息验证规则模块，并初始化代码如下：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> joi = <span class="built_in">require</span>(<span class="string">&#x27;@hapi/joi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * string() 值必须是字符串</span></span><br><span class="line"><span class="comment"> * alphanum() 值只能是包含 a-zA-Z0-9 的字符串</span></span><br><span class="line"><span class="comment"> * min(length) 最小长度</span></span><br><span class="line"><span class="comment"> * max(length) 最大长度</span></span><br><span class="line"><span class="comment"> * required() 值是必填项，不能为 undefined</span></span><br><span class="line"><span class="comment"> * pattern(正则表达式) 值必须符合正则表达式的规则</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 用户名的验证规则</span></span><br><span class="line"><span class="keyword">const</span> username = joi.<span class="title function_">string</span>().<span class="title function_">alphanum</span>().<span class="title function_">min</span>(<span class="number">1</span>).<span class="title function_">max</span>(<span class="number">10</span>).<span class="title function_">required</span>()</span><br><span class="line"><span class="comment">// 密码的验证规则</span></span><br><span class="line"><span class="keyword">const</span> password = joi</span><br><span class="line">  .<span class="title function_">string</span>()</span><br><span class="line">  .<span class="title function_">pattern</span>(<span class="regexp">/^[\S]&#123;6,12&#125;$/</span>)</span><br><span class="line">  .<span class="title function_">required</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册和登录表单的验证规则对象</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">reg_login_schema</span> = &#123;</span><br><span class="line">  <span class="comment">// 表示需要对 req.body 中的数据进行验证</span></span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    username,</span><br><span class="line">    password,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>修改 <code>/router/user.js</code> 中的代码如下：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入用户路由处理函数模块</span></span><br><span class="line"><span class="keyword">const</span> userHandler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/user&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 导入验证表单数据的中间件</span></span><br><span class="line"><span class="keyword">const</span> expressJoi = <span class="built_in">require</span>(<span class="string">&#x27;@escook/express-joi&#x27;</span>)</span><br><span class="line"><span class="comment">// 2. 导入需要的验证规则对象</span></span><br><span class="line"><span class="keyword">const</span> &#123; reg_login_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/user&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册新用户</span></span><br><span class="line"><span class="comment">// 3. 在注册新用户的路由中，声明局部中间件，对当前请求中携带的数据进行验证</span></span><br><span class="line"><span class="comment">// 3.1 数据验证通过后，会把这次请求流转给后面的路由处理函数</span></span><br><span class="line"><span class="comment">// 3.2 数据验证失败后，终止后续代码的执行，并抛出一个全局的 Error 错误，进入全局错误级别中间件中进行处理</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/reguser&#x27;</span>, <span class="title function_">expressJoi</span>(reg_login_schema), userHandler.<span class="property">regUser</span>)</span><br><span class="line"><span class="comment">// 登录</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, userHandler.<span class="property">login</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 的全局错误级别中间件中，捕获验证失败的错误，并把验证失败的结果响应给客户端：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> joi = <span class="built_in">require</span>(<span class="string">&#x27;@hapi/joi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">err, req, res, next</span>) &#123;</span><br><span class="line">  <span class="comment">// 数据验证失败</span></span><br><span class="line">  <span class="keyword">if</span> (err <span class="keyword">instanceof</span> joi.<span class="property">ValidationError</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line">  <span class="comment">// 未知错误</span></span><br><span class="line">  res.<span class="title function_">cc</span>(err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="2-6-登录"><a href="#2-6-登录" class="headerlink" title="2.6 登录"></a>2.6 登录</h3><h4 id="2-6-0-实现步骤"><a href="#2-6-0-实现步骤" class="headerlink" title="2.6.0 实现步骤"></a>2.6.0 实现步骤</h4><ol><li>检测表单数据是否合法</li><li>根据用户名查询用户的数据</li><li>判断用户输入的密码是否正确</li><li>生成 JWT 的 Token 字符串</li></ol><h4 id="2-6-1-检测登录表单的数据是否合法"><a href="#2-6-1-检测登录表单的数据是否合法" class="headerlink" title="2.6.1 检测登录表单的数据是否合法"></a>2.6.1 检测登录表单的数据是否合法</h4><ol><li>将 <code>/router/user.js</code> 中 <code>登录</code> 的路由代码修改如下：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 登录的路由</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="title function_">expressJoi</span>(reg_login_schema), userHandler.<span class="property">login</span>)</span><br></pre></td></tr></table></figure><h4 id="2-6-2-根据用户名查询用户的数据"><a href="#2-6-2-根据用户名查询用户的数据" class="headerlink" title="2.6.2 根据用户名查询用户的数据"></a>2.6.2 根据用户名查询用户的数据</h4><ol><li>接收表单数据：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> userinfo = req.<span class="property">body</span></span><br></pre></td></tr></table></figure><ol><li>定义 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ev_users where username=?`</span></span><br></pre></td></tr></table></figure><ol><li>执行 SQL 语句，查询用户的数据：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, userinfo.<span class="property">username</span>, <span class="keyword">function</span> (<span class="params">err, results</span>) &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line">  <span class="comment">// 执行 SQL 语句成功，但是查询到数据条数不等于 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;登录失败！&#x27;</span>)</span><br><span class="line">  <span class="comment">// TODO：判断用户输入的登录密码是否和数据库中的密码一致</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="2-6-3-判断用户输入的密码是否正确"><a href="#2-6-3-判断用户输入的密码是否正确" class="headerlink" title="2.6.3 判断用户输入的密码是否正确"></a>2.6.3 判断用户输入的密码是否正确</h4><blockquote><p>核心实现思路：调用 <code>bcrypt.compareSync(用户提交的密码, 数据库中的密码)</code> 方法比较密码是否一致</p><p>返回值是布尔值（true 一致、false 不一致）</p></blockquote><p>具体的实现代码如下：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 拿着用户输入的密码,和数据库中存储的密码进行对比</span></span><br><span class="line"><span class="keyword">const</span> compareResult = bcrypt.<span class="title function_">compareSync</span>(userinfo.<span class="property">password</span>, results[<span class="number">0</span>].<span class="property">password</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果对比的结果等于 false, 则证明用户输入的密码错误</span></span><br><span class="line"><span class="keyword">if</span> (!compareResult) &#123;</span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;登录失败！&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO：登录成功，生成 Token 字符串</span></span><br></pre></td></tr></table></figure><h4 id="2-6-4-生成-JWT-的-Token-字符串"><a href="#2-6-4-生成-JWT-的-Token-字符串" class="headerlink" title="2.6.4 生成 JWT 的 Token 字符串"></a>2.6.4 生成 JWT 的 Token 字符串</h4><blockquote><p>核心注意点：在生成 Token 字符串的时候，一定要剔除 <strong>密码</strong> 和 <strong>头像</strong> 的值</p></blockquote><ol><li>通过 ES6 的高级语法，快速剔除 <code>密码</code> 和 <code>头像</code> 的值：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 剔除完毕之后，user 中只保留了用户的 id, username, nickname, email 这四个属性的值</span></span><br><span class="line"><span class="keyword">const</span> user = &#123; ...results[<span class="number">0</span>], <span class="attr">password</span>: <span class="string">&#x27;&#x27;</span>, <span class="attr">user_pic</span>: <span class="string">&#x27;&#x27;</span> &#125;</span><br></pre></td></tr></table></figure><ol><li>运行如下的命令，安装生成 Token 字符串的包：</li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i jsonwebtoken@8.5.1</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/user.js</code> 模块的头部区域，导入 <code>jsonwebtoken</code> 包：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 用这个包来生成 Token 字符串</span></span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li>创建 <code>config.js</code> 文件，并向外共享 <strong>加密</strong> 和 <strong>还原</strong> Token 的 <code>jwtSecretKey</code> 字符串：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">jwtSecretKey</span>: <span class="string">&#x27;itheima No1. ^_^&#x27;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>将用户信息对象加密成 Token 字符串：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入配置文件</span></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">&#x27;../config&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成 Token 字符串</span></span><br><span class="line"><span class="keyword">const</span> tokenStr = jwt.<span class="title function_">sign</span>(user, config.<span class="property">jwtSecretKey</span>, &#123;</span><br><span class="line">  <span class="attr">expiresIn</span>: <span class="string">&#x27;10h&#x27;</span>, <span class="comment">// token 有效期为 10 个小时</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol><li>将生成的 Token 字符串响应给客户端：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">res.<span class="title function_">send</span>(&#123;</span><br><span class="line">  <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">message</span>: <span class="string">&#x27;登录成功！&#x27;</span>,</span><br><span class="line">  <span class="comment">// 为了方便客户端使用 Token，在服务器端直接拼接上 Bearer 的前缀</span></span><br><span class="line">  <span class="attr">token</span>: <span class="string">&#x27;Bearer &#x27;</span> + tokenStr,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="2-7-配置解析-Token-的中间件"><a href="#2-7-配置解析-Token-的中间件" class="headerlink" title="2.7 配置解析 Token 的中间件"></a>2.7 配置解析 Token 的中间件</h3><ol><li>运行如下的命令，安装解析 Token 的中间件：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">npm i express-jwt@<span class="number">5.3</span><span class="number">.3</span></span><br></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 中注册路由之前，配置解析 Token 的中间件：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入配置文件</span></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">&#x27;./config&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解析 token 的中间件</span></span><br><span class="line"><span class="keyword">const</span> expressJWT = <span class="built_in">require</span>(<span class="string">&#x27;express-jwt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 .unless(&#123; path: [/^\/api\//] &#125;) 指定哪些接口不需要进行 Token 的身份认证</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">expressJWT</span>(&#123; <span class="attr">secret</span>: config.<span class="property">jwtSecretKey</span> &#125;).<span class="title function_">unless</span>(&#123; <span class="attr">path</span>: [<span class="regexp">/^\/api\//</span>] &#125;))</span><br></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 中的 <code>错误级别中间件</code> 里面，捕获并处理 Token 认证失败后的错误：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 错误中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">err, req, res, next</span>) &#123;</span><br><span class="line">  <span class="comment">// 省略其它代码...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 捕获身份认证失败的错误</span></span><br><span class="line">  <span class="keyword">if</span> (err.<span class="property">name</span> === <span class="string">&#x27;UnauthorizedError&#x27;</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;身份认证失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 未知错误...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="3-个人中心"><a href="#3-个人中心" class="headerlink" title="3. 个人中心"></a>3. 个人中心</h2><h3 id="3-1-获取用户的基本信息"><a href="#3-1-获取用户的基本信息" class="headerlink" title="3.1 获取用户的基本信息"></a>3.1 获取用户的基本信息</h3><h4 id="3-1-0-实现步骤"><a href="#3-1-0-实现步骤" class="headerlink" title="3.1.0 实现步骤"></a>3.1.0 实现步骤</h4><ol><li>初始化 <strong>路由</strong> 模块</li><li>初始化 <strong>路由处理函数</strong> 模块</li><li>获取用户的基本信息</li></ol><h4 id="3-1-1-初始化路由模块"><a href="#3-1-1-初始化路由模块" class="headerlink" title="3.1.1 初始化路由模块"></a>3.1.1 初始化路由模块</h4><ol><li>创建 <code>/router/userinfo.js</code> 路由模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入 express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建路由对象</span></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取用户的基本信息</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/userinfo&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向外共享路由对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 中导入并使用个人中心的路由模块：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入并使用用户信息路由模块</span></span><br><span class="line"><span class="keyword">const</span> userinfoRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/userinfo&#x27;</span>)</span><br><span class="line"><span class="comment">// 注意：以 /my 开头的接口，都是有权限的接口，需要进行 Token 身份认证</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/my&#x27;</span>, userinfoRouter)</span><br></pre></td></tr></table></figure><h4 id="3-1-2-初始化路由处理函数模块"><a href="#3-1-2-初始化路由处理函数模块" class="headerlink" title="3.1.2 初始化路由处理函数模块"></a>3.1.2 初始化路由处理函数模块</h4><ol><li>创建 <code>/router_handler/userinfo.js</code> 路由处理函数模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取用户基本信息的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">getUserInfo</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>修改 <code>/router/userinfo.js</code> 中的代码如下：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入用户信息的处理函数模块</span></span><br><span class="line"><span class="keyword">const</span> userinfo_handler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/userinfo&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取用户的基本信息</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/userinfo&#x27;</span>, userinfo_handler.<span class="property">getUserInfo</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><h4 id="3-1-3-获取用户的基本信息"><a href="#3-1-3-获取用户的基本信息" class="headerlink" title="3.1.3 获取用户的基本信息"></a>3.1.3 获取用户的基本信息</h4><ol><li>在 <code>/router_handler/userinfo.js</code> 头部导入数据库操作模块：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入数据库操作模块</span></span><br><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../db/index&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li>定义 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 根据用户的 id，查询用户的基本信息</span></span><br><span class="line"><span class="comment">// 注意：为了防止用户的密码泄露，需要排除 password 字段</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">`select id, username, nickname, email, user_pic from ev_users where id=?`</span></span><br></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 注意：req 对象上的 user 属性，是 Token 解析成功，express-jwt 中间件帮我们挂载上去的</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, req.<span class="property">user</span>.<span class="property">id</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 1. 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. 执行 SQL 语句成功，但是查询到的数据条数不等于 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;获取用户信息失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. 将用户信息响应给客户端</span></span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;获取用户基本信息成功！&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: results[<span class="number">0</span>],</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="3-2-更新用户的基本信息"><a href="#3-2-更新用户的基本信息" class="headerlink" title="3.2 更新用户的基本信息"></a>3.2 更新用户的基本信息</h3><h4 id="3-2-0-实现步骤"><a href="#3-2-0-实现步骤" class="headerlink" title="3.2.0 实现步骤"></a>3.2.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>实现更新用户基本信息的功能</li></ol><h4 id="3-2-1-定义路由和处理函数"><a href="#3-2-1-定义路由和处理函数" class="headerlink" title="3.2.1 定义路由和处理函数"></a>3.2.1 定义路由和处理函数</h4><ol><li>在 <code>/router/userinfo.js</code> 模块中，新增 <code>更新用户基本信息</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 更新用户的基本信息</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/userinfo&#x27;</span>, userinfo_handler.<span class="property">updateUserInfo</span>)</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/userinfo.js</code> 模块中，定义并向外共享 <code>更新用户基本信息</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 更新用户基本信息的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">updateUserInfo</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-2-2-验证表单数据"><a href="#3-2-2-验证表单数据" class="headerlink" title="3.2.2 验证表单数据"></a>3.2.2 验证表单数据</h4><ol><li>在 <code>/schema/user.js</code> 验证规则模块中，定义 <code>id</code>，<code>nickname</code>，<code>email</code> 的验证规则如下：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 定义 id, nickname, emial 的验证规则</span></span><br><span class="line"><span class="keyword">const</span> id = joi.<span class="title function_">number</span>().<span class="title function_">integer</span>().<span class="title function_">min</span>(<span class="number">1</span>).<span class="title function_">required</span>()</span><br><span class="line"><span class="keyword">const</span> nickname = joi.<span class="title function_">string</span>().<span class="title function_">required</span>()</span><br><span class="line"><span class="keyword">const</span> email = joi.<span class="title function_">string</span>().<span class="title function_">email</span>().<span class="title function_">required</span>()</span><br></pre></td></tr></table></figure><ol><li>并使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 验证规则对象 - 更新用户基本信息</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">update_userinfo_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    id,</span><br><span class="line">    nickname,</span><br><span class="line">    email,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router/userinfo.js</code> 模块中，导入验证数据合法性的中间件：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入验证数据合法性的中间件</span></span><br><span class="line"><span class="keyword">const</span> expressJoi = <span class="built_in">require</span>(<span class="string">&#x27;@escook/express-joi&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router/userinfo.js</code> 模块中，导入需要的验证规则对象：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入需要的验证规则对象</span></span><br><span class="line"><span class="keyword">const</span> &#123; update_userinfo_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/user&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router/userinfo.js</code> 模块中，修改 <code>更新用户的基本信息</code> 的路由如下：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 更新用户的基本信息</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/userinfo&#x27;</span>, <span class="title function_">expressJoi</span>(update_userinfo_schema), userinfo_handler.<span class="property">updateUserInfo</span>)</span><br></pre></td></tr></table></figure><h4 id="3-2-3-实现更新用户基本信息的功能"><a href="#3-2-3-实现更新用户基本信息的功能" class="headerlink" title="3.2.3 实现更新用户基本信息的功能"></a>3.2.3 实现更新用户基本信息的功能</h4><ol><li>定义待执行的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`update ev_users set ? where id=?`</span></span><br></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行 SQL 语句并传参：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, [req.<span class="property">body</span>, req.<span class="property">body</span>.<span class="property">id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 执行 SQL 语句成功，但影响行数不为 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;修改用户基本信息失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 修改用户信息成功</span></span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;修改用户基本信息成功！&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="3-3-重置密码"><a href="#3-3-重置密码" class="headerlink" title="3.3 重置密码"></a>3.3 重置密码</h3><h4 id="3-3-0-实现步骤"><a href="#3-3-0-实现步骤" class="headerlink" title="3.3.0 实现步骤"></a>3.3.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>实现重置密码的功能</li></ol><h4 id="3-3-1-定义路由和处理函数"><a href="#3-3-1-定义路由和处理函数" class="headerlink" title="3.3.1 定义路由和处理函数"></a>3.3.1 定义路由和处理函数</h4><ol><li>在 <code>/router/userinfo.js</code> 模块中，新增 <code>重置密码</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 重置密码的路由</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/updatepwd&#x27;</span>, userinfo_handler.<span class="property">updatePassword</span>)</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/userinfo.js</code> 模块中，定义并向外共享 <code>重置密码</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 重置密码的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">updatePassword</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-3-2-验证表单数据"><a href="#3-3-2-验证表单数据" class="headerlink" title="3.3.2 验证表单数据"></a>3.3.2 验证表单数据</h4><blockquote><p>核心验证思路：旧密码与新密码，必须符合密码的验证规则，并且新密码不能与旧密码一致！</p></blockquote><ol><li>在 <code>/schema/user.js</code> 模块中，使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 验证规则对象 - 重置密码</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">update_password_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    <span class="comment">// 使用 password 这个规则，验证 req.body.oldPwd 的值</span></span><br><span class="line">    <span class="attr">oldPwd</span>: password,</span><br><span class="line">    <span class="comment">// 使用 joi.not(joi.ref(&#x27;oldPwd&#x27;)).concat(password) 规则，验证 req.body.newPwd 的值</span></span><br><span class="line">    <span class="comment">// 解读：</span></span><br><span class="line">    <span class="comment">// 1. joi.ref(&#x27;oldPwd&#x27;) 表示 newPwd 的值必须和 oldPwd 的值保持一致</span></span><br><span class="line">    <span class="comment">// 2. joi.not(joi.ref(&#x27;oldPwd&#x27;)) 表示 newPwd 的值不能等于 oldPwd 的值</span></span><br><span class="line">    <span class="comment">// 3. .concat() 用于合并 joi.not(joi.ref(&#x27;oldPwd&#x27;)) 和 password 这两条验证规则</span></span><br><span class="line">    <span class="attr">newPwd</span>: joi.<span class="title function_">not</span>(joi.<span class="title function_">ref</span>(<span class="string">&#x27;oldPwd&#x27;</span>)).<span class="title function_">concat</span>(password),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router/userinfo.js</code> 模块中，导入需要的验证规则对象：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入需要的验证规则对象</span></span><br><span class="line"><span class="keyword">const</span> &#123; update_userinfo_schema, update_password_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/user&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li>并在 <code>重置密码的路由</code> 中，使用 <code>update_password_schema</code> 规则验证表单的数据，示例代码如下：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/updatepwd&#x27;</span>, <span class="title function_">expressJoi</span>(update_password_schema), userinfo_handler.<span class="property">updatePassword</span>)</span><br></pre></td></tr></table></figure><h4 id="3-3-3-实现重置密码的功能"><a href="#3-3-3-实现重置密码的功能" class="headerlink" title="3.3.3 实现重置密码的功能"></a>3.3.3 实现重置密码的功能</h4><ol><li>根据 <code>id</code> 查询用户是否存在：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 定义根据 id 查询用户数据的 SQL 语句</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ev_users where id=?`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行 SQL 语句查询用户是否存在</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, req.<span class="property">user</span>.<span class="property">id</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 检查指定 id 的用户是否存在</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;用户不存在！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// TODO：判断提交的旧密码是否正确</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol><li>判断提交的 <strong>旧密码</strong> 是否正确：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在头部区域导入 bcryptjs 后，</span></span><br><span class="line"><span class="comment">// 即可使用 bcrypt.compareSync(提交的密码，数据库中的密码) 方法验证密码是否正确</span></span><br><span class="line"><span class="comment">// compareSync() 函数的返回值为布尔值，true 表示密码正确，false 表示密码错误</span></span><br><span class="line"><span class="keyword">const</span> bcrypt = <span class="built_in">require</span>(<span class="string">&#x27;bcryptjs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断提交的旧密码是否正确</span></span><br><span class="line"><span class="keyword">const</span> compareResult = bcrypt.<span class="title function_">compareSync</span>(req.<span class="property">body</span>.<span class="property">oldPwd</span>, results[<span class="number">0</span>].<span class="property">password</span>)</span><br><span class="line"><span class="keyword">if</span> (!compareResult) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;原密码错误！&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li>对新密码进行 <code>bcrypt</code> 加密之后，更新到数据库中：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 定义更新用户密码的 SQL 语句</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">`update ev_users set password=? where id=?`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 对新密码进行 bcrypt 加密处理</span></span><br><span class="line"><span class="keyword">const</span> newPwd = bcrypt.<span class="title function_">hashSync</span>(req.<span class="property">body</span>.<span class="property">newPwd</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行 SQL 语句，根据 id 更新用户的密码</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, [newPwd, req.<span class="property">user</span>.<span class="property">id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// SQL 语句执行失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SQL 语句执行成功，但是影响行数不等于 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;更新密码失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 更新密码成功</span></span><br><span class="line">  res.<span class="title function_">cc</span>(<span class="string">&#x27;更新密码成功！&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="3-4-更新用户头像"><a href="#3-4-更新用户头像" class="headerlink" title="3.4 更新用户头像"></a>3.4 更新用户头像</h3><h4 id="3-4-0-实现步骤"><a href="#3-4-0-实现步骤" class="headerlink" title="3.4.0 实现步骤"></a>3.4.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>实现更新用户头像的功能</li></ol><h4 id="3-4-1-定义路由和处理函数"><a href="#3-4-1-定义路由和处理函数" class="headerlink" title="3.4.1 定义路由和处理函数"></a>3.4.1 定义路由和处理函数</h4><ol><li>在 <code>/router/userinfo.js</code> 模块中，新增 <code>更新用户头像</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 更新用户头像的路由</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/update/avatar&#x27;</span>, userinfo_handler.<span class="property">updateAvatar</span>)</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/userinfo.js</code> 模块中，定义并向外共享 <code>更新用户头像</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 更新用户头像的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">updateAvatar</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-4-2-验证表单数据"><a href="#3-4-2-验证表单数据" class="headerlink" title="3.4.2 验证表单数据"></a>3.4.2 验证表单数据</h4><ol><li>在 <code>/schema/user.js</code> 验证规则模块中，定义 <code>avatar</code> 的验证规则如下：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// dataUri() 指的是如下格式的字符串数据：</span></span><br><span class="line"><span class="comment">// data:image/png;base64,VE9PTUFOWVNFQ1JFVFM=</span></span><br><span class="line"><span class="keyword">const</span> avatar = joi.<span class="title function_">string</span>().<span class="title function_">dataUri</span>().<span class="title function_">required</span>()</span><br></pre></td></tr></table></figure><ol><li>并使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 验证规则对象 - 更新头像</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">update_avatar_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    avatar,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router/userinfo.js</code> 模块中，导入需要的验证规则对象：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; update_avatar_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/user&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router/userinfo.js</code> 模块中，修改 <code>更新用户头像</code> 的路由如下：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/update/avatar&#x27;</span>, <span class="title function_">expressJoi</span>(update_avatar_schema), userinfo_handler.<span class="property">updateAvatar</span>)</span><br></pre></td></tr></table></figure><h4 id="3-4-3-实现更新用户头像的功能"><a href="#3-4-3-实现更新用户头像的功能" class="headerlink" title="3.4.3 实现更新用户头像的功能"></a>3.4.3 实现更新用户头像的功能</h4><ol><li>定义更新用户头像的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;update ev_users set user_pic=? where id=?&#x27;</span></span><br></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行 SQL 语句，更新对应用户的头像：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, [req.<span class="property">body</span>.<span class="property">avatar</span>, req.<span class="property">user</span>.<span class="property">id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 执行 SQL 语句成功，但是影响行数不等于 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;更新头像失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 更新用户头像成功</span></span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;更新头像成功！&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="4-文章分类管理"><a href="#4-文章分类管理" class="headerlink" title="4. 文章分类管理"></a>4. 文章分类管理</h2><h3 id="4-1-新建-ev-article-cate-表"><a href="#4-1-新建-ev-article-cate-表" class="headerlink" title="4.1 新建 ev_article_cate 表"></a>4.1 新建 ev_article_cate 表</h3><h4 id="4-1-1-创建表结构"><a href="#4-1-1-创建表结构" class="headerlink" title="4.1.1 创建表结构"></a>4.1.1 创建表结构</h4><p><img src="./images/2.jpg" alt="文章分类表结构"></p><h4 id="4-1-2-新增两条初始数据"><a href="#4-1-2-新增两条初始数据" class="headerlink" title="4.1.2 新增两条初始数据"></a>4.1.2 新增两条初始数据</h4><p><img src="./images/3.jpg" alt="文章分类表结构"></p><h3 id="4-2-获取文章分类列表"><a href="#4-2-获取文章分类列表" class="headerlink" title="4.2 获取文章分类列表"></a>4.2 获取文章分类列表</h3><h4 id="4-2-0-实现步骤"><a href="#4-2-0-实现步骤" class="headerlink" title="4.2.0 实现步骤"></a>4.2.0 实现步骤</h4><ol><li>初始化路由模块</li><li>初始化路由处理函数模块</li><li>获取文章分类列表数据</li></ol><h4 id="4-2-1-初始化路由模块"><a href="#4-2-1-初始化路由模块" class="headerlink" title="4.2.1 初始化路由模块"></a>4.2.1 初始化路由模块</h4><ol><li>创建 <code>/router/artcate.js</code> 路由模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入 express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建路由对象</span></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取文章分类的列表数据</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/cates&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向外共享路由对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 中导入并使用文章分类的路由模块：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入并使用文章分类路由模块</span></span><br><span class="line"><span class="keyword">const</span> artCateRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/artcate&#x27;</span>)</span><br><span class="line"><span class="comment">// 为文章分类的路由挂载统一的访问前缀 /my/article</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/my/article&#x27;</span>, artCateRouter)</span><br></pre></td></tr></table></figure><h4 id="4-2-2-初始化路由处理函数模块"><a href="#4-2-2-初始化路由处理函数模块" class="headerlink" title="4.2.2 初始化路由处理函数模块"></a>4.2.2 初始化路由处理函数模块</h4><ol><li>创建 <code>/router_handler/artcate.js</code> 路由处理函数模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取文章分类列表数据的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">getArticleCates</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>修改 <code>/router/artcate.js</code> 中的代码如下：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入文章分类的路由处理函数模块</span></span><br><span class="line"><span class="keyword">const</span> artcate_handler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/artcate&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取文章分类的列表数据</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/cates&#x27;</span>, artcate_handler.<span class="property">getArticleCates</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><h4 id="4-2-3-获取文章分类列表数据"><a href="#4-2-3-获取文章分类列表数据" class="headerlink" title="4.2.3 获取文章分类列表数据"></a>4.2.3 获取文章分类列表数据</h4><ol><li>在 <code>/router_handler/artcate.js</code> 头部导入数据库操作模块：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入数据库操作模块</span></span><br><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../db/index&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li>定义 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 根据分类的状态，获取所有未被删除的分类列表数据</span></span><br><span class="line"><span class="comment">// is_delete 为 0 表示没有被 标记为删除 的数据</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;select * from ev_article_cate where is_delete=0 order by id asc&#x27;</span></span><br></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 1. 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. 执行 SQL 语句成功</span></span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;获取文章分类列表成功！&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: results,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="4-3-新增文章分类"><a href="#4-3-新增文章分类" class="headerlink" title="4.3 新增文章分类"></a>4.3 新增文章分类</h3><h4 id="4-3-0-实现步骤"><a href="#4-3-0-实现步骤" class="headerlink" title="4.3.0 实现步骤"></a>4.3.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>查询 <code>分类名称</code> 与 <code>分类别名</code> 是否被占用</li><li>实现新增文章分类的功能</li></ol><h4 id="4-3-1-定义路由和处理函数"><a href="#4-3-1-定义路由和处理函数" class="headerlink" title="4.3.1 定义路由和处理函数"></a>4.3.1 定义路由和处理函数</h4><ol><li>在 <code>/router/artcate.js</code> 模块中，添加 <code>新增文章分类</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 新增文章分类的路由</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/addcates&#x27;</span>, artcate_handler.<span class="property">addArticleCates</span>)</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/artcate.js</code> 模块中，定义并向外共享 <code>新增文章分类</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 新增文章分类的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">addArticleCates</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-3-2-验证表单数据"><a href="#4-3-2-验证表单数据" class="headerlink" title="4.3.2 验证表单数据"></a>4.3.2 验证表单数据</h4><ol><li>创建 <code>/schema/artcate.js</code> 文章分类数据验证模块，并定义如下的验证规则：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入定义验证规则的模块</span></span><br><span class="line"><span class="keyword">const</span> joi = <span class="built_in">require</span>(<span class="string">&#x27;@hapi/joi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义 分类名称 和 分类别名 的校验规则</span></span><br><span class="line"><span class="keyword">const</span> name = joi.<span class="title function_">string</span>().<span class="title function_">required</span>()</span><br><span class="line"><span class="keyword">const</span> alias = joi.<span class="title function_">string</span>().<span class="title function_">alphanum</span>().<span class="title function_">required</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 校验规则对象 - 添加分类</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">add_cate_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    name,</span><br><span class="line">    alias,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router/artcate.js</code> 模块中，使用 <code>add_cate_schema</code> 对数据进行验证：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入验证数据的中间件</span></span><br><span class="line"><span class="keyword">const</span> expressJoi = <span class="built_in">require</span>(<span class="string">&#x27;@escook/express-joi&#x27;</span>)</span><br><span class="line"><span class="comment">// 导入文章分类的验证模块</span></span><br><span class="line"><span class="keyword">const</span> &#123; add_cate_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/artcate&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新增文章分类的路由</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/addcates&#x27;</span>, <span class="title function_">expressJoi</span>(add_cate_schema), artcate_handler.<span class="property">addArticleCates</span>)</span><br></pre></td></tr></table></figure><h4 id="4-3-3-查询分类名称与别名是否被占用"><a href="#4-3-3-查询分类名称与别名是否被占用" class="headerlink" title="4.3.3 查询分类名称与别名是否被占用"></a>4.3.3 查询分类名称与别名是否被占用</h4><ol><li>定义查重的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 定义查询 分类名称 与 分类别名 是否被占用的 SQL 语句</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ev_article_cate where name=? or alias=?`</span></span><br></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行查重的操作：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 执行查重操作</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, [req.<span class="property">body</span>.<span class="property">name</span>, req.<span class="property">body</span>.<span class="property">alias</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 判断 分类名称 和 分类别名 是否被占用</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">2</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;分类名称与别名被占用，请更换后重试！&#x27;</span>)</span><br><span class="line">  <span class="comment">// 分别判断 分类名称 和 分类别名 是否被占用</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">1</span> &amp;&amp; results[<span class="number">0</span>].<span class="property">name</span> === req.<span class="property">body</span>.<span class="property">name</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;分类名称被占用，请更换后重试！&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">1</span> &amp;&amp; results[<span class="number">0</span>].<span class="property">alias</span> === req.<span class="property">body</span>.<span class="property">alias</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;分类别名被占用，请更换后重试！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// TODO：新增文章分类</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="4-3-4-实现新增文章分类的功能"><a href="#4-3-4-实现新增文章分类的功能" class="headerlink" title="4.3.4 实现新增文章分类的功能"></a>4.3.4 实现新增文章分类的功能</h4><ol><li>定义新增文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`insert into ev_article_cate set ?`</span></span><br></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行新增文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, req.<span class="property">body</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// SQL 语句执行失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SQL 语句执行成功，但是影响行数不等于 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;新增文章分类失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 新增文章分类成功</span></span><br><span class="line">  res.<span class="title function_">cc</span>(<span class="string">&#x27;新增文章分类成功！&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="4-4-根据-Id-删除文章分类"><a href="#4-4-根据-Id-删除文章分类" class="headerlink" title="4.4 根据 Id 删除文章分类"></a>4.4 根据 Id 删除文章分类</h3><h4 id="4-4-0-实现步骤"><a href="#4-4-0-实现步骤" class="headerlink" title="4.4.0 实现步骤"></a>4.4.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>实现删除文章分类的功能</li></ol><h4 id="4-4-1-定义路由和处理函数"><a href="#4-4-1-定义路由和处理函数" class="headerlink" title="4.4.1 定义路由和处理函数"></a>4.4.1 定义路由和处理函数</h4><ol><li>在 <code>/router/artcate.js</code> 模块中，添加 <code>删除文章分类</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 删除文章分类的路由</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/deletecate/:id&#x27;</span>, artcate_handler.<span class="property">deleteCateById</span>)</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/artcate.js</code> 模块中，定义并向外共享 <code>删除文章分类</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 删除文章分类的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">deleteCateById</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-4-2-验证表单数据"><a href="#4-4-2-验证表单数据" class="headerlink" title="4.4.2 验证表单数据"></a>4.4.2 验证表单数据</h4><ol><li>在 <code>/schema/artcate.js</code> 验证规则模块中，定义 id 的验证规则如下：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 定义 分类Id 的校验规则</span></span><br><span class="line"><span class="keyword">const</span> id = joi.<span class="title function_">number</span>().<span class="title function_">integer</span>().<span class="title function_">min</span>(<span class="number">1</span>).<span class="title function_">required</span>()</span><br></pre></td></tr></table></figure><ol><li>并使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 校验规则对象 - 删除分类</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">delete_cate_schema</span> = &#123;</span><br><span class="line">  <span class="attr">params</span>: &#123;</span><br><span class="line">    id,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router/artcate.js</code> 模块中，导入需要的验证规则对象，并在路由中使用：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入删除分类的验证规则对象</span></span><br><span class="line"><span class="keyword">const</span> &#123; delete_cate_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/artcate&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除文章分类的路由</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/deletecate/:id&#x27;</span>, <span class="title function_">expressJoi</span>(delete_cate_schema), artcate_handler.<span class="property">deleteCateById</span>)</span><br></pre></td></tr></table></figure><h4 id="4-4-3-实现删除文章分类的功能"><a href="#4-4-3-实现删除文章分类的功能" class="headerlink" title="4.4.3 实现删除文章分类的功能"></a>4.4.3 实现删除文章分类的功能</h4><ol><li>定义删除文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`update ev_article_cate set is_delete=1 where id=?`</span></span><br></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行删除文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, req.<span class="property">params</span>.<span class="property">id</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SQL 语句执行成功，但是影响行数不等于 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;删除文章分类失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 删除文章分类成功</span></span><br><span class="line">  res.<span class="title function_">cc</span>(<span class="string">&#x27;删除文章分类成功！&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="4-5-根据-Id-获取文章分类数据"><a href="#4-5-根据-Id-获取文章分类数据" class="headerlink" title="4.5 根据 Id 获取文章分类数据"></a>4.5 根据 Id 获取文章分类数据</h3><h4 id="4-5-0-实现步骤"><a href="#4-5-0-实现步骤" class="headerlink" title="4.5.0 实现步骤"></a>4.5.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>实现获取文章分类的功能</li></ol><h4 id="4-5-1-定义路由和处理函数"><a href="#4-5-1-定义路由和处理函数" class="headerlink" title="4.5.1 定义路由和处理函数"></a>4.5.1 定义路由和处理函数</h4><ol><li>在 <code>/router/artcate.js</code> 模块中，添加 <code>根据 Id 获取文章分类</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/cates/:id&#x27;</span>, artcate_handler.<span class="property">getArticleById</span>)</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/artcate.js</code> 模块中，定义并向外共享 <code>根据 Id 获取文章分类</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 根据 Id 获取文章分类的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">getArticleById</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-5-2-验证表单数据"><a href="#4-5-2-验证表单数据" class="headerlink" title="4.5.2 验证表单数据"></a>4.5.2 验证表单数据</h4><ol><li>在 <code>/schema/artcate.js</code> 验证规则模块中，使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 校验规则对象 - 根据 Id 获取分类</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">get_cate_schema</span> = &#123;</span><br><span class="line">  <span class="attr">params</span>: &#123;</span><br><span class="line">    id,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router/artcate.js</code> 模块中，导入需要的验证规则对象，并在路由中使用：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入根据 Id 获取分类的验证规则对象</span></span><br><span class="line"><span class="keyword">const</span> &#123; get_cate_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/artcate&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据 Id 获取文章分类的路由</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/cates/:id&#x27;</span>, <span class="title function_">expressJoi</span>(get_cate_schema), artcate_handler.<span class="property">getArticleById</span>)</span><br></pre></td></tr></table></figure><h4 id="4-5-3-实现获取文章分类的功能"><a href="#4-5-3-实现获取文章分类的功能" class="headerlink" title="4.5.3 实现获取文章分类的功能"></a>4.5.3 实现获取文章分类的功能</h4><ol><li>定义根据 Id 获取文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ev_article_cate where id=?`</span></span><br></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, req.<span class="property">params</span>.<span class="property">id</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SQL 语句执行成功，但是没有查询到任何数据</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;获取文章分类数据失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 把数据响应给客户端</span></span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;获取文章分类数据成功！&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: results[<span class="number">0</span>],</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="4-6-根据-Id-更新文章分类数据"><a href="#4-6-根据-Id-更新文章分类数据" class="headerlink" title="4.6 根据 Id 更新文章分类数据"></a>4.6 根据 Id 更新文章分类数据</h3><h4 id="4-6-0-实现步骤"><a href="#4-6-0-实现步骤" class="headerlink" title="4.6.0 实现步骤"></a>4.6.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>查询 <code>分类名称</code> 与 <code>分类别名</code> 是否被占用</li><li>实现更新文章分类的功能</li></ol><h4 id="4-6-1-定义路由和处理函数"><a href="#4-6-1-定义路由和处理函数" class="headerlink" title="4.6.1 定义路由和处理函数"></a>4.6.1 定义路由和处理函数</h4><ol><li>在 <code>/router/artcate.js</code> 模块中，添加 <code>更新文章分类</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 更新文章分类的路由</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/updatecate&#x27;</span>, artcate_handler.<span class="property">updateCateById</span>)</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/artcate.js</code> 模块中，定义并向外共享 <code>更新文章分类</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 更新文章分类的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">updateCateById</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-6-2-验证表单数据"><a href="#4-6-2-验证表单数据" class="headerlink" title="4.6.2 验证表单数据"></a>4.6.2 验证表单数据</h4><ol><li>在 <code>/schema/artcate.js</code> 验证规则模块中，使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 校验规则对象 - 更新分类</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">update_cate_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    <span class="title class_">Id</span>: id,</span><br><span class="line">    name,</span><br><span class="line">    alias,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router/artcate.js</code> 模块中，导入需要的验证规则对象，并在路由中使用：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入更新文章分类的验证规则对象</span></span><br><span class="line"><span class="keyword">const</span> &#123; update_cate_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/artcate&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 更新文章分类的路由</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/updatecate&#x27;</span>, <span class="title function_">expressJoi</span>(update_cate_schema), artcate_handler.<span class="property">updateCateById</span>)</span><br></pre></td></tr></table></figure><h4 id="4-5-4-查询分类名称与别名是否被占用"><a href="#4-5-4-查询分类名称与别名是否被占用" class="headerlink" title="4.5.4 查询分类名称与别名是否被占用"></a>4.5.4 查询分类名称与别名是否被占用</h4><ol><li>定义查重的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 定义查询 分类名称 与 分类别名 是否被占用的 SQL 语句</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ev_article_cate where Id&lt;&gt;? and (name=? or alias=?)`</span></span><br></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行查重的操作：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 执行查重操作</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, [req.<span class="property">body</span>.<span class="property">Id</span>, req.<span class="property">body</span>.<span class="property">name</span>, req.<span class="property">body</span>.<span class="property">alias</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 判断 分类名称 和 分类别名 是否被占用</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">2</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;分类名称与别名被占用，请更换后重试！&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">1</span> &amp;&amp; results[<span class="number">0</span>].<span class="property">name</span> === req.<span class="property">body</span>.<span class="property">name</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;分类名称被占用，请更换后重试！&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">1</span> &amp;&amp; results[<span class="number">0</span>].<span class="property">alias</span> === req.<span class="property">body</span>.<span class="property">alias</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;分类别名被占用，请更换后重试！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// TODO：更新文章分类</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="4-5-5-实现更新文章分类的功能"><a href="#4-5-5-实现更新文章分类的功能" class="headerlink" title="4.5.5 实现更新文章分类的功能"></a>4.5.5 实现更新文章分类的功能</h4><ol><li>定义更新文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`update ev_article_cate set ? where Id=?`</span></span><br></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, [req.<span class="property">body</span>, req.<span class="property">body</span>.<span class="property">Id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SQL 语句执行成功，但是影响行数不等于 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;更新文章分类失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 更新文章分类成功</span></span><br><span class="line">  res.<span class="title function_">cc</span>(<span class="string">&#x27;更新文章分类成功！&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="5-文章管理"><a href="#5-文章管理" class="headerlink" title="5. 文章管理"></a>5. 文章管理</h2><h3 id="5-1-新建-ev-articles-表"><a href="#5-1-新建-ev-articles-表" class="headerlink" title="5.1 新建 ev_articles 表"></a>5.1 新建 ev_articles 表</h3><p><img src="./images/4.jpg" alt="ev_articles表结构"></p><h3 id="5-2-发布新文章"><a href="#5-2-发布新文章" class="headerlink" title="5.2 发布新文章"></a>5.2 发布新文章</h3><h4 id="5-2-0-实现步骤"><a href="#5-2-0-实现步骤" class="headerlink" title="5.2.0 实现步骤"></a>5.2.0 实现步骤</h4><ol><li>初始化路由模块</li><li>初始化路由处理函数模块</li><li>使用 multer 解析表单数据</li><li>验证表单数据</li><li>实现发布文章的功能</li></ol><h4 id="5-2-1-初始化路由模块"><a href="#5-2-1-初始化路由模块" class="headerlink" title="5.2.1 初始化路由模块"></a>5.2.1 初始化路由模块</h4><ol><li>创建 <code>/router/article.js</code> 路由模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入 express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建路由对象</span></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发布新文章</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/add&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向外共享路由对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 中导入并使用文章的路由模块：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入并使用文章路由模块</span></span><br><span class="line"><span class="keyword">const</span> articleRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/article&#x27;</span>)</span><br><span class="line"><span class="comment">// 为文章的路由挂载统一的访问前缀 /my/article</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/my/article&#x27;</span>, articleRouter)</span><br></pre></td></tr></table></figure><h4 id="5-2-2-初始化路由处理函数模块"><a href="#5-2-2-初始化路由处理函数模块" class="headerlink" title="5.2.2 初始化路由处理函数模块"></a>5.2.2 初始化路由处理函数模块</h4><ol><li>创建 <code>/router_handler/article.js</code> 路由处理函数模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 发布新文章的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">addArticle</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>修改 <code>/router/article.js</code> 中的代码如下：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入文章的路由处理函数模块</span></span><br><span class="line"><span class="keyword">const</span> article_handler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/article&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发布新文章</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/add&#x27;</span>, article_handler.<span class="property">addArticle</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><h4 id="5-2-3-使用-multer-解析表单数据"><a href="#5-2-3-使用-multer-解析表单数据" class="headerlink" title="5.2.3 使用 multer 解析表单数据"></a>5.2.3 使用 multer 解析表单数据</h4><blockquote><p>注意：使用 <code>express.urlencoded()</code> 中间件无法解析 <code>multipart/form-data</code> 格式的请求体数据。</p><p>当前项目，推荐使用 multer 来解析 <code>multipart/form-data</code> 格式的表单数据。<a href="https://www.npmjs.com/package/multer">https://www.npmjs.com/package/multer</a></p></blockquote><ol><li>运行如下的终端命令，在项目中安装 <code>multer</code>：</li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i multer@1.4.2</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/article.js</code> 模块中导入并配置 <code>multer</code>：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入解析 formdata 格式表单数据的包</span></span><br><span class="line"><span class="keyword">const</span> multer = <span class="built_in">require</span>(<span class="string">&#x27;multer&#x27;</span>)</span><br><span class="line"><span class="comment">// 导入处理路径的核心模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 multer 的实例对象，通过 dest 属性指定文件的存放路径</span></span><br><span class="line"><span class="keyword">const</span> upload = <span class="title function_">multer</span>(&#123; <span class="attr">dest</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;../uploads&#x27;</span>) &#125;)</span><br></pre></td></tr></table></figure><ol><li>修改 <code>发布新文章</code> 的路由如下：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 发布新文章的路由</span></span><br><span class="line"><span class="comment">// upload.single() 是一个局部生效的中间件，用来解析 FormData 格式的表单数据</span></span><br><span class="line"><span class="comment">// 将文件类型的数据，解析并挂载到 req.file 属性中</span></span><br><span class="line"><span class="comment">// 将文本类型的数据，解析并挂载到 req.body 属性中</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/add&#x27;</span>, upload.<span class="title function_">single</span>(<span class="string">&#x27;cover_img&#x27;</span>), article_handler.<span class="property">addArticle</span>)</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/article.js</code> 模块中的 <code>addArticle</code> 处理函数中，将 <code>multer</code> 解析出来的数据进行打印：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 发布新文章的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">addArticle</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>) <span class="comment">// 文本类型的数据</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;--------分割线----------&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">file</span>) <span class="comment">// 文件类型的数据</span></span><br><span class="line"></span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="5-2-4-验证表单数据"><a href="#5-2-4-验证表单数据" class="headerlink" title="5.2.4 验证表单数据"></a>5.2.4 验证表单数据</h4><blockquote><p>实现思路：通过 express-joi <strong>自动验证</strong> req.body 中的文本数据；通过 if 判断<strong>手动验证</strong> req.file 中的文件数据；</p></blockquote><ol><li>创建 <code>/schema/article.js</code> 验证规则模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入定义验证规则的模块</span></span><br><span class="line"><span class="keyword">const</span> joi = <span class="built_in">require</span>(<span class="string">&#x27;@hapi/joi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义 标题、分类Id、内容、发布状态 的验证规则</span></span><br><span class="line"><span class="keyword">const</span> title = joi.<span class="title function_">string</span>().<span class="title function_">required</span>()</span><br><span class="line"><span class="keyword">const</span> cate_id = joi.<span class="title function_">number</span>().<span class="title function_">integer</span>().<span class="title function_">min</span>(<span class="number">1</span>).<span class="title function_">required</span>()</span><br><span class="line"><span class="keyword">const</span> content = joi.<span class="title function_">string</span>().<span class="title function_">required</span>().<span class="title function_">allow</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> state = joi.<span class="title function_">string</span>().<span class="title function_">valid</span>(<span class="string">&#x27;已发布&#x27;</span>, <span class="string">&#x27;草稿&#x27;</span>).<span class="title function_">required</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 验证规则对象 - 发布文章</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">add_article_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    title,</span><br><span class="line">    cate_id,</span><br><span class="line">    content,</span><br><span class="line">    state,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router/article.js</code> 模块中，导入需要的验证规则对象，并在路由中使用：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入验证数据的中间件</span></span><br><span class="line"><span class="keyword">const</span> expressJoi = <span class="built_in">require</span>(<span class="string">&#x27;@escook/express-joi&#x27;</span>)</span><br><span class="line"><span class="comment">// 导入文章的验证模块</span></span><br><span class="line"><span class="keyword">const</span> &#123; add_article_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/article&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发布新文章的路由</span></span><br><span class="line"><span class="comment">// 注意：在当前的路由中，先后使用了两个中间件：</span></span><br><span class="line"><span class="comment">//       先使用 multer 解析表单数据</span></span><br><span class="line"><span class="comment">//       再使用 expressJoi 对解析的表单数据进行验证</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/add&#x27;</span>, upload.<span class="title function_">single</span>(<span class="string">&#x27;cover_img&#x27;</span>), <span class="title function_">expressJoi</span>(add_article_schema), article_handler.<span class="property">addArticle</span>)</span><br></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/article.js</code> 模块中的 <code>addArticle</code> 处理函数中，通过 <code>if</code> 判断客户端是否提交了 <code>封面图片</code>：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 发布新文章的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">addArticle</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 手动判断是否上传了文章封面</span></span><br><span class="line">  <span class="keyword">if</span> (!req.<span class="property">file</span> || req.<span class="property">file</span>.<span class="property">fieldname</span> !== <span class="string">&#x27;cover_img&#x27;</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;文章封面是必选参数！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// TODO：表单数据合法，继续后面的处理流程...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="5-2-5-实现发布文章的功能"><a href="#5-2-5-实现发布文章的功能" class="headerlink" title="5.2.5 实现发布文章的功能"></a>5.2.5 实现发布文章的功能</h4><ol><li>整理要插入数据库的文章信息对象：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入处理路径的 path 核心模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> articleInfo = &#123;</span><br><span class="line">  <span class="comment">// 标题、内容、状态、所属的分类Id</span></span><br><span class="line">  ...req.<span class="property">body</span>,</span><br><span class="line">  <span class="comment">// 文章封面在服务器端的存放路径</span></span><br><span class="line">  <span class="attr">cover_img</span>: path.<span class="title function_">join</span>(<span class="string">&#x27;/uploads&#x27;</span>, req.<span class="property">file</span>.<span class="property">filename</span>),</span><br><span class="line">  <span class="comment">// 文章发布时间</span></span><br><span class="line">  <span class="attr">pub_date</span>: <span class="keyword">new</span> <span class="title class_">Date</span>(),</span><br><span class="line">  <span class="comment">// 文章作者的Id</span></span><br><span class="line">  <span class="attr">author_id</span>: req.<span class="property">user</span>.<span class="property">id</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>定义发布文章的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`insert into ev_articles set ?`</span></span><br></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行发布文章的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入数据库操作模块</span></span><br><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../db/index&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行 SQL 语句</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, articleInfo, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 执行 SQL 语句成功，但是影响行数不等于 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;发布文章失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 发布文章成功</span></span><br><span class="line">  res.<span class="title function_">cc</span>(<span class="string">&#x27;发布文章成功&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 中，使用 <code>express.static()</code> 中间件，将 <code>uploads</code> 目录中的图片托管为静态资源：</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 托管静态资源文件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/uploads&#x27;</span>, express.<span class="title function_">static</span>(<span class="string">&#x27;./uploads&#x27;</span>))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 后端 </tag>
            
            <tag> api </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>日本語の面接</title>
      <link href="/posts/ac314544/"/>
      <url>/posts/ac314544/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><p>仕事らしい仕事は、したことがありません。（我没做过像这样的工作）</p>]]></content>
      
      
      <categories>
          
          <category> 日语 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日语 </tag>
            
            <tag> 面接 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo_blog 多语言改造</title>
      <link href="/posts/27f8ffde/"/>
      <url>/posts/27f8ffde/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><div class="note blue no-icon flat"><p>hexo + butterfly 个人博客 &amp; webstack 主题个人导航搭建全过程系列</p><ol><li><a href="/posts/d9146854/">hexo_blog の誕生 - 基础环境配置（一）</a></li><li>博客魔改（二）</li><li>gitactions 实现自动化部署（三）</li><li><a href="/posts/e9fa50d9/">独立开发tooltip遇到的实际问题（四）</a></li><li><a href="/posts/19af9b1f/">实现 github &amp; aliyun 双端部署（五）</a> </li><li>hexo_blog 多语言改造（六）⇦当前位置🪂</li></ol></div><h3 id="探索-hexo-butterfly-blog-多语言版本的改造-本地项目改造"><a href="#探索-hexo-butterfly-blog-多语言版本的改造-本地项目改造" class="headerlink" title="探索 hexo +  butterfly blog 多语言版本的改造 - 本地项目改造"></a>探索 hexo +  butterfly blog 多语言版本的改造 - 本地项目改造</h3><p>使用 npm workspace 管理公共依赖</p><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <ol><li><p>从远程仓库拉取最新源码时，为其创建一个外部文件夹，例如 hexo_blog，嵌套源码在源码文件夹内</p></li><li><p>然后，复制一份源码文件夹，重命名为 hexo_blog_en</p></li><li><p>然后，在外层执行 npm init -y，然后填写如下配置</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 在运行 npm init -y 命令时，-y 是一个快捷选项，代表 &quot;yes&quot;。它的作用是快速生成一个默认的 package.json 文件，而无需通过命令行交互手动填写各项配置。</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;HexoBlogSource&quot;,</span><br><span class="line">  &quot;private&quot;: true, // 防止项目被发布到 npm 上，workspaces 必须是私有的</span><br><span class="line">  &quot;workspaces&quot;: [</span><br><span class="line">    &quot;hexo_blog&quot;,</span><br><span class="line">    &quot;hexo_blog.en&quot;,</span><br><span class="line">    &quot;hexo_blog.ja&quot;,</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 这会告诉 npm 管理多个子目录</span><br><span class="line">// npm install 会在外层 node_modules 中安装所有的依赖，并且各个子目录都会继承这些依赖。</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol><ol><li><p>然后，修改但语言版本源码中的 package.json 文件中的 name 字段，确保名称不同</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 各自版本中的 package.json</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>​</p></li><li><p>至此，返回至外层目录，执行 npm i ，将项目所需的依赖安装至外层目录，即可以通过顶层的 <code>node_modules</code> 使用依赖，避免重复安装。</p></li></ol>              </div>            </details><h3 id="git-仓库迁移-amp-改造"><a href="#git-仓库迁移-amp-改造" class="headerlink" title="git 仓库迁移&amp;改造"></a>git 仓库迁移&amp;改造</h3><h3 id="问题谨记"><a href="#问题谨记" class="headerlink" title="问题谨记"></a>问题谨记</h3><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <ol><li><p>relative_link: true</p><p>当 <code>relative_link: true</code> 时，生成的链接是基于<strong>当前页面路径</strong>的相对路径，而不是从站点根目录开始的绝对路径。这种行为可能会导致从其他页面跳转到首页的链接错误。</p><p>当站点启用了 Pjax（如 Butterfly 主题默认启用），可能会导致<strong>相对路径的链接错误</strong>。原因是：</p><ul><li>Pjax 仅加载页面的内容部分，而不刷新整个页面（包括 <code>&lt;head&gt;</code>）。</li><li>页面在加载后，浏览器的当前路径没有完全更新，导致解析相对路径时出错。</li></ul><p>例如：</p><ul><li>从 <code>/posts/post1/</code> 页面跳转到 <code>/about/</code> 页面后，浏览器当前路径仍然显示为 <code>/posts/post1/</code>。</li><li>再点击“首页”链接，Pjax 会错误地以 <code>/posts/post1/</code> 为参考路径，解析相对路径，生成错误的跳转链接。</li></ul><p>最终跳转到类似错误路径：</p><ul><li><code>https://youruilin.github.io/posts/post1/index.html</code></li></ul></li></ol><h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a><strong>解决方案</strong></h4><p>改用 relative_link: false</p>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo d 实现 github &amp; aliyun 双端部署</title>
      <link href="/posts/19af9b1f/"/>
      <url>/posts/19af9b1f/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><div class="note blue no-icon flat"><p>hexo + butterfly 个人博客 &amp; webstack 主题个人导航搭建全过程系列</p><ol><li><a href="/posts/d9146854">hexo_blog の誕生 - 基础环境配置（一）</a></li><li>博客魔改（二）</li><li><a href="/posts/42cfc10a/">gitactions 实现自动化部署（三）</a></li><li>独立开发tooltip遇到的实际问题（四）</li><li>实现 github &amp; aliyun 双端部署 ⇦当前位置🪂</li></ol></div><h4 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h4><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>环境配置：debun 11 &amp;  <strong>2</strong>核(vCPU)  2 GiB  3 Mbps</p><p>创建博客存放的目录</p><p>例如，存放在 /home/www/hexo</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /home</span><br><span class="line">mkdir www</span><br><span class="line">cd www</span><br><span class="line">mkdir hexo</span><br></pre></td></tr></table></figure><p>然后，安装 nginx</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 首先确保系统软件包列表是最新的</span><br><span class="line">sudo apt update</span><br><span class="line"></span><br><span class="line">// 使用 apt 包管理器来安装 Nginx</span><br><span class="line">sudo apt install nginx</span><br><span class="line"></span><br><span class="line">// 启动</span><br><span class="line">sudo systemctl status nginx</span><br></pre></td></tr></table></figure><p>配置 nginx 路由：</p><p>建立了博客的根目录后，需要将 nginx 服务器指向这个根目录地址，才能访问到博客页面，所以需要修改 nginx 的配置文件。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /etc/nginx</span><br><span class="line">ls</span><br><span class="line"></span><br><span class="line">// 其中，nginx.conf 就是默认配置文件</span><br></pre></td></tr></table></figure><p>但不采用直接修改 nginx 配置文件的方式，而是新建一个文件夹，将自己的配置写在新建的文件夹中。再利用include，在配置文件nginx.conf中将文件夹引入进来即可。</p><p>这样若有新的需求时，只需在文件夹中添加新需求的配置文件即可，不会再次修改配置文件nginx.conf，提高效率。</p><p>切换/etc/nginx/目录，在此目录下创建一个文件夹vhost：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /etc/nginx</span><br><span class="line">mkdir vhost</span><br><span class="line">cd vhost</span><br><span class="line"></span><br><span class="line">// 输入vim blog.conf新建blog.conf文件并编辑内容：</span><br><span class="line">vim blog.conf</span><br><span class="line"></span><br><span class="line">server&#123;        </span><br><span class="line">listen    80;</span><br><span class="line">root /home/www/hexo;</span><br><span class="line">         server_name iooio.cn;</span><br><span class="line">         location /&#123;        </span><br><span class="line">         &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 为了让http://www.test.top/也能访问到博客页面</span><br><span class="line">// 再新建一个配置文件wwwblog.conf，将server_name设置为 www.iooio.cn</span><br><span class="line"></span><br><span class="line">vim wwwblog.conf</span><br><span class="line">server&#123;        </span><br><span class="line">listen    80;</span><br><span class="line">root /home/www/hexo;</span><br><span class="line">         server_name iooio.cn;</span><br><span class="line">         location /&#123;        </span><br><span class="line">         &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 这样，/etc/nginx/vhost目录下就有两个配置文件，blog.conf和wwwblog.conf;</span><br></pre></td></tr></table></figure><p>打开/etc/nginx/目录下的nginx.conf文件</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 增加一行代码</span><br><span class="line"></span><br><span class="line">vim /etc/nginx/nginx.conf</span><br><span class="line"></span><br><span class="line">// 注意，要写在http&#123;&#125;的里面</span><br><span class="line">include /etc/nginx/vhost/*.conf; # 增加这一行代码</span><br></pre></td></tr></table></figure><p><img src="https://ucc.alicdn.com/pic/developer-ecology/0d59a1a13e4a41f2b00286447ee285af.png?x-oss-process=image%2Fresize%2Cw_1400%2Fformat%2Cwebp" alt="image040.png"></p>              </div>            </details><h4 id="安装-node-js"><a href="#安装-node-js" class="headerlink" title="安装 node.js"></a>安装 node.js</h4><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>使用 nvm 来安装和管理node</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 安装 nvm</span><br><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash</span><br><span class="line"></span><br><span class="line">// 需要手动启动一下</span><br><span class="line">source ~/.bashrc</span><br><span class="line"></span><br><span class="line">// 即可以安装指定版本的 node.js</span><br><span class="line">nvm install 18</span><br></pre></td></tr></table></figure>              </div>            </details><h4 id="安装git-amp-建立-ssh-信任"><a href="#安装git-amp-建立-ssh-信任" class="headerlink" title="安装git &amp; 建立 ssh 信任"></a>安装git &amp; 建立 ssh 信任</h4><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt install git</span><br><span class="line"></span><br><span class="line">//新建一个 git 用户, 并修改它的权限</span><br><span class="line">adduser git</span><br><span class="line">chmod 740 /etc/sudoers</span><br><span class="line"></span><br><span class="line">// 打开/etc/sudoers命令：</span><br><span class="line">vi /etc/sudoers</span><br><span class="line"></span><br><span class="line">// 添加语句（注意大小写）：</span><br><span class="line">git ALL=(ALL) ALL</span><br><span class="line"></span><br><span class="line">// 回收文件权限</span><br><span class="line">chmod 400 /etc/sudoers</span><br><span class="line"></span><br><span class="line">// 设置一个密码</span><br><span class="line">passwd git</span><br></pre></td></tr></table></figure><p>然后，切换到 git 用户</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">su git</span><br><span class="line">cd ~</span><br><span class="line">mkdir .ssh</span><br><span class="line">// 使用 ls -a 即可看到隐藏的 .ssh 文件</span><br><span class="line">ls -a</span><br><span class="line">cd .ssh</span><br><span class="line"></span><br><span class="line">// 新建文件, 这个文件吗是定死的，少一个 s 都是不行的</span><br><span class="line">touch authorized_keys</span><br></pre></td></tr></table></figure><p>现在，使用 fileZilla 将本地 id_rsa.pub 上传至 aliyun .ssh 目录下</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 公钥的内容拷贝到 authorized_key 文件中</span><br><span class="line">cd ~/.ssh</span><br><span class="line">cat id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure><p>看看通不通？</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh git@8.139.6.124</span><br></pre></td></tr></table></figure>              </div>            </details><h4 id="配置-git-仓库"><a href="#配置-git-仓库" class="headerlink" title="配置 git 仓库"></a>配置 git 仓库</h4><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p> 在服务器上使用git用户创建一个Git仓库，并且在该仓库中新建一个post-receive钩子文件。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd ~</span><br><span class="line">// 创建一个裸仓库</span><br><span class="line">git init --bare hexo.git</span><br><span class="line">vi ~/hexo.git/hooks/post-receive</span><br><span class="line"></span><br><span class="line">// 然后，写入以下代码，即：让钩子文件删除/home/www/hexo目录下原有的文件</span><br><span class="line">// 然后从blog.git仓库 clone 新的博客静态文件到/home/www/hexo目录下。</span><br><span class="line">git --work-tree=/home/www/hexo --git-dir=/home/git/hexo.git checkout -f</span><br><span class="line"></span><br><span class="line">// 然后，授予钩子文件可执行权限</span><br><span class="line">chmod +x ~/hexo.git/hooks/post-receive</span><br><span class="line">cd ~</span><br><span class="line">sudo chmod -R 777 /home/www/hexo</span><br><span class="line"></span><br><span class="line">// 现在，设置远程仓库的默认分支</span><br><span class="line">cd /home/git/hexo.git</span><br><span class="line">git symbolic-ref HEAD refs/heads/main</span><br><span class="line"></span><br><span class="line">// 禁用-删除默认站点配置</span><br><span class="line">sudo rm /etc/nginx/sites-enabled/default</span><br><span class="line"></span><br><span class="line">// 重载 Nginx</span><br><span class="line">sudo systemctl reload nginx</span><br></pre></td></tr></table></figure>              </div>            </details><h4 id="现在，为项目配置-ssl-证书"><a href="#现在，为项目配置-ssl-证书" class="headerlink" title="现在，为项目配置 ssl 证书"></a>现在，为项目配置 ssl 证书</h4><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>首先，安装 Certbot</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 安装Certbot</span><br><span class="line">sudo apt install certbot python3-certbot-nginx</span><br><span class="line"></span><br><span class="line">// 申请</span><br><span class="line">sudo certbot --nginx -d iooio.cn -d www.iooio.cn</span><br><span class="line"></span><br><span class="line">// 验证</span><br><span class="line">sudo certbot certificates</span><br></pre></td></tr></table></figure>              </div>            </details><h4 id="本地-deploy-推几次试试"><a href="#本地-deploy-推几次试试" class="headerlink" title="本地 deploy 推几次试试"></a>本地 deploy 推几次试试</h4><p>看权限是否给到位了  / </p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>随机点名demo</title>
      <link href="/posts/9056bd21/"/>
      <url>/posts/9056bd21/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><h2 id="写了一个vue3-3-ts的随机点名demo"><a href="#写了一个vue3-3-ts的随机点名demo" class="headerlink" title="写了一个vue3.3+ts的随机点名demo"></a>写了一个vue3.3+ts的随机点名demo</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>2024年12月9日晚 - 第一版</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> list =</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&#x27;曹睿,曹紫暄,董诚诚,范雅迪,高梦,何宪祖,何晓通,侯苏函,侯文凯,孔钦正,孔书瑶,李珂,李庆群,李如康,李茹,李子俊,刘奥乾,刘文一,刘宇鑫,路涵,罗继贤,吕晓天,马昌豪,马楚俨,苗静宸,苗庆奥,牛子璇,任广顺,邵文鑫,邵文扬,盛少杰,司文鱼,田平,田森,田晓萌,王奥嘉,王国庆,王荟,王洁,王胜钊,王一川,王籽晴,魏梓轩,奚雨欣,席兴硕,许安迪,许涵铭,杨婉晴,杨鑫炜,张涵月,张笑瑜,张宇铭,张子安,赵畅,赵凯,赵敏滔,钟瑶菡,朱超然,朱维展,朱治国&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">list.<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">name</span> =&gt;</span> <span class="string">`<span class="subst">$&#123;name&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 学生名单</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> students = ref&lt;string[]&gt;(list.<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">name</span> =&gt;</span> <span class="string">`<span class="subst">$&#123;name&#125;</span>`</span>))</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 当前高亮索引</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> activeIndex = ref&lt;number | <span class="literal">null</span>&gt;(<span class="literal">null</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 已点名学生数组</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> selected = ref&lt;string[]&gt;([])</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">/**</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"> * 随机点名函数</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"> */</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">pickRandomStudent</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 排除已经选中的学生</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> remainingStudents = students.<span class="property">value</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">student</span> =&gt;</span> !selected.<span class="property">value</span>.<span class="title function_">includes</span>(student))</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (remainingStudents.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> randomIndex = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * remainingStudents.<span class="property">length</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> selectedStudent = remainingStudents[randomIndex]</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 如果当前已选中，则从当前标签开始逐步切换</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> startIndex = activeIndex.<span class="property">value</span> !== <span class="literal">null</span> ? activeIndex.<span class="property">value</span> : <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 计算最短路径的横向和纵向步数</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> startRow = <span class="title class_">Math</span>.<span class="title function_">floor</span>(startIndex / <span class="number">6</span>) <span class="comment">// 当前所在行</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> startCol = startIndex % <span class="number">6</span> <span class="comment">// 当前所在列</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> targetIndex = students.<span class="property">value</span>.<span class="title function_">indexOf</span>(selectedStudent) <span class="comment">// 目标索引</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> targetRow = <span class="title class_">Math</span>.<span class="title function_">floor</span>(targetIndex / <span class="number">6</span>) <span class="comment">// 目标所在行</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> targetCol = targetIndex % <span class="number">6</span> <span class="comment">// 目标所在列</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> horizontalSteps = <span class="title class_">Math</span>.<span class="title function_">abs</span>(startCol - targetCol) <span class="comment">// 水平步数</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> verticalSteps = <span class="title class_">Math</span>.<span class="title function_">abs</span>(startRow - targetRow) <span class="comment">// 垂直步数</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 总步数 = 横向步数 + 纵向步数</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> totalSteps = horizontalSteps + verticalSteps</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> currentStep = <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> interval = <span class="number">100</span> <span class="comment">// 每次切换的时间间隔，100ms</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 清空索引并触发动画</span></span></span><br><span class="line"><span class="language-javascript">    activeIndex.<span class="property">value</span> = <span class="literal">null</span></span></span><br><span class="line"><span class="language-javascript">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> moveAnimation = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 计算下一个索引</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> nextIndex = startIndex + currentStep</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 计算当前步数方向</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (currentStep &lt; horizontalSteps) &#123;</span></span><br><span class="line"><span class="language-javascript">          nextIndex = (startIndex + currentStep) % students.<span class="property">value</span>.<span class="property">length</span> <span class="comment">// 水平移动</span></span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentStep &lt; totalSteps) &#123;</span></span><br><span class="line"><span class="language-javascript">          nextIndex = startIndex + (currentStep - horizontalSteps) * <span class="number">6</span> <span class="comment">// 纵向移动</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        activeIndex.<span class="property">value</span> = nextIndex</span></span><br><span class="line"><span class="language-javascript">        currentStep++</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 到达目标索引时停止动画</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (currentStep &gt;= totalSteps) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="built_in">clearInterval</span>(moveAnimation)</span></span><br><span class="line"><span class="language-javascript">          activeIndex.<span class="property">value</span> = targetIndex <span class="comment">// 确保最后停在目标索引</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 将选中的学生添加到已点名学生列表中</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (!selected.<span class="property">value</span>.<span class="title function_">includes</span>(selectedStudent)) &#123;</span></span><br><span class="line"><span class="language-javascript">            selected.<span class="property">value</span>.<span class="title function_">push</span>(selectedStudent)</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;, interval)</span></span><br><span class="line"><span class="language-javascript">    &#125;, <span class="number">300</span>) <span class="comment">// 延迟300ms后开始动画（和CSS动画时间保持一致）</span></span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;所有学生已被抽中！&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;choujiang&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>随机抽奖<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;student-list&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-for</span>=<span class="string">&quot;(student, index) in students&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:class</span>=<span class="string">&quot;&#123; active: activeIndex === index &#125;&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        &#123;&#123; student &#125;&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 随机点名按钮 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;pickRandomStudent&quot;</span>&gt;</span>随机抽奖<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 显示已点名学生 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;selected.length&quot;</span> <span class="attr">class</span>=<span class="string">&quot;selected-list&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>中将名单<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(student, index) in selected&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span>&gt;</span></span><br><span class="line">          &#123;&#123; student &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-id">#choujiang</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">font-family</span>: Avenir, Helvetica, Arial, sans-serif;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">60px</span> <span class="number">60px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.student-list</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">display</span>: grid;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">grid-template-columns</span>: <span class="built_in">repeat</span>(<span class="number">6</span>, <span class="number">1</span>fr); <span class="comment">/* 每行 6 个 */</span></span></span><br><span class="line"><span class="language-css">  <span class="attribute">gap</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">list-style-type</span>: none;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">li</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">15px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ddd</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#f9f9f9</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">transition</span>:</span></span><br><span class="line"><span class="language-css">    transform <span class="number">0.3s</span>,</span></span><br><span class="line"><span class="language-css">    background-color <span class="number">0.3s</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">li</span><span class="selector-class">.active</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#42b983</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">font-weight</span>: bold;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>);</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border</span>: none;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#42b983</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">font-size</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">button</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#369b72</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/* 显示已点名学生的列表 */</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.selected-list</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">bottom</span>: <span class="number">70px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">right</span>: <span class="number">60px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.8</span>);</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>);</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.selected-list</span> <span class="selector-tag">h3</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">font-size</span>: <span class="number">18px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.selected-list</span> <span class="selector-tag">ul</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">list-style-type</span>: none;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.selected-list</span> <span class="selector-tag">li</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">font-size</span>: <span class="number">18px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> 演示 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo_blog原创开发tooltip功能</title>
      <link href="/posts/e9fa50d9/"/>
      <url>/posts/e9fa50d9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><div class="note blue no-icon flat"><p>hexo + butterfly 个人博客 &amp; webstack 主题个人导航搭建全过程系列</p><ol><li>基础环境配置（一）</li><li>博客魔改（二）</li><li>gitactions 实现自动化部署（三）</li><li>独立开发tooltip功能全记录（四）⇦当前位置🪂</li></ol></div><h2 id="独立开发-tooltip-功能过程记录"><a href="#独立开发-tooltip-功能过程记录" class="headerlink" title="独立开发 tooltip 功能过程记录"></a>独立开发 tooltip 功能过程记录</h2><h3 id="悬浮框"><a href="#悬浮框" class="headerlink" title="悬浮框"></a>悬浮框</h3><details class="folding-tag" ><summary> 初代版本 </summary>              <div class='content'>              <ol><li><p>影响自定义鼠标效果的解决方案：限制 tootip 的作用域，通过 添加 .content 类名</p></li><li><p>需要排除受到影响的类或标签，例如 .content 深层嵌套时 ，.tabs 切换按钮失效 和 <figure> 代码块标签的折叠显示按钮</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取 .content 下的所有元素，排除 .tabs 标签</span></span><br><span class="line">  <span class="keyword">const</span> allElements = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.content *&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> filteredElements = <span class="title class_">Array</span>.<span class="title function_">from</span>(allElements).<span class="title function_">filter</span>(<span class="function"><span class="params">el</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> foldingTag = el.<span class="title function_">closest</span>(<span class="string">&quot;.folding-tag&quot;</span>); <span class="comment">// 检查是否有最近的 .folding-tag</span></span><br><span class="line">    <span class="keyword">const</span> isInsideContent = el.<span class="title function_">closest</span>(<span class="string">&quot;.content&quot;</span>); <span class="comment">// 检查元素是否在 .content 内部</span></span><br><span class="line">    <span class="keyword">const</span> isFigure = el.<span class="property">tagName</span>.<span class="title function_">toLowerCase</span>() === <span class="string">&#x27;figure&#x27;</span>; <span class="comment">// 检查元素是否是 &lt;figure&gt; 标签</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> !(foldingTag &amp;&amp; foldingTag.<span class="title function_">querySelector</span>(<span class="string">&quot;.content .tabs&quot;</span>)) &amp;&amp; !isInsideContent &amp;&amp; !isFigure;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></li></ol>              </div>            </details><details class="folding-tag" ><summary> 严格规则匹配，精简了代码逻辑 </summary>              <div class='content'>              <ol><li><p>2024-12-3 下午，严格规定了匹配元素的格式，新增支持全角和半角括号 <code>《》</code>、<code>「」</code> 的代码。其余规则保持不变，确保括号内容严格符合成对括号包裹，并且仅包含唯一合法分隔符 <code>｜</code> 或 <code>|</code> 的情况。</p><hr><p><strong>更新后的代码</strong></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">filteredElements.<span class="title function_">forEach</span>(<span class="function"><span class="params">tag</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 匹配成对的全角或半角括号（包括新增的《》和「」），并确保括号内部内容包含唯一的｜或|</span></span><br><span class="line">  tag.<span class="property">innerHTML</span> = tag.<span class="property">innerHTML</span>.<span class="title function_">replace</span>(</span><br><span class="line">    <span class="regexp">/(?:［|【|\[|《|「)([^［【\[《「］】\]》」]*?[｜\|][^［【\[《「］】\]》」]*?)(?:］|】|\]|》|」)/g</span>,</span><br><span class="line">    <span class="keyword">function</span> (<span class="params">match, content</span>) &#123;</span><br><span class="line">      <span class="comment">// 校验是否包含合法的全角或半角分隔符 ｜ 或 |</span></span><br><span class="line">      <span class="keyword">if</span> ((content.<span class="title function_">match</span>(<span class="regexp">/[｜\|]/g</span>) || []).<span class="property">length</span> === <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> parts = content.<span class="title function_">split</span>(<span class="regexp">/[｜\|]/</span>); <span class="comment">// 按全角或半角 | 分割</span></span><br><span class="line">        <span class="keyword">if</span> (parts.<span class="property">length</span> === <span class="number">2</span> &amp;&amp; parts[<span class="number">0</span>].<span class="title function_">trim</span>() &amp;&amp; parts[<span class="number">1</span>].<span class="title function_">trim</span>()) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="string">`&lt;span class=&quot;tooltip&quot; data-tooltip=&quot;<span class="subst">$&#123;parts[<span class="number">1</span>].trim()&#125;</span>&quot;&gt;<span class="subst">$&#123;parts[<span class="number">0</span>].trim()&#125;</span>&lt;/span&gt;`</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 若括号内容不符合格式要求，返回原内容</span></span><br><span class="line">      <span class="keyword">return</span> match;</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><hr><p><strong>改动点说明</strong></p><ol><li><p>正则表达式新增支持的括号类型：</p><ul><li>新增括号类型：</li><li>开始符号：<code>《</code> 和 <code>「</code>。</li><li>结束符号：<code>》</code> 和 <code>」</code>。</li><li>括号类型完整支持：</li><li>开始：<code>［</code>、<code>【</code>、<code>[</code>、<code>《</code>、<code>「</code>。</li><li>结束：<code>］</code>、<code>】</code>、<code>]</code>、<code>》</code>、<code>」</code>。</li></ul><hr><ol><li>规则保持不变：</li></ol><ul><li><p>唯一合法分隔符</p></li><li><p>校验括号内容是否包含且仅包含一个全角或半角分隔符</p></li></ul><p>(content.match(/[｜|]/g) || []).length === 1</p></li></ol></li></ol><ul><li><p>内容验证：按分隔符分割后，确保两部分内容都不为空：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> parts = content.<span class="title function_">split</span>(<span class="regexp">/[｜\|]/</span>);</span><br><span class="line"><span class="keyword">if</span> (parts.<span class="property">length</span> === <span class="number">2</span> &amp;&amp; parts[<span class="number">0</span>].<span class="title function_">trim</span>() &amp;&amp; parts[<span class="number">1</span>].<span class="title function_">trim</span>()) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;span class=&quot;tooltip&quot; data-tooltip=&quot;<span class="subst">$&#123;parts[<span class="number">1</span>].trim()&#125;</span>&quot;&gt;<span class="subst">$&#123;parts[<span class="number">0</span>].trim()&#125;</span>&lt;/span&gt;`</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><hr><p><strong>测试用例</strong></p><p>输入示例：</p>   <figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>【测试内容|提示信息】<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>[测试内容｜提示信息]<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>［测试内容|提示信息］<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>《测试内容｜提示信息》<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>「测试内容|提示信息」<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>【测试内容提示信息】<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>【测试内容|】<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>《|提示信息》<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>「测试内容｜提示信息｜额外内容」<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>《测试内容|》<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>输出结果：</p>   <figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;tooltip&quot;</span> <span class="attr">data-tooltip</span>=<span class="string">&quot;提示信息&quot;</span>&gt;</span>测试内容<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;tooltip&quot;</span> <span class="attr">data-tooltip</span>=<span class="string">&quot;提示信息&quot;</span>&gt;</span>测试内容<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;tooltip&quot;</span> <span class="attr">data-tooltip</span>=<span class="string">&quot;提示信息&quot;</span>&gt;</span>测试内容<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;tooltip&quot;</span> <span class="attr">data-tooltip</span>=<span class="string">&quot;提示信息&quot;</span>&gt;</span>测试内容<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;tooltip&quot;</span> <span class="attr">data-tooltip</span>=<span class="string">&quot;提示信息&quot;</span>&gt;</span>测试内容<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>【测试内容提示信息】<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>【测试内容|】<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>《|提示信息》<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>「测试内容｜提示信息｜额外内容」<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>《测试内容|》<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><p><strong>规则总结</strong></p><ol><li><strong>新增括号支持</strong>：<ul><li>现支持以下全角和半角括号类型：<ul><li><code>[ ]</code>、<code>［ ］</code>、<code>【 】</code></li><li><code>《 》</code>、<code>「 」</code></li></ul></li></ul></li><li><strong>严格分隔符校验</strong>：<ul><li>括号内容中必须且仅能包含一个全角或半角分隔符 <code>｜</code> 或 <code>|</code>。</li></ul></li><li><strong>成对括号验证</strong>：<ul><li>确保括号成对且嵌套格式正确。</li></ul></li><li><strong>不符合条件保留原样</strong>：<ul><li>对于不符合规则的内容（如缺少括号、分隔符数量不符或嵌套格式错误），直接返回原内容。</li></ul></li></ol>              </div>            </details><h3 id="文章页面主题色配置-amp-前端调用样式"><a href="#文章页面主题色配置-amp-前端调用样式" class="headerlink" title="文章页面主题色配置&amp;前端调用样式"></a>文章页面主题色配置&amp;前端调用样式</h3><details class="folding-tag" ><summary> 文章头部指定主题色，供前端调用色值，进行文章风格统一 </summary>              <div class='content'>              <p>以下是具体的实现步骤：</p><hr><ol><li><strong>在 Front-matter 中定义 theme_color</strong></li></ol><p>在你的 Markdown 文件中，添加 Front-matter 并定义 <code>theme_color</code>，例如：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: 我的文章</span><br><span class="line">theme_color: &quot;#e5a80d&quot;</span><br><span class="line">---</span><br></pre></td></tr></table></figure><hr><ol><li><strong>在 layout.pug 中注入 CSS 变量</strong></li></ol><p>你需要在 <code>layout.pug</code> 的 <code>&lt;head&gt;</code> 部分动态生成 CSS 变量。找到 <code>head.pug</code> 的引入部分（通常在 <code>head</code> 标签内），并在其上方或下方添加以下代码：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">style.</span><br><span class="line">  :root &#123;</span><br><span class="line">    --theme-color: #&#123;page.theme_color || theme.highlight_text_color || &quot;#e5a80d&quot;&#125;;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><ul><li><code>page.theme_color</code>：从当前文章的 Front-matter 中获取 <code>theme_color</code>。</li><li><code>theme.highlight_text_color</code>：如果 Front-matter 中没有定义 <code>theme_color</code>，则使用主题配置中的默认值（你需要在主题配置中定义 <code>highlight_text_color</code>）。</li><li><code>#e5a80d</code>：如果以上都没有定义，则使用默认的备用颜色。</li></ul><p>修改后的 <code>layout.pug</code> 示例：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">doctype html</span><br><span class="line">html(lang=config.language data-theme=theme.display_mode class=htmlClassHideAside)</span><br><span class="line">  head</span><br><span class="line">    style.</span><br><span class="line">      :root &#123;</span><br><span class="line">        --theme-color: #&#123;page.theme_color || theme.highlight_text_color || &quot;#e5a80d&quot;&#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    include ./head.pug</span><br><span class="line">  body</span><br><span class="line">    if theme.preloader.enable</span><br><span class="line">      !=partial(&#x27;includes/loading/index&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line"></span><br><span class="line">    if theme.background </span><br><span class="line">      #an_music_bg     </span><br><span class="line">      if page.background</span><br><span class="line">        #web_bg(style=`background:`+ page.background + `;background-attachment: local;background-position: center;background-size: cover;background-repeat: no-repeat;`)</span><br><span class="line">      else</span><br><span class="line">        #web_bg(style=getBgPath(theme.background))</span><br><span class="line">      </span><br><span class="line">    !=partial(&#x27;includes/sidebar&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line"></span><br><span class="line">    #body-wrap(class=pageType)</span><br><span class="line">      include ./header/index.pug</span><br><span class="line"></span><br><span class="line">      main#content-inner.layout(class=hideAside)</span><br><span class="line">        if body</span><br><span class="line">          div!= body</span><br><span class="line">        else</span><br><span class="line">          block content</span><br><span class="line">          if theme.aside.enable &amp;&amp; page.aside !== false</span><br><span class="line">            include widget/index.pug</span><br><span class="line"></span><br><span class="line">      - const footerBg = theme.footer_img</span><br><span class="line">      - const footer_bg = footerBg ? footerBg === true ? bg_img : getBgPath(footerBg) : &#x27;&#x27;</span><br><span class="line">      footer#footer(style=footer_bg)</span><br><span class="line">        !=partial(&#x27;includes/footer&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line"></span><br><span class="line">    include ./rightside.pug</span><br><span class="line">    include ./additional-js.pug</span><br></pre></td></tr></table></figure><hr><ol><li><strong>在主题配置中定义默认颜色（可选）</strong></li></ol><p>如果你希望在主题配置中定义一个默认的 <code>highlight_text_color</code>，可以在 <code>_config.butterfly.yml</code> 中添加：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">highlight_text_color: &quot;#e5a80d&quot;</span><br></pre></td></tr></table></figure><hr><ol><li><strong>在 CSS 中使用变量</strong></li></ol><p>在你的自定义 CSS 文件中（通常是 <code>source/css/custom.css</code>），使用 CSS 变量来定义 <code>.highlight-text</code> 的样式：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.highlight-text &#123;</span><br><span class="line">  color: var(--theme-color);</span><br><span class="line">  font-weight: 700;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><ol><li><strong>在文章中使用 .highlight-text 类</strong></li></ol><p>在你的 Markdown 文件中，可以直接使用 HTML 标签并添加 <code>.highlight-text</code> 类：</p><p>markdown</p><p>复制</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;p class=&quot;highlight-text&quot;&gt;这段文字会使用 Front-matter 中定义的 theme_color 颜色。&lt;/p&gt;</span><br></pre></td></tr></table></figure><hr><ol><li><strong>重新生成并预览</strong></li></ol><p>完成以上步骤后，运行以下命令重新生成 Hexo 站点并预览效果：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</span><br></pre></td></tr></table></figure><hr><p> 总结</p><p>通过以上步骤，你可以实现：</p><ol><li>在 Front-matter 中定义每篇文章的 <code>theme_color</code>。</li><li>使用 Pug 模板引擎动态生成 CSS 变量。</li><li>在 Butterfly 主题中应用动态颜色。</li></ol>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo_blog の誕生</title>
      <link href="/posts/d9146854/"/>
      <url>/posts/d9146854/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><div class="note blue no-icon flat"><p>hexo + butterfly 个人博客 &amp; webstack 主题个人导航搭建全过程系列</p><ol><li>hexo_blog の誕生 - 基础环境配置（一）⇦当前位置🪂</li><li>博客魔改（二）</li><li>gitactions 实现自动化部署（三）</li><li>独立开发tooltip遇到的实际问题（四）</li><li><a href="/posts/19af9b1f/">实现 github &amp; aliyun 双端部署（五）</a> </li><li>hexo_blog 多语言改造（六）</li></ol></div><h2 id="基础环境配置"><a href="#基础环境配置" class="headerlink" title="基础环境配置"></a>基础环境配置</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <h3 id="node-安装"><a href="#node-安装" class="headerlink" title="node 安装"></a>node 安装</h3><p>官方下载地址：<a href="https://nodejs.org/en/download/">https://nodejs.org/en/download/</a></p><h3 id="修改npm源："><a href="#修改npm源：" class="headerlink" title="修改npm源："></a>修改npm源：</h3><p>npm下载各种模块，默认是从国处服务器下载，速度较慢，建议配置成淘宝镜像。打开CMD窗口，运行如下命令:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm config set registry https://registry.npmmirror.com/</span><br></pre></td></tr></table></figure><h3 id="推荐使用-nrm-管理npm源"><a href="#推荐使用-nrm-管理npm源" class="headerlink" title="推荐使用 nrm 管理npm源"></a>推荐使用 nrm 管理npm源</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 全局安装 nrm </span></span><br><span class="line">npm install nrm -g --save</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 切换到淘宝镜像</span></span><br><span class="line">nrm use taobao</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试镜像速度</span></span><br><span class="line">nrm test taobao</span><br></pre></td></tr></table></figure><h3 id="安装-amp-使用-webstack-主题"><a href="#安装-amp-使用-webstack-主题" class="headerlink" title="安装&amp;使用 webstack 主题"></a>安装&amp;使用 webstack 主题</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 要求 hexo &gt;= 5.0</span><br><span class="line">npm install hexo-theme-webstack -S</span><br></pre></td></tr></table></figure><ol><li><p>安装完成后，删除原有主题文件夹和配置文件</p></li><li><p>然后到 、modules 文件中，找到刚刚下载的主题文件夹，进去将配置文件复制到项目根目录</p></li><li><p>将其重命名为<code>_config.webstack.yml</code>。</p><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="string">//</span> <span class="string">将</span> <span class="string">theme</span> <span class="string">修改为</span> <span class="string">webstack</span></span><br><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">webstack</span></span><br></pre></td></tr></table></figure></li></ol>              </div>            </details><h2 id="起步前文件结构调整"><a href="#起步前文件结构调整" class="headerlink" title="起步前文件结构调整"></a>起步前文件结构调整</h2><p>将主题文件夹移至根目录的 /themes 文件夹当中，方便对主题进行魔改</p><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <h3 id="1-复制主题到项目根目录"><a href="#1-复制主题到项目根目录" class="headerlink" title="1. 复制主题到项目根目录"></a>1. <strong>复制主题到项目根目录</strong></h3><p>将主题从 <code>node_modules</code> 中复制到项目根目录的 <code>themes</code> 文件夹下。例如：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cp -r node_modules/webstack themes/webstack</span><br></pre></td></tr></table></figure><p>此时，<code>themes/webstack</code> 就是该主题的完整拷贝。</p><hr><h3 id="2-修改-Hexo-配置文件"><a href="#2-修改-Hexo-配置文件" class="headerlink" title="2. 修改 Hexo 配置文件"></a>2. <strong>修改 Hexo 配置文件</strong></h3><p>在 Hexo 的根目录下找到 <code>_config.yml</code> 文件，并修改 <code>theme</code> 字段为你移动后的主题名称，例如：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">theme: webstack</span><br></pre></td></tr></table></figure><p>这样，Hexo 会直接从 <code>themes/webstack</code> 文件夹中加载主题，而不是从 <code>node_modules</code> 中加载。</p><hr><h3 id="3-清理多余依赖"><a href="#3-清理多余依赖" class="headerlink" title="3. 清理多余依赖"></a>3. <strong>清理多余依赖</strong></h3><p>如果主题已经从 <code>node_modules</code> 中移出，可以考虑从 <code>package.json</code> 中移除该主题的依赖项：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm uninstall webstack</span><br></pre></td></tr></table></figure><p>这将防止 Hexo 再次将主题安装到 <code>node_modules</code> 中。</p><hr><h3 id="4-未来更新管理"><a href="#4-未来更新管理" class="headerlink" title="4. 未来更新管理"></a>4. <strong>未来更新管理</strong></h3><ul><li><strong>手动更新</strong>：如果你需要更新主题，只能手动下载新版本，或通过 Git 的方式管理 <code>themes/webstack</code>。</li><li><strong>Git 管理</strong>：你可以将 <code>themes/webstack</code> 添加为一个 Git 子模块，方便未来更新。</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd themes</span><br><span class="line">git submodule add &lt;webstack-theme-git-repo-url&gt; webstack</span><br></pre></td></tr></table></figure><hr><h3 id="5-注意事项"><a href="#5-注意事项" class="headerlink" title="5. 注意事项"></a>5. <strong>注意事项</strong></h3><ul><li><strong>性能和依赖问题</strong>：从 <code>node_modules</code> 中移出主题后，Hexo 不再直接管理它的依赖，因此主题的某些功能可能需要你手动管理依赖。</li><li><strong>备份代码</strong>：修改主题代码前，建议将其纳入版本控制（如 Git），以便回滚或同步修改。</li></ul><hr><p>这样操作后，可以直接在项目根目录的 <code>themes/webstack</code> 文件夹中进行主题修改，方便又高效！</p><p>当然，这时候如果一切运行正常的话，之前的主题文件夹就可以删除啦！</p>              </div>            </details><h2 id="将静态博客挂载到-GitHub-Pages-amp-git-初始化"><a href="#将静态博客挂载到-GitHub-Pages-amp-git-初始化" class="headerlink" title="将静态博客挂载到 GitHub Pages &amp; git 初始化"></a>将静态博客挂载到 GitHub Pages &amp; git 初始化</h2><h3 id="首先是在-git-上创建仓库"><a href="#首先是在-git-上创建仓库" class="headerlink" title="首先是在 git 上创建仓库"></a>首先是在 git 上创建仓库</h3><details class="folding-tag" ><summary> 关于仓库命名 </summary>              <div class='content'>              <p>在为你的 GitHub 仓库命名时，特别是用于 Hexo 博客部署时，有一些需要注意的事项和建议，既能方便管理，又避免潜在问题。</p><hr><h3 id="1-符合-GitHub-Pages-的规则"><a href="#1-符合-GitHub-Pages-的规则" class="headerlink" title="1. 符合 GitHub Pages 的规则"></a><strong>1. 符合 GitHub Pages 的规则</strong></h3><ul><li><strong>个人主页仓库</strong>：如果这是用于个人主页的博客，仓库名称必须为 <code>username.github.io</code>（<code>username</code> 是你的 GitHub 用户名）。这个仓库会自动绑定到你的个人域名：<code>https://username.github.io/</code>。</li><li><strong>项目页面仓库</strong>：如果博客是独立项目，可以自由命名，比如 <code>first-blog</code>、<code>second-blog</code>。项目页面会显示为子路径，例如：<code>https://username.github.io/first-blog/</code>。</li></ul><hr><h3 id="2-简洁易懂"><a href="#2-简洁易懂" class="headerlink" title="2. 简洁易懂"></a><strong>2. 简洁易懂</strong></h3><p>选择简短且能清晰表达仓库用途的名称，方便未来维护和他人理解。例如：</p><ul><li><code>hexo-blog</code></li><li><code>tech-notes-blog</code></li><li><code>personal-blog</code></li></ul><p>避免过长或无意义的名称，比如：</p><ul><li><code>hexo2023personalblogsecondedition</code></li></ul><hr><h3 id="3-避免特殊字符"><a href="#3-避免特殊字符" class="headerlink" title="3. 避免特殊字符"></a><strong>3. 避免特殊字符</strong></h3><p>仓库名称仅支持字母、数字、<code>-</code>（中横线）、<code>_</code>（下划线），且名称不能以连字符开头或结尾。例如：</p><ul><li><strong>合法</strong>：<code>hexo-blog</code>, <code>second_blog</code></li><li><strong>非法</strong>：<code>-hexo-blog</code>, <code>second blog</code>（空格会导致错误）</li></ul><p>建议使用 <code>-</code> 分隔单词，这种命名风格更符合主流习惯，例如 <code>hexo-blog</code>。</p><hr><h3 id="4-避免与现有仓库冲突"><a href="#4-避免与现有仓库冲突" class="headerlink" title="4. 避免与现有仓库冲突"></a><strong>4. 避免与现有仓库冲突</strong></h3><p>确保新的仓库名称不与已有的仓库名称重复，特别是如果你已经有其他 Hexo 博客项目，需要区分开来。例如：</p><ul><li><code>personal-blog</code></li><li><code>work-blog</code></li></ul><hr><h3 id="5-考虑扩展性"><a href="#5-考虑扩展性" class="headerlink" title="5. 考虑扩展性"></a><strong>5. 考虑扩展性</strong></h3><p>如果你计划未来添加多个类似项目，可以使用统一的命名模式，例如：</p><ul><li><code>blog-personal</code></li><li><code>blog-tech</code></li><li><code>blog-lifestyle</code></li></ul><p>这样能保持结构一致，便于管理。</p><hr><h3 id="6-SEO-和访问友好性"><a href="#6-SEO-和访问友好性" class="headerlink" title="6. SEO 和访问友好性"></a><strong>6. SEO 和访问友好性</strong></h3><p>如果你希望博客在搜索引擎中更容易被找到，仓库名可以稍微贴近关键词。例如：</p><ul><li><code>coding-blog</code></li><li><code>travel-journal</code></li></ul><p>对于公共仓库，这些名字还能让其他开发者快速了解项目内容。</p><hr><h3 id="7-私密性考虑"><a href="#7-私密性考虑" class="headerlink" title="7. 私密性考虑"></a><strong>7. 私密性考虑</strong></h3><p>如果仓库会公开，但其中涉及个人隐私或敏感信息，避免在名称中使用全名、详细地址等私密信息。</p><p>例如：</p><ul><li>避免：<code>john-doe-personal-blog</code></li><li>更好：<code>personal-blog</code></li></ul><hr><h3 id="8-区分主要用途"><a href="#8-区分主要用途" class="headerlink" title="8. 区分主要用途"></a><strong>8. 区分主要用途</strong></h3><p>如果你用一个仓库只存放 Hexo 的静态文件，另一个仓库存放 Hexo 源码，可以在命名中有所体现：</p><ul><li><code>second-blog-source</code>（Hexo 源码）</li><li><code>second-blog</code>（静态文件）</li></ul><p>这样便于区分功能和用途。</p><hr><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a><strong>总结</strong></h3><p>一个好的仓库名称应具备以下特点：</p><ul><li>简单明了（如 <code>tech-blog</code>）</li><li>符合 GitHub Pages 的规则</li><li>无特殊字符，使用 <code>-</code> 分隔单词</li><li>可扩展且方便未来管理（如 <code>blog-project1</code>）</li><li>避免敏感信息</li></ul><p>选择合适的名称后，未来的管理和部署都会更加高效！</p>              </div>            </details><h3 id="连接至-github"><a href="#连接至-github" class="headerlink" title="连接至 github"></a>连接至 github</h3><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <ol><li><p>配置用户名和邮箱</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --global user.name &quot;你的用户名&quot;</span><br><span class="line">git config --global user.email &quot;你的邮箱&quot;</span><br></pre></td></tr></table></figure></li><li><p>执行以下命令生成ssh公钥，此公钥用于你的计算机连接Github</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;你的邮箱&quot;</span><br></pre></td></tr></table></figure></li><li><p>用户根文件夹下，找到 .ssh 文件，会看到 id_rsa.pub 公钥文件，响应的 id_rsa 为私钥</p></li><li><p>将 SSH KEY 公钥配置到 GitHub：进入github，点击右上角头像 选择<code>settings</code>，进入设置页后选择 <code>SSH and GPG keys</code>，名字随便起，公钥填到<code>Key</code>那一栏。</p></li><li><p>测试连接</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure><p>​</p></li></ol>              </div>            </details><h3 id="项目中安装-hexo-deployer-git"><a href="#项目中安装-hexo-deployer-git" class="headerlink" title="项目中安装 hexo-deployer-git"></a>项目中安装 hexo-deployer-git</h3><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <ol><li><p>安装 hexo-deployer-git</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure></li><li><p>_config.yml，就是整个Hexo框架的配置文件了。可以在里面修改大部分的配置。详细可参考官方的<a href="https://hexo.io/zh-cn/docs/configuration">配置描述</a>。<br>修改最后一行的配置，将repository修改为你自己的github项目地址即可，还有分支要改为<code>main</code>代表主分支（注意缩进）。</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repository:</span> <span class="string">git@github.com:Fomalhaut-Blog/Fomalhaut-Blog.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">main</span></span><br></pre></td></tr></table></figure></li><li><p>然后，执行 hexo 三连</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo generate &amp;&amp; hexo deploy  // Git BASH终端</span><br><span class="line">hexo clean; hexo generate; hexo deploy  // VSCODE终端</span><br></pre></td></tr></table></figure><p>​</p></li></ol>              </div>            </details><h3 id="无法连接至-github-的解决方案"><a href="#无法连接至-github-的解决方案" class="headerlink" title="无法连接至 github 的解决方案"></a>无法连接至 github 的解决方案</h3><p>开源项目<a href="https://github.com/521xueweihan/GitHub520">Github520</a></p><p>通过修改Host文件的方法解决访问速度慢的问题</p><h2 id="样式调整"><a href="#样式调整" class="headerlink" title="样式调整"></a>样式调整</h2><h3 id="iconfont-图标引入"><a href="#iconfont-图标引入" class="headerlink" title="iconfont 图标引入"></a>iconfont 图标引入</h3><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>在 _config.webstack.yml 末尾，加入如下代码</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">iconfont: //at.alicdn.com/t/c/font_4763045_hil03iimvno.css</span><br></pre></td></tr></table></figure><p>修改 themes\webstack\layout\common\group.ejs 文件</p><p>修改前，第一行的 h4 标签中的 i 标签，图标名称是写死的</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;h4 class=&quot;text-gray&quot;&gt;&lt;i class=&quot;linecons-tag&quot; style=&quot;margin-right: 7px;&quot; id=&quot;&lt;%= e.name.replace(/[\s]+/g, &#x27;-&#x27;) %&gt;&quot;&gt;&lt;/i&gt;&lt;%= e.name %&gt;&lt;/h4&gt;</span><br><span class="line">&lt;div class=&quot;row&quot;&gt;</span><br><span class="line">  &lt;% menus.forEach(function(menu) &#123; %&gt;</span><br><span class="line">  &lt;div class=&quot;col-sm-3&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;xe-widget xe-conversations box2 label-info&quot; onclick=&quot;window.open(&#x27;&lt;%= url_for(menu.url) %&gt;&#x27;, &#x27;_blank&#x27;)&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;bottom&quot; title=&quot;&quot; data-original-title=&quot;&lt;%= url_for(menu.url) %&gt;&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;xe-comment-entry&quot;&gt;</span><br><span class="line">        &lt;a class=&quot;xe-user-img&quot;&gt;</span><br><span class="line">          &lt;img data-src=&quot;&lt;%= url_for(menu.img) %&gt;&quot; class=&quot;lozad img-circle&quot; width=&quot;40&quot;&gt;</span><br><span class="line">        &lt;/a&gt;</span><br><span class="line">        &lt;div class=&quot;xe-comment&quot;&gt;</span><br><span class="line">          &lt;a href=&quot;#&quot; class=&quot;xe-user-name overflowClip_1&quot;&gt;</span><br><span class="line">            &lt;strong&gt;&lt;%= menu.name %&gt;&lt;/strong&gt;</span><br><span class="line">          &lt;/a&gt;</span><br><span class="line">          &lt;p class=&quot;overflowClip_2&quot;&gt;&lt;%= menu.description %&gt;&lt;/p&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;% &#125;) %&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;br /&gt;</span><br></pre></td></tr></table></figure><p>修改后，参照如下：</p><p>其中，参照 id 的内容，推定 e.icon 为侧边栏菜单的图标，因此修改如下</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;h4 class=&quot;text-gray&quot;&gt;</span><br><span class="line">  &lt;i class=&quot;&lt;%= e.icon || &#x27;linecons-tag&#x27; %&gt;&quot; style=&quot;margin-right: 7px;&quot; id=&quot;&lt;%= e.name.replace(/[\s]+/g, &#x27;-&#x27;) %&gt;&quot;&gt;&lt;/i&gt;</span><br><span class="line">  &lt;%= e.name %&gt;</span><br><span class="line">&lt;/h4&gt;</span><br></pre></td></tr></table></figure><p>这时候，在菜单的 icon 中，就能够以 iconfont icon-riben 的形式进行替换啦！</p>              </div>            </details><h3 id="取消主题自带的-tooltip-效果"><a href="#取消主题自带的-tooltip-效果" class="headerlink" title="取消主题自带的 tooltip 效果"></a>取消主题自带的 tooltip 效果</h3><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>在 _config.webstack.yml 末尾，加入如下代码</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">custom: /css/custom.css</span><br><span class="line"></span><br><span class="line">// 然后写入如下样式</span><br><span class="line">.tooltip &#123;</span><br><span class="line">  <span class="attribute">display</span>: none <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><p>到这里，基本上就完了基本的框架修改，后面就是完善这个 nav_demo 啦！~ </p><p>撒花啦<del>~</del><del>~</del>~~</p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue3.2+Vite+Typescript 开发（二）</title>
      <link href="/posts/f3ee6f99/"/>
      <url>/posts/f3ee6f99/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><div class="note blue no-icon flat"><p>Vue3.2+Vite+Typescript 开发双端招聘全过程系列导航</p><ol><li><a href="/posts/976198b5/">基础环境配置（一）</a></li><li>可复用的页面交互逻辑（二） ⇦当前位置🪂</li><li>个人中心模块（三）</li><li>即将闪亮登场..</li></ol></div><h2 id="基于vue实现常见的Tab切换组件"><a href="#基于vue实现常见的Tab切换组件" class="headerlink" title="基于vue实现常见的Tab切换组件"></a>基于vue实现常见的Tab切换组件</h2><details class="folding-tag" ><summary> 点击设计思路与实现 </summary>              <div class='content'>              <p>核心思路：携带不同标签页的id分别发起api请求，根据id值分别得到对应的返回结果，进而渲染出一一对应的数据</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; reactive &#125; from &#x27;vue&#x27;</span><br><span class="line">  </span><br><span class="line">// 先准备待渲染的数据</span><br><span class="line">const tabs = [</span><br><span class="line">  &#123;</span><br><span class="line">    type: 2,</span><br><span class="line">    text: &#x27;待签约&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    type: 3,</span><br><span class="line">    text: &#x27;履约中&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    type: 4,</span><br><span class="line">    text: &#x27;已完成&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    type: 5,</span><br><span class="line">    text: &#x27;已失效&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">// 用于在 html 结构中为标签添加动态属性</span><br><span class="line">const state = reactive(&#123;</span><br><span class="line">  type: tabs[0].type</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 通过简单的赋值运算、布尔判断，为标签添加 active 类</span><br><span class="line">const setTabList = type =&gt; &#123;</span><br><span class="line">  if (type === state.type) return</span><br><span class="line">  state.type = type</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;contract-tab&quot;&gt;</span><br><span class="line">    &lt;span</span><br><span class="line">      v-for=&quot;(item, index) in tabs&quot;</span><br><span class="line">      :key=&quot;index&quot;</span><br><span class="line">      :class=&quot;state.type === item.type ? &#x27;active&#x27; : &#x27;&#x27;&quot;</span><br><span class="line">      @click=&quot;setTabList(item.type)&quot;</span><br><span class="line">      &gt;&#123;&#123; item.text &#125;&#125;&lt;i&gt;&lt;/i</span><br><span class="line">    &gt;&lt;/span&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.contract-tab &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  span &#123;</span><br><span class="line">    font-size: 0.75rem;</span><br><span class="line">    line-height: 0.75rem;</span><br><span class="line">    font-weight: 400;</span><br><span class="line">    color: #666666;</span><br><span class="line">    flex: 1;</span><br><span class="line">    align-items: center;</span><br><span class="line">    border-bottom: 1px solid #eeeeee;</span><br><span class="line">    padding: 0.59rem 0;</span><br><span class="line">    text-align: center;</span><br><span class="line">    position: relative;</span><br><span class="line">    &amp;.active &#123;</span><br><span class="line">      color: #ff9415;</span><br><span class="line">      i &#123;</span><br><span class="line">        width: 1.63rem;</span><br><span class="line">        height: 0.05rem;</span><br><span class="line">        background-color: #ff9415;</span><br><span class="line">        position: absolute;</span><br><span class="line">        bottom: 0px;</span><br><span class="line">        left: 50%;</span><br><span class="line">        margin-left: -0.815rem;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><details class="folding-tag" ><summary> 将 type 值存进 store 中，实现返回上一级时，停在之前的 tab 上 </summary>              <div class='content'>              <p>/src/stores/contract.ts</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> contractStore = <span class="title function_">defineStore</span>(&#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="string">&#x27;contract&#x27;</span>,</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">setType</span>(<span class="params"><span class="keyword">type</span></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">type</span> = <span class="keyword">type</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>然后，在 ContractPage.vue 组件中</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">type</span>: store.<span class="property">type</span> || tabs[<span class="number">0</span>].<span class="property">type</span>,  <span class="comment">// 优先从 store 里面取值</span></span><br><span class="line">  <span class="attr">list</span>: [],</span><br><span class="line">  <span class="attr">loading</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">activeIndex</span>: <span class="number">0</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">setTabList</span> = type =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (type === state.<span class="property">type</span>) <span class="keyword">return</span></span><br><span class="line">  state.<span class="property">type</span> = type</span><br><span class="line">  store.<span class="title function_">setType</span>(type)</span><br><span class="line">  <span class="comment">// console.log(`点击了第$&#123;store.type&#125;个标签`)</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">getContractList</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details>              </div>            </details><h2 id="vant组件下拉刷新的-bug-修复"><a href="#vant组件下拉刷新的-bug-修复" class="headerlink" title="vant组件下拉刷新的  bug 修复"></a>vant组件下拉刷新的  bug 修复</h2><details class="folding-tag" ><summary> 这个直接在代码中注释了 </summary>              <div class='content'>              <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;van-pull-refresh v-model=&quot;state.loading&quot; @refresh=&quot;getContractList&quot;&gt;</span><br><span class="line">    &lt;ContractList :contract-list=&quot;state.list&quot;&gt;&lt;/ContractList&gt;</span><br><span class="line">  // 新增这个加载组件，并在上方 state 中声明 activeIndex ，默认值为 0</span><br><span class="line">    // 在下拉组件的 @refresh 函数中，添加 state.activeIndex++ 的逻辑</span><br><span class="line">    // 这样以来，在页面载入后的首次请求中，就会满足设定的条件，显示“加载中..”</span><br><span class="line">    // 随后的请求中 activeIndex 不再 === 0 ，就不会再次触发了</span><br><span class="line">    &lt;van-loading v-if=&quot;state.activeIndex === 0 &amp;&amp; state.loading&quot;&gt;加载中...&lt;/van-loading&gt;</span><br><span class="line">    &lt;div v-if=&quot;!state.loading &amp;&amp; state.list.length == 0&quot; class=&quot;wy-no-data&quot;&gt;暂无数据&lt;/div&gt;</span><br><span class="line">  &lt;/van-pull-refresh&gt;</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="按键防抖"><a href="#按键防抖" class="headerlink" title="按键防抖"></a>按键防抖</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 原始代码</span></span><br><span class="line"><span class="comment">// directives 是一个函数，用于注册自定义指令到 Vue 应用实例中。</span></span><br><span class="line"><span class="comment">// 参数 app 是 Vue 应用实例，通过它可以调用 app.directive 方法注册全局指令。</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">directives</span> = (<span class="params"><span class="attr">app</span>:<span class="built_in">any</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 注册了一个名为 debounce 的指令，通过 v-debounce 的形式在模板中使用。</span></span><br><span class="line">    app.<span class="title function_">directive</span>(<span class="string">&#x27;debounce&#x27;</span>, &#123;</span><br><span class="line">        <span class="comment">// mounted：当指令绑定的 DOM 元素挂载到页面时触发。</span></span><br><span class="line">        <span class="title function_">mounted</span>(<span class="params"><span class="attr">el</span>:<span class="built_in">any</span>,<span class="attr">binding</span>:<span class="built_in">any</span></span>) &#123;</span><br><span class="line">            <span class="comment">// 检查传入指令的值是否为一个函数。因为防抖机制需要包裹一个函数回调</span></span><br><span class="line">            <span class="comment">// 如果不是函数，直接退出。</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">typeof</span> binding.<span class="property">value</span> !==<span class="string">&#x27;function&#x27;</span>) <span class="keyword">return</span></span><br><span class="line">            <span class="comment">// timer：用于保存定时器 ID，用于防抖逻辑。</span></span><br><span class="line"> <span class="comment">// handler：绑定事件的实际执行函数。</span></span><br><span class="line">            el.<span class="property">timer</span> = <span class="literal">null</span></span><br><span class="line">            el.<span class="property">handler</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                <span class="comment">// 防抖逻辑：</span></span><br><span class="line">                <span class="comment">// 如果 timer 不为空，清除之前的定时器。</span></span><br><span class="line">                <span class="keyword">if</span> (el.<span class="property">timer</span>) &#123;</span><br><span class="line">                    <span class="built_in">clearTimeout</span>(el.<span class="property">timer</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 使用 setTimeout 创建一个新的定时器，延迟 600ms 后</span></span><br><span class="line">                <span class="comment">// 调用 binding.value，即用户传入的回调函数。</span></span><br><span class="line">                el.<span class="property">timer</span> = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    binding.<span class="property">value</span>.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>)</span><br><span class="line">                &#125;,<span class="number">600</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 将 el.handler 绑定为元素的 click 事件处理程序。</span></span><br><span class="line"> <span class="comment">// 当用户点击绑定了 v-debounce 的元素时，el.handler 将控制回调函数的触发频率。</span></span><br><span class="line">            el.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>,el.<span class="property">handler</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// beforeUnmount：当指令绑定的 DOM 元素被移除时触发。</span></span><br><span class="line">        <span class="title function_">beforeUnmount</span>(<span class="params"><span class="attr">el</span>:<span class="built_in">any</span>, <span class="attr">binding</span>:<span class="built_in">any</span></span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(el.<span class="property">timer</span>)&#123;</span><br><span class="line">                el.<span class="property">timer</span> = <span class="literal">null</span></span><br><span class="line">                <span class="comment">// 清除定时器，避免内存泄漏。</span></span><br><span class="line">                <span class="built_in">clearTimeout</span>(el.<span class="property">timer</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 移除绑定的 click 事件监听器。</span></span><br><span class="line">            el.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;click&#x27;</span>,el.<span class="property">handler</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这段代码定义了一个自定义 Vue 指令 <code>v-debounce</code>，用于防止某些事件（比如 <code>click</code>）在短时间内被多次触发。通过引入“防抖”机制（Debounce），仅在事件停止触发一段时间后才执行回调函数。</p><p>以下是对这段代码的详细解读，包括其实现逻辑和工作原理：</p><hr><h3 id="代码功能"><a href="#代码功能" class="headerlink" title="代码功能"></a><strong>代码功能</strong></h3><p>这段代码定义了一个自定义 Vue 指令 <code>v-debounce</code>，用于防止某些事件（比如 <code>click</code>）在短时间内被多次触发。通过引入“防抖”机制（Debounce），仅在事件停止触发一段时间后才执行回调函数。</p><hr><h3 id="代码逐段解析"><a href="#代码逐段解析" class="headerlink" title="代码逐段解析"></a><strong>代码逐段解析</strong></h3><h4 id="1-导出函数-directives"><a href="#1-导出函数-directives" class="headerlink" title="1. 导出函数 directives"></a>1. <strong>导出函数 directives</strong></h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">directives</span> = (<span class="params">app: any</span>) =&gt; &#123;</span><br><span class="line">  app.<span class="title function_">directive</span>(<span class="string">&#x27;debounce&#x27;</span>, &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>directives</code> 是一个函数，用于注册自定义指令到 Vue 应用实例中。</li><li>参数 <code>app</code> 是 Vue 应用实例，通过它可以调用 <code>app.directive</code> 方法注册全局指令。</li></ul><hr><h4 id="2-注册指令-debounce"><a href="#2-注册指令-debounce" class="headerlink" title="2. 注册指令 debounce"></a>2. <strong>注册指令 debounce</strong></h4><ul><li>注册了一个名为 <code>debounce</code> 的指令，通过 <code>v-debounce</code> 的形式在模板中使用。</li><li>该指令的生命周期方法包括：<ul><li><code>mounted</code>：当指令绑定的 DOM 元素挂载到页面时触发。</li><li><code>beforeUnmount</code>：当指令绑定的 DOM 元素被移除时触发。</li></ul></li></ul><hr><h4 id="3-mounted-钩子"><a href="#3-mounted-钩子" class="headerlink" title="3. mounted 钩子"></a>3. <strong>mounted 钩子</strong></h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">mounted</span>(<span class="params">el: any, binding: any</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> binding.<span class="property">value</span> !== <span class="string">&#x27;function&#x27;</span>) <span class="keyword">return</span></span><br></pre></td></tr></table></figure><ul><li><p>参数说明：</p><ul><li><code>el</code>：指令绑定的 DOM 元素。</li><li><code>binding</code>：包含指令相关信息的对象，例如 <code>binding.value</code> 是传入指令的值。</li></ul></li><li><p>逻辑</p><ul><li>检查传入指令的值是否为一个函数。因为防抖机制需要包裹一个函数回调，如果不是函数，直接退出。</li></ul></li></ul><hr><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">el.<span class="property">timer</span> = <span class="literal">null</span></span><br><span class="line">el.<span class="property">handler</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (el.<span class="property">timer</span>) &#123;</span><br><span class="line">        <span class="built_in">clearTimeout</span>(el.<span class="property">timer</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    el.<span class="property">timer</span> = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        binding.<span class="property">value</span>.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>)</span><br><span class="line">    &#125;, <span class="number">600</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>功能</p><ul><li><p>给el添加两个属性：</p><ul><li><code>timer</code>：用于保存定时器 ID，用于防抖逻辑。</li><li><code>handler</code>：绑定事件的实际执行函数。</li></ul></li><li><p>防抖逻辑：</p><ol><li>如果 <code>timer</code> 不为空，清除之前的定时器。</li><li>使用 <code>setTimeout</code> 创建一个新的定时器，延迟 600ms 后调用 <code>binding.value</code>，即用户传入的回调函数。</li></ol></li></ul></li></ul><hr><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">el.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, el.<span class="property">handler</span>)</span><br></pre></td></tr></table></figure><ul><li>将 <code>el.handler</code> 绑定为元素的 <code>click</code> 事件处理程序。</li><li>当用户点击绑定了 <code>v-debounce</code> 的元素时，<code>el.handler</code> 将控制回调函数的触发频率。</li></ul><hr><h4 id="4-beforeUnmount-钩子"><a href="#4-beforeUnmount-钩子" class="headerlink" title="4. beforeUnmount 钩子"></a>4. <strong>beforeUnmount 钩子</strong></h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">beforeUnmount</span>(<span class="params">el: any, binding: any</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (el.<span class="property">timer</span>) &#123;</span><br><span class="line">        el.<span class="property">timer</span> = <span class="literal">null</span></span><br><span class="line">        <span class="built_in">clearTimeout</span>(el.<span class="property">timer</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    el.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;click&#x27;</span>, el.<span class="property">handler</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>功能</p><ul><li>在指令绑定的元素即将从 DOM 移除时：<ol><li>清除定时器，避免内存泄漏。</li><li>移除绑定的 <code>click</code> 事件监听器。</li></ol></li></ul></li></ul><hr><h3 id="核心逻辑"><a href="#核心逻辑" class="headerlink" title="核心逻辑"></a><strong>核心逻辑</strong></h3><ol><li><strong>防抖机制</strong>：<ul><li>用户频繁触发事件时，函数不会立即执行，而是等用户停止操作一段时间后才执行最后一次触发的回调函数。</li><li>防止短时间内多次调用带来的性能问题或逻辑错误。</li></ul></li><li><strong>生命周期管理</strong>：<ul><li>使用 Vue 指令的生命周期（<code>mounted</code> 和 <code>beforeUnmount</code>）确保指令的逻辑正确注册和清理，避免内存泄漏或事件重复绑定的问题。</li></ul></li></ol><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 严格类型声明的代码</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">DirectiveBinding</span>, <span class="title class_">ObjectDirective</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义类型，扩展 HTMLElement</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DebouncedHTMLElement</span> <span class="keyword">extends</span> <span class="title class_">HTMLElement</span> &#123;</span><br><span class="line">  timer?: <span class="title class_">NodeJS</span>.<span class="property">Timeout</span> | <span class="literal">null</span></span><br><span class="line">  handler?: <span class="function">(<span class="params">...<span class="attr">args</span>: <span class="built_in">unknown</span>[]</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义自定义指令</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">directives</span> = (<span class="params"><span class="attr">app</span>: &#123;</span></span><br><span class="line"><span class="params">  directive: (name: <span class="built_in">string</span>, options: ObjectDirective) =&gt; <span class="built_in">void</span></span></span><br><span class="line"><span class="params">&#125;</span>) =&gt; &#123;</span><br><span class="line">  app.<span class="title function_">directive</span>(<span class="string">&#x27;debounce&#x27;</span>, &#123;</span><br><span class="line">    <span class="title function_">mounted</span>(<span class="params"><span class="attr">el</span>: <span class="title class_">DebouncedHTMLElement</span>, <span class="attr">binding</span>: <span class="title class_">DirectiveBinding</span></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> binding.<span class="property">value</span> !== <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;v-debounce expects a function as its value&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      el.<span class="property">timer</span> = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 定义防抖处理函数</span></span><br><span class="line">      el.<span class="property">handler</span> = <span class="keyword">function</span> (<span class="params">...<span class="attr">args</span>: <span class="built_in">unknown</span>[]</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (el.<span class="property">timer</span>) &#123;</span><br><span class="line">          <span class="built_in">clearTimeout</span>(el.<span class="property">timer</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        el.<span class="property">timer</span> = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          binding.<span class="property">value</span>.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args)</span><br><span class="line">        &#125;, <span class="number">600</span>)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 添加事件监听</span></span><br><span class="line">      el.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, el.<span class="property">handler</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">beforeUnmount</span>(<span class="params"><span class="attr">el</span>: <span class="title class_">DebouncedHTMLElement</span></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (el.<span class="property">timer</span>) &#123;</span><br><span class="line">        <span class="built_in">clearTimeout</span>(el.<span class="property">timer</span>)</span><br><span class="line">        el.<span class="property">timer</span> = <span class="literal">null</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (el.<span class="property">handler</span>) &#123;</span><br><span class="line">        el.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;click&#x27;</span>, el.<span class="property">handler</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>最后要在main.ts中注册</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;vant/lib/index.css&#x27;</span> <span class="comment">// 引入 vant 全局样式</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./assets/css/style.css&#x27;</span> <span class="comment">// 引入自定义的全局样式, 放在vant后面, 避免被 vant ui 样式覆盖</span></span><br><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 组合式 setup api 中, 可直接按需引入, 而无需进行注册</span></span><br><span class="line"><span class="comment">// import &#123; Button, NavBar, Tabbar, TabbarItem, Checkbox, Toast, Icon &#125; from &#x27;vant&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@/utils/rem&#x27;</span> <span class="comment">// 引入 rem 适配方案</span></span><br><span class="line"><span class="keyword">import</span> &#123; directives &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/common&#x27;</span> <span class="comment">// 引入防抖</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"><span class="title function_">directives</span>(app)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">createPinia</span>())</span><br><span class="line">app.<span class="title function_">use</span>(router)</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="底部-tabbar-的显示和隐藏逻辑设计与实现"><a href="#底部-tabbar-的显示和隐藏逻辑设计与实现" class="headerlink" title="底部 tabbar 的显示和隐藏逻辑设计与实现"></a>底部 tabbar 的显示和隐藏逻辑设计与实现</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>保持根组件的简洁，将 vant 中的组件进行二次封装后，写在app.vue 中</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script setup lang=<span class="string">&quot;ts&quot;</span>&gt;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ScrollFooter</span> <span class="keyword">from</span> <span class="string">&#x27;./components/ScrollFooter.vue&#x27;</span></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">RouterView</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">ScrollFooter</span>&gt;</span><span class="tag">&lt;/<span class="name">ScrollFooter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>/src/components/ScrollFooter.vue</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script setup lang=<span class="string">&quot;ts&quot;</span>&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; ref, onMounted, onUnmounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="comment">// 控制 FooterTabbar 的显示与隐藏</span></span><br><span class="line"><span class="keyword">const</span> showFooter = <span class="title function_">ref</span>(<span class="literal">true</span>)</span><br><span class="line"><span class="keyword">let</span> lastScrollTop = <span class="number">0</span> <span class="comment">// 上一次的滚动位置</span></span><br><span class="line"><span class="comment">// eslint-disable-next-line no-undef</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">scrollTimeout</span>: <span class="title class_">NodeJS</span>.<span class="property">Timeout</span> | <span class="literal">null</span> = <span class="literal">null</span> <span class="comment">// 用于监听停止滚动的定时器</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 滚动事件逻辑</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleScroll</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> scrollTop = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollTop</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (scrollTop &gt; lastScrollTop) &#123;</span><br><span class="line">    <span class="comment">// 向下滚动，隐藏 Footer</span></span><br><span class="line">    showFooter.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (scrollTop &lt; lastScrollTop) &#123;</span><br><span class="line">    <span class="comment">// 向上滚动，显示 Footer</span></span><br><span class="line">    showFooter.<span class="property">value</span> = <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置停止滚动后的逻辑</span></span><br><span class="line">  <span class="keyword">if</span> (scrollTimeout) <span class="built_in">clearTimeout</span>(scrollTimeout)</span><br><span class="line">  scrollTimeout = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    showFooter.<span class="property">value</span> = <span class="literal">true</span> <span class="comment">// 停止滚动后归位</span></span><br><span class="line">  &#125;, <span class="number">900</span>)</span><br><span class="line"></span><br><span class="line">  lastScrollTop = scrollTop</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听滚动事件</span></span><br><span class="line"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, handleScroll)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">onUnmounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, handleScroll)</span><br><span class="line">  <span class="keyword">if</span> (scrollTimeout) <span class="built_in">clearTimeout</span>(scrollTimeout)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">&quot;footer-transition&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 动态显示 FooterTabbar --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">FooterTabbar</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">v-show</span>=<span class="string">&quot;</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml">        showFooter &amp;&amp;</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml">        !$route.path.startsWith(&#x27;/login&#x27;) &amp;&amp;</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml">        !$route.path.startsWith(&#x27;/task/TaskDetails&#x27;) &amp;&amp;</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml">        !$route.path.startsWith(&#x27;/contract/ContractDetails&#x27;) &amp;&amp;</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml">        !$route.path.startsWith(&#x27;/contract/ContractProgress&#x27;)</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml">      &quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="comment">/* 过渡动画 */</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.footer-transition-enter-active</span>,</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.footer-transition-leave-active</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">transition</span>:</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    transform <span class="number">0.7s</span> ease,</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    opacity <span class="number">0.7s</span> ease;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="comment">/* 隐藏时向下滑动并变透明 */</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.footer-transition-enter-from</span>,</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.footer-transition-leave-to</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">100%</span>);</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="comment">/* 显示时恢复正常位置 */</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.footer-transition-enter-to</span>,</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.footer-transition-leave-from</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="新消息通知红点技术方案设计与实现"><a href="#新消息通知红点技术方案设计与实现" class="headerlink" title="新消息通知红点技术方案设计与实现"></a>新消息通知红点技术方案设计与实现</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>消息模块中的 index.vue</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">&lt;script setup lang=<span class="string">&quot;ts&quot;</span>&gt;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MessageList</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/list/MessageList.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; messageStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores/message&#x27;</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">messageStore</span>()</span><br><span class="line">store.<span class="title function_">getSystemMessageList</span>()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  // 组件化思想</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">MessageList</span> <span class="attr">:message-list</span>=<span class="string">&quot;store.systemNewMessage&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">MessageList</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>/src/components/list/MessageList.vue</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const &#123; messageList &#125; = defineProps&lt;&#123;</span><br><span class="line">  messageList</span><br><span class="line">&#125;&gt;()</span><br></pre></td></tr></table></figure><p><strong>defineProps 泛型参数 &lt;{ messageList }&gt;</strong>：</p><ul><li>泛型定义了 <code>props</code> 的类型，帮助 TypeScript 提供更好的类型推断。</li><li>在这个例子中，泛型 <code>{ messageList }</code> 表示组件的 <code>props</code> 中应该有一个名为 <code>messageList</code> 的属性。</li><li><strong>未指定 messageList 的具体类型</strong>，所以默认会是 <code>any</code> 类型。</li></ul><p><strong>消息红点的实现方法</strong>：</p><p>现在样式中适用span标签写好一个小红点</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// html 结构</span></span><br><span class="line"><span class="comment">// 根据返回值，使用 v-if 条件加载即可</span></span><br><span class="line">&lt;span v-<span class="keyword">if</span>=<span class="string">&quot;item.is_show&quot;</span>&gt;&lt;/span&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// css 样式</span></span><br><span class="line">span &#123;</span><br><span class="line">  <span class="attr">float</span>: right;</span><br><span class="line">  <span class="attr">color</span>: #<span class="number">999999</span>;</span><br><span class="line">  font-<span class="attr">size</span>: <span class="number">0.</span>7rem;</span><br><span class="line">  font-<span class="attr">weight</span>: <span class="number">100</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="泛型声明-amp-类型断言"><a href="#泛型声明-amp-类型断言" class="headerlink" title="泛型声明&amp;类型断言"></a>泛型声明&amp;类型断言</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">apiResponse 泛型声明</button><button type="button" class="tab">state 在初始化数据时使用类型断言</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// api 接口中 使用泛型声明</span></span><br><span class="line"><span class="comment">// 消息列表接口</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> systemList&lt;T&gt;(data): <span class="title class_">Promise</span>&lt;&#123; <span class="attr">data</span>: T &#125;&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/user/inform/list&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">    <span class="attr">params</span>: data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>具体来说：</p><h3 id="1-systemList-lt-T-gt-data-的泛型声明"><a href="#1-systemList-lt-T-gt-data-的泛型声明" class="headerlink" title="1. systemList&lt;T&gt;(data) 的泛型声明"></a>1. <code>systemList&lt;T&gt;(data)</code> 的泛型声明</h3><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> systemList&lt;T&gt;(data): <span class="title class_">Promise</span>&lt;&#123; <span class="attr">data</span>: T &#125;&gt; &#123; </span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/user/inform/list&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">    <span class="attr">params</span>: data</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>systemList&lt;T&gt;(data)</code> 中的 <code>&lt;T&gt;</code> 是一个 <strong>泛型类型参数</strong>，它允许你在调用 <code>systemList</code> 函数时指定一个具体的类型。<code>T</code> 是一个占位符，它代表了你希望 <code>systemList</code> 返回的响应数据的类型。</li></ul><h3 id="2-Promise-lt-T-gt-的含义"><a href="#2-Promise-lt-T-gt-的含义" class="headerlink" title="2. Promise&lt;T&gt; 的含义"></a>2. <code>Promise&lt;T&gt;</code> 的含义</h3><p><code>Promise&lt;T&gt;</code> 是一个 <strong>泛型类型</strong>，用于描述异步操作的结果类型。在这个例子中，<code>Promise&lt;T&gt;</code> 表示 <code>systemList</code> 函数返回的 <strong>Promise 对象</strong>，而该 Promise 最终会解析为类型为 <code>T</code> 的数据。</p><h3 id="两者的关系"><a href="#两者的关系" class="headerlink" title="两者的关系"></a>两者的关系</h3><ul><li><code>systemList</code> 函数的返回值是一个 <code>Promise&lt;T&gt;</code>，即一个异步操作的结果，最终将会返回类型为 <code>T</code> 的数据。</li><li>你在调用 <code>systemList</code> 时，传入的 <code>T</code> 决定了你希望从 <code>request</code> 调用中获得的响应数据的类型。</li></ul><h3 id="解释过程"><a href="#解释过程" class="headerlink" title="解释过程"></a>解释过程</h3><ol><li><strong>泛型传递</strong>：函数 <code>systemList</code> 定义了一个类型参数 <code>T</code>，这意味着你在调用该函数时，可以指定 <code>T</code> 的实际类型。</li><li><strong>请求返回类型</strong>：<code>Promise&lt;T&gt;</code> 表示异步操作的返回类型。当你执行 <code>request</code> 请求并获得响应时，返回的数据会被视作类型 <code>T</code>。</li></ol><h3 id="示例："><a href="#示例：" class="headerlink" title="示例："></a>示例：</h3><p>假设你希望从接口 <code>/user/inform/list</code> 获取的响应数据是一个包含多个消息对象的数组，你可以在调用 <code>systemList</code> 时指定 <code>T</code> 的类型。</p><p>例如：</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Message</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">content</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getMessages</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> systemList&lt;<span class="title class_">Message</span>[]&gt;(&#123; <span class="attr">type</span>: <span class="number">0</span> &#125;);  <span class="comment">// T 被指定为 Message[]</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(result);  <span class="comment">// 这里 result 的类型是 Message[]</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在这个例子中：</p><ul><li><code>T</code> 被指定为 <code>Message[]</code>，即返回的数据应该是一个 <code>Message</code> 类型的数组。</li><li><code>systemList&lt;Message[]&gt;</code> 返回的结果会是一个 <code>Promise&lt;Message[]&gt;</code>，这意味着 <code>systemList</code> 将返回一个包含 <code>Message</code> 类型数组的异步响应。</li></ul><h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><ul><li><code>systemList&lt;T&gt;</code> 通过泛型 <code>T</code> 使得你能够灵活地指定返回数据的类型。</li><li><code>Promise&lt;T&gt;</code> 表示 <code>systemList</code> 函数返回的是一个 <code>Promise</code>，它最终会解析为类型为 <code>T</code> 的数据。</li><li><code>T</code> 是占位符，代表你调用 <code>systemList</code> 时传入的类型，它决定了返回数据的结构。</li></ul><p>下一个小节会展开进行详细补充..</p></div><div class="tab-item-content"><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在 stores 模块中</span></span><br><span class="line"><span class="comment">// /src/stores/message.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; systemList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/message&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> messageList &#123;</span><br><span class="line">  title</span><br><span class="line">  create_time</span><br><span class="line">  content</span><br><span class="line">  id</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> messageStore = <span class="title function_">defineStore</span>(&#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="string">&#x27;message&#x27;</span>,</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="comment">// 使用类型断言进行数据初始化</span></span><br><span class="line">      <span class="attr">systemMessageList</span>: [] <span class="keyword">as</span> messageList[],</span><br><span class="line">      <span class="attr">systemNewMessage</span>: [] <span class="keyword">as</span> messageList[]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">getSystemMessageList</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> res = <span class="keyword">await</span> systemList&lt;messageList[]&gt;(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">is_informtype</span>: <span class="number">2</span></span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">if</span> (res) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">systemMessageList</span> = res.<span class="property">data</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">systemMessageList</span>[<span class="number">0</span>]) <span class="variable language_">this</span>.<span class="property">systemNewMessage</span> = [<span class="variable language_">this</span>.<span class="property">systemMessageList</span>[<span class="number">0</span>]]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><h2 id="三种常见的类型声明方式"><a href="#三种常见的类型声明方式" class="headerlink" title="三种常见的类型声明方式"></a>三种常见的类型声明方式</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>在不同场景下，选择适合的方式非常重要。以下是三种常见的方式，以及它们的优缺点和适用场景：</p><hr><h3 id="1-显式声明类型"><a href="#1-显式声明类型" class="headerlink" title="1. 显式声明类型"></a>1. <strong>显式声明类型</strong></h3><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="attr">systemMessageList</span>: [] <span class="keyword">as</span> &#123; <span class="attr">title</span>: <span class="built_in">string</span>; <span class="attr">create_time</span>: <span class="built_in">string</span>; <span class="attr">content</span>: <span class="built_in">string</span>; <span class="attr">id</span>: <span class="built_in">number</span> &#125;[],</span><br></pre></td></tr></table></figure><h4 id="优点"><a href="#优点" class="headerlink" title="优点:"></a><strong>优点</strong>:</h4><ul><li>清晰直观：类型信息一目了然。</li><li>独立性强：无需依赖其他函数或工具类型，直接定义。</li></ul><h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点:"></a><strong>缺点</strong>:</h4><ul><li>重复定义：如果接口结构发生变化，需要在多个地方手动同步更新。</li><li>繁琐：对于复杂的数据结构，显式声明会变得冗长。</li></ul><h4 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景:"></a><strong>适用场景</strong>:</h4><ul><li>类型简单，接口结构不容易变动。</li><li>需要快速确认类型定义且与外部逻辑无关的场景。</li></ul><hr><h3 id="2-通过接口-类型定义引用"><a href="#2-通过接口-类型定义引用" class="headerlink" title="2. 通过接口/类型定义引用"></a>2. <strong>通过接口/类型定义引用</strong></h3><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">MessageList</span> &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">create_time</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">content</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="attr">systemMessageList</span>: [] <span class="keyword">as</span> <span class="title class_">MessageList</span>[],</span><br></pre></td></tr></table></figure><h4 id="优点-1"><a href="#优点-1" class="headerlink" title="优点:"></a><strong>优点</strong>:</h4><ul><li>中央化管理：类型定义可以复用，减少重复劳动。</li><li>可读性高：通过语义化的接口名称，提升代码可读性。</li></ul><h4 id="缺点-1"><a href="#缺点-1" class="headerlink" title="缺点:"></a><strong>缺点</strong>:</h4><ul><li>需要提前声明类型，可能额外引入复杂性。</li><li>如果类型与接口定义脱钩，可能需要手动更新。</li></ul><h4 id="适用场景-1"><a href="#适用场景-1" class="headerlink" title="适用场景:"></a><strong>适用场景</strong>:</h4><ul><li>类型需要在多个地方复用时。</li><li>项目中存在清晰的类型管理系统（如一个专门的 <code>types.ts</code> 文件）。</li></ul><h3 id="这里详细说明"><a href="#这里详细说明" class="headerlink" title="这里详细说明"></a>这里详细说明</h3><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 目标: 明确接口的返回数据的属性和类型。</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ChatMessageListResponse</span> &#123;</span><br><span class="line">  <span class="attr">data</span>: <span class="title class_">Array</span>&lt;&#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">message</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">sender</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">timestamp</span>: <span class="built_in">string</span>;</span><br><span class="line">  &#125;&gt;;</span><br><span class="line">  <span class="attr">success</span>: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> chatMessageList&lt;T = <span class="title class_">ChatMessageListResponse</span>&gt;(): <span class="title class_">Promise</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/it_chat/my/message/list&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="T-ChatMessageListResponse-的含义"><a href="#T-ChatMessageListResponse-的含义" class="headerlink" title="T = ChatMessageListResponse 的含义"></a>T = ChatMessageListResponse 的含义</h4><p>在 TypeScript 中，<code>T = ChatMessageListResponse</code> 为泛型 <code>T</code> 提供了一个默认值。如果在调用 <code>chatMessageList</code> 函数时，未显式指定类型，<code>T</code> 将自动被推断为 <code>ChatMessageListResponse</code>。</p><h4 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a><strong>Promise</strong></h4><p><code>Promise&lt;T&gt;</code> 是一个内置泛型类型，用于描述 <strong>异步操作的返回结果类型</strong>。具体来说，它表示的是一个 Promise 对象，该对象最终会以 <code>resolve</code> 的形式返回一个类型为 <code>T</code> 的值。例如：</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getData</span>(<span class="params"></span>): <span class="title class_">Promise</span>&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;Hello, world!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title function_">getData</span>(); <span class="comment">// result 推断为 string 类型</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// T 是一个占位符类型，允许在调用函数时动态地指定返回值的类型。</span></span><br></pre></td></tr></table></figure><hr><h3 id="3-使用动态类型推断"><a href="#3-使用动态类型推断" class="headerlink" title="3. 使用动态类型推断"></a>3. <strong>使用动态类型推断</strong></h3><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="attr">systemMessageList</span>: [] <span class="keyword">as</span> <span class="title class_">Awaited</span>&lt;<span class="title class_">ReturnType</span>&lt;<span class="keyword">typeof</span> systemList&gt;&gt;[<span class="string">&#x27;data&#x27;</span>],</span><br></pre></td></tr></table></figure><h4 id="优点-2"><a href="#优点-2" class="headerlink" title="优点:"></a><strong>优点</strong>:</h4><ul><li>自动同步：类型动态依赖于函数的返回值，接口变化时无需手动更新。</li><li>灵活性强：适用于复杂的场景或第三方接口返回的数据类型。</li></ul><h4 id="缺点-2"><a href="#缺点-2" class="headerlink" title="缺点:"></a><strong>缺点</strong>:</h4><ul><li>可读性较低：对初学者或不熟悉 TypeScript 工具类型的开发者可能不直观。</li><li>依赖链较深：如果 <code>systemList</code> 定义不明确或返回类型未定义，可能导致类型推断失败。</li></ul><h4 id="适用场景-2"><a href="#适用场景-2" class="headerlink" title="适用场景:"></a><strong>适用场景</strong>:</h4><ul><li>类型需要依赖外部函数或接口定义，可能会发生变动。</li><li>项目较大且维护团队熟悉 TypeScript 高级语法。</li></ul><hr><h3 id="最佳实践建议"><a href="#最佳实践建议" class="headerlink" title="最佳实践建议"></a><strong>最佳实践建议</strong></h3><p>综合考虑，<strong>方式 2（通过接口/类型定义引用）</strong> 通常是最佳实践，原因如下：</p><ol><li><strong>清晰可读：</strong> 开发者可以一眼看到接口的结构，而不需要跳转到其他文件。</li><li><strong>复用性高：</strong> 如果其他地方也需要使用该类型，可以直接复用。</li><li><strong>灵活性适中：</strong> 中央化管理类型定义，便于维护和修改。</li></ol><p>但如果你的项目有如下特点，<strong>方式 3（动态类型推断）</strong> 是更好的选择：</p><ul><li><strong>快速迭代</strong>：接口变动频繁，动态推断可以减少重复工作。</li><li><strong>外部接口较复杂</strong>：推断机制可以简化复杂的类型管理。</li></ul><h3 id="推荐代码"><a href="#推荐代码" class="headerlink" title="推荐代码"></a><strong>推荐代码</strong></h3><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 定义接口</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">MessageList</span> &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">create_time</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">content</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用接口定义类型</span></span><br><span class="line"><span class="attr">systemMessageList</span>: [] <span class="keyword">as</span> <span class="title class_">MessageList</span>[],</span><br></pre></td></tr></table></figure><p>这样既能保证代码清晰，又具有一定的扩展性，是大多数场景下的最佳实践！</p>              </div>            </details><h2 id="一种较为轻便的、仅针对小型项目的泛型声明方法"><a href="#一种较为轻便的、仅针对小型项目的泛型声明方法" class="headerlink" title="一种较为轻便的、仅针对小型项目的泛型声明方法"></a>一种较为轻便的、仅针对小型项目的泛型声明方法</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>双招项目</p><p>/src/api/contract</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;../utils/request&#x27;</span></span><br><span class="line"><span class="comment">// 合约列表接口</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> contractResponse &#123;</span><br><span class="line">  records</span><br><span class="line">  msg</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">contractList</span>(<span class="params">data</span>): <span class="title class_">Promise</span>&lt;contractResponse&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/task/myContractAllList&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">    <span class="attr">params</span>: data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> contractDetailResponse &#123;</span><br><span class="line">  records</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 合约详情接口</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">contractDetail</span>(<span class="params">data</span>): <span class="title class_">Promise</span>&lt;contractDetailResponse&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/task/contractAllList&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">    <span class="attr">params</span>: data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 合约签约/拒绝接口</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> contractOpreation&lt;T&gt;(data): <span class="title class_">Promise</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/contract/isContract&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;put&#x27;</span>,</span><br><span class="line">    data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 如上，合约签约/拒绝接口，请求函数的返回值类型是一个泛型 <code>Promise&lt;T&gt;</code>，没有显式指定具体的类型 <code>T</code></p><p>当调用时，可以通过显式泛型参数指定返回数据的类型。例如：</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">const</span> <span class="title function_">putContractOpreation</span> = <span class="keyword">async</span> <span class="keyword">type</span> =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> contractOpreation&lt;&#123; meg &#125;&gt;(&#123;</span><br><span class="line">    <span class="attr">is_contract_type</span>: <span class="keyword">type</span>,</span><br><span class="line">    <span class="attr">contract_id</span>: contractId</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">meg</span>, <span class="string">&#x27;这里是确认签约的返回数据&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="title function_">showToast</span>(res.<span class="property">meg</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再如：/src/api/message.ts</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 消息列表接口</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> systemList&lt;T&gt;(data): <span class="title class_">Promise</span>&lt;&#123; <span class="attr">data</span>: T &#125;&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/user/inform/list&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">    <span class="attr">params</span>: data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 消息详情</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> systemDetails&lt;T&gt;(data): <span class="title class_">Promise</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/user/inform/lookover&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">    <span class="attr">params</span>: data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对话列表接口</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> chatMessageList&lt;T&gt;(): <span class="title class_">Promise</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/it_chat/my/message/list&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>以上请求函数的返回值类型是一个泛型 <code>Promise&lt;T&gt;</code>，没有显式指定具体的类型 <code>T</code>，然后接下来在函数的 调用位置，进行显示声明：</p><p>/src/stores/message.ts</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; systemList, chatMessageList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/message&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> messageList &#123;</span><br><span class="line">  title</span><br><span class="line">  create_time</span><br><span class="line">  content</span><br><span class="line">  id</span><br><span class="line">  specific_time</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> messageStore = <span class="title function_">defineStore</span>(&#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="string">&#x27;message&#x27;</span>,</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">systemMessageList</span>: [] <span class="keyword">as</span> messageList[], <span class="comment">// 使用类型断言初始化</span></span><br><span class="line">      <span class="attr">systemNewMessage</span>: [] <span class="keyword">as</span> messageList[],</span><br><span class="line">      <span class="attr">messageList</span>: []</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">getSystemMessageList</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> res = <span class="keyword">await</span> systemList&lt;messageList[]&gt;(&#123; <span class="comment">// 就在这里，进行了显示类型声明</span></span><br><span class="line">        <span class="attr">type</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">is_informtype</span>: <span class="number">2</span></span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">if</span> (res) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">systemMessageList</span> = res.<span class="property">data</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">systemMessageList</span>[<span class="number">0</span>]) <span class="variable language_">this</span>.<span class="property">systemNewMessage</span> = [<span class="variable language_">this</span>.<span class="property">systemMessageList</span>[<span class="number">0</span>]]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">getChatMessageList</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> res = <span class="keyword">await</span> chatMessageList&lt;&#123; data &#125;&gt;() <span class="comment">// 这里也算是显示声明了数据结构</span></span><br><span class="line">      <span class="comment">//（尽管这里只声明了结构，缺少数据类型声明） </span></span><br><span class="line">      <span class="keyword">if</span> (res) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">messageList</span> = res.<span class="property">data</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="轮循方式实现对话消息实时展示"><a href="#轮循方式实现对话消息实时展示" class="headerlink" title="轮循方式实现对话消息实时展示"></a>轮循方式实现对话消息实时展示</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <h3 id="1-创建定时器"><a href="#1-创建定时器" class="headerlink" title="1. 创建定时器"></a>1. <strong>创建定时器</strong></h3><p>使用 <code>setInterval</code> 来定时请求后端接口，获取新的对话消息。通常，轮询时间间隔设置为几秒钟（例如：每 3 秒请求一次）。</p><p>/src/views/message/MessageTalk/[things_id]/[receive_id].vue</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 首先，在 state 中定义一个 定时器id</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">list</span>: [] <span class="keyword">as</span> chatMessageContentResponseItem[],</span><br><span class="line">  <span class="attr">loading</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">value</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">taskName</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="comment">// 确保定时器就仅此一个</span></span><br><span class="line">  <span class="attr">creacteSetInterval</span>: <span class="literal">null</span> <span class="keyword">as</span> <span class="title class_">ReturnType</span>&lt;<span class="keyword">typeof</span> <span class="built_in">setInterval</span>&gt; | <span class="literal">null</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="2-定义接口请求方法"><a href="#2-定义接口请求方法" class="headerlink" title="2. 定义接口请求方法"></a>2. <strong>定义接口请求方法</strong></h3><p>创建一个请求方法，用于向后端获取最新的聊天消息。</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">getChatMessageContent</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  state.<span class="property">loading</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> chatMessageContent&lt;chatMessageContentResponse&gt;(&#123;</span><br><span class="line">    <span class="attr">receive_id</span>: receiveId,</span><br><span class="line">    <span class="attr">things_id</span>: taskId,</span><br><span class="line">    <span class="attr">things_type</span>: <span class="number">0</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (res.<span class="property">data</span>) &#123;</span><br><span class="line">    state.<span class="property">list</span> = res.<span class="property">data</span></span><br><span class="line">    state.<span class="property">taskName</span> = (res.<span class="property">data</span>[<span class="number">0</span>] &amp;&amp; res.<span class="property">data</span>[<span class="number">0</span>].<span class="property">taskName</span>) || <span class="string">&#x27;任务&#x27;</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">showToast</span>(res.<span class="property">msg</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  state.<span class="property">loading</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">getChatMessageContent</span>()</span><br></pre></td></tr></table></figure><h3 id="3-更新界面"><a href="#3-更新界面" class="headerlink" title="3. 更新界面"></a>3. <strong>更新界面</strong></h3><p>首先，当然是创建一个定时器</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">stopSetInterval</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 有就清除</span></span><br><span class="line">  <span class="keyword">if</span> (state.<span class="property">creacteSetInterval</span>) &#123;</span><br><span class="line">    <span class="built_in">clearInterval</span>(state.<span class="property">creacteSetInterval</span>)</span><br><span class="line">    state.<span class="property">creacteSetInterval</span> = <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">createInterval</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 有就清除</span></span><br><span class="line">  <span class="title function_">stopSetInterval</span>()</span><br><span class="line">  state.<span class="property">creacteSetInterval</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getChatMessageContent</span>()</span><br><span class="line">  &#125;, <span class="number">5000</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">createInterval</span>()  <span class="comment">// 停止轮循</span></span><br></pre></td></tr></table></figure><h3 id="4-停止轮询"><a href="#4-停止轮询" class="headerlink" title="4. 停止轮询"></a>4. <strong>停止轮询</strong></h3><p>如果用户离开聊天界面或其他需要停止轮询的场景，可以通过 <code>clearInterval</code> 来清除定时器，停止继续请求数据。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">clearInterval(interval);  // 停止轮循</span><br></pre></td></tr></table></figure><h3 id="5-考虑优化"><a href="#5-考虑优化" class="headerlink" title="5. 考虑优化"></a>5. <strong>考虑优化</strong></h3><ul><li><strong>停止轮询</strong>：在用户离开页面、切换频道或进入非活跃状态时，可以停止轮询，以减少不必要的请求。</li><li><strong>请求优化</strong>：可以在请求时增加分页或根据时间戳获取新消息，避免每次请求获取所有消息。</li><li><strong>长轮询</strong>：如果每次轮询的数据量较大，可以采用长轮询（Long Polling），即当没有新数据时，服务器会保持请求连接，直到有新数据时再返回响应。</li></ul><h3 id="轮询步骤概览："><a href="#轮询步骤概览：" class="headerlink" title="轮询步骤概览："></a>轮询步骤概览：</h3><ol><li><strong>启动定时器</strong>：设置一个 <code>setInterval</code> 定时器，每隔一段时间请求接口。</li><li><strong>请求消息</strong>：调用 API 获取聊天消息。</li><li><strong>更新页面</strong>：将新获取的消息显示到页面上。</li><li><strong>清除定时器</strong>：在适当的时候清除定时器，如页面离开时。</li></ol><h3 id="优点与缺点："><a href="#优点与缺点：" class="headerlink" title="优点与缺点："></a>优点与缺点：</h3><ul><li><strong>优点</strong>：<ul><li>实现简单，易于上手。</li><li>对于实时性要求不高的场景，可以较为平滑地展示数据更新。</li></ul></li><li><strong>缺点</strong>：<ul><li>消耗服务器和客户端资源，频繁的请求会导致性能问题。</li><li>不如 WebSocket 等实时技术那么高效。</li></ul></li></ul><p>如果对实时性要求较高，建议使用 WebSocket 或长轮询技术来代替轮询。</p>              </div>            </details><h2 id="二次总结-provide-inject-依赖注入"><a href="#二次总结-provide-inject-依赖注入" class="headerlink" title="二次总结 provide / inject 依赖注入"></a>二次总结 provide / inject 依赖注入</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>父组件提供需要注入的方法，然后使用 provide 传递</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/message/MessageTalk</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">wordsChange</span> = (<span class="params">value: string</span>) =&gt; &#123;</span><br><span class="line">  state.<span class="property">value</span> = value</span><br><span class="line">  <span class="comment">// state.worksVisible = false </span></span><br><span class="line">  <span class="comment">// 这里先注释，后面使用其他方法关闭快捷短语展示框</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">provide</span>(<span class="string">&#x27;popup&#x27;</span>, &#123;</span><br><span class="line">  wordsChange</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>子组件接受，接受起来还是有点麻烦，请看</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 首先要声明要接受的函数的类型</span></span><br><span class="line">interface <span class="title class_">PopupContext</span> &#123;</span><br><span class="line">  <span class="attr">wordsChange</span>: <span class="function">(<span class="params">value: string</span>) =&gt;</span> <span class="keyword">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; wordsChange &#125; = inject&lt;<span class="title class_">PopupContext</span>&gt;(<span class="string">&#x27;popup&#x27;</span>)! <span class="comment">// 非空断言</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 这样，就可以子组件内部调用啦！</span></span><br></pre></td></tr></table></figure><p>在 Vue 中，<code>provide</code> 和 <code>inject</code> 是基于依赖注入的机制。<code>provide</code> 用来在父组件中提供数据或方法，而 <code>inject</code> 用来在子组件中获取这些数据或方法。尽管父组件通过 <code>provide</code> 提供了数据或方法，并且在子组件中可以通过 <code>inject</code> 获取，但 Vue 并没有自动推断出类型的继承关系，因此需要显式地在子组件中声明类型。</p><h3 id="为什么不能直接继承类型？"><a href="#为什么不能直接继承类型？" class="headerlink" title="为什么不能直接继承类型？"></a><strong>为什么不能直接继承类型？</strong></h3><ol><li><p><strong>类型推导的局限性：</strong>Vue 的 <code>provide</code> 和 <code>inject</code> 本身并没有像其他框架那样提供类型的自动传递机制。虽然在 JavaScript 中，父子组件的依赖关系通过 <code>provide</code> 和 <code>inject</code> 实现，但这并不意味着 TypeScript 能够自动推断并传递类型。因为 <code>inject</code> 返回的是 <code>unknown</code> 类型，TypeScript 无法直接推断出父组件提供的内容的类型。</p></li><li><p><strong>provide 与 inject 的类型声明不具备继承性：</strong>在 TypeScript 中，<code>provide</code> 和 <code>inject</code> 的实现机制并没有直接关联父子组件的类型。在父组件通过 <code>provide</code> 提供数据或方法时，并没有为这些提供的值赋予 TypeScript 类型上下文，子组件需要显式地声明类型才能获取类型推导。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const value = inject&lt;PopupContext&gt;(&#x27;popup&#x27;);</span><br></pre></td></tr></table></figure><p>即使父组件已经定义了 <code>PopupContext</code> 类型，<code>inject</code> 不会自动继承父组件的类型。这是因为 Vue 设计上的一个特性：<code>inject</code> 必须显式地提供类型信息来让 TypeScript 确保安全的类型推导。</p></li></ol><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a><strong>解决方案</strong></h3><p>为了避免重复声明类型，你可以显式地为 <code>inject</code> 提供类型，这样可以确保 <code>inject</code> 获取到正确的类型。这也是 TypeScript 提供的机制，它要求在进行依赖注入时明确类型，确保类型安全。</p><h3 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a><strong>代码示例</strong></h3><h4 id="1-父组件通过-provide-提供类型"><a href="#1-父组件通过-provide-提供类型" class="headerlink" title="1. 父组件通过 provide 提供类型"></a>1. <strong>父组件通过 provide 提供类型</strong></h4><p>父组件通过 <code>provide</code> 提供 <code>wordsChange</code> 函数，并且使用共享的类型：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// types.ts</span></span><br><span class="line"><span class="keyword">export</span> interface <span class="title class_">PopupContext</span> &#123;</span><br><span class="line">  <span class="attr">wordsChange</span>: <span class="function">(<span class="params">value: string</span>) =&gt;</span> <span class="keyword">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 父组件</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">PopupContext</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./types&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">wordsChange</span>: <span class="title class_">PopupContext</span>[<span class="string">&#x27;wordsChange&#x27;</span>] = <span class="function">(<span class="params">value: string</span>) =&gt;</span> &#123;</span><br><span class="line">  state.<span class="property">value</span> = value;</span><br><span class="line">  state.<span class="property">worksVisible</span> = <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">provide</span>(<span class="string">&#x27;popup&#x27;</span>, &#123; wordsChange &#125;);</span><br></pre></td></tr></table></figure><h4 id="2-子组件通过-inject-获取并使用类型"><a href="#2-子组件通过-inject-获取并使用类型" class="headerlink" title="2. 子组件通过 inject 获取并使用类型"></a>2. <strong>子组件通过 inject 获取并使用类型</strong></h4><p>子组件通过 <code>inject</code> 获取 <code>wordsChange</code> 函数，并显式声明类型：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 子组件</span></span><br><span class="line"><span class="keyword">import</span> &#123; inject &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">PopupContext</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./types&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 显式声明类型</span></span><br><span class="line">    <span class="keyword">const</span> &#123; wordsChange &#125; = inject&lt;<span class="title class_">PopupContext</span>&gt;(<span class="string">&#x27;popup&#x27;</span>)!; <span class="comment">// 使用非空断言</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 wordsChange</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleChange</span> = (<span class="params">value: string</span>) =&gt; &#123;</span><br><span class="line">      <span class="title function_">wordsChange</span>(value);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      handleChange</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a><strong>总结</strong></h3><ul><li><strong>类型推导的局限性</strong>：Vue 的 <code>provide</code> 和 <code>inject</code> 没有内置的类型继承机制，<code>inject</code> 返回的是 <code>unknown</code> 类型，因此无法自动推导父组件提供的数据类型。</li><li><strong>显式声明类型</strong>：为了确保类型安全，子组件需要显式地声明 <code>inject</code> 的类型，特别是当 <code>provide</code> 提供的是复杂的数据或方法时。</li><li><strong>避免重复声明</strong>：可以通过创建共享类型文件，避免在父子组件中重复声明相同的类型，从而提高代码的可维护性。</li></ul>              </div>            </details><h2 id="在目标区域以外点击所触发的效果设计与实现"><a href="#在目标区域以外点击所触发的效果设计与实现" class="headerlink" title="在目标区域以外点击所触发的效果设计与实现"></a>在目标区域以外点击所触发的效果设计与实现</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p><code>ref</code> 用来创建一个响应式的引用，可以绑定到 DOM 元素或组件实例。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const inputArea = ref&lt;HTMLElement | null&gt;(null)</span><br></pre></td></tr></table></figure><p>在标签结构中，为父盒子添加属性：ref=”inputArea”</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&quot;inputArea&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;[&#x27;talk-bottom&#x27;, &#123; &#x27;talk-visible&#x27;: state.worksVisible &#125;]&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;talk-input&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> @<span class="attr">click</span>=<span class="string">&quot;worksClick&quot;</span>&gt;</span>常用语<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">&quot;state.value&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 可以用 i 标签选择器找到它 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">&quot;smile-o&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;emojiClick&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>发送<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">TalkWords</span> <span class="attr">v-show</span>=<span class="string">&quot;state.worksVisible&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;inputArea&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">TalkWords</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>src/message/MessageTalk</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> inputArea = ref&lt;<span class="title class_">HTMLElement</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleClickOutside</span> = (<span class="params">event: MouseEvent</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;事件目标:&#x27;</span>, event.<span class="property">target</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;inputArea的类型:&#x27;</span>, inputArea.<span class="property">value</span>?.<span class="property">constructor</span>.<span class="property">name</span>) <span class="comment">// 确认 inputArea 的类型</span></span><br><span class="line">  <span class="keyword">if</span> (inputArea.<span class="property">value</span> &amp;&amp; inputArea.<span class="property">value</span> <span class="keyword">instanceof</span> <span class="title class_">HTMLElement</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> isOutside = !inputArea.<span class="property">value</span>.<span class="title function_">contains</span>(event.<span class="property">target</span> <span class="keyword">as</span> <span class="title class_">Node</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;是否在 inputArea 外部:&#x27;</span>, isOutside)</span><br><span class="line">    <span class="keyword">if</span> (isOutside) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;点击了以外的区域&#x27;</span>)</span><br><span class="line">      state.<span class="property">worksVisible</span> = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">              </span><br><span class="line"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 重点认识 nextTick()，见下方</span></span><br><span class="line">  <span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, handleClickOutside)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">onBeforeUnmount</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">stopSetInterval</span>()</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;click&#x27;</span>, handleClickOutside)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="代码解析"><a href="#代码解析" class="headerlink" title="代码解析"></a><strong>代码解析</strong></h3><h4 id="1-onMounted"><a href="#1-onMounted" class="headerlink" title="1. onMounted"></a><strong>1. onMounted</strong></h4><ul><li><strong>触发时机</strong>：<code>onMounted</code> 是 Vue 的生命周期钩子，在组件被挂载到 DOM 上后触发。</li><li><strong>作用</strong>：用来执行需要依赖 DOM 的操作，例如事件监听、初始化动画、或操作原生 DOM 元素。</li></ul><h4 id="2-nextTick"><a href="#2-nextTick" class="headerlink" title="2. nextTick"></a><strong>2. nextTick</strong></h4><ul><li><strong>定义</strong>：<code>nextTick</code> 是 Vue 提供的一个异步方法，用于在 DOM 更新完成并渲染到视图后，执行回调函数。</li><li>必要性：<ul><li>Vue 的 DOM 更新是异步的。当组件数据发生变化时，Vue 会在下一个事件循环中批量更新 DOM。</li><li>如果你在 DOM 更新前执行操作，可能会遇到 DOM 尚未更新的问题。</li></ul></li><li>在此代码中的作用：<ul><li>确保 <code>document.addEventListener(&#39;click&#39;, handleClickOutside)</code> 在组件挂载完成且 DOM 渲染后执行。</li><li>虽然 <code>onMounted</code> 保证了组件已经挂载到 DOM 上，但某些情况下（如递归组件或复杂渲染逻辑），需要等待 DOM 完全渲染完成，才可以安全地操作。</li></ul></li></ul><h4 id="3-document-addEventListener-‘click’-handleClickOutside"><a href="#3-document-addEventListener-‘click’-handleClickOutside" class="headerlink" title="3. document.addEventListener(‘click’, handleClickOutside)"></a><strong>3. document.addEventListener(‘click’, handleClickOutside)</strong></h4><ul><li><strong>作用</strong>：为整个文档添加一个全局的点击事件监听器。</li><li>逻辑：<ul><li>在任意位置点击时，触发 <code>handleClickOutside</code> 方法。</li><li>这个方法通常用于检测用户是否点击了组件外部区域，比如关闭弹窗、隐藏下拉菜单等。</li></ul></li></ul>              </div>            </details><h2 id="纯-css-方法，为盒子高度变化添加过渡效果"><a href="#纯-css-方法，为盒子高度变化添加过渡效果" class="headerlink" title="纯 css 方法，为盒子高度变化添加过渡效果"></a>纯 css 方法，为盒子高度变化添加过渡效果</h2><p>为父盒子的高度变化添加了过渡效果</p><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>为父盒子添加动态类</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 为目标盒子添加动态类 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&quot;inputArea&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;[&#x27;talk-bottom&#x27;, &#123; &#x27;talk-visible&#x27;: state.worksVisible &#125;]&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;talk-input&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> @<span class="attr">click</span>=<span class="string">&quot;worksClick&quot;</span>&gt;</span>常用语<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">&quot;state.value&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 可以用 i 标签选择器找到它 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">&quot;smile-o&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;emojiClick&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>发送<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- v-if=&quot;state.worksVisible&quot;  最初的state.worksVisible，用于控制 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 该弹组件的显示隐藏 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 添加过渡效果后：为父组件设置了最大高度和初始高度 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 不再使用 v-if 控制该组件的显示隐藏 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 即，TalkWords 组件进入聊天界面后就被加载 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 只不过高度被限制了 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 由于组件内部的逻辑设计：仅在组件被加载时调用 快捷短语 api 请求函数 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 因此在短语列表的更新上，后续开发要特别留意 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 因为此时，点击常用语按钮，已不再触发常用语列表更新 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 实测到这里，这个v-show完全没有比要加，加了反而控制台提示警告 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 实测到这里，v-if 或 v-show 还是要加，用于快捷短语和标签组件的互斥 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 通过将 TalkWords 中的标签全部归集到一个标准 html 根标签中，例如 div 标签中，来消除有关警告  --&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">TalkWords</span> <span class="attr">v-show</span>=<span class="string">&quot;state.worksVisible&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">TalkWords</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">// 在原有样式基础上</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.talk-bottom</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">width</span>: <span class="number">100vw</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background</span>: <span class="number">#ffffff</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">z-index</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#eeeeee</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css">  </span></span><br><span class="line"><span class="language-css">// 增加如下样式</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.talk-bottom</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">overflow</span>: hidden; <span class="comment">/* 隐藏内容超出部分 */</span></span></span><br><span class="line"><span class="language-css">  <span class="attribute">max-height</span>: <span class="number">2.6rem</span>; <span class="comment">/* 初始的最大高度（盒子本身的高度） */</span></span></span><br><span class="line"><span class="language-css">  <span class="attribute">transition</span>: max-height <span class="number">0.3s</span> ease; <span class="comment">/* 高度变化的平滑过渡 */</span></span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.talk-bottom</span><span class="selector-class">.talk-visible</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">max-height</span>: <span class="number">350px</span>; <span class="comment">/* 当显示时，设置较大的最大高度 */</span></span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ps：这种方法，导致了出现未知原因的组件内 showToast  提示框被其他样式覆盖，奋斗了三个多小时也未找到解决办法，暂时放弃 showToast，使用其他方法，showDialog</p><p>其实，反过来也不难理解，toast 本身就是渐变效果，根父组件添加的渐变效果难免冲突！</p><p>pps：最便捷、直接、高效的方法，其实就是看文档，不然也不会直到 20024/12/3号深夜才从文档得知，函调方式按需引入的提示框方法，都是通过 show~ 的方式来调用！！</p><h3 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h3><p>通过以下方式来全局注册组件，更多注册方式请参考<a href="https://vant-ui.github.io/vant/#/zh-CN/advanced-usage#zu-jian-zhu-ce">组件注册</a>。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; createApp &#125; from &#x27;vue&#x27;;</span><br><span class="line">import &#123; Toast &#125; from &#x27;vant&#x27;;</span><br><span class="line"></span><br><span class="line">const app = createApp();</span><br><span class="line">app.use(Toast);</span><br></pre></td></tr></table></figure><h3 id="函数调用"><a href="#函数调用" class="headerlink" title="函数调用"></a>函数调用</h3><p>为了便于使用 <code>Toast</code>，Vant 提供了一系列辅助函数，通过辅助函数可以快速唤起全局的 Toast 组件。</p><p>比如使用 <code>showToast</code> 函数，调用后会直接在页面中渲染对应的轻提示。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; showToast &#125; from &#x27;vant&#x27;;</span><br><span class="line"></span><br><span class="line">showToast(&#x27;提示内容&#x27;);</span><br></pre></td></tr></table></figure><h3 id="找到原因啦！！"><a href="#找到原因啦！！" class="headerlink" title="找到原因啦！！"></a>找到原因啦！！</h3><p>请往下看..</p>              </div>            </details><h2 id="vant4-页面使用Popup-导致Toast样式变成白底"><a href="#vant4-页面使用Popup-导致Toast样式变成白底" class="headerlink" title="vant4 页面使用Popup,导致Toast样式变成白底"></a>vant4 页面使用Popup,导致Toast样式变成白底</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>详见：<a href="https://www.start6.cn/archives/400">周凯</a></p><ul><li><p>vant4 的 Popup组件使用，会导致Toast组件样式发生变化，背景色变成白底</p><p>原因是：单独使用 Toast 组件，Toast 样式顶掉了Popup样式；如果使用了Popup组件，就会重新多添加一次Popup样式，就导致后添加的Popup样式顶掉了Toast样式，就造成样式冲突，Toast就变成白底了</p></li><li><p>解决方法：</p><ul><li><p>在 基础css文件中，或者最外层css文件，强制 !important 样式为默认样式</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* vant4的 Toast 和 Popup 样式冲突,会导致 Toast 变成白底 */</span></span><br><span class="line"><span class="selector-class">.van-popup</span><span class="selector-class">.van-toast</span>&#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">var</span>(--van-toast-background) <span class="meta">!important</span>;</span><br><span class="line"><span class="attribute">box-sizing</span>: content-box <span class="meta">!important</span>;</span><br><span class="line"><span class="comment">/* 下面3条css,影响不大 */</span></span><br><span class="line"><span class="attribute">transition</span>: all <span class="built_in">var</span>(--van-duration-fast) <span class="meta">!important</span>;</span><br><span class="line"><span class="attribute">width</span>: <span class="built_in">var</span>(--van-toast-default-width) <span class="meta">!important</span>;</span><br><span class="line"><span class="attribute">max-width</span>: <span class="built_in">var</span>(--van-toast-max-width) <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.van-popup</span><span class="selector-class">.van-toast</span> <span class="selector-class">.van-toast__icon</span>&#123;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="built_in">var</span>(--van-toast-icon-size) <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul>              </div>            </details><h2 id="底部快捷短语组件显示-隐藏撑大父盒子使其高度渐变过渡的终极解决方案"><a href="#底部快捷短语组件显示-隐藏撑大父盒子使其高度渐变过渡的终极解决方案" class="headerlink" title="底部快捷短语组件显示/隐藏撑大父盒子使其高度渐变过渡的终极解决方案"></a>底部快捷短语组件显示/隐藏撑大父盒子使其高度渐变过渡的终极解决方案</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <h3 id="首先为两个盒子增加过渡效果"><a href="#首先为两个盒子增加过渡效果" class="headerlink" title="首先为两个盒子增加过渡效果"></a>首先为两个盒子增加过渡效果</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.talk-page</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f3f3f3</span>;</span><br><span class="line">  // 需要减去顶部 bar 的高度和ui稿件中底部组件的高度</span><br><span class="line">  <span class="attribute">height</span>: <span class="built_in">calc</span>(<span class="number">100vh</span> - <span class="number">40px</span> - <span class="number">2.6rem</span>);</span><br><span class="line">  <span class="attribute">overflow</span>: auto;</span><br><span class="line">  <span class="attribute">transition</span>: height <span class="number">200ms</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.talk-bottom</span> &#123;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden; <span class="comment">/* 隐藏内容超出部分 */</span></span><br><span class="line">  <span class="attribute">max-height</span>: <span class="number">2.6rem</span>; <span class="comment">/* 初始的最大高度（较小的高度） */</span></span><br><span class="line">  <span class="attribute">transition</span>: max-height <span class="number">0.3s</span> ease; <span class="comment">/* 高度变化的平滑过渡 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后，通过在dom加载结束后，根据子组件显示所需要的高度，直接设置 max-height 的值的方式，来实现任意高度变化时的过渡效果，例如：</p><p>原始写法：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">worksClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;点击了常用语&#x27;</span>)</span><br><span class="line">  <span class="comment">// 确定此时 dom 已加载</span></span><br><span class="line">  <span class="keyword">if</span> (inputArea.<span class="property">value</span> &amp;&amp; messageList.<span class="property">value</span>) &#123;</span><br><span class="line">    <span class="comment">// 添加空值检查，确保 inputArea.value 不为 null</span></span><br><span class="line">    <span class="keyword">if</span> (state.<span class="property">worksVisible</span>) &#123;</span><br><span class="line">      <span class="comment">// 如果已经展开，设置高度收起并延迟关闭</span></span><br><span class="line">      inputArea.<span class="property">value</span>.<span class="property">style</span>.<span class="property">maxHeight</span> = <span class="string">&#x27;2.6rem&#x27;</span></span><br><span class="line">      messageList.<span class="property">value</span>.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;calc(100vh - 40px - 2.6rem)&#x27;</span></span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        state.<span class="property">worksVisible</span> = !state.<span class="property">worksVisible</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;延迟关闭常用语面板&#x27;</span>)</span><br><span class="line">      &#125;, <span class="number">300</span>) <span class="comment">// 延迟 300 毫秒</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 如果未展开，立即打开并设置高度</span></span><br><span class="line">      state.<span class="property">worksVisible</span> = !state.<span class="property">worksVisible</span></span><br><span class="line">      inputArea.<span class="property">value</span>.<span class="property">style</span>.<span class="property">maxHeight</span> = <span class="string">&#x27;290px&#x27;</span></span><br><span class="line">      messageList.<span class="property">value</span>.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;calc(100vh - 320px)&#x27;</span></span><br><span class="line">      state.<span class="property">emojiVisible</span> = <span class="literal">false</span> <span class="comment">// 确保 emoji 面板关闭</span></span><br><span class="line">      <span class="title function_">scrollToBottom</span>(<span class="number">150</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;inputArea.value is null&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">emojiClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;emojiClick&#x27;</span>)</span><br><span class="line">  <span class="comment">// 这里增加一个判断，判断快捷短语弹框是否开启</span></span><br><span class="line">  <span class="keyword">if</span> (state.<span class="property">worksVisible</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (inputArea.<span class="property">value</span> &amp;&amp; messageList.<span class="property">value</span>) &#123;</span><br><span class="line">      <span class="comment">// 使 300px - 210px 这一段高度变化附带过渡效果</span></span><br><span class="line">      inputArea.<span class="property">value</span>.<span class="property">style</span>.<span class="property">maxHeight</span> = <span class="string">&#x27;210px&#x27;</span></span><br><span class="line">      messageList.<span class="property">value</span>.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;calc(100vh - 200px - 2.6rem)&#x27;</span></span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        state.<span class="property">worksVisible</span> = !state.<span class="property">worksVisible</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;延迟关闭常用语面板&#x27;</span>)</span><br><span class="line">      &#125;, <span class="number">200</span>) <span class="comment">// 延迟 300 毫秒</span></span><br><span class="line">      state.<span class="property">emojiVisible</span> = !state.<span class="property">emojiVisible</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (inputArea.<span class="property">value</span> &amp;&amp; messageList.<span class="property">value</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (state.<span class="property">emojiVisible</span>) &#123;</span><br><span class="line">        <span class="comment">// 如果已经展开，设置高度收起并延迟关闭</span></span><br><span class="line">        inputArea.<span class="property">value</span>.<span class="property">style</span>.<span class="property">maxHeight</span> = <span class="string">&#x27;2.6rem&#x27;</span></span><br><span class="line">        messageList.<span class="property">value</span>.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;calc(100vh - 46px - 2.6rem)&#x27;</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          state.<span class="property">emojiVisible</span> = !state.<span class="property">emojiVisible</span></span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;延迟关闭常用语面板&#x27;</span>)</span><br><span class="line">        &#125;, <span class="number">300</span>) <span class="comment">// 延迟 300 毫秒</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        inputArea.<span class="property">value</span>.<span class="property">style</span>.<span class="property">maxHeight</span> = <span class="string">&#x27;210px&#x27;</span></span><br><span class="line">        messageList.<span class="property">value</span>.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;calc(100vh - 200px - 2.6rem)&#x27;</span></span><br><span class="line">        <span class="title function_">scrollToBottom</span>(<span class="number">200</span>)</span><br><span class="line">        state.<span class="property">emojiVisible</span> = !state.<span class="property">emojiVisible</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;触发了吗？&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以下是精简写法：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">worksClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;点击了常用语&#x27;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 确保 DOM 元素已加载</span></span><br><span class="line">  <span class="keyword">if</span> (!inputArea.<span class="property">value</span> || !messageList.<span class="property">value</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;inputArea.value 或 messageList.value 为 null&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 更新状态和样式</span></span><br><span class="line">  <span class="keyword">const</span> isVisible = state.<span class="property">worksVisible</span>;</span><br><span class="line">  inputArea.<span class="property">value</span>.<span class="property">style</span>.<span class="property">maxHeight</span> = isVisible ? <span class="string">&#x27;2.6rem&#x27;</span> : <span class="string">&#x27;290px&#x27;</span>;</span><br><span class="line">  messageList.<span class="property">value</span>.<span class="property">style</span>.<span class="property">height</span> = isVisible </span><br><span class="line">    ? <span class="string">&#x27;calc(100vh - 40px - 2.6rem)&#x27;</span> </span><br><span class="line">    : <span class="string">&#x27;calc(100vh - 320px)&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!isVisible) &#123;</span><br><span class="line">    state.<span class="property">emojiVisible</span> = <span class="literal">false</span>; <span class="comment">// 确保 emoji 面板关闭</span></span><br><span class="line">    <span class="title function_">scrollToBottom</span>(<span class="number">150</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 延迟切换状态</span></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    state.<span class="property">worksVisible</span> = !isVisible;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(isVisible ? <span class="string">&#x27;延迟关闭常用语面板&#x27;</span> : <span class="string">&#x27;打开常用语面板&#x27;</span>);</span><br><span class="line">  &#125;, isVisible ? <span class="number">300</span> : <span class="number">0</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">emojiClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;emojiClick&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 确保 DOM 元素已加载</span></span><br><span class="line">  <span class="keyword">if</span> (!inputArea.<span class="property">value</span> || !messageList.<span class="property">value</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;inputArea.value 或 messageList.value 为 null&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> isEmojiVisible = state.<span class="property">emojiVisible</span>;</span><br><span class="line">  <span class="keyword">const</span> isWorksVisible = state.<span class="property">worksVisible</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (isWorksVisible) &#123;</span><br><span class="line">    <span class="comment">// 如果常用语面板开启，调整为 emoji 面板高度</span></span><br><span class="line">    inputArea.<span class="property">value</span>.<span class="property">style</span>.<span class="property">maxHeight</span> = <span class="string">&#x27;210px&#x27;</span>;</span><br><span class="line">    messageList.<span class="property">value</span>.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;calc(100vh - 200px - 2.6rem)&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      state.<span class="property">worksVisible</span> = <span class="literal">false</span>; <span class="comment">// 关闭常用语面板</span></span><br><span class="line">      state.<span class="property">emojiVisible</span> = !isEmojiVisible; <span class="comment">// 切换 emoji 面板状态</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;延迟关闭常用语面板并切换 emoji 状态&#x27;</span>);</span><br><span class="line">    &#125;, <span class="number">200</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isEmojiVisible) &#123;</span><br><span class="line">      <span class="comment">// 如果 emoji 面板已开启，收起面板</span></span><br><span class="line">      inputArea.<span class="property">value</span>.<span class="property">style</span>.<span class="property">maxHeight</span> = <span class="string">&#x27;2.6rem&#x27;</span>;</span><br><span class="line">      messageList.<span class="property">value</span>.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;calc(100vh - 46px - 2.6rem)&#x27;</span>;</span><br><span class="line"></span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        state.<span class="property">emojiVisible</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;延迟关闭 emoji 面板&#x27;</span>);</span><br><span class="line">      &#125;, <span class="number">300</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 如果 emoji 面板未开启，展开面板</span></span><br><span class="line">      inputArea.<span class="property">value</span>.<span class="property">style</span>.<span class="property">maxHeight</span> = <span class="string">&#x27;210px&#x27;</span>;</span><br><span class="line">      messageList.<span class="property">value</span>.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;calc(100vh - 200px - 2.6rem)&#x27;</span>;</span><br><span class="line">      <span class="title function_">scrollToBottom</span>(<span class="number">200</span>);</span><br><span class="line"></span><br><span class="line">      state.<span class="property">emojiVisible</span> = <span class="literal">true</span>;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;打开 emoji 面板&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>声明一个 <code>adjustHeights</code> 函数，作为通用工具函数，用于 <code>emojiClick</code> 和 <code>worksClick</code> 中动态调整高度，能够进一步优化代码结构并减少重复逻辑。</p><p>以下是优化后的版本：</p><h3 id="抽离-adjustHeights"><a href="#抽离-adjustHeights" class="headerlink" title="抽离 adjustHeights"></a>抽离 <code>adjustHeights</code></h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">adjustHeights</span> = (<span class="params">inputHeight: string</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (inputArea.<span class="property">value</span> &amp;&amp; messageList.<span class="property">value</span>) &#123;</span><br><span class="line">    inputArea.<span class="property">value</span>.<span class="property">style</span>.<span class="property">maxHeight</span> = inputHeight;</span><br><span class="line">    messageList.<span class="property">value</span>.<span class="property">style</span>.<span class="property">height</span> = <span class="string">`calc(100vh - 40px - <span class="subst">$&#123;inputHeight&#125;</span>)`</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;inputArea.value 或 messageList.value 为 null&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="优化后的-emojiClick"><a href="#优化后的-emojiClick" class="headerlink" title="优化后的 emojiClick"></a>优化后的 <code>emojiClick</code></h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">emojiClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;emojiClick&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!inputArea.<span class="property">value</span> || !messageList.<span class="property">value</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;inputArea.value 或 messageList.value 为 null&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> isEmojiVisible = state.<span class="property">emojiVisible</span>;</span><br><span class="line">  <span class="keyword">const</span> isWorksVisible = state.<span class="property">worksVisible</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (isWorksVisible) &#123;</span><br><span class="line">    <span class="comment">// 如果常用语面板开启，调整为 emoji 面板高度</span></span><br><span class="line">    <span class="title function_">adjustHeights</span>(<span class="string">&#x27;210px&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      state.<span class="property">worksVisible</span> = <span class="literal">false</span>; <span class="comment">// 关闭常用语面板</span></span><br><span class="line">      state.<span class="property">emojiVisible</span> = !isEmojiVisible; <span class="comment">// 切换 emoji 面板状态</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;延迟关闭常用语面板并切换 emoji 状态&#x27;</span>);</span><br><span class="line">    &#125;, <span class="number">200</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isEmojiVisible) &#123;</span><br><span class="line">      <span class="comment">// 如果 emoji 面板已开启，收起面板</span></span><br><span class="line">      <span class="title function_">adjustHeights</span>(<span class="string">&#x27;2.6rem&#x27;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        state.<span class="property">emojiVisible</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;延迟关闭 emoji 面板&#x27;</span>);</span><br><span class="line">      &#125;, <span class="number">300</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 如果 emoji 面板未开启，展开面板</span></span><br><span class="line">      <span class="title function_">adjustHeights</span>(<span class="string">&#x27;210px&#x27;</span>);</span><br><span class="line">      <span class="title function_">scrollToBottom</span>(<span class="number">200</span>);</span><br><span class="line"></span><br><span class="line">      state.<span class="property">emojiVisible</span> = <span class="literal">true</span>;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;打开 emoji 面板&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="优化后的-worksClick"><a href="#优化后的-worksClick" class="headerlink" title="优化后的 worksClick"></a>优化后的 <code>worksClick</code></h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">worksClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;点击了常用语&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!inputArea.<span class="property">value</span> || !messageList.<span class="property">value</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;inputArea.value 或 messageList.value 为 null&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> isWorksVisible = state.<span class="property">worksVisible</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (isWorksVisible) &#123;</span><br><span class="line">    <span class="comment">// 如果常用语面板已开启，收起面板</span></span><br><span class="line">    <span class="title function_">adjustHeights</span>(<span class="string">&#x27;2.6rem&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      state.<span class="property">worksVisible</span> = <span class="literal">false</span>;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;延迟关闭常用语面板&#x27;</span>);</span><br><span class="line">    &#125;, <span class="number">300</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果常用语面板未开启，展开面板</span></span><br><span class="line">    <span class="title function_">adjustHeights</span>(<span class="string">&#x27;290px&#x27;</span>);</span><br><span class="line">    <span class="title function_">scrollToBottom</span>(<span class="number">150</span>);</span><br><span class="line"></span><br><span class="line">    state.<span class="property">worksVisible</span> = <span class="literal">true</span>;</span><br><span class="line">    state.<span class="property">emojiVisible</span> = <span class="literal">false</span>; <span class="comment">// 确保 emoji 面板关闭</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;打开常用语面板&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="优化的核心点"><a href="#优化的核心点" class="headerlink" title="优化的核心点"></a>优化的核心点</h3><ol><li><strong>复用 adjustHeights 函数</strong>：<ul><li>高度调整逻辑完全抽离，通过传递不同的高度参数实现动态变化。</li></ul></li><li><strong>减少重复代码</strong>：<ul><li><code>emojiClick</code> 和 <code>worksClick</code> 都调用 <code>adjustHeights</code>，避免重复设置 <code>inputArea</code> 和 <code>messageList</code> 的样式。</li></ul></li><li><strong>保持功能独立性</strong>：<ul><li>状态切换逻辑保留在各自的函数中，而高度调整作为通用逻辑单独处理。</li></ul></li></ol><h3 id="使用效果"><a href="#使用效果" class="headerlink" title="使用效果"></a>使用效果</h3><ul><li>高度调整逻辑简单统一，便于维护。</li><li>每个函数的主要逻辑清晰，专注于状态切换。</li><li>如果未来需要修改高度规则或增加日志信息，只需修改 <code>adjustHeights</code> 函数即可。</li></ul><p>这个版本不仅简洁高效，还增强了可读性和扩展性！</p>              </div>            </details><h2 id="通过-defineProps-接收父组件属性的响应式问题"><a href="#通过-defineProps-接收父组件属性的响应式问题" class="headerlink" title="通过 defineProps() 接收父组件属性的响应式问题"></a>通过 defineProps<fatherProps>() 接收父组件属性的响应式问题</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>公共组件通过 <code>defineProps&lt;fatherProps&gt;()</code> 接收父组件的 <code>:text</code> 属性，并将其初始化为 <code>state.value</code>。但是当 <code>:text</code> 属性发生变化时，<code>state.value</code> 并不会自动更新，因为 <code>state.value</code> 是在组件初始化时通过 <code>text</code> 赋值的，而后续的 <code>props</code> 变化不会触发对 <code>state.value</code> 的更新。</p><p>这是因为 Vue 的 <code>props</code> 是响应式的，而直接赋值给 <code>state.value</code> 则打断了这种响应式连接。</p><p>问题的根源在于 <code>TalkWordsAdd</code> 组件的 <code>state.value</code> 初始化逻辑。组件的 <code>text</code> 值通过 <code>defineProps</code> 传入，但 <code>state.value</code> 仅在组件首次加载时使用 <code>text</code> 初始化。后续父组件传递新的 <code>text</code> 时，<code>state.value</code> 不会更新。</p><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a><strong>解决方案</strong></h3><p>为了确保输入框中的值能够正确地随着 <code>:text</code> 的更新而变化，可以使用一个 <code>watch</code> 监听 <code>props.text</code> 的变化，并同步更新 <code>state.value</code>。</p><h4 id="修改代码如下："><a href="#修改代码如下：" class="headerlink" title="修改代码如下："></a>修改代码如下：</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; inject, reactive, watch &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 省略前面的代码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">value</span>: text || <span class="string">&#x27;&#x27;</span> <span class="comment">// 初始化</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听 props 的 text 变化</span></span><br><span class="line"><span class="title function_">watch</span>(<span class="function">() =&gt;</span> text, <span class="function">(<span class="params">newText</span>) =&gt;</span> &#123;</span><br><span class="line">  state.<span class="property">value</span> = newText || <span class="string">&#x27;&#x27;</span> <span class="comment">// 同步更新 state.value</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>通过 <code>watch</code>，每当父组件传递的 <code>text</code> 属性发生变化时，<code>state.value</code> 都会更新，从而确保输入框内的内容正确回显。</p>              </div>            </details><h2 id="对话消息组件-对话框消息渲染后，立即触发滚动至最底部"><a href="#对话消息组件-对话框消息渲染后，立即触发滚动至最底部" class="headerlink" title="对话消息组件-对话框消息渲染后，立即触发滚动至最底部"></a>对话消息组件-对话框消息渲染后，立即触发滚动至最底部</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <h3 id="首先，为父盒子添加ref-”message”"><a href="#首先，为父盒子添加ref-”message”" class="headerlink" title="首先，为父盒子添加ref=”message”"></a>首先，为父盒子添加ref=”message”</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">van-nav-bar</span> <span class="attr">:title</span>=<span class="string">&quot;state.task_name&quot;</span> <span class="attr">left-arrow</span> @<span class="attr">click-left</span>=<span class="string">&quot;leftBack&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&quot;messageList&quot;</span> <span class="attr">class</span>=<span class="string">&quot;talk-page&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dt</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-for</span>=<span class="string">&quot;(item, index) in state.list&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:class</span>=<span class="string">&quot;item.receive_id == receiveId ? &#x27;active&#x27; : &#x27;&#x27;&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h5</span>&gt;</span>&#123;&#123; item.create_time &#125;&#125;<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-if</span>=<span class="string">&quot;item.receive_id == receiveId&quot;</span> <span class="attr">:src</span>=<span class="string">&quot;item.senderPhoto&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-else</span> <span class="attr">:src</span>=<span class="string">&quot;item.receivePhoto&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; item.text &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&quot;inputArea&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;[&#x27;talk-bottom&#x27;]&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;talk-input&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> @<span class="attr">click</span>=<span class="string">&quot;worksClick&quot;</span>&gt;</span>常用语<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">&quot;state.value&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 可以用 i 标签选择器找到它 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">&quot;smile-o&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;emojiClick&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> @<span class="attr">click</span>=<span class="string">&quot;sentMessage&quot;</span>&gt;</span>发送<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TalkWords</span> <span class="attr">v-show</span>=<span class="string">&quot;state.worksVisible&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">TalkWords</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TalkEmoji</span> <span class="attr">v-show</span>=<span class="string">&quot;state.emojiVisible&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">TalkEmoji</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>通过 <code>ref</code> 获取 DOM 元素。</p><h3 id="然后，定义一个滚动函数"><a href="#然后，定义一个滚动函数" class="headerlink" title="然后，定义一个滚动函数"></a>然后，定义一个滚动函数</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">scrollToBottom</span> = (<span class="params">delay: number = <span class="number">0</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (messageList.<span class="property">value</span>) &#123;</span><br><span class="line">    <span class="comment">// 确保 messageList.value 不为 null 或 undefined</span></span><br><span class="line">    <span class="keyword">if</span> (delay &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (messageList.<span class="property">value</span>) &#123;</span><br><span class="line">          <span class="comment">// 再次确认 messageList.value 存在</span></span><br><span class="line">          messageList.<span class="property">value</span>.<span class="property">scrollTop</span> = messageList.<span class="property">value</span>.<span class="property">scrollHeight</span></span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;延迟执行滚动&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, delay)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      messageList.<span class="property">value</span>.<span class="property">scrollTop</span> = messageList.<span class="property">value</span>.<span class="property">scrollHeight</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;确保执行了滚动&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="在需要的位置调用滚动函数"><a href="#在需要的位置调用滚动函数" class="headerlink" title="在需要的位置调用滚动函数"></a>在需要的位置调用滚动函数</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  <span class="function">() =&gt;</span> state.<span class="property">list</span>,</span><br><span class="line">  <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">scrollToBottom</span>()</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getChatMessageContent</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  state.<span class="property">loading</span> = <span class="literal">true</span></span><br><span class="line">  <span class="comment">// 在这里传入对泛型进行替换</span></span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> chatMessageContent&lt;chatMessageContentResponse&gt;(&#123;</span><br><span class="line">    <span class="attr">receive_id</span>: receiveId,</span><br><span class="line">    <span class="attr">things_id</span>: taskId,</span><br><span class="line">    <span class="attr">things_type</span>: <span class="number">0</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">if</span> (res.<span class="property">data</span>) &#123;</span><br><span class="line">    state.<span class="property">list</span> = res.<span class="property">data</span></span><br><span class="line">    state.<span class="property">task_name</span> = (res.<span class="property">data</span>[<span class="number">0</span>] &amp;&amp; res.<span class="property">data</span>[<span class="number">0</span>].<span class="property">task_name</span>) || <span class="string">&#x27;任务&#x27;</span></span><br><span class="line">    <span class="comment">// 等待 dom 加载</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">nextTick</span>()</span><br><span class="line">    <span class="title function_">scrollToBottom</span>()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">showToast</span>(res.<span class="property">msg</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  state.<span class="property">loading</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="解决一个类型声明问题"><a href="#解决一个类型声明问题" class="headerlink" title="解决一个类型声明问题"></a>解决一个类型声明问题</h2><p>原始代码：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">getCityList</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> cityList&lt;<span class="title class_">City</span>[]&gt;()</span><br><span class="line">  <span class="keyword">if</span> (res) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cityList</span> = res</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">city</span>: <span class="title class_">City</span>[] = [] <span class="comment">// 明确指定 city 的类型</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; res.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      city.<span class="title function_">push</span>(&#123;</span><br><span class="line">        <span class="attr">name</span>: res[i].<span class="property">name</span>,</span><br><span class="line">        <span class="attr">children</span>: res[i].<span class="property">children</span> || [] <span class="comment">// 如果 children 为 undefined，则使用空数组</span></span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">if</span> (res[i].<span class="property">children</span> &amp;&amp; res[i].<span class="property">children</span>?.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; res[i].<span class="property">children</span>.<span class="property">length</span>; j++) &#123;</span><br><span class="line">          city[i].<span class="property">children</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">            <span class="attr">name</span>: res[i].<span class="property">children</span>[j].<span class="property">name</span> || <span class="string">&#x27;&#x27;</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">areaList</span> = city</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>改进后的代码：</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">City</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  children</span><br><span class="line">  key</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Area</span> &#123;</span><br><span class="line">  <span class="attr">text</span>: <span class="built_in">string</span></span><br><span class="line">  children</span><br><span class="line">  value</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="title function_">getCityList</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">res</span>: <span class="title class_">City</span>[] = <span class="keyword">await</span> <span class="title function_">cityList</span>()</span><br><span class="line">  <span class="keyword">if</span> (res) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cityList</span> = res</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">city</span>: <span class="title class_">Area</span>[] = []</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; res.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      city.<span class="title function_">push</span>(&#123;</span><br><span class="line">        <span class="attr">text</span>: res[i].<span class="property">name</span>,</span><br><span class="line">        <span class="attr">value</span>: res[i].<span class="property">key</span>,</span><br><span class="line">        <span class="attr">children</span>: []</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">if</span> (res[i].<span class="property">children</span> &amp;&amp; res[i].<span class="property">children</span>?.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; res[i].<span class="property">children</span>.<span class="property">length</span>; j++) &#123;</span><br><span class="line">          city[i].<span class="property">children</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">            <span class="attr">text</span>: res[i].<span class="property">children</span>[j].<span class="property">name</span>,</span><br><span class="line">            <span class="attr">value</span>: res[i].<span class="property">children</span>[j].<span class="property">key</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">areaList</span> = city</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(city, <span class="string">&#x27;city&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>日本語能力練習</title>
      <link href="/posts/42edf4c9/"/>
      <url>/posts/42edf4c9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><div class="note blue no-icon flat"><p>日本語の勉強すればするほど、楽しいに感じになりました。ここで、全过程系列导航～</p><ol><li><a href="/posts/d711a81c/">新标准日本语文法要点（上）</a> </li><li>新标准日本语文法要点（中） </li><li>新标准日本语文法要点（下）</li><li><a href="/posts/42edf4c9/">日本語能力練習</a> ⇦当前位置🪂</li></ol></div><h1 id="日语n2-听力-kugei"><a href="#日语n2-听力-kugei" class="headerlink" title="日语n2 听力 - kugei"></a>日语n2 听力 - kugei</h1><h2 id="2023年-12か月"><a href="#2023年-12か月" class="headerlink" title="2023年　12か月"></a>2023年　12か月</h2><details class="folding-tag" ><summary> 問題２ 点击查看原文 </summary>              <div class='content'>              <details class="folding-tag" ><summary> どんな点が最もいいと言っていますか。 </summary>              <div class='content'>              <p>会社の「昼休み｜ひるやすみ、午休」に男の人と女のがある【アナウンサー|播音员】について話してます。男の人はこのアナウンサーのどんな点が最もいいと言っていますか。男の人です。</p><p>男：ねえ、今テレビに「映ってる｜うつる的て形 + いる的缩略形式，用来表示某种状态的持续。」アナウンサー、人気があるよね。</p><p>女：うん、いつも「柔らかい｜やわらかい」「表情｜ひょうじょう」で「親しみ｜したしみ」やすい「雰囲気｜ふんいき」を出してるよね。</p><p>男：うん、それに、声も落ち着いていて、聞き取りやすいって言われてるみたいだね。</p><p>僕は【声|こえ】や「雰囲気｜ふんいき」って言うよりは「討論番組｜とうろんばんぐ」で「司会｜しかい」している時の「進行｜しんこう、推进或主持」の仕方に【感心|かんしん、钦佩，赞叹】【させられる|是使役被动态的动词形式，表示“被迫产生某种感情或动作”。意为“不得不感到佩服”或“被迫感叹”】よ。</p><p>女：そう、「この間｜前几天，最近」スポーツ選手にインタビューしてたのを見たけど、その時は選手が【答え|こたえる】「にく｜にくい、難い、难以，很难..」そうで、質問の仕方が【どうなのかなぁ|“どうなのかなぁ”是口语中表示怀疑的句型，相当于中文的“是怎么回事呢”或“这样是否合适”。って思った是“我觉得”的意思。】って思ったんだよね。</p><p>男：「得意不得意｜分别表示擅长与不擅长」があるのかなぁ。僕がよく見る番組ではゲストが言いたい「放題｜ほうだ､随便，任意」言っても、【うまい具合|意为“巧妙地，得体地”，表示某种技巧或者方法很合适。】に対してるんだよね。</p><p>自分が会議なんかで司会する時の参考にしたいと思うことが多いんだ。</p><p>女：へえ、そうなんだね。</p><p>男の人はこのアナウンサーのどんな点が最もいいと言っていますか。</p><p>③司会者として番組を進めるのが上な点。</p>              </div>            </details><h3 id="問題2-2-女の人の企画は何が問題ですか。"><a href="#問題2-2-女の人の企画は何が問題ですか。" class="headerlink" title="問題2-2　女の人の企画は何が問題ですか。"></a>問題2-2　女の人の企画は何が問題ですか。</h3><details class="folding-tag" ><summary> おもちゃの会社で課長と女の人が話しています </summary>              <div class='content'>              <p>おもちゃの会社で課長と女の人が話しています。女の人の企画は何が問題ですか。</p><p>課長：森田さん、森田さんが立ってた「幼児｜ようじ」向けの夏休み「親子｜おやこ」「体験｜たいけん」のインベントの企画見ました。企画では「会場｜かいじょう」は駅から「近い｜ちかい」所にしたんですね。</p><p>女：はい。駅近いほうが来やすいと思いまして。</p><p>課長：それはいいんですが、「駐車場｜ちゅうしゃじょう」..、子供連れだと、車で来ようとする人も少なくないと思いますよ。</p><p>会場周辺に有料駐車場がありますが、駐車場がある「施設｜しせつ」のほうが参加者の数が増えると思うんです。</p><p>女：わかりました。あのう、「見積もり｜みつもり」が少し予算を「超えて｜こえて」しまっているのは大丈夫でしょうか。</p><p>課長：「当日｜とうじつ」に「雇う｜やとう」スタッフにかかる費用が高くなっている点ですね。幼児を対象としてた企画ですから、安全に「実施｜じっし」するために、｢多少|たしょう｣のオーバーは仕方ないと思います。</p><p>企画の内容自体はいいと思うので、今「指摘｜してき」したもう一度検討してください。</p>              </div>            </details>              </div>            </details><details class="folding-tag" ><summary> 問題１ 点击查看原文 </summary>              <div class='content'>              <h3 id="問題1-5"><a href="#問題1-5" class="headerlink" title="問題1-5"></a>問題1-5</h3><details class="folding-tag" ><summary> 植物をどうしますか </summary>              <div class='content'>              <p>ガーデニングの店で男の人と店員が話しています。男の人はまず、「植物｜しょくぶつ」をどうしますか。</p><p>すみません。うちで「育て｜そだて」ている植物の事で教えていただきたいんです。</p><p>この写真の「葉っぱ｜はっぱ」が「掌｜ての」みたいな植物なんですが、最近葉も「枝｜えだ」も「弱々しく｜よわよわしい」「なっちゃって｜是 なってしまって 的口语缩略形式。なる：动词，意为“变成”。しまう：助动词，表示遗憾、不好的结果。 て：接续助词，连接句子或表示未完结。」。</p><p>店員：あ、これですか。写真では「日当たり｜ひあたり」があまり良くないように見えますが..</p><p>男：ソファーの横に「置いて｜おいて」るんですけど、あまり日は…</p><p>店員：これ日当たりのいい場所を「好みます｜このみます」から、「日光｜にっこう」が良く「当たる｜あたる」窓際に「移して｜うつる」あげるといいですよ。水はどうしていますか。</p><p>男：あ、昨日はやりましたけど、毎日はやってないです。</p><p>店員：それでいいですよ。土「つち」の表面が「乾いて｜かわいて」からやれば十分ですから。</p><p>男：はい。あのう、「弱って｜よわって」る枝って、切るんですか。</p><p>店員：その「必要｜ひつよう」はないですよ。それより、元気になったら、今より少し大きめの「鉢｜はち」に「植え替え｜うえかえ」てやると、良く育ちますよ。</p><p>男：ありがとうございます、元気になるように、必要な事をまず「やっ｜やる：动词，意为“做”。」「てみます｜表示尝试某个动作。」。</p><p>男の人はまず、植物をどうしますか。</p>              </div>            </details><h3 id="問題1-4"><a href="#問題1-4" class="headerlink" title="問題1-4"></a>問題1-4</h3><details class="folding-tag" ><summary> この後まず、何をしますか。 </summary>              <div class='content'>              <p>大学で、男の学生と女の学生が話しています。女の学生はこの後まず、何をしますか。</p><p>男：中村さん、「青葉｜あおば」市の市民文化祭の事だけど、ステージ「演奏｜えんそう」の「出演者｜しゅつえんしゃ」「応募｜おうぼ」「しよう｜动词的意向形」「っていう｜用于引出间接引用或说明。类似于“也就是说”“是关于……的”。」話。</p><p>女：二人でギター「弾いて｜ひいて」、【歌おう|歌う的意向形，表示说话人提议一起唱歌吧】って【言ってた|言っていた的口语缩略形式，表示某人之前提到过某事。】【やつ|指代某件事、某个提议或某个对象】ね。</p><p>「事前｜じぜん」「先行｜せんこう」のための「演奏動画｜えんそうどうが」の「作成｜さくせい」が「締め切り｜しめきり」に間に合わないって締めたよね。</p><p>男：それ、僕の「勘違い｜かんちがい」だったよ。</p><p>ごめん！「応募申請書｜おうぼしんせいしょ」と動画を「同時｜どうじ」に「提出｜ていしゅ」し「なきゃいけない｜口语中的‘しなければいけない’的简略形式，表示“必须做……”。」と思ってたんだけど、「動画｜どうが」は申請書の締め切り後、一週間以内の提出だったんだ。</p><p>女：えっ！そうだったの！私もホームページ見たのに、「気が付かなかった｜気が付く：惯用动词、気が付かなかった是否定的过去形，表示“没有注意到”」。ごめんね！</p><p>男：うん。「間に合い｜まにあう、基本动词：赶得上」【そう|接在动词连用形后，表示“看起来……”“似乎……”。】だから、「申し込む｜もうしこむ，动词基本形，申请」よ！パソコンで申請書「作って｜つくって」くれたって【言ってた|言う（说）的过去进行形，表示对过去说过的话的回忆，口语中常用’言ってた’而非’言っていた’。】けど、「削除｜さくじょ」【しちゃった|しちゃった是’してしまった’的口语缩略形式，其中して<strong>：动词する的て形，表示动作。しまった</strong>：表示动作的完成或带有遗憾的语气。】</p><p>女：残してあるよ。</p><p>男：じゃ、それ使えるね！締め切り明日だから、「提出｜ていしゅつ」、「任せる｜まかせる、托付、交给某人」ね。</p><p>女：了解。</p><p>男：動画作成もすぐに取り掛から「なきゃ｜なきゃ：口语中表示“必须”的缩略形式，相当于‘なければならない’。」、応募する「以上｜以上、接在动词后表示“既然……”，には进一步强调其后续影响。」には絶対「出たい｜出る表示“参加”“出场”，意志形’出たい’表示“想要参加”。」からね。</p><p>女の学生はこの後まず、何をしますか。</p>              </div>            </details><h3 id="問題1-３何を決めなければなりませんか"><a href="#問題1-３何を決めなければなりませんか" class="headerlink" title="問題1-３何を決めなければなりませんか"></a>問題1-３何を決めなければなりませんか</h3><details class="folding-tag" ><summary> 点击查看原文 </summary>              <div class='content'>              <p>日本語のクラスで先生が留学生に話しています。</p><p>留学生は今の「授業・じゅぎょう」の終わるまでにグループで何を決めなければなりませんか。</p><p>えー、テキストの第四課ではごみ「処理・しょり」の「現状・げんじょう」と問題点、その「対策・たいさ」について日本の例を読みました。</p><p>前回話した通り皆さんはグルプレでーつの国を取り上げ、ごみ処理の現状、問題点、対策を【テーマ｜Theme，主题】に来月発表し【てもらいます|て  もらいます，用法包括两种含义： ❶说话人请别人做某事； ❷说话人承受了由于别人的动作而带来的恩惠；】。</p><p>今からどの国について「調べる｜しらべる」か、グループで話し合ってもらいます。</p><p>うちで参考になりそうな資料を探したりして、調べたい国を「それぞれ｜分别」考え【て来ました|表示动作的完成或过程回溯（至今）。】ね。</p><p>前回の「授業｜じゅぎょう」でグループのリーダーや「記録係｜きろくがかり」など「役割｜やくわり」を分担しました。</p><p>リーダーを中心に話し合って、授業の終わりに、私に「報告｜ほうこ」してください。</p><p>留学生は今日の授業の終わるまでにグループで何を決めなければなりませんか。</p>              </div>            </details><h3 id="問題1-2-チケット-予約"><a href="#問題1-2-チケット-予約" class="headerlink" title="問題1-2　チケット　予約"></a>問題1-2　チケット　予約</h3><details class="folding-tag" ><summary> 点击查看原文 </summary>              <div class='content'>              <p>会社で、男の人と女の人が話しています。女のは新幹線の席をどう予約しますか。</p><p>男：山本さん、「明後日・あさって」私と行く出張の件だけど。部長も一緒に行く「ことになった・こと指的是一个事件、行为或情况，になった是“成为”的过去式，表示事情已经决定或发生了变化。」から、新幹線のチケット、私と部長の分も一緒に取ってくれますか。</p><p>女：あ、ちょうど今予約をしようとしていたところです。七時発のがあります。えーと、「先頭・せんとう」の車両に四つ空きがありますけど、三人「並んで・ならんで」座るのが無理ですね。</p><p>「画面・がめん」見ていただけますか。白い所が「空席・くうせき」です。</p><p>男：えーと、部長に窓側希望って「言われている・言う（说）→ 言われる（被动态，ない形去掉ない＋られる、被说） 言われている（正在被说），表示某人（部长）说了某事，特别是别人告诉说话者某个事情的情形。」ので、「窓側・まどが」席を「抑えて・おさえる、表示“保留、控制、占据”座位。」「もらえます・这是もらう的可能态，用来表示请求别人帮忙做某事。它常常带有委婉的请求语气，意思是“能帮我做……吗？”。」か。</p><p>女：はい。</p><p>男：あと私たちの席は部長も私たちがずっと横にいるより、一人のほうがリラックスできるでしょうから、私たちは今「空いて・あいて」いる残りの二人席でいいですよね。</p><p>女：そうですね。わかりました。</p><p>女の人は新幹線の席をどう予約しますか。</p>              </div>            </details><h3 id="問題1-1-プレゼンテーション"><a href="#問題1-1-プレゼンテーション" class="headerlink" title="問題1-1 プレゼンテーション"></a>問題1-1 プレゼンテーション</h3><details class="folding-tag" ><summary> 点击查看原文 </summary>              <div class='content'>              <p>大学で女の学生と男の学生がプレゼンテーションの練習の後に話しています。</p><p>女の学生はこれから何をしなければなりませんか。</p><p>女：先輩、《プレゼンテーション | 演示、报告 presentation》の練習を見て《いただけて|いただけて：是“いただく”的可能态形式，表示“得到”或“承蒙”。在敬语中，”いただく”是“もらう”（得到）的谦虚说法。这里表示“能够看”的意思，暗含了对对方的感谢和敬意。》ありがたいです。</p><p>他の大学との《合同|ごうどう》《ゼミ | 源自于德语“Seminar”（研讨会）的外来词》で発表《なんて|一种口语中的表达，通常用于强调或表达某种轻蔑、谦逊或感叹。这里的语气是强调“在这种情况下”的意思，有一点轻微的自谦或惊讶的感觉。可以理解为“像这样的演讲”。》、私、初めて《なんで|“なぜ”的口语形态，意思是“为什么”，但在这里，它用来表示原因，等同于“因为”或“由于”的意思。》。今の私のプレゼンどうでしたか。</p><p>男：うん。話す内容が整理されてて、《簡潔|かんけつ》に《纏められてる|まとめて》って感じがするよ。</p><p>女：そうですか。あのう、自分で時間をはかってみたら、予定した時間より、早く終わるんです。</p><p>それで、もう少し内容を《追加|ついか》できそうなんですが、説明足りない部分はありますか。</p><p>男：今以上に《詰め込む|つめこむ、死记硬背》ことはないよ、それより「速度・そくど」を少し落として話す練習をしてといて。</p><p>「原稿・げんこう」を読むのに、「一生懸命・いっしょうけんめい、拼命的意思」「になっちゃって・口语化，表示“变得……”或“做了……”。在这里表示“做得过于专心”或“拼命做而忘记其他”。」、早くなり「がちだった｜～がちだ：有某种倾向、动词第一连用形+がちだ；」から。</p><p>間いている人の理解が「追いつか・おいつか」「なくなちゃう・表示变成、导致的口语化表达」よ。</p><p>女：はい、原稿は「暗記・あんき、背诵」「しなちゃ・其实是しないと的口语变体，其中的’ちゃ’是ちゃう的缩写，常见于口语中，相当于标准语中的ないと：如果不…就不行的意思。」だめですか。</p><p>男：「覚えた・おぼえる的过去式，记住、记得」つもりでも、言葉が[でなくなる|由动词“でない”（不、不能）和“なる”（变得、成为）组成，意思是“变得说不出来”。]ことがあるから、見ながらやっていいんじゃない。</p><p>女：わかりました。</p><p>女の学生はこれから何をしなければなりませんか。</p><ol><li>話す内容を整理する</li><li>原稿に内容を足す</li><li>「ゆっくり・慢慢的」話す練習をする　</li><li>げんこうを暗記する</li></ol>              </div>            </details>              </div>            </details><h2 id="2018年-7月"><a href="#2018年-7月" class="headerlink" title="2018年　7月"></a>2018年　7月</h2><details class="folding-tag" ><summary> 問題４ 点击查看原文 </summary>              <div class='content'>              <details class="folding-tag" ><summary> １番　李さん、昨日のプレゼンで李さんを「見直｜みなお」「しちゃった｜ 是 してしまった的口语缩略形式，通常用于表示某个动作已经完成，并且常常带有一些意外、遗憾、后悔等情感色彩。」。 </summary>              <div class='content'>              <div class='checkbox'><input type="checkbox" />            <p>1.それじゃ、もう一度見直してみる</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>2.ええ、｢頑張っただけどな|意思是：”嗯，我尽力了，但……”｣</p>            </div><div class='checkbox'><input type="checkbox" />            <p>3.そう？ありがとう。</p>            </div>              </div>            </details><details class="folding-tag" ><summary> ２番　うん、この天気じゃ、今日のお花見は｢中止|ちゅうし｣にするしかないね。 </summary>              <div class='content'>              <div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>1.残念だけと、「しようがないね。｜しよう（意志形）＋がない：不这样不行，没有办法..」</p>            </div><div class='checkbox'><input type="checkbox" />            <p>2.この天気でもやるの。</p>            </div><div class='checkbox'><input type="checkbox" />            <p>3.中止にしなくてよかったね。</p>            </div>              </div>            </details><details class="folding-tag" ><summary> ３番　お客様、館内での撮影はご遠慮いただけますか。 </summary>              <div class='content'>              <div class='checkbox'><input type="checkbox" />            <p>1.あっ、「お願いしていいですか。｜可以拜托一下吗？」</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>2.すみません。【だめ|<strong>だめ</strong>：表示“不行”或“不可”的意思】【なん|口语中，<strong>なん</strong> 是 <strong>の</strong> 的变形】ですね。</p>            </div><div class='checkbox'><input type="checkbox" />            <p>3.じゃあ、【遠慮なく|えんりょ：客气，遠慮なく，表示不客气】。</p>            </div>              </div>            </details><details class="folding-tag" ><summary> ４番　今日は｢ついて|是动词 **つく** 的 **て形**，在这里用作连词，连接后面的 **ない**，表示否定。**つく** 在这里指的是“运气”或“运势”，而 **ついてない** 表示“运气不好”或“倒霉”。｣ないな。 </summary>              <div class='content'>              <div class='checkbox'><input type="checkbox" />            <p>1.だから｢つけて|是动词 <strong>つける</strong>（戴、佩戴）的 <strong>て形</strong>，表示动作的连接或进行。<strong>つける</strong> 在这里指的是佩戴物品，如帽子、眼镜、耳环等。｣｢こなかった|是动词 <strong>来る</strong>（来）的 <strong>否定过去形</strong>，表示“没有来”或“没有进行某个动作”。｣んだね｡</p>            </div><div class='checkbox'><input type="checkbox" />            <p>2.【うまく|副词，表示“顺利地”或“巧妙地”。】「傷｜いた」んだ、よかったね。</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>3.えっ、なんかあったの？</p>            </div>              </div>            </details><details class="folding-tag" ><summary> ５番　課長、次の企画のリーダー、引き受けた以上はしっかりやります。 </summary>              <div class='content'>              <div class='checkbox'><input type="checkbox" />            <p>1.引き受けるかどうか迷てるの？</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>2.うん、期待してるからね。</p>            </div><div class='checkbox'><input type="checkbox" />            <p>3.ひきうけて欲しかったな。</p>            </div>              </div>            </details><details class="folding-tag" ><summary> ６番　今日の講演会、聞きに来た「甲斐｜かい：值得」がありましたね。 </summary>              <div class='content'>              <div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>1.「貴重｜きちょう」なお話が聞けましたね。</p>            </div><div class='checkbox'><input type="checkbox" />            <p>2.講演会聞けたらよかったですよね。</p>            </div><div class='checkbox'><input type="checkbox" />            <p>3.確かに来る必要なかったんですね。</p>            </div>              </div>            </details><details class="folding-tag" ><summary> 1番　李さん、昨日のプレゼンで李さんを「見直｜みなお」「しちゃった｜ 是 **してしまった** 的口语缩略形式，通常用于表示某个动作已经完成，并且常常带有一些意外、遗憾、后悔等情感色彩。」。 </summary>              <div class='content'>              <div class='checkbox'><input type="checkbox" />            <p>1.それじゃ、もう一度見直してみる</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>2.ええ、｢頑張っただけどな|意思是：”嗯，我尽力了，但……”｣</p>            </div><div class='checkbox'><input type="checkbox" />            <p>3.そう？ありがとう。</p>            </div>              </div>            </details><details class="folding-tag" ><summary> 1番　李さん、昨日のプレゼンで李さんを「見直｜みなお」「しちゃった｜ 是 **してしまった** 的口语缩略形式，通常用于表示某个动作已经完成，并且常常带有一些意外、遗憾、后悔等情感色彩。」。 </summary>              <div class='content'>              <div class='checkbox'><input type="checkbox" />            <p>1.それじゃ、もう一度見直してみる</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>2.ええ、｢頑張っただけどな|意思是：”嗯，我尽力了，但……”｣</p>            </div><div class='checkbox'><input type="checkbox" />            <p>3.そう？ありがとう。</p>            </div>              </div>            </details><details class="folding-tag" ><summary> 1番　李さん、昨日のプレゼンで李さんを「見直｜みなお」「しちゃった｜ 是 **してしまった** 的口语缩略形式，通常用于表示某个动作已经完成，并且常常带有一些意外、遗憾、后悔等情感色彩。」。 </summary>              <div class='content'>              <div class='checkbox'><input type="checkbox" />            <p>1.それじゃ、もう一度見直してみる</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>2.ええ、｢頑張っただけどな|意思是：”嗯，我尽力了，但……”｣</p>            </div><div class='checkbox'><input type="checkbox" />            <p>3.そう？ありがとう。</p>            </div>              </div>            </details><details class="folding-tag" ><summary> 1番　李さん、昨日のプレゼンで李さんを「見直｜みなお」「しちゃった｜ 是 **してしまった** 的口语缩略形式，通常用于表示某个动作已经完成，并且常常带有一些意外、遗憾、后悔等情感色彩。」。 </summary>              <div class='content'>              <div class='checkbox'><input type="checkbox" />            <p>1.それじゃ、もう一度見直してみる</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>2.ええ、｢頑張っただけどな|意思是：”嗯，我尽力了，但……”｣</p>            </div><div class='checkbox'><input type="checkbox" />            <p>3.そう？ありがとう。</p>            </div>              </div>            </details>              </div>            </details><details class="folding-tag" ><summary> 問題３ 点击查看原文 </summary>              <div class='content'>              <details class="folding-tag" ><summary> 1番　【レポーター|reporter，记者】は　山川鉄道の何について話していますか </summary>              <div class='content'>              <p>女：私は今山川鉄道の山川駅に来ています。｢屋根|やね、屋顶｣のない小さな駅なんですが、可愛らしい「列車｜れっしゃ」が「一両発車｜いちりょう、はっしゃ：日本的乡村或偏远地区，小型列车（如一両編成）较为常见」を待っています。「普段｜ふだん，平时」は静かな駅ですが、今日は朝から大変｢混雑｜こんざ｣しています。この山川鉄道、今日の【最終|さいしゅ】列車の「運転｜うんてん」を「最後｜さいご」に一「世紀｜せいき」近くの「歴史｜れきし」に「幕をしろす｜まく，意为：落下帷幕」ことになりました。【沿線|えんせん】にも、その「姿｜すがた：身影，姿态」を【一目|いちもく：一眼】見ようとカメラを持った【大勢|おおぜい】の鉄道ファンや観光客が「集まって｜あつまる」います。</p>              </div>            </details><details class="folding-tag" ><summary> ２番　女の人は何について話していますか。 </summary>              <div class='content'>              <p>テレビでアナウンサーが女の人にインタビューしています。</p><p>男：今日は「ペット｜pet」の服を作っている山田みどりさんに「お越し｜おこし：来る（くる）的敬语形式」いただきました。</p><p>女：よろしくお願いします。今日は飼い犬のしろと一緒に来ました。しろが「着｜きる」ているこの服、私が始めて作った服なんです。</p><p>男：とても素敵ですね。でも、「おしゃれ｜时尚，富有品味」が「目的｜もくてき」だったわけじゃないんですよね。</p><p>女：ええ、しろは気温差に「弱く｜よわく」、｢皮膚|ひふ｣が弱い犬で、体調管理のために服が必要なんです。でも、市販の服だとサイズがぴったりとは合わないので、働きにくいんでしょうね。着るのを「嫌がって｜いやがる」。それなら自分で作ろうと思いまして。　「やわらかい｜軟らかい」「生地｜きじ」で働きを邪魔しないようなデザインにしたら、しろも嫌がらず着てくれたんです。</p><p>男：そうですか。</p><p>女：何枚か作ってるうちに、いろんな犬の服を作りたくなってきて、インターネットで販売を始めたら、どんどん「注文｜ちゅうもん：订餐，下单，订购」が入ってきたんです。お客様をお待たせしてしまっているのが現状ですが、一着一着心をこめて「製作｜せいさく」しています。</p>              </div>            </details><details class="folding-tag" ><summary> ３番　アナウンサーは何について話していますか。 </summary>              <div class='content'>              <p>アナウンサー：今日は天気雨の「現象｜げんしょう」があちこちで｢観察|かんさつ｣されました。空に｢雲｜くも｣一つなく晴れているのに突然雨が降るということの現象どのように起きるのか、皆さん案外ご存じないんじゃないでしょうか。</p><p>天気雨は雨の｢粒｜つぶ｣が雨雲から落ちた後に雲が｢消|けす、けえたり｣動いたりしたために発生します。雨の粒が強い風で飛ばされて雲から離れたところに降ることで発生する場合もあります。できれば、突然の雨は避けたいものですが、雨の粒に日の｢光|ひかり｣が当たるのはきれいですよね。「同様｜どうよう」の現象は冬にも雪で見られるんですよ。</p><div class='checkbox'><input type="checkbox" />            <p>1.天気雨を｢予測|よそく｣する方法</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>2.天気雨が降る｢仕組み|しくみ、指事物或系统的组织、安排和运行方式，原理｣</p>            </div><div class='checkbox'><input type="checkbox" />            <p>3.天気雨を避ける方法</p>            </div><div class='checkbox'><input type="checkbox" />            <p>4.天気雨が多い｢季節|きせつ｣</p>            </div>              </div>            </details><details class="folding-tag" ><summary> ４番　アナウンサーは何について話していますか。 </summary>              <div class='content'>              <p>アナウンサー：今、「若葉町|わかばまち」の「中央｜ちゅうおう」「高校｜こうこう」に来ています。去年からこちらの高校の校門の前で記念写真を撮ろうという外国人の観光客がたくさん「訪れる｜おとずれる」ようになりました。それは､この高校で映画「｢青春｜せいしゅん｣ストーリー」が「撮影｜さつえい」されたためです。この映画は１０年前に日本で「公開｜こうか」され、大変｢話題｜わだい｣になりました。この映画に｢出演｜しゅつえん｣していた「俳優｜はいゆう、男演员」青木たくやさんが去年別の映画で世界的な映画賞を取ったことで、海外でもこの映画が「注目｜ちゅうもく」されるようになったんだそうです。高校だけでなく、町のあちこちにこの映画が撮影された所があり、ファンに大変人気があるとのことです。</p><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>1.海外からこの町を訪れる人が増えた理由</p>            </div><div class='checkbox'><input type="checkbox" />            <p>2.この映画が日本で話題になった理由</p>            </div><div class='checkbox'><input type="checkbox" />            <p>3.ある俳優が映画賞を取った</p>            </div><div class='checkbox'><input type="checkbox" />            <p>4.この町で映画が撮影された理由</p>            </div>              </div>            </details><details class="folding-tag" ><summary> ５番　｢議員｜ぎいん｣が言いたいことは何ですか。 </summary>              <div class='content'>              <p>議員：昨年度の調査によると、わが｢河中町|かわなかまち｣では誰も住んでいない｢空き家|あきや｣がこの十年で「二倍｜にばい」に増えていることが「明らか｜あきらか，某事物或情况清楚、显而易见，没有疑问或不明确的地方。」になりました。空き家の「増加｜ぞうか」は【地域|ちいき】の｢防犯上｜ぼうはんじょう｣、「深刻｜しんこく」な問題です。「火災｜かさい」の発見が遅れたり、建物が古くなって「崩れたり｜くずれる」する「危険｜きけん」もあります。</p><p>【そうした空き家|这样的空置房屋】は【早急|そうきゅう】に「取り壊すべきだ｜应该拆除」という「意見｜いけん」が出ていますが、再生させる道を「探る｜さぐる」方がいいのではないでしょうか。全国の例を調べてみますと「自治体｜じちたい」が空き家を管理し、商業「施設｜しせつ」として再生させているところもあり、人を「呼び込む｜よびこむ」ことに【つながって|つながる：连接，联系】いる例もあります。</p><div class='checkbox'><input type="checkbox" />            <p>1.空き家の数を調べるべきだ</p>            </div><div class='checkbox'><input type="checkbox" />            <p>2.空き家を早く取り壊すべきだ</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>3.空き家を「活用｜かつよう」すべきだ</p>            </div><div class='checkbox'><input type="checkbox" />            <p>4.空き家が増えた理由を調べるべきだ</p>            </div>              </div>            </details>              </div>            </details><details class="folding-tag" ><summary> 問題２ 点击查看原文 </summary>              <div class='content'>              <details class="folding-tag" ><summary> 1番　女の学生は、このアニメのどんな所に「魅力｜みりょく」を感じたと言っていますか。 </summary>              <div class='content'>              <p>男：桜映画祭で【金賞|きんしょう】を取った「アニメ｜是日语中对<strong>动画（animation）</strong>的简称」、見たんだって。どうだった？300年前の日本が「舞台｜ぶたい，这里引申为故事发生的背景或场景」に「なってる｜なっている的口语简化」んでしょう。</p><p>女：うん、「歴史｜れきし」的な｢事実|じじつ｣も「丁寧｜ていねい、礼貌，恭敬的」「追ってる｜おってる，追溯，继续跟随，ている＝ってる」から。歴史好きの人には【そこが|そこ表示指代，が表示 强调】【楽しめる|“楽しむ”（享受、享乐）的可能态，表示“能够享受”或“能体会到乐趣”。】【んじゃないかな|じゃない是“ではない”的口语形式，表示否定或不是，かな，表示推测、猜测，整体表示一种推测和柔和的语气：“不是……吧？”、“可能是……吧？”。】。</p><p>男：ううん。</p><p>女：私は、自分が音楽やってるせいか、いつもは、テーマ音楽を取られるんだけど。これ、｢物語|ものがたり｣の「展開｜てんかい」にインパクトがあってね。</p><p>何て言うか、何度も「予想｜よそう」を【裏切られて|うらぎる的被动形，背叛，辜负，意思是：故事情节多次反转，完全超出了我的预期。】【ハラハラ|形容紧张、担忧的情绪】【ドキドキ|形容心跳加速，可能是因为兴奋或紧张。】し【っばなし|っぱなし，表示动作或状态持续，翻译为“一直处于……的状态”。】。今までは映画は音楽「次第｜しだい、取决于，依赖于，有时用于表达“随即”“一旦”」って思ってたんだけど。</p><p>男：そうなんだ。</p><p>女：新聞「じゃ｜＝口语中的では」、「登場｜とうじょう」「人物｜じんぶつ」の心の変化が丁寧に【描かれてる｜えがく被动形的ている形式、描写、描绘】って「評価｜ひょうか」だよね。その見方は、私はよくわからなかったけど。</p>              </div>            </details><details class="folding-tag" ><summary> ２番　東京行きの飛行機の出発時間が遅れている理由は何ですか。 </summary>              <div class='content'>              <p>男：すみません。さっきの放送、よく聞こえなかったんですが、東京行きの便、出発時間変更になったんですか？</p><p>女：はい。大変申し訳ございません。1時間遅れで12時15分の出発に変更となりました。</p><p>男：え、そんなに？</p><p>女：申し訳ございません。東京便として使う予定の飛行機がまだこちらの空港に「到着｜とうちゃく」していないんです。「雪｜ゆき」で出発が遅れました。</p><p>男：あ、そうなんですか。【チェックインカウンター|（check-in counter）：登机柜台】が混んでいたそれで、遅れいるのかと思ったんですが。</p><p>女：申し訳ございません。もう【間もなく|马上、即将、很快】到着する予定「でして｜是です的另一种表达方式，语气更加正式和谦逊。」、「清掃｜せいそう」が終わり「次第｜しだい：一旦.. 就..」、東京行きのお客様をご案内いたします。</p><p>男：わかりました。「故障｜こしょう」ってわけじゃないんですよね。だったら「これ以上｜更多，进一步」遅れる【ってことはない|没有可能、不可能】ですよね。</p><p>女：はい。「恐れ入ります｜おそれいります」が、もう少々お待ちください。</p>              </div>            </details><details class="folding-tag" ><summary> 3番　男の人は「どうして｜为什么」今、日本語を勉強していますか。 </summary>              <div class='content'>              <p>男：私は来日にして3年になります。「和菓子｜わがし」が【きっかけ|以..为契机、诱因】で日本に「興味｜きょうみ」を持ち、日本語を「学ぶ｜まなぶ」ようになりました。和菓子職人を「目指して｜めざす，表示以…为目标」いた時期もありましたが、昨年、食品メーカーに「就職｜しゅうしょく」し、「平日｜へいじつ」は仕事、週末は日本語教室に通日々です。</p><p>毎日の暮らしの中で言葉で不自由を感じることはありませんが、職場でじゃまだまだ「力｜ちから」が足りないなと感じる「場面｜ばめん，场面、情形」があり、日本語教室で「学ぶ｜まなぶ」ことはたくさんあると感じています。</p>              </div>            </details><details class="folding-tag" ><summary> ４番　男の人は、女の人の「むし｜虫の」飼い方の何に問題があると言っていますか。 </summary>              <div class='content'>              <p>女：あの、田中さん。虫に詳しいって聞いたんだけど、ちょっと聞いてもいい？</p><p>男：どうしたの？</p><p>女：うちで子供とカブトムシを「飼い｜かい」始めたんだけど、最近、元気がなくて。飼い方に問題があるのかな？</p><p>男：飼い方で大事なのは「土｜つち」、「温度｜おんど」管理、「餌｜えさ」の量、ケースの大きさだけど何か気になることある？</p><p>女：んー、ケースは３「匹｜ぴき」いるから餌の取り合いにならないように大きめのにしているんだ。温度管理は「小型｜こがた」の「扇風機｜せんぷうき」もつけてるし、特に日中は温度が３０°以上にならないように気を付けてて。</p><p>土は「潜り｜もぐり」やすいようにできるだけ「軟らかい｜やわらかい」のにしてるよ。</p><p>男：あ、わかった。</p><p>女：え？</p><p>男：扇風機「回す|まわす」と土全体が「乾燥｜かんそ」しちゃうんだ。土の中にいる時体から水分を「吸収｜きゅうしゅう」してるんだよ。</p><p>女：そうなの？餌の量が足りないのかなと考えてだけと、あー、だから元気がなかったのね。なるほど。</p>              </div>            </details><details class="folding-tag" ><summary> ５番　女の職員が、講演会について「反省｜はんせい」していることは何ですか。 </summary>              <div class='content'>              <p>男：【斉藤|さいとう】さん、昨日の食事に関する講演会、どうだった？</p><p>女：あ、課長。今、ご「報告｜ほうこ」に「伺おう｜是 <strong>伺（うかが）う</strong> 的意向形，用来表达“打算去做某事”，同时体现对对方的尊敬」と思っていたところです。「お陰｜おかげ、表示“托某人、某事的福”或“得益于……”」様で会場の「座席｜ざせき」が全部「埋まる｜うまる、沾满，填满」ほどの人で、ポスターを「掲示｜けいじする」「地域｜ちいき」を「拡大｜かくだい」したのが「よかったんでしょうか｜表示推测，意思是“可能是这个做法起到了效果”」。</p><p>男：そうか。</p><p>女：講演会に「アンケート｜问卷调查」を取ったんですけど、参加者の感想からは「調理法｜ちょうりほう」など【実践|じっせ】的な内容が「喜ばれた｜よろこ：被动形式，意为“受到喜爱、欢迎”。」ことが分かりました。</p><p>「講演中｜ちゅう」「熱心｜ねっしん」に【メモしている|memo，记笔记】方が何人かいたので材料や作り方を書いたものをお配りしておけばよかったと思います。</p><p>男：今回資料は用意しなかったもんね。</p><p>女：はい。それから今回は新しい会場を使ったんですが、先生の近くで話が【開けて|あける、打开，畅通，这里表示更容易展开讨论】よかったという声 も多く「いただき｜もらう、他行自利，表示自谦。同时，也是 食べる、飲む的自谦」ました。</p>              </div>            </details>              </div>            </details><details class="folding-tag" ><summary> 問題１　点击查看详情 </summary>              <div class='content'>              <details class="folding-tag" ><summary> ５番参加者はこのあと、まず、何をしますか。 </summary>              <div class='content'>              <p>学生の勉強会で、司会の人が話しています。参加者はこのあと、まず、何をしますか。</p><p>司会：今日は、大学「合同｜ごうどう」勉強会にご参加いただき、ありがたいです。これから、世界が今「抱えている｜かかえる、」「諸問題｜しょもんだい」についてグループ「討論｜とうろん」を「行｜おこな」い、理解を「深めて｜ふかめる」いきます。皆さん、【すでに｜副词，已经】グルプレに【分かれてます|分かれる是被动形，てます是ています的口语形式】ね。お「配り｜くばる，分发」してある「名簿｜めいぼ」に「〇｜丸、まる，表示圆圈符号」の【ついている|つく（附附加、标注）】人がグループのリーダーです。リーダーを中心に、話し合い「進めて｜すすめる」いただきます。「予め｜あらかじめ」、皆さんに選んでいただきいた「課題｜かだい」について「議論｜ぎろん」し、どのような「対応｜たいおう、应对，处理」ができるか、グループごとに意見をまとめて「発表｜はっぴょう」してください。「本題｜ほんだい、主题，正题」に入る前に、自己紹介も「兼ねて｜かねる」、皆さんが今取り組んでいる研究テーマについて話してください。「リラックス｜relax」してから、話し合いに入りましょう。</p>              </div>            </details><details class="folding-tag" ><summary> ４番　男の人はこれから、まず、何をしなければなりませんか。 </summary>              <div class='content'>              <p>市役所の国際交流課で、男の人と女の人が話しています。男の人はこれからまず、何をしなければなりませんか。</p><p>男：課長。来月の料理教室のことなんですが。</p><p>女：あぁ、アジア料理教室の話ですね。誰でも家で作れるものっていうことでメニューも決めたんですよね？</p><p>男：ええ、「講師｜こうし」の方と「打ち合わせして｜进行商讨、讨论。」材料のリストをもらったんです。僕が材料を人数分、まとめて「揃える｜そろえる、」ことになってるんですけど、｢聞いたことのない材料|从未听说过的材料｣があって、、、「取り寄せ｜とりよせ，表示“订购、取回、从远方获取”的意思」ないといけないみたいんですよ。</p><p>女：その辺で買えるもので代わりにできないか、講師の先生に「相談｜そうだん」してください。難しいようなら、メニュー、「変更｜へんこう」ですね。</p><p>男：わかりました。</p><p>女：作り方が簡単でも、材料が「近所｜きんじょ」で手に入るものじゃないとね。</p><p>男：そうですね。メニューが変更になったら参加者にも知らせます。</p>              </div>            </details><details class="folding-tag" ><summary> ３番　女の学生はこのあと何をしますか。 </summary>              <div class='content'>              <p>女：先輩、去年の夏休みに農業「体験｜たいけん」へ行かれたんですよね？大学が「主催｜しゅさい」してる。あれ、私も来週から１ヶ月行くんです。何か持ってった方がいい物とかありますか。</p><p>男：「保険証｜ほけんしょう」、去年忘れた人がいて大変だったんだよ。コピー「すら｜是一个强调的助词，表示连……都（都不、甚至不）」「持ってきてなくて｜持ってくる（带来）的否定形式」、【僕らみたいな|像我们这样的】「素人｜しろうと，外行人，没有专业经验或知识的人」が農業やるときは「思わぬ|思う的否定形思わない的连体形、没想到的」「怪我｜けが」とかあるから【忘れないように気を付けて|要注意、小心】。</p><p>女：はい。「いつも｜总是，平常」【持ち歩いてます|指的是“随身携带”，是“持ち歩く”（携带，带着走）的动词的现在进行时，てます是ています的口语形式。】。</p><p>男：そう。それから、Tシャツは多めに持ってったほうがいいよ。「作業着｜さぎょうぎ」のなかに「着る｜きる」んだけど、作業してると「想像｜そうぞう」以上に「汗をかく｜あせをかく、出汗」からね。作業着と「長靴｜ながぐつ」は貸してもらえるよ。よく「実習生｜じっしゅうせい」が来るからか、いろんなサイズのがあったよ。</p><p>女：よかった。長靴買わ「なきゃって｜表示“必须买”的意思，是 <strong>買わなければいけない</strong> 的缩写形式。」思ってだけど。Tシャツは作業着があるから「いいかなって思って｜我觉得也许这样就好了」部屋着ぐらいしか用意してませんでした。</p><p>男：そうそう。実は去年、僕「健康診断｜けんこうしんだん」受けるの忘れてて、もう少しで参加できなくなりそうだったんだよ。</p><p>女：へぇー、で、どうしたんですか？</p><p>男：診断書を「すぐ出してくれる｜すぐ、迅速，直接，てくれる、他行自利」病院を探して何とか【間に合った|赶得上】んだけどね。</p><p>女：あぁ、それで、今年は提出が先週までだったんですね。</p>              </div>            </details><details class="folding-tag" ><summary> 2番 女の人はこのあと、まず、何をしなければなりませんか。 </summary>              <div class='content'>              <p>会社で、男人と女の人が話しています。女の人はこのあと、まず、何をしなければなりませんか。</p><p>男：佐藤さん、そろそろ会員向けのセールの案内を「出さ|だす：表示“发出”或“推出”的意思，指发出促销通知。」「なきゃいけない|这是“なければいけない”的口语形式，表示“必须”或“需要”的意思。」んだけど。</p><p>女：はい。</p><p>男：「印刷屋｜いんさつや」さんから案内の「はがき｜明信片」が「出来上がって｜这是“出来上がる”的过去形，表示“做好了”或“完成了”。」たから、「あて名｜地址（指写在明信片上的收件人名字和地址）」の「シール｜标签（“seal”的音译）」を「作ってくれる｜て＋くれる：别人为自己做某事」かな。会員の｢情報|じょうほう」を「まとめた｜“まとめる”（整理、汇总）」ファイルを「わかるよう｜这是“わかる”的“ように”形式，表示“为了使…明了”或“确保能理解”。」ね。あれ使って「さくして｜这是“作して”的口语形式，表示“做”的意思，这里可以理解为“做一下”或“处理”。」。あ、「郵送｜ゆうそう」物を希望していないお客さんにはメールで送るから、シールは「いらない｜表示“不需要”或“没有必要”。常用于描述事物、东西的需求与否。」よ。</p><p>女：はい。会員情報のファイルは「更新｜こうしん」「されてる｜されている的口语形式，被动形式」んですか。</p><p>男：うん、されてるよ。されてるよ。「個人｜こじん」情報だから、気を付けて「作業｜さぎょう」してね。</p><p>女：はい。メールのほうも私が送りますか。</p><p>男：まだ「文章｜ぶんしょう」を準備していないから「今日はいいよ｜今天不用，今天就算了吧」。</p>              </div>            </details><details class="folding-tag" ><summary> １番　女の学生はこのあと、何をしますか。 </summary>              <div class='content'>              <p>男：「鈴木｜すずき」さん、この間「頼まれた｜たのむ、たのます」レポートのチェックだけど。</p><p>女：あ、先輩、もう見てくださったんですか。</p><p>男：うん、再調査して対象の数も増えてよくなったんじゃない。「考察｜こうさつ」も「説得力｜せっとくりょく」増えして、読んでて「面白｜おもしろ」かったよ。</p><p>女：本当ですか。ありがとうございます。再調査、思ったより時間がかかって。でも、やってよかったです。</p><p>男：よく頑張ったね。うん、｢せっかく｜表示“费尽心思”、“特意”｣だから、｢結果|けっか」の「示し｜しめし」方をもう少し「工夫｜くふう」してみたら？表ばっかりじゃなくて、少しグラフも入れるとか。もう少しぱっと見て分かるように。</p><p>女：あ、はい。</p><p>男：それにしても、この「分析｜ぶんせき」方法面白いね。今度僕も使ってみよう。</p>              </div>            </details>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> 日语 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日语 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue3.2+Vite+Typescript 开发（一）</title>
      <link href="/posts/976198b5/"/>
      <url>/posts/976198b5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><div class="note blue no-icon flat"><p>Vue3.2+Vite+Typescript 开发双端招聘全过程系列导航</p><ol><li>基础环境配置（一）⇦当前位置🪂</li><li><a href="/posts/f3ee6f99">可复用的页面交互逻辑（二）</a></li><li>个人中心模块（三）</li><li>即将闪亮登场..</li></ol></div><h2 id="项目创建"><a href="#项目创建" class="headerlink" title="项目创建"></a>项目创建</h2><details class="folding-tag" ><summary> 两种项目创建方式现在都是基于 vite </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">create vue</button><button type="button" class="tab"><i class="fas fa-bomb"></i>vite</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>vue3 - 官方推荐 create vue </strong></p><p>create-vue 是一个官方的 Vue 项目脚手架工具，用来快速创建 Vue 3 项目。默认情况下，它使用 Vite 作为构建工具</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pnpm create vue@latest</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">✔ Project name: … &lt;your-project-name&gt;</span><br><span class="line">✔ Add TypeScript? … No / Yes</span><br><span class="line">✔ Add JSX Support? … No / Yes</span><br><span class="line">✔ Add Vue Router for Single Page Application development? … No / Yes</span><br><span class="line">✔ Add Pinia for state management? … No / Yes</span><br><span class="line">✔ Add Vitest for Unit testing? … No / Yes</span><br><span class="line">✔ Add an End-to-End Testing Solution? … No / Cypress / Nightwatch / Playwright</span><br><span class="line">✔ Add ESLint for code quality? … No / Yes</span><br><span class="line">✔ Add Prettier for code formatting? … No / Yes</span><br><span class="line">✔ Add Vue DevTools 7 extension for debugging? (experimental) … No / Yes</span><br><span class="line"></span><br><span class="line">Scaffolding project in ./&lt;your-project-name&gt;...</span><br><span class="line">Done.</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 如果不确定是否要开启某个功能，你可以直接按下回车键选择 No。在项目被创建后，通过以下步骤安装依赖并启动开发服务器：</span><br><span class="line">cd &lt;your-project-name&gt;</span><br><span class="line">pnpm install</span><br><span class="line">pnpm run dev</span><br><span class="line"></span><br><span class="line">// 此命令会在 ./dist 文件夹中为你的应用创建一个生产环境的构建版本。</span><br><span class="line">pnpm run build</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><h3 id="Vite-を使う理由"><a href="#Vite-を使う理由" class="headerlink" title="Vite を使う理由"></a>Vite を使う理由</h3><h4 id="問題点"><a href="#問題点" class="headerlink" title="問題点"></a>問題点</h4><p>ES モジュールがブラウザーで利用できるようになるまで、開発者はモジュール化された JavaScript を生成するネイティブの仕組みを持っていませんでした。これは、私たちが「バンドル」のコンセプトに慣れ親しんでいる理由でもあります: すなわち、ブラウザーで実行可能なようにソースモジュールをクロール、処理し、連結するツールを使用しています。</p><p>時を経て <a href="https://webpack.js.org/">webpack</a> や <a href="https://rollupjs.org/">Rollup</a>、<a href="https://parceljs.org/">Parcel</a> のようなツールが登場し、フロントエンド開発者の開発体験は大きく向上されました。</p><p>しかしながら、大規模なアプリケーションが作られるようになってくると、取り扱う JavaScript の量は劇的に増加しました。大規模プロジェクトでは、数千ものモジュールが含まれることも珍しくありません。JavaScript ベースのツールを使用していては、いずれパフォーマンスのボトルネックにぶつかります: 開発サーバーを起動するのにやたらと長く待つこともあります（数分かかることさえ！）。また、Hot Module Replacement（HMR）を利用していても、ファイル編集がブラウザーに反映されるまで数秒かかることもあります。フィードバックの遅さが継続することは、開発者の生産性や幸福度に大きな影響を与える可能性があります。</p><p>Vite では新しいエコシステムの進歩を活用し、これらの問題を解決することに取り組んでいます: ブラウザーのネイティブ ES モジュールや、ネイティブにコンパイルされる言語で書かれた先進的な JavaScript ツールの利用です。</p><h3 id="现实问题"><a href="#现实问题" class="headerlink" title="现实问题"></a>现实问题</h3><p>在浏览器支持 ES 模块之前，JavaScript 并没有提供原生机制让开发者以模块化的方式进行开发。这也正是我们对 “打包” 这个概念熟悉的原因：使用工具抓取、处理并将我们的源码模块串联成可以在浏览器中运行的文件。</p><p>时过境迁，我们见证了诸如 <a href="https://webpack.js.org/">webpack</a>、<a href="https://rollupjs.org/">Rollup</a> 和 <a href="https://parceljs.org/">Parcel</a> 等工具的变迁，它们极大地改善了前端开发者的开发体验。</p><p>然而，当我们开始构建越来越大型的应用时，需要处理的 JavaScript 代码量也呈指数级增长。包含数千个模块的大型项目相当普遍。基于 JavaScript 开发的工具就会开始遇到性能瓶颈：通常需要很长时间（甚至是几分钟！）才能启动开发服务器，即使使用模块热替换（HMR），文件修改后的效果也需要几秒钟才能在浏览器中反映出来。如此循环往复，迟钝的反馈会极大地影响开发者的开发效率和幸福感。</p><p>Vite 旨在利用生态系统中的新进展解决上述问题：浏览器开始原生支持 ES 模块，且越来越多 JavaScript 工具使用编译型语言编写。</p><h3 id="遅いサーバー起動"><a href="#遅いサーバー起動" class="headerlink" title="遅いサーバー起動"></a>遅いサーバー起動</h3><p>開発サーバーがコールドスタートするとき、バンドラーベースのビルドセットアップは、アプリケーション全体を提供する前に、アプリケーション全体を隅々までクロールしてビルドする必要があります。</p><p>Vite はまず最初にアプリケーションのモジュールを 2 つのカテゴリーに分割することで、開発サーバーの起動時間を改善します: <strong>依存関係</strong>と<strong>ソースコード</strong>です。</p><ul><li><p><strong>依存関係</strong>の大部分は開発中あまり変更されないプレーンな JavaScript です。巨大な依存関係の中には、処理コストが極めて高いものがあります（例: 100 ものモジュールを持つコンポーネントライブラリー）。依存関係は、様々なモジュール形式で出力されることがあります（例: ESM または CommonJS）。</p><p>Vite は、<a href="https://esbuild.github.io/">esbuild</a> を使用して<a href="https://ja.vite.dev/guide/dep-pre-bundling">依存関係の事前バンドル</a>を行います。esbuild は Go 言語によって開発されており、依存関係の事前バンドルは、JavaScript ベースよりも 10 倍から 100 倍高速です。</p></li><li><p><strong>ソースコード</strong>には変換を必要とするプレーンな JavaScript ではないものが含まれることがよくあり、頻繁に編集されます（例: JSX、CSS や Vue/Svelte コンポーネント）。また、全てのソースコードを同時に読み込む必要はありません（例: ルーティングによるコード分割）。</p><p>Vite は、<a href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Guide/Modules">ネイティブ ESM</a> を行使してソースコードを提供します。ブラウザーは、実質的にバンドラーの仕事の一部を引き受けます: Vite はブラウザーのリクエストに応じて、ソースコードを変換し提供するのみになります。条件で囲われている動的インポートのコードは、現在の画面で使われる場合のみ処理されます。</p></li></ul><p>バンドルベースの開発サーバーentry···routeroutemodulemodulemodulemodule···BundleServer ready</p><p>ネイティブ ESM ベースの開発サーバーentry···routeroutemodulemodulemodulemodule···Server ready動的インポート （コード分割点）HTTP リクエスト</p><h3 id="遅い更新速度"><a href="#遅い更新速度" class="headerlink" title="遅い更新速度"></a>遅い更新速度<a href="https://ja.vite.dev/guide/why.html#%E9%81%85%E3%81%84%E6%9B%B4%E6%96%B0%E9%80%9F%E5%BA%A6"></a></h3><p>バンドラーベースのビルドセットアップでファイルが編集されたとき、全てのバンドルを再構築することが非効率なことは明白です: 更新スピードはアプリケーションのサイズに応じて線形的に低下してしまうからです。</p><p>バンドラーの中には開発サーバーがメモリー上でバンドルを実行し、ファイルが変更されたときにモジュールグラフの一部のみ無効化して再処理を行うものも存在しますが、それでもバンドル全体を再構築して、ウェブページをリロードしなければなりません。バンドルの再構築にはコストがかかりますし、ページがリロードされるとアプリケーションの現在の状態は消えてしまいます。そのため、幾つかのバンドラーは HMR（ホットモジュールリプレースメント）をサポートしています: これにより、ページの変更に関係のない部分には影響を与えることなく、モジュールを「ホットリプレース」することができます。これは開発者体験を大きく改善します。- しかしながら、実際には HMR でもアプリケーションが大きくなるにつれ更新速度が著しく悪化することが分かってきました。</p><p>Vite では、HMR をネイティブ ESM 上で行います。ファイルが編集されたとき、Vite は編集されたモジュールと最も近い HMR バウンダリ間のつながりを正確に無効化することで（大抵はモジュール本体だけです）、HMR による更新はアプリケーションのサイズに関係なく一貫して高速で実行されます。</p><p>また、Vite は HTTP ヘッダーを活用して、フルページのリロードも高速化します（ここでも、ブラウザーにはもっと働いてもらいます）: ソースコードモジュールのリクエストでは <code>304 Not Modified</code> を利用して条件が作成されます。そして、依存モジュールのリクエストでは、一度キャッシュされたものが再びサーバーにヒットしないよう、<code>Cache-Control: max-age=31536000,immutable</code> を利用して積極的にキャッシュされます。</p><p>超高速な Vite を一度体験してしまうと、バンドルでの開発にまた耐えられるかはとても疑わしいです。</p><h3 id="プロダクションではバンドルする理由"><a href="#プロダクションではバンドルする理由" class="headerlink" title="プロダクションではバンドルする理由"></a>プロダクションではバンドルする理由<a href="https://ja.vite.dev/guide/why.html#%E3%83%95%E3%82%9A%E3%83%AD%E3%82%BF%E3%82%99%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A6%E3%82%99%E3%81%AF%E3%83%8F%E3%82%99%E3%83%B3%E3%83%88%E3%82%99%E3%83%AB%E3%81%99%E3%82%8B%E7%90%86%E7%94%B1"></a></h3><p>ネイティブ ESM が広くサポートされるようになっても、バンドルされていない ESM をプロダクション用にリリースすることは非効率です（HTTP/2 を利用していても）。これは、ネットワークのラウンドトリップの増加がネストされたインポートによって引き起こされるためです。プロダクションでは最適化されたローディングパフォーマンスを得るために、ツリーシェイキングや遅延読み込み、（キャッシュ改善のための）共通コード分割などの技術を用いつつバンドルを行うことは、より良いことです。</p><p>開発サーバーとプロダクションビルド間で、最適化された出力と一貫した動作を確保することは容易なことではありません。そのため、Vite にはあらかじめ調整された<a href="https://ja.vite.dev/guide/build">ビルドコマンド</a>が用意されており、これには従来の常識を破る多くの<a href="https://ja.vite.dev/guide/features#build-optimizations">パフォーマンス最適化</a>が施されています。</p><h3 id="なぜ-esbuild-でバンドルしないのか？"><a href="#なぜ-esbuild-でバンドルしないのか？" class="headerlink" title="なぜ esbuild でバンドルしないのか？"></a>なぜ esbuild でバンドルしないのか？<a href="https://ja.vite.dev/guide/why.html#%E3%81%AA%E3%81%9B%E3%82%99-esbuild-%E3%81%A6%E3%82%99%E3%83%8F%E3%82%99%E3%83%B3%E3%83%88%E3%82%99%E3%83%AB%E3%81%97%E3%81%AA%E3%81%84%E3%81%AE%E3%81%8B"></a></h3><p>Vite は <a href="https://ja.vite.dev/guide/dep-pre-bundling">開発環境で一部の依存関係を事前バンドルする</a>ために esbuild を活用していますが、本番ビルドのためのバンドラーとしては esbuild を利用しません。</p><p>Vite の現在のプラグイン API は、<code>esbuild</code> をバンドラーとして使用することと互換性がありません。<code>esbuild</code> の方が速いにもかかわらず、Vite は Rollup の柔軟なプラグイン API とインフラストラクチャーを採用し、エコシステムでの成功に大きく貢献しました。当面は、Rollup の方がパフォーマンスと柔軟性のトレードオフに優れていると考えています。</p><p>Rollup はパフォーマンスの向上にも取り組んでおり、<a href="https://github.com/rollup/rollup/pull/5073">v4 でパーサーを SWC に切り替えました</a>。 そして、Rolldown と呼ばれる Rollup の Rust ポートを構築する取り組みが進行中です。 Rolldown の準備が完了すると、Vite の Rollup と esbuild の両方が置き換えられ、ビルドのパフォーマンスが大幅に向上し、開発とビルドの間の不一致が解消されます。 <a href="https://youtu.be/hrdwQHoAp0M">詳細については、Evan You の ViteConf 2023 基調講演</a> をご覧ください。</p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><h2 id="什么是TypeScript"><a href="#什么是TypeScript" class="headerlink" title="什么是TypeScript?"></a>什么是TypeScript?</h2><details class="folding-tag" ><summary> TypeScript 是具有类型语法的 JaveScript - 点击查看详情 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">示例1</button><button type="button" class="tab">示例2</button><button type="button" class="tab">示例3</button><button type="button" class="tab">基础概念</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>示例1.</strong></p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Result</span> = <span class="string">&quot;pass&quot;</span> | <span class="string">&quot;fail&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">verify</span>(<span class="params"><span class="attr">result</span>: <span class="title class_">Result</span></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (result === <span class="string">&quot;pass&quot;</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Passed&quot;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    consle.<span class="title function_">log</span>(<span class="string">&quot;Failed&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p><strong>示例 2.</strong></p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">hello</span> = names =&gt;&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`hi,<span class="subst">$&#123;names&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hello</span>(<span class="string">&#x27;luffy&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以上相当于定义了一个函数 hello，它接收一个参数 names，并在函数体中使用该参数来输出消息。</span></span><br><span class="line"><span class="comment">// 以下为原始写法</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hello</span>(<span class="params">names</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`hi, <span class="subst">$&#123;names&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hello</span>(<span class="string">&#x27;luffy&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 两者在定义参数上本质是一样的，都是在函数调用时传入参数。但箭头函数的语法更简洁，特别是当只有一个参数且函数体只有一行时，可以直接省略大括号 &#123;&#125;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p><strong>示例 3.</strong></p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 函数参数类型</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">hello</span> = (<span class="params"><span class="attr">name</span>: <span class="built_in">string</span></span>)  =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`hi, <span class="subst">$&#123;names&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hello0</span>(<span class="number">666</span>)</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p><strong>基础概念.</strong></p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 基础类型: 字符串, 数字, 布尔</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">str</span>: <span class="built_in">string</span> = <span class="string">&#x27;Hello world&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">num</span>: <span class="built_in">number</span> =  <span class="number">1</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">bool</span>: <span class="built_in">boolean</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//复杂类型: 数组, 对象</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">arr</span>: <span class="built_in">number</span>[] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">arr[<span class="number">0</span>] = <span class="string">&#x27;0&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">obj</span>: &#123; <span class="attr">x</span>: <span class="built_in">number</span>; <span class="attr">y</span>: <span class="built_in">number</span> &#125; = &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">1</span> &#125;</span><br><span class="line"><span class="keyword">const</span> <span class="attr">optionalObj</span>: &#123; <span class="attr">x</span>: <span class="built_in">number</span>; y?: <span class="built_in">number</span> &#125; = &#123; <span class="attr">x</span>: <span class="number">1</span> &#125;</span><br><span class="line">optionalObj.<span class="property">y</span> = <span class="string">&#x27;y&#x27;</span></span><br><span class="line">optionalObj.<span class="property">y</span> = <span class="number">2</span></span><br><span class="line">optionalObj.<span class="property">z</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象类型: 匿名, 接口 interface, 类型别名 type</span></span><br><span class="line"><span class="comment">// 接口</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IType</span> &#123;</span><br><span class="line">  <span class="attr">str</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 类型别名</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">TType</span> = &#123;</span><br><span class="line">  <span class="attr">str</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 类型推断</span></span><br><span class="line"><span class="keyword">let</span> n = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 类型断言</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>((x.<span class="property">contents</span> <span class="keyword">as</span> <span class="built_in">string</span>).<span class="title function_">toLowerCase</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 泛型, 包括泛型对象类型\泛型函数\泛型类</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IGeneric</span>&lt;<span class="title class_">Type</span>&gt;&#123;</span><br><span class="line">  <span class="attr">test</span>: <span class="title class_">Type</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 IGeneric，并指定 Type 为 string 类型</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">stringGeneric</span>: <span class="title class_">IGeneric</span>&lt;<span class="built_in">string</span>&gt; = &#123;</span><br><span class="line">  <span class="attr">test</span>: <span class="string">&quot;Hello&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 IGeneric，并指定 Type 为 number 类型</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">numberGeneric</span>: <span class="title class_">IGeneric</span>&lt;<span class="built_in">number</span>&gt; = &#123;</span><br><span class="line">  <span class="attr">test</span>: <span class="number">123</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 特殊类型: void\any\unknow\never</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><h2 id="初始化项目"><a href="#初始化项目" class="headerlink" title="初始化项目"></a>初始化项目</h2><details class="folding-tag" ><summary> create vue 基于vite 内置了 ts 依赖 可忽略这个步骤 - 点击查看详情 </summary>              <div class='content'>              <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">// 0. 初始化项目，新建package.json</span><br><span class="line"><span class="built_in">mkdir</span> <span class="built_in">test</span></span><br><span class="line">npm init</span><br><span class="line"></span><br><span class="line">// 1. 安装 typescript</span><br><span class="line">npm install typecript -D</span><br><span class="line"></span><br><span class="line">如果 npm 慢，可以使用 cnpm</span><br><span class="line">npm install -g cnpm </span><br><span class="line"></span><br><span class="line">// 2.将 ts 编译成 js</span><br><span class="line">// 其中 npx 允许使用安装在局部的包</span><br><span class="line">npx tsc 文件名.ts</span><br><span class="line"></span><br><span class="line">// 3. 新建一个 tsconfig.json</span><br><span class="line">npx tsc --init</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="git协作"><a href="#git协作" class="headerlink" title="git协作"></a>git协作</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">需求协作</button><button type="button" class="tab">多人协作</button><button type="button" class="tab"><i class="fas fa-bomb"></i>git 常用命令</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>我们在开发大型项目时，会同时开发多个需求</strong></p><p>git 提供了 branch（分支）功能 - 本质为指向 commit 节点对象的一个指针，当我们新建分支时，实际上是新建了一个指针并指向了当前 commit</p><p>分支操作</p><ul><li><strong><code>git branch</code></strong>：列出本地分支。</li><li><strong><code>git branch &lt;branch-name&gt;</code></strong>：创建新分支。</li><li><strong><code>git checkout &lt;branch-name&gt;</code></strong>：切换到指定分支。</li><li><strong><code>git checkout -b &lt;branch-name&gt;</code></strong>：创建并切换到新分支。</li><li><strong><code>git merge &lt;branch-name&gt;</code></strong>：合并其他分支到当前分支。</li><li><strong><code>git branch -d &lt;branch-name&gt;</code></strong>：删除本地分支。</li></ul></div><div class="tab-item-content"><p><strong>大型项目，往往需要跟其他人一起协作</strong></p><ol><li>git 分支合并</li></ol><p>将一个分支上的代码合并进当前分支</p><p><code>git fetch origin</code> 是用于从远程仓库获取最新的提交到本地的命令。具体含义如下：</p><ul><li><code>git fetch</code>：从远程仓库中抓取（fetch）所有分支的更新，获取远程仓库中的最新提交和引用（tags、branches 等），但不会修改本地工作目录，也不会自动合并这些更新。</li><li><code>origin</code>：是默认远程仓库的名称，表示你想要从 <code>origin</code> 这个远程仓库获取更新。通常，<code>origin</code> 是你在 <code>git clone</code> 时默认创建的远程仓库别名。</li></ul><ol><li>使用场景</li></ol><p><code>git fetch origin</code> 常用于以下场景：</p><ul><li>你想了解远程仓库的最新变化，但暂时不想合并这些更改到当前分支中。</li><li>配合其他命令（如 <code>git merge</code> 或 <code>git rebase</code>）来手动处理从远程分支获取的更新。</li></ul><ol><li>命令工作流程</li></ol><ul><li>执行 <code>git fetch origin</code>，Git 会连接到 <code>origin</code> 远程仓库并下载所有分支的最新提交和引用。</li><li>这些更新会保存到你本地仓库的远程分支中，例如 <code>origin/main</code>，而不会影响你当前的分支或工作目录。</li></ul></div><div class="tab-item-content"><ol><li>初始化和克隆仓库</li></ol><ul><li><strong><code>git init</code></strong>：初始化一个新的 Git 仓库。</li><li><strong><code>git clone &lt;repository-url&gt;</code></strong>：克隆远程仓库到本地。</li></ul><ol><li>查看仓库状态</li></ol><ul><li><strong><code>git status</code></strong>：查看当前分支的状态，显示已修改但未提交的文件。</li><li><strong><code>git log</code></strong>：查看提交历史。</li><li><strong><code>git diff</code></strong>：显示未提交的变更。</li></ul><ol><li>分支操作</li></ol><ul><li><strong><code>git branch</code></strong>：列出本地分支。</li><li><strong><code>git branch &lt;branch-name&gt;</code></strong>：创建新分支。</li><li><strong><code>git checkout &lt;branch-name&gt;</code></strong>：切换到指定分支。</li><li><strong><code>git checkout -b &lt;branch-name&gt;</code></strong>：创建并切换到新分支。</li><li><strong><code>git merge &lt;branch-name&gt;</code></strong>：合并其他分支到当前分支。</li><li><strong><code>git branch -d &lt;branch-name&gt;</code></strong>：删除本地分支。</li></ul><ol><li>提交和推送代码</li></ol><ul><li><strong><code>git add &lt;file&gt;</code></strong>：添加文件到暂存区。</li><li><strong><code>git add .</code></strong>：添加所有修改的文件到暂存区。</li><li><strong><code>git commit -m &quot;&lt;message&gt;&quot;</code></strong>：提交暂存区中的文件，附带提交信息。</li><li><strong><code>git push</code></strong>：将本地分支推送到远程仓库。</li><li><strong><code>git push origin &lt;branch-name&gt;</code></strong>：将指定分支推送到远程仓库。</li></ul><ol><li>更新和拉取代码</li></ol><ul><li><strong><code>git pull</code></strong>：从远程仓库拉取最新的更改，并合并到当前分支。</li><li><strong><code>git fetch</code></strong>：拉取远程仓库的最新内容但不合并，通常与 <code>git merge</code> 一起使用。</li></ul><ol><li>冲突解决</li></ol><ul><li><strong><code>git mergetool</code></strong>：使用外部工具来帮助解决合并冲突。</li><li><strong><code>git diff --base &lt;file&gt;</code></strong>：查看冲突文件的基础版本。</li><li><strong><code>git add &lt;file&gt;</code></strong>：在解决冲突后，使用该命令标记冲突已解决。</li></ul><ol><li>远程仓库管理</li></ol><ul><li><strong><code>git remote -v</code></strong>：查看当前配置的远程仓库。</li><li><strong><code>git remote add &lt;name&gt; &lt;url&gt;</code></strong>：添加新的远程仓库。</li><li><strong><code>git remote rm &lt;name&gt;</code></strong>：删除指定的远程仓库。</li></ul><ol><li>回滚和撤销</li></ol><ul><li><strong><code>git reset --hard &lt;commit-hash&gt;</code></strong>：将当前分支重置到指定提交。</li><li><strong><code>git revert &lt;commit-hash&gt;</code></strong>：撤销指定提交，并生成一个新的提交来记录此次撤销。</li><li><strong><code>git reset HEAD &lt;file&gt;</code></strong>：将文件从暂存区移除，但保留修改。</li></ul><ol><li>协作工作流相关</li></ol><ul><li><strong><code>git stash</code></strong>：临时保存当前工作区的修改，用于切换分支或拉取代码时避免冲突。</li><li><strong><code>git stash pop</code></strong>：恢复保存的工作区修改。</li><li><strong><code>git rebase &lt;branch-name&gt;</code></strong>：将当前分支变基到指定分支之上。</li></ul><ol><li>标签</li></ol><ul><li><strong><code>git tag &lt;tag-name&gt;</code></strong>：为当前提交打标签。</li><li><strong><code>git push origin &lt;tag-name&gt;</code></strong>：将标签推送到远程仓库。</li></ul></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><h2 id="git-hooks"><a href="#git-hooks" class="headerlink" title="git hooks"></a>git hooks</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">基础概念</button><button type="button" class="tab">初始化</button><button type="button" class="tab"><i class="fas fa-bomb"></i>commitlint</button><button type="button" class="tab">开始使用</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>什么是 git hooks</strong></p><p><code>Git hooks</code> 是 Git 提供的一种机制，允许在 Git 仓库中的特定事件发生时执行自定义脚本。它可以帮助开发者在进行一些操作时触发自动化流程，例如提交代码前自动检查代码风格、提交后通知某个服务等。</p><p>Git hooks 的作用</p><p>Git hooks 是本地钩子，它们与代码仓库一起存在，并在特定的 Git 事件（如提交、推送、合并等）触发时自动执行，典型的应用包括：</p><ul><li><strong>提交前代码检查</strong>：在提交代码之前自动运行测试或检查代码风格。</li><li><strong>提交信息规范化</strong>：确保提交信息遵循一定的格式。</li><li><strong>自动部署</strong>：在推送代码到远程仓库后，自动触发部署脚本。</li></ul><p>Git hooks 的分类</p><p>Git hooks 分为两大类：</p><ol><li><strong>客户端钩子（Client-Side Hooks）</strong>：主要在本地开发阶段触发，影响的是开发者的本地仓库行为。例如，提交前的检查、提交后的动作。</li><li><strong>服务端钩子（Server-Side Hooks）</strong>：主要在服务器端 Git 仓库中触发，影响的是推送到远程仓库的操作。例如，禁止推送不符合规定的提交或自动化部署等。</li></ol><p>常用的 Git hooks</p><p>Git hook 是存放在 <code>.git/hooks/</code> 目录下的一组脚本，以下是一些常用的钩子事件：</p><ol><li><strong>pre-commit</strong></li></ol><ul><li><strong>触发时机</strong>：在执行 <code>git commit</code> 前触发。</li><li><strong>用途</strong>：可以用来检查代码格式、运行测试或阻止提交不符合规范的代码。</li></ul><ol><li><strong>commit-msg</strong></li></ol><ul><li><strong>触发时机</strong>：在提交信息编辑完毕后执行。</li><li><strong>用途</strong>：用来检查提交信息是否符合规范，如确保每次提交信息都有相应的 issue 编号或规定格式。</li></ul><ol><li><strong>pre-push</strong></li></ol><ul><li><strong>触发时机</strong>：在执行 <code>git push</code> 前触发。</li><li><strong>用途</strong>：可以用来阻止推送某些特定分支、运行测试等。</li></ul><ol><li><strong>post-commit</strong></li></ol><ul><li><strong>触发时机</strong>：在提交完成后触发。</li><li><strong>用途</strong>：可以用于记录提交日志、发送通知或触发 CI（持续集成）服务。</li></ul><ol><li><strong>pre-receive</strong></li></ol><ul><li><strong>触发时机</strong>：在服务端接收到推送请求但未处理前触发。</li><li><strong>用途</strong>：在服务器端用于验证推送的代码，如确保符合公司标准，或防止特定分支的推送。</li></ul><ol><li><strong>post-receive</strong></li></ol><ul><li><strong>触发时机</strong>：在服务器端接受推送并处理后触发。</li><li><strong>用途</strong>：常用于触发自动化部署、发送推送通知等。</li></ul></div><div class="tab-item-content"><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// install</span></span><br><span class="line">pnpm add --save-dev husky</span><br><span class="line"><span class="comment">// husky init</span></span><br><span class="line">pnpm exec husky init</span><br><span class="line"></span><br><span class="line"><span class="comment">// 参见官方文档：https://typicode.github.io/husky/get-started.html</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p><strong>为什么需要 commitlint?</strong></p><p>产生大量的 commit 版本后，良好的 commit 信息可帮我们更好的回顾或回退版本</p><p><strong>如何规范?</strong></p><ol><li><p>提供一套规范来约束项目的 commit 信息；</p><p>type(scope?): subject  </p><p><code>type(scope?): subject</code> 是一种规范化的 Git 提交信息格式，通常用于 <strong>Conventional Commits</strong> 规范。这种格式有助于标准化提交信息，明确每次提交的意图。下面简述各部分的含义：</p><ol><li><strong>type (必填)</strong></li></ol><p><code>type</code> 表示提交的<strong>类型</strong>，用于描述这次提交的目的或性质。常见的 <code>type</code> 包括：</p><ul><li><code>feat</code>：新增功能（feature）。</li><li><code>fix</code>：修复 bug。</li><li><code>docs</code>：文档变更。</li><li><code>style</code>：代码格式变更（不影响代码逻辑的变动，如空格、格式等）。</li><li><code>refactor</code>：代码重构（不包括新增功能或修复 bug 的变动）。</li><li><code>test</code>：添加或修改测试。</li><li><code>chore</code>：非代码逻辑的变动（如构建任务、工具配置等）。</li></ul><ol><li><strong>scope (可选)</strong></li></ol><p><code>scope</code> 用来标明<strong>本次提交影响的模块或功能的范围</strong>。通常是项目中的某个特定功能、模块或子系统，帮助团队成员明确该提交的影响范围。</p><ul><li>例子：<ul><li><code>feat(user)</code>: 影响用户模块。</li><li><code>fix(auth)</code>: 影响身份认证模块。</li></ul></li></ul><p><strong>注意：</strong> <code>scope</code> 是可选的，如果不需要指定具体的模块范围，可以省略。</p><ol><li><strong>subject (必填)</strong></li></ol><p><code>subject</code> 是对本次提交的<strong>简要描述</strong>，用于说明提交内容。需要注意的是：</p><ul><li>使用简洁明了的语言。</li><li>应该以<strong>动词</strong>开头，通常是<strong>祈使句</strong>形式，如 “add”，”fix”，”update” 等。</li><li><strong>不要以大写字母开头</strong>，且不要以句号结尾。</li></ul><p><strong>例子：</strong></p><ul><li><code>feat(auth): add login functionality</code> (新增了登录功能)。</li><li><code>fix(user): resolve issue with profile picture upload</code> (修复了头像上传的问题)。</li></ul></li></ol></div><div class="tab-item-content"><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 那当然需要先安装下</span></span><br><span class="line">pnpm add --save-dev @commitlint/&#123;cli,config-conventional&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 下面这句话的意思，是将标的字符串内容写进 &gt; 指向的文件当中，如果不存在该文件，则自动创建该文件</span></span><br><span class="line">echo <span class="string">&quot;export default &#123; extends: [&#x27;@commitlint/config-conventional&#x27;] &#125;;&quot;</span> &gt; commitlint.<span class="property">config</span>.<span class="property">js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Add commit message linting to commit-msg hook</span></span><br><span class="line">echo <span class="string">&quot;pnpm dlx commitlint --edit \$1&quot;</span> &gt; .<span class="property">husky</span>/commit-msg</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这行命令是 Unix/Linux 系统中的 chmod 命令，用于更改文件或目录的权限</span></span><br><span class="line"><span class="comment">// Windows 系统中使用 husky，可以跳过 chmod 步骤。Windows 文件系统默认不需要像 Unix 系统那样手动设置文件执行权限，Husky 的钩子应该可以正常工作。</span></span><br><span class="line">chmod a+x .<span class="property">husky</span>/commit-msg</span><br></pre></td></tr></table></figure><ul><li><strong>chmod</strong>：这是改变文件权限的命令。</li><li><strong>a+x</strong>：表示给所有用户（<code>a</code> 是 “all” 的意思，包括用户本人、用户组和其他用户）添加执行权限（<code>+x</code> 表示增加执行权限）。</li><li><strong>.husky/commit-msg</strong>：这是文件路径，表示你要更改权限的文件。这个文件是 <code>husky</code> 钩子脚本，用来检查提交信息（commit message）。</li></ul><p>作用</p><p>这条命令的作用是让 <code>.husky/commit-msg</code> 文件可以被执行。<code>commit-msg</code> 是 <code>husky</code> 钩子，用来在 Git 提交时自动检查提交信息是否符合规范。让这个文件具有执行权限后，Git 在提交时可以调用并运行这个脚本。</p><p>一般在设置 <code>husky</code> 钩子时，需要给相应的钩子文件（如 <code>commit-msg</code>、<code>pre-commit</code> 等）赋予执行权限，否则这些钩子无法运行。</p><p>commit-msg</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/usr/bin/env sh</span><br><span class="line">. &quot;$(dirname -- &quot;$0&quot;)/_/husky.sh&quot;</span><br><span class="line"></span><br><span class="line">pnpm dlx commitlint --edit &quot;$1&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>pre-commit</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/usr/bin/env sh</span><br><span class="line">. &quot;$(dirname -- &quot;$0&quot;)/_/husky.sh&quot;</span><br><span class="line"></span><br><span class="line"># 这里挺操蛋的, 在配置具体 prettier 规则之前, 这里的npm test 处于未配置状态, 引起报错</span><br><span class="line">#npm test</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><h2 id="rem适配-amp-amp-路径别名"><a href="#rem适配-amp-amp-路径别名" class="headerlink" title="rem适配 &amp;&amp; 路径别名"></a>rem适配 &amp;&amp; 路径别名</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">rem 适配</button><button type="button" class="tab">路径别名</button></div><div class="tab-contents"><div class="tab-item-content active"><p>/src/utils/rem.ts</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 基准大小</span></span><br><span class="line"><span class="keyword">const</span> baseSize = <span class="number">37.5</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setRem</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> scale = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientWidth</span> / <span class="number">750</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">style</span>.<span class="property">fontSize</span> = baseSize * <span class="title class_">Math</span>.<span class="title function_">min</span>(scale, <span class="number">1</span>) + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化</span></span><br><span class="line"><span class="title function_">setRem</span>()</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onresize</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">setRem</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> baseSize</span><br><span class="line"></span><br><span class="line"><span class="comment">// 然后在 main.ts 中：</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@/utils/rem&#x27;</span> <span class="comment">// 引入 rem 适配方案</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>tsconfig.app.json 文件中需要配置别名路径</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;extends&quot;</span>: <span class="string">&quot;@vue/tsconfig/tsconfig.dom.json&quot;</span>,</span><br><span class="line">  <span class="string">&quot;include&quot;</span>: [<span class="string">&quot;env.d.ts&quot;</span>, <span class="string">&quot;src/**/*&quot;</span>, <span class="string">&quot;src/**/*.vue&quot;</span>,<span class="string">&quot;src/**/*.ts&quot;</span>,<span class="string">&quot;src/**/*.d.ts&quot;</span>,<span class="string">&quot;src/**/*.tsx&quot;</span>,],</span><br><span class="line">  <span class="string">&quot;exclude&quot;</span>: [<span class="string">&quot;src/**/__tests__/*&quot;</span>],</span><br><span class="line">  <span class="string">&quot;compilerOptions&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;composite&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&quot;tsBuildInfoFile&quot;</span>: <span class="string">&quot;./node_modules/.tmp/tsconfig.app.tsbuildinfo&quot;</span>,</span><br><span class="line">    <span class="string">&quot;baseUrl&quot;</span>: <span class="string">&quot;.&quot;</span>,</span><br><span class="line">    <span class="comment">// 这里配置了路径别名</span></span><br><span class="line">    <span class="string">&quot;paths&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;@/*&quot;</span>: [<span class="string">&quot;./src/*&quot;</span>],</span><br><span class="line">      <span class="string">&quot;@&quot;</span>: [<span class="string">&quot;./src&quot;</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;noImplicitAny&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="string">&quot;allowJs&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&quot;skipLibCheck&quot;</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><h2 id="eslint，prettier"><a href="#eslint，prettier" class="headerlink" title="eslint，prettier"></a>eslint，prettier</h2><details class="folding-tag" ><summary> 代码规范标准 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">eslint</button><button type="button" class="tab">prettier</button><button type="button" class="tab"><i class="fas fa-bomb"></i>ESLint + Prettier 配置</button><button type="button" class="tab">eslint stylist 规则冲突问题</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>在运行代码前，发现语法错误和潜在bug</strong></p><p>允许定制自己的代码规范</p><p>ESLint规则的三个等级：off、warn、error</p><p><code>ESlint</code>扩展会优先去查找项目根目录中的<code>eslint.config.js</code> 配置文件，并且包括配置文件所提到的<code>ESlint</code>插件，也就是<code>npm</code>依赖包，是的没错，<code>ESlint</code>扩展本身所需的<code>ESlint</code> 版本和<code>ESlint</code>插件，都是来自于<code>node_modules</code>，你可以试着把这个目录删了，<code>vscode</code>中的<code>ESlint</code>扩展就会报错，无法运行。</p><p>但你启用<code>vscode</code>中的<code>ESlint</code>扩展之后，并不会对所有文件生效，你还需要配置<code>ESlint</code>扩展的设置来对所需的文件启用校验。</p><p>这里建议为每个项目单独添加vscode独有的设置，也就是项目根目录中创建一个<code>.vscode</code>目录，里面放置一个<code>settings.json</code>文件，这样<code>vscode</code>就会优先读取该设置：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// .vscode/settings.json</span><br><span class="line">&#123;</span><br><span class="line">  &quot;eslint.validate&quot;: [</span><br><span class="line">    &quot;javascript&quot;,</span><br><span class="line">    &quot;vue&quot;,</span><br><span class="line">    &quot;vue-html&quot;,</span><br><span class="line">    &quot;typescript&quot;,</span><br><span class="line">    &quot;typescriptreact&quot;,</span><br><span class="line">    &quot;html&quot;,</span><br><span class="line">    &quot;css&quot;,</span><br><span class="line">    &quot;scss&quot;,</span><br><span class="line">    &quot;less&quot;,</span><br><span class="line">    &quot;json&quot;,</span><br><span class="line">    &quot;jsonc&quot;,</span><br><span class="line">    &quot;json5&quot;,</span><br><span class="line">    &quot;markdown&quot;</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样一来，配置中所提到的文件格式，都会被<code>ESlint</code>扩展识别。</p><p>到这里，ESlint基本算是可以正常使用了，でも，ちょうど待ってください，<code>prettier</code>がありますね。</p></div><div class="tab-item-content"><p><strong>用于检测代码中的格式问题</strong></p><p>ESLint 是侧重对项目代码质量的把控，而Prettier更侧重于统一项目的代码风格</p><p>因此，两者配合一起使用，比较好。</p></div><div class="tab-item-content"><p><strong>ESLint9之后，原有的配置文件已经被弃用</strong></p><p>在我还不知道如何从0开始配置ESlint的时候，ESlint已经更新到9.x了。</p><div class="btns rounded grid5">            <a class="button" href='https://eslint.nodejs.cn/docs/latest/use/configure/migration-guide' title='查看文档'><i class='fas fa-book-open'></i>查看文档</a>          </div><p><p>总而言之，从ESlint9.x开始，在使用create vue 创建项目后，如果选中了eslint，那么项目中生成的文件为 eslint.config.js（ESNext）或者eslint.config.mjs（CommonJS）命名的配置文件。</p><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 依赖包安装</span><br><span class="line">pnpm add eslint @eslint/js globals typescript-eslint eslint-plugin-vue @stylistic/eslint-plugin eslint-plugin-prettier -D</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import eslint from &#x27;@eslint/js&#x27;</span><br><span class="line">import globals from &#x27;globals&#x27;</span><br><span class="line">import tseslint from &#x27;typescript-eslint&#x27;</span><br><span class="line">import eslintPluginVue from &#x27;eslint-plugin-vue&#x27;</span><br><span class="line">import stylistic from &#x27;@stylistic/eslint-plugin&#x27;</span><br><span class="line">import eslintPluginPrettierRecommended from &#x27;eslint-plugin-prettier/recommended&#x27;</span><br><span class="line"></span><br><span class="line">export default tseslint.config(</span><br><span class="line">  &#123;</span><br><span class="line">    ignores: [&#x27;node_modules&#x27;, &#x27;dist&#x27;, &#x27;public&#x27;]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  /** js推荐配置 */</span><br><span class="line">  eslint.configs.recommended,</span><br><span class="line">  /** ts推荐配置 */</span><br><span class="line">  ...tseslint.configs.recommended,</span><br><span class="line">  /** vue推荐配置 */</span><br><span class="line">  ...eslintPluginVue.configs[&#x27;flat/recommended&#x27;],</span><br><span class="line"></span><br><span class="line">  stylistic.configs.customize(&#123;</span><br><span class="line">    indent: 2,</span><br><span class="line">    quotes: &#x27;single&#x27;,</span><br><span class="line">    semi: false,</span><br><span class="line">    jsx: true,</span><br><span class="line">    braceStyle: &#x27;1tbs&#x27;,</span><br><span class="line">    arrowParens: &#x27;always&#x27;</span><br><span class="line">  &#125;),</span><br><span class="line"></span><br><span class="line">  /**</span><br><span class="line">   * javascript 规则</span><br><span class="line">   */</span><br><span class="line">  &#123;</span><br><span class="line">    files: [&#x27;**/*.&#123;js,mjs,cjs,vue&#125;&#x27;],</span><br><span class="line">    rules: &#123;</span><br><span class="line">      &#x27;no-console&#x27;: &#x27;warn&#x27;,</span><br><span class="line">      &#x27;@stylistic/comma-dangle&#x27;: [&#x27;error&#x27;, &#x27;never&#x27;],</span><br><span class="line">      &#x27;prettier/prettier&#x27;: [</span><br><span class="line">        &#x27;warn&#x27;,</span><br><span class="line">        &#123;</span><br><span class="line">          singleQuote: true, // 单引号</span><br><span class="line">          semi: false, // 无分号</span><br><span class="line">          printWidth: 80, // 每行宽度至多80字符</span><br><span class="line">          trailingComma: &#x27;none&#x27;, // 不加对象|数组最后逗号</span><br><span class="line">          endOfLine: &#x27;auto&#x27; // 换行符号不限制（win mac 不一致）</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  /**</span><br><span class="line">   * 配置全局变量</span><br><span class="line">   */</span><br><span class="line">  &#123;</span><br><span class="line">    languageOptions: &#123;</span><br><span class="line">      globals: &#123;</span><br><span class="line">        ...globals.browser,</span><br><span class="line"></span><br><span class="line">        /** 追加一些其他自定义全局规则 */</span><br><span class="line">        wx: true</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  /**</span><br><span class="line">   * vue 规则</span><br><span class="line">   */</span><br><span class="line">  &#123;</span><br><span class="line">    files: [&#x27;**/*.vue&#x27;],</span><br><span class="line">    languageOptions: &#123;</span><br><span class="line">      parserOptions: &#123;</span><br><span class="line">        /** typescript项目需要用到这个 */</span><br><span class="line">        parser: tseslint.parser,</span><br><span class="line">        ecmaVersion: &#x27;latest&#x27;,</span><br><span class="line">        /** 允许在.vue 文件中使用 JSX */</span><br><span class="line">        ecmaFeatures: &#123;</span><br><span class="line">          jsx: true</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    rules: &#123;</span><br><span class="line">      // 在这里追加 vue 规则</span><br><span class="line">      // pretter 专注于代码的美观度 （格式化工具）</span><br><span class="line">      &#x27;vue/no-mutating-props&#x27;: [</span><br><span class="line">        &#x27;error&#x27;,</span><br><span class="line">        &#123;</span><br><span class="line">          shallowOnly: true</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      // ESLint 关注于规范</span><br><span class="line">      &#x27;vue/multi-word-component-names&#x27;: [</span><br><span class="line">        &#x27;warn&#x27;,</span><br><span class="line">        &#123;</span><br><span class="line">          ignores: [&#x27;index&#x27;] // vue组件名称多单词组成（忽略index.vue）</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &#x27;no-undef&#x27;: &#x27;error&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  /**</span><br><span class="line">   * typescript 规则</span><br><span class="line">   */</span><br><span class="line">  &#123;</span><br><span class="line">    files: [&#x27;**/*.&#123;ts,tsx,vue&#125;&#x27;],</span><br><span class="line">    rules: &#123;</span><br><span class="line">      &#x27;linebreak-style&#x27;: [&#x27;error&#x27;, &#x27;unix&#x27;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  /**</span><br><span class="line">   * prettier 配置</span><br><span class="line">   * 会合并根目录下的prettier.config.js 文件</span><br><span class="line">   * @see https://prettier.io/docs/en/options</span><br><span class="line">   */</span><br><span class="line">  eslintPluginPrettierRecommended</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p><div class="tag link"><a class="link-card" title="稀土掘金 - teojs" href="https://article.juejin.cn/post/7402696141495779363#heading-0"><div class="left"><img src="https://p3-passport.byteacctimg.com/img/user-avatar/384b8b880b987b921132a9ae561d11bf~100x100.awebp"/></div><div class="right"><p class="text">稀土掘金 - teojs</p><p class="url">https://article.juejin.cn/post/7402696141495779363#heading-0</p></div></a></div><div class="tag link"><a class="link-card" title="前端俱乐部" href="https://juejin.cn/post/7424906473576972340"><div class="left"><img src="https://p26-passport.byteacctimg.com/img/user-avatar/351dda31ca8c57481d723d386ee07d94~100x100.awebp"/></div><div class="right"><p class="text">前端俱乐部</p><p class="url">https://juejin.cn/post/7424906473576972340</p></div></a></div></div><div class="tab-item-content"><p>ESLint Stylistic 是一个社区维护的开源项目，专注于为 JavaScript 和 TypeScript 提供风格和格式化相关的 ESLint 规则。该项目由 ESLint 和 typescript-eslint 团队发起，旨在将原本在核心规则中被弃用的风格和格式化规则独立出来，以便社区能够更好地维护这些规则。</p><p>该项目的主要编程语言是 TypeScript，同时也包含一些 JavaScript 代码。</p><p>规则冲突问题 - 在使用 ESLint Stylistic 时，可能会遇到与现有 ESLint 规则冲突的情况，导致代码检查失败。</p><p><details class="folding-tag" ><summary> eslint-plugin-vue & vite-plugin-eslint - 着重介绍俩插件 </summary>              <div class='content'>              <p>eslint-plugin-vue  &amp; vite-plugin-eslint</p><p><code>vite-plugin-eslint</code> 和 <code>eslint-plugin-vue</code> 是两个与 ESLint 相关的插件，分别用于 Vite 项目和 Vue 项目的代码质量检查。</p><p>vite-plugin-eslint</p><ul><li><p><strong>作用</strong>: 这个插件将 ESLint 集成到 Vite 构建过程中。它可以在开发时自动检查你的代码，并在代码出现问题时给出即时反馈。</p></li><li><p>功能</p><p>:</p><ul><li>实时 lint：在开发过程中，当你修改代码时，插件会即时运行 ESLint 检查，并在控制台中显示错误和警告。</li><li>自定义 ESLint 配置：支持使用自定义的 ESLint 配置文件，可以根据项目需求进行灵活设置。</li><li>适配 Vite 的开发环境，提升开发效率。</li></ul></li></ul><p>eslint-plugin-vue</p><ul><li><p><strong>作用</strong>: 这是一个专门为 Vue.js 提供的 ESLint 插件，提供 Vue 相关的 lint 规则。</p></li><li><p>功能</p><p>:</p><ul><li>Vue 特有的规则：包括模板语法、组件定义、指令使用等方面的 lint 规则，帮助开发者遵循最佳实践。</li><li>支持 Vue 3：适配 Vue 3 的新特性，确保代码符合最新的 Vue 开发标准。</li><li>提高代码可读性和可维护性，减少潜在的错误。</li></ul></li></ul><p>总结</p><ul><li><p><code>vite-plugin-eslint</code> 是用于将 ESLint 集成到 Vite 开发流程中的插件，确保在开发过程中实时检查代码质量。</p></li><li><p><code>eslint-plugin-vue</code> 则是专门针对 Vue.js 的 lint 规则插件，帮助开发者编写符合 Vue 最佳实践的代码。两者结合使用，可以有效提升 Vue 项目的代码质量和开发体验。</p></li></ul><p><code>vite-plugin-eslint</code> 和 <code>eslint-plugin-vue</code> 之间并不冲突，它们实际上是互补的工具，可以一起使用，以实现更好的代码质量管理。</p><p>关系与互补性</p><ul><li><strong>vite-plugin-eslint</strong>: 负责将 ESLint 集成到 Vite 项目中，提供实时的代码检查反馈。它会在开发过程中自动运行 ESLint。</li><li><strong>eslint-plugin-vue</strong>: 提供专门针对 Vue 组件的 lint 规则。这个插件需要在 ESLint 的配置文件中进行设置，以确保你的 Vue 代码符合特定的规范。</li></ul><p>使用建议</p><ol><li><strong>一起使用</strong>: 在 Vite 项目中使用 <code>vite-plugin-eslint</code> 来实时检查代码，同时在 ESLint 配置中引入 <code>eslint-plugin-vue</code>，以确保 Vue 组件代码符合最佳实践。</li><li><strong>配置 ESLint</strong>: 确保 ESLint 配置中包含 <code>eslint-plugin-vue</code>，并按照项目需求启用或禁用特定规则。</li><li><strong>避免重复检查</strong>: 如果在 Vite 配置中使用了 <code>vite-plugin-eslint</code>，不需要在构建时重复运行 ESLint，除非你有特定需求。</li></ol><p>总的来说，合理配置这两个插件将有助于提升你的开发体验和代码质量，不会导致冲突。</p>              </div>            </details></p><p>解决步骤：</p><p>检查现有规则：首先，检查你的 .eslintrc.json 文件中是否已经存在与 ESLint Stylistic 规则冲突的配置。</p><p>禁用冲突规则：如果发现冲突规则，可以在配置文件中禁用这些规则。例如，如果你已经配置了 indent 规则，可以禁用它：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;rules&quot;: &#123;</span><br><span class="line">    &quot;indent&quot;: &quot;off&quot;,</span><br><span class="line">    &quot;@stylistic/indent&quot;: [&quot;error&quot;, 2]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>逐步应用规则：建议逐步应用 ESLint Stylistic 的规则，避免一次性引入过多规则导致冲突。</p><p>自定义规则问题 - 新手可能希望自定义 ESLint Stylistic 的规则，但不知道如何正确配置。</p><p>解决步骤：</p><p>了解规则配置：首先，阅读 ESLint Stylistic 的官方文档，了解每个规则的配置选项。</p><p>自定义规则：在 .eslintrc.json 文件中，根据文档中的说明自定义规则。</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;rules&quot;</span>: &#123;</span><br><span class="line">  <span class="comment">// 例如，如果你想自定义缩进规则：</span></span><br><span class="line">    <span class="string">&quot;@stylistic/indent&quot;</span>: [<span class="string">&quot;error&quot;</span>, <span class="number">4</span>],</span><br><span class="line">    <span class="comment">// 例如, 去掉末尾逗号需要这样设置</span></span><br><span class="line">    <span class="string">&#x27;@stylistic/comma-dangle&#x27;</span>: [<span class="string">&#x27;error&#x27;</span>, <span class="string">&#x27;never&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 同时, 需要注意的是, prettier 内置了一些规则, 即使不配置任何prettier, 也会生效</span></span><br><span class="line">    <span class="comment">// 因此, 需要想要实现末尾去掉逗号, 需要在 prettier 里进行自主设置</span></span><br><span class="line">    <span class="attr">trailingComma</span>: <span class="string">&#x27;none&#x27;</span>, <span class="comment">// 不加对象|数组最后逗号</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>测试配置：在应用自定义规则后，运行 ESLint 检查代码，确保配置正确无误。</p><p>通过以上步骤，新手可以更好地理解和使用 ESLint Stylistic 项目，避免常见问题。<br>————————————————</p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><div class="tag link"><a class="link-card" title="ESLint Stylistic 项目常见问题解决方案" href="https://blog.csdn.net/gitblog_01286/article/details/143048511"><div class="left"><img src="https://profile-avatar.csdnimg.cn/default.jpg!1"/></div><div class="right"><p class="text">ESLint Stylistic 项目常见问题解决方案</p><p class="url">https://blog.csdn.net/gitblog_01286/article/details/143048511</p></div></a></div>              </div>            </details><h2 id="vueuse-工具集-amp-pinia-独立维护-amp-vant-3"><a href="#vueuse-工具集-amp-pinia-独立维护-amp-vant-3" class="headerlink" title="vueuse 工具集 &amp; pinia 独立维护 &amp; vant 3"></a>vueuse 工具集 &amp; pinia 独立维护 &amp; vant 3</h2><details class="folding-tag" ><summary> 开发环境初始化 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">vueuse</button><button type="button" class="tab"><i class="fas fa-bomb"></i>vant3</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>VueUse 是基于 <a href="https://vuejs.org/guide/extras/composition-api-faq.html">组合式 API</a> 的实用函数集合。</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 安装</span><br><span class="line">pnpm i @vueuse/core --save</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p><strong>Vant 3UI：轻量的移动端组件库</strong></p><p>在基于 Rsbuild、Vite、webpack 或 vue-cli 的项目中使用 Vant 时，可以使用 <a href="https://github.com/unplugin/unplugin-vue-components">unplugin-vue-components</a> 插件，它可以自动引入组件。</p><p>Vant 官方基于 <code>unplugin-vue-components</code> 提供了自动导入样式的解析器 <a href="https://github.com/youzan/vant/tree/main/packages/vant-auto-import-resolver">@vant/auto-import-resolver</a>，两者可以配合使用。</p><p>相比于常规用法，这种方式可以按需引入组件的 CSS 样式，从而减少一部分代码体积，但使用起来会变得繁琐一些。如果业务对 CSS 的体积要求不是特别极致，我们推荐使用更简便的常规用法。</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 当然是先安装好</span></span><br><span class="line">pnpm i vant --save</span><br><span class="line"></span><br><span class="line"><span class="comment">// 按需引入组件样式</span></span><br><span class="line"># 通过 pnpm 安装</span><br><span class="line">pnpm add @vant/auto-<span class="keyword">import</span>-resolver unplugin-vue-components unplugin-auto-<span class="keyword">import</span> -D</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><h2 id="请求拦截器"><a href="#请求拦截器" class="headerlink" title="请求拦截器"></a>请求拦截器</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <ol><li><p>src目录下创建utils/request.ts</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; showToast &#125; <span class="keyword">from</span> <span class="string">&#x27;vant&#x27;</span></span><br><span class="line"><span class="keyword">const</span> baseURL = <span class="string">&#x27;/api&#x27;</span></span><br><span class="line"><span class="keyword">const</span> service = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  baseURL,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">10000</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 发起请求之前的拦截器</span></span><br><span class="line">service.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> token = <span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (token) &#123;</span><br><span class="line">      <span class="comment">// config.headers = &#123;</span></span><br><span class="line">      <span class="comment">//   &#x27;x-access-token&#x27;: token</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">      <span class="comment">// 直接在 headers 对象上添加属性</span></span><br><span class="line">      config.<span class="property">headers</span>[<span class="string">&#x27;x-access-token&#x27;</span>] = token</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="params">error</span> =&gt;</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">)</span><br><span class="line"><span class="comment">// 响应拦截器</span></span><br><span class="line">service.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> res = response.<span class="property">data</span></span><br><span class="line">    <span class="keyword">if</span> (response.<span class="property">status</span> !== <span class="number">200</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(res.<span class="property">success</span> || <span class="string">&#x27;Error&#x27;</span>))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (res.<span class="property">code</span> == <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="property">result</span> || res.<span class="property">data</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">showToast</span>(res.<span class="property">message</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出后在 api 文件中引入</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> service</span><br></pre></td></tr></table></figure></li></ol>              </div>            </details><h2 id="快速创建文件结构-路由规则"><a href="#快速创建文件结构-路由规则" class="headerlink" title="快速创建文件结构-路由规则"></a>快速创建文件结构-路由规则</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">项目页面结构&自动配置路由 - 两款插件对比</button><button type="button" class="tab">使用代码快速创建</button><button type="button" class="tab"><i class="fas fa-bomb"></i>快速配置路由规则</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>项目页面结构</strong></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">views</span><br><span class="line">  login</span><br><span class="line">    index.<span class="property">vue</span>                    <span class="comment">// 登录页</span></span><br><span class="line">    serviceAgree.<span class="property">vue</span>             <span class="comment">// 服务协议</span></span><br><span class="line">    privatePolicy.<span class="property">vue</span>            <span class="comment">// 隐私政策</span></span><br><span class="line">  task</span><br><span class="line">    index.<span class="property">vue</span>                    <span class="comment">// 任务主页</span></span><br><span class="line">    search.<span class="property">vue</span>                   <span class="comment">// 任务搜索</span></span><br><span class="line">    details.<span class="property">vue</span>                  <span class="comment">// 任务详情</span></span><br><span class="line">    cpmpanySource.<span class="property">vue</span>            <span class="comment">// 公司任务主页</span></span><br><span class="line">  contract                       </span><br><span class="line">    index.<span class="property">vue</span>                    <span class="comment">// 合约主页</span></span><br><span class="line">    details.<span class="property">vue</span>                  <span class="comment">// 合约详情</span></span><br><span class="line">    progress.<span class="property">vue</span>                 <span class="comment">// 合约进度</span></span><br><span class="line">  message</span><br><span class="line">    index.<span class="property">vue</span>                    <span class="comment">// 消息主页 </span></span><br><span class="line">    systemList.<span class="property">vue</span>               <span class="comment">// 消息列表</span></span><br><span class="line">    systemDetails.<span class="property">vue</span>            <span class="comment">// 消息详情</span></span><br><span class="line">    talk.<span class="property">vue</span>                     <span class="comment">// 对话</span></span><br><span class="line">  my</span><br><span class="line">    index.<span class="property">vue</span>                    <span class="comment">// 我的主页</span></span><br><span class="line">    user                         <span class="comment">// 用户中心</span></span><br><span class="line">      index.<span class="property">vue</span>                  <span class="comment">// 个人信息</span></span><br><span class="line">      autheReal.<span class="property">vue</span>              <span class="comment">// 实名认证</span></span><br><span class="line">      certifeild.<span class="property">vue</span>             <span class="comment">// 已完成实名认证</span></span><br><span class="line">      identitySwitch.<span class="property">vue</span>         <span class="comment">// 切换身份</span></span><br><span class="line">    set                          <span class="comment">// 我的设置</span></span><br><span class="line">      index.<span class="property">vue</span>                  <span class="comment">// 设置页</span></span><br><span class="line">    feedback                     <span class="comment">// 意见反馈</span></span><br><span class="line">      index.<span class="property">vue</span>                  <span class="comment">// 反馈主页</span></span><br><span class="line">    account                      <span class="comment">// 账户</span></span><br><span class="line">      index.<span class="property">vue</span>                  <span class="comment">// 账户主页</span></span><br><span class="line">      advance.<span class="property">vue</span>                <span class="comment">// 账户提现</span></span><br><span class="line">      coinExplain.<span class="property">vue</span>            <span class="comment">// 无忧币说明</span></span><br><span class="line">      depositExplain.<span class="property">vue</span>         <span class="comment">// 押金说明</span></span><br><span class="line">    resume                       <span class="comment">// 我的简历</span></span><br><span class="line">      index.<span class="property">vue</span>                  <span class="comment">// 简历主页</span></span><br><span class="line">      preview.<span class="property">vue</span>                <span class="comment">// 简历预览</span></span><br><span class="line">    collect                      <span class="comment">// 收藏</span></span><br><span class="line">      index.<span class="property">vue</span>                  <span class="comment">// 收藏主页</span></span><br><span class="line">  talent                         <span class="comment">// 人才主页</span></span><br><span class="line">    index.<span class="property">vue</span>                    <span class="comment">// 人才详情</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 先创建文件夹</span></span><br><span class="line">mkdir -p src/views/&#123;login,task,contract,message,my/user,my/set,my/feedback,my/account,my/resume,my/collect,talent&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 然后按照文件夹, 一一创建具体文件</span></span><br><span class="line"><span class="comment">// 最佳实践: 使用 PascalCase - 首字母大写的驼峰命名，而非首字母小写。这不仅符合 Vue 官方的推荐，也有助于代码一致性和可读性，尤其在大型项目和协作开发中。</span></span><br><span class="line"></span><br><span class="line"># 创建 login 模块文件</span><br><span class="line">touch src/views/login/&#123;index.<span class="property">vue</span>,<span class="title class_">ServiceAgree</span>.<span class="property">vue</span>,<span class="title class_">PrivatePolicy</span>.<span class="property">vue</span>&#125;</span><br><span class="line"></span><br><span class="line"># 创建 task 模块文件</span><br><span class="line">touch src/views/task/&#123;index.<span class="property">vue</span>,<span class="title class_">TaskSearch</span>.<span class="property">vue</span>,<span class="title class_">TaskDetails</span>.<span class="property">vue</span>,<span class="title class_">TaskCpmpanySource</span>.<span class="property">vue</span>&#125;</span><br><span class="line"></span><br><span class="line"># 创建 contract 模块文件</span><br><span class="line">touch src/views/contract/&#123;index.<span class="property">vue</span>,<span class="title class_">ContractDetails</span>.<span class="property">vue</span>,<span class="title class_">ContractProgress</span>.<span class="property">vue</span>&#125;</span><br><span class="line"></span><br><span class="line"># 创建 message 模块文件</span><br><span class="line">touch src/views/message/&#123;index.<span class="property">vue</span>,<span class="title class_">SystemList</span>.<span class="property">vue</span>,<span class="title class_">SystemDetails</span>.<span class="property">vue</span>,<span class="title class_">MessageTalk</span>.<span class="property">vue</span>&#125;</span><br><span class="line"></span><br><span class="line"># 创建 my 模块文件</span><br><span class="line">touch src/views/my/index.<span class="property">vue</span></span><br><span class="line">touch src/views/my/user/&#123;index.<span class="property">vue</span>,<span class="title class_">AutheReal</span>.<span class="property">vue</span>,<span class="title class_">CertiFeild</span>.<span class="property">vue</span>,<span class="title class_">IdentitySwitch</span>.<span class="property">vue</span>&#125;</span><br><span class="line">touch src/views/my/set/index.<span class="property">vue</span></span><br><span class="line">touch src/views/my/feedback/index.<span class="property">vue</span></span><br><span class="line">touch src/views/my/account/&#123;index.<span class="property">vue</span>,<span class="title class_">AcountAdvance</span>.<span class="property">vue</span>,<span class="title class_">CoinExplain</span>.<span class="property">vue</span>,<span class="title class_">DepositExplain</span>.<span class="property">vue</span>&#125;</span><br><span class="line">touch src/views/my/resume/&#123;index.<span class="property">vue</span>,<span class="title class_">ResumePreview</span>.<span class="property">vue</span>&#125;</span><br><span class="line">touch src/views/my/collect/index.<span class="property">vue</span></span><br><span class="line"></span><br><span class="line"># 创建 talent 模块文件</span><br><span class="line">touch src/views/talent/index.<span class="property">vue</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// vue-router 当然是先安装一下</span><br><span class="line">pnpm vue-router</span><br></pre></td></tr></table></figure><p><strong>两款插件</strong></p><details class="folding-tag" ><summary> vite-plugin-pages 404页面的手动配置&动态路由 </summary>              <div class='content'>              <p><strong>404路由配置</strong></p><p><code>vite-plugin-pages</code> 插件在自动生成路由时，并不会直接处理 404 页面。若要添加 404 页面支持，需结合 <code>vue-router</code> 的一些配置。以下是详细步骤来设置 404 页面。</p><ol><li>创建 404 页面组件</li></ol><p>在 <code>src/pages</code> 目录中创建 <code>404.vue</code> 文件，并编写 404 页面内容：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- src/pages/404.vue --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;not-found&quot;&gt;</span><br><span class="line">    &lt;h1&gt;404 - Page Not Found&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;The page you are looking for doesn’t exist.&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.not-found &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  padding: 2rem;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><ol><li>安装并配置 <code>vite-plugin-pages</code></li></ol><p>确保已安装 <code>vite-plugin-pages</code>，并配置 <code>vite.config.js</code>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pnpm install vite-plugin-pages -D</span><br></pre></td></tr></table></figure><p>在 <code>vite.config.js</code> 中导入插件并添加配置：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// vite.config.js</span><br><span class="line">import &#123; defineConfig &#125; from &#x27;vite&#x27;;</span><br><span class="line">import vue from &#x27;@vitejs/plugin-vue&#x27;;</span><br><span class="line">import Pages from &#x27;vite-plugin-pages&#x27;;</span><br><span class="line"></span><br><span class="line">export default defineConfig(&#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    vue(),</span><br><span class="line">    Pages(&#123;</span><br><span class="line">      // 使用默认配置即可，Pages 插件会自动读取 src/pages 下的 .vue 文件并生成路由</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ol><li>配置 <code>vue-router</code> 捕获所有未知路由</li></ol><p><code>vite-plugin-pages</code> 会自动生成 <code>routes</code> 配置，我们可以使用这些生成的路由，并手动添加 404 页面配置。在 <code>src/main.js</code> 或 <code>src/main.ts</code> 中完成以下设置：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/main.js 或 src/main.ts</span><br><span class="line">import &#123; createApp &#125; from &#x27;vue&#x27;;</span><br><span class="line">import App from &#x27;./App.vue&#x27;;</span><br><span class="line">import &#123; createRouter, createWebHistory &#125; from &#x27;vue-router&#x27;;</span><br><span class="line">import generatedRoutes from &#x27;virtual:generated-pages&#x27;;</span><br><span class="line"></span><br><span class="line">const routes = [</span><br><span class="line">  ...generatedRoutes,</span><br><span class="line">  // 添加 404 页面路由，捕获所有未知路径</span><br><span class="line">  &#123; path: &#x27;/:pathMatch(.*)*&#x27;, name: &#x27;NotFound&#x27;, component: () =&gt; import(&#x27;./pages/404.vue&#x27;) &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">const router = createRouter(&#123;</span><br><span class="line">  history: createWebHistory(),</span><br><span class="line">  routes,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const app = createApp(App);</span><br><span class="line">app.use(router);</span><br><span class="line">app.mount(&#x27;#app&#x27;);</span><br></pre></td></tr></table></figure><ol><li>可选配置：重定向到首页或其他页面</li></ol><p>如果希望未匹配的路径重定向到首页或其他页面，而不是显示 404 页面，可以将 <code>404.vue</code> 替换为首页或指定页面。例如：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const routes = [</span><br><span class="line">  ...generatedRoutes,</span><br><span class="line">  // 重定向到首页</span><br><span class="line">  &#123; path: &#x27;/:pathMatch(.*)*&#x27;, redirect: &#x27;/&#x27; &#125;</span><br><span class="line">];</span><br></pre></td></tr></table></figure><ol><li>可选配置：在生产环境中部署时处理 404</li></ol><p>如果使用 GitHub Pages、Netlify 等平台部署，静态网站通常会出现直接访问 404 页面 URL 时无法找到页面的情况。这时可以根据部署平台的不同，分别进行配置：</p><p><strong>Netlify</strong>：在根目录下创建 <code>_redirects</code> 文件，添加如下配置：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/*    /index.html   200</span><br></pre></td></tr></table></figure><p><strong>Vercel</strong>：Vercel 自动支持单页应用，默认不需要额外配置。</p><p><strong>GitHub Pages</strong>：在 <code>404.html</code> 中添加 JavaScript 重定向代码：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">  window.location.href = &#x27;/#&#x27; + window.location.pathname;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><strong>总结</strong></p><p>配置 404 页面时需完成以下步骤：</p><ol><li>创建 <code>404.vue</code> 页面。</li><li>使用 <code>vite-plugin-pages</code> 自动生成路由。</li><li>在 <code>vue-router</code> 中手动添加通配符路由 <code>/:pathMatch(.*)*</code> 指向 <code>404.vue</code> 组件。</li><li>（可选）根据部署平台的需求配置生产环境的 404 页面处理。</li></ol><p>动态路由</p><p>动态路由参数</p><p>如果你需要接收动态参数，如 <code>things_id</code> 和 <code>receive_id</code>，你需要确保你的文件名包含正确的参数名称，例如：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">src/pages/</span><br><span class="line">  message/</span><br><span class="line">    MessageTalk/</span><br><span class="line">      [things_id].vue</span><br><span class="line">      [receive_id].vue</span><br></pre></td></tr></table></figure><p>或者使用 <code>MessageTalk.vue</code> 文件的嵌套路由：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">src/pages/</span><br><span class="line">  message/</span><br><span class="line">    [things_id]/</span><br><span class="line">      [receive_id].vue</span><br></pre></td></tr></table></figure><p><code>vite-plugin-pages</code> 会自动解析这些动态参数并将它们映射到路由中。</p>              </div>            </details><p><code>unplugin-vue-router</code> 和 <code>vite-plugin-pages</code> 都是为 Vue 开发的文件系统路由插件，主要用于简化路由配置。但它们在特性和实现方式上有所不同。以下是两者的简要对比：</p><p><code>vite-plugin-pages vs unplugin-vue-router</code></p><details class="folding-tag" ><summary> 最好还是使用后者，因为... </summary>              <div class='content'>              <p>可以直接在页面中使用 <code>definePage</code> 来定义 <code>meta</code>，并且 <strong>不会</strong> 报错，因为 <code>unplugin-vue-router</code> 提供了类型支持和自动引入 <code>definePage</code> 的功能。正确配置后，<code>definePage</code> 会在页面中自动识别，无需额外导入。以下是确保配置无误的步骤：</p><ol><li>确保 <code>vite.config.ts</code> 配置了 <code>unplugin-vue-router</code></li></ol><p>在 <code>vite.config.ts</code> 中确保插件已经正确配置，通常设置如下：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// vite.config.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">VueRouter</span> <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-router/vite&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title class_">VueRouter</span>(&#123; <span class="comment">/* 配置项，可选 */</span> &#125;),</span><br><span class="line">    <span class="title function_">vue</span>()</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol><li>添加 <code>unplugin-vue-router</code> 的自动生成文件</li></ol><p><code>unplugin-vue-router</code> 会自动生成路由文件，并包含类型声明。添加好插件后，首次启动项目时它会生成类型声明文件。这些文件通常位于 <code>src/typed-router.d.ts</code> 中，可以提供完整的路由类型支持。</p><ol><li>在页面组件中使用 <code>definePage</code> 定义 <code>meta</code></li></ol><p>成功配置后，<code>definePage</code> 函数会在页面组件中自动识别，你可以直接定义 <code>meta</code>，例如：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/pages/Home.vue</span></span><br><span class="line">&lt;script setup lang=<span class="string">&quot;ts&quot;</span>&gt;</span><br><span class="line"><span class="title function_">definePage</span>(&#123;</span><br><span class="line">  <span class="attr">meta</span>: &#123;</span><br><span class="line">    <span class="attr">showTabBar</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>首页内容<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ol><li>验证和使用 <code>meta</code> 信息</li></ol><p>在主布局或根组件中，可以通过 <code>route.meta.showTabBar</code> 访问并根据需要使用 <code>meta</code> 信息。例如：</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">&lt;!-- <span class="title class_">App</span>.<span class="property">vue</span> --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">router-view</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">TabBar</span> <span class="attr">v-if</span>=<span class="string">&quot;$route.meta.showTabBar !== false&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">TabBar</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/TabBar.vue&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>这样配置后，<code>definePage</code> 应该不会报错，<code>meta</code> 信息也可以直接在页面中定义并在组件中读取，实现动态显示组件的功能。</p>              </div>            </details><p>方法：通过 <code>meta</code> 字段配置路由</p><p><code>vite-plugin-pages</code> 本身并不直接支持 <code>definePageMeta</code>，这个 API 是 <code>Nuxt.js</code> 的功能，而在 Vue 3 项目中并没有官方直接的 <code>definePageMeta</code> 功能。因此，以下是实现类似效果的替代方法：</p><details class="folding-tag" ><summary> vite-plugin-pages - 可尝试通过 meta 字段配置路由 </summary>              <div class='content'>              <p>使用 <code>vite-plugin-pages</code> 时，可以在 <code>vite.config.ts</code> 文件中对路由进行扩展，设置 <code>meta</code> 字段，用于单个页面的额外配置。</p><p> 步骤 1：配置 <code>vite-plugin-pages</code> 添加 <code>meta</code></p><p>在 <code>vite.config.ts</code> 中，通过 <code>extendRoute</code> 为指定页面添加 <code>meta</code> 字段：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// vite.config.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Pages</span> <span class="keyword">from</span> <span class="string">&#x27;vite-plugin-pages&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title function_">vue</span>(),</span><br><span class="line">    <span class="title class_">Pages</span>(&#123;</span><br><span class="line">      <span class="title function_">extendRoute</span>(<span class="params">route</span>) &#123;</span><br><span class="line">        <span class="comment">// 比如为 login 页面设置特定的 meta</span></span><br><span class="line">        <span class="keyword">if</span> (route.<span class="property">name</span> === <span class="string">&#x27;login&#x27;</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> &#123;</span><br><span class="line">            ...route,</span><br><span class="line">            <span class="attr">meta</span>: &#123; <span class="attr">showTabBar</span>: <span class="literal">false</span> &#125; <span class="comment">// 自定义 meta 数据</span></span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 可以为其他页面单独设置不同的 meta 配置</span></span><br><span class="line">        <span class="keyword">return</span> route;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>步骤 2：在页面组件中读取 <code>meta</code> 信息</p><p>在页面组件中使用 <code>useRoute</code> 读取路由 <code>meta</code> 信息：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/pages/YourPage.vue</span></span><br><span class="line">&lt;script setup lang=<span class="string">&quot;ts&quot;</span>&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; useRoute &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> route = <span class="title function_">useRoute</span>();</span><br><span class="line"><span class="comment">// 使用 meta 配置</span></span><br><span class="line"><span class="keyword">const</span> showTabBar = route.<span class="property">meta</span>.<span class="property">showTabBar</span> !== <span class="literal">false</span>;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>页面内容<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 根据 showTabBar 动态控制 TabBar 显示 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">TabBar</span> <span class="attr">v-if</span>=<span class="string">&quot;showTabBar&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>注意事项</p><ol><li>如果需要在多个页面中复用 <code>meta</code> 字段，可在 <code>extendRoute</code> 中批量设置条件。</li><li>此方法兼容 Vue 3 的组合式 API，并与 <code>vite-plugin-pages</code> 配置无冲突。</li></ol>              </div>            </details><ol><li>功能对比</li></ol><div class="table-container"><table><thead><tr><th>特性</th><th>vite-plugin-pages</th><th>unplugin-vue-router</th></tr></thead><tbody><tr><td><strong>路由自动化</strong></td><td>根据文件系统自动生成路由</td><td>根据文件系统自动生成路由</td></tr><tr><td><strong>文件名映射</strong></td><td>支持文件名到路由的直接映射</td><td>支持文件名到路由的直接映射</td></tr><tr><td><strong>动态路由支持</strong></td><td>支持动态路由命名（如 <code>[id].vue</code>）</td><td>支持动态路由命名（如 <code>[id].vue</code>）</td></tr><tr><td><strong>嵌套路由</strong></td><td>支持基于目录结构的嵌套路由</td><td>支持基于目录结构的嵌套路由</td></tr><tr><td><strong>404 页面支持</strong></td><td>需要手动配置 404 页面</td><td>可自动处理 404 页面</td></tr><tr><td><strong>全局导航守卫</strong></td><td>不支持</td><td>支持全局导航守卫</td></tr><tr><td><strong>懒加载支持</strong></td><td>自动支持懒加载</td><td>自动支持懒加载</td></tr><tr><td><strong>TypeScript 支持</strong></td><td>原生支持，需配置类型声明</td><td>原生支持，需配置类型声明</td></tr><tr><td><strong>构建时路由生成</strong></td><td>构建时生成路由，支持虚拟模块</td><td>构建时生成路由，支持虚拟模块</td></tr></tbody></table></div><ol><li>使用场景</li></ol><div class="table-container"><table><thead><tr><th>场景</th><th>适合的插件</th></tr></thead><tbody><tr><td><strong>小型项目</strong></td><td>vite-plugin-pages</td></tr><tr><td><strong>快速开发与原型设计</strong></td><td>vite-plugin-pages</td></tr><tr><td><strong>简单的路由管理</strong></td><td>vite-plugin-pages</td></tr><tr><td><strong>复杂的路由需求</strong></td><td>unplugin-vue-router</td></tr><tr><td><strong>需要权限管理和导航守卫</strong></td><td>unplugin-vue-router</td></tr><tr><td><strong>大型项目</strong></td><td>unplugin-vue-router</td></tr><tr><td><strong>高级路由配置</strong></td><td>unplugin-vue-router</td></tr></tbody></table></div><ol><li>优缺点</li></ol><p>vite-plugin-pages</p><p><strong>优点</strong>：</p><ul><li><strong>快速上手</strong>：可以快速生成路由配置，节省时间。</li><li><strong>减少冗余</strong>：不需要手动维护路由数组，文件结构直接映射路由。</li><li><strong>易于维护</strong>：通过修改文件名和结构来轻松管理路由。</li></ul><p><strong>缺点</strong>：</p><ul><li><strong>灵活性有限</strong>：对于复杂需求，可能需要手动调整。</li><li><strong>不支持所有高级功能</strong>：如全局导航守卫等功能需额外实现。</li></ul><p>unplugin-vue-router</p><p><strong>优点</strong>：</p><ul><li><strong>灵活性高</strong>：支持多种复杂路由配置，包括嵌套路由、命名路由、动态路由等。</li><li><strong>强大的功能</strong>：支持全局导航守卫、懒加载等高级功能。</li><li><strong>广泛使用</strong>：作为广泛支持的插件，文档和社区支持丰富。</li></ul><p><strong>缺点</strong>：</p><ul><li><strong>配置复杂</strong>：对于初学者，路由配置可能较为繁琐。</li><li><strong>手动维护</strong>：需要手动维护路由数组，增加了工作量。</li></ul><ol><li>集成方式</li></ol><p><code>vite-plugin-pages &amp; unplugin-vue-router</code></p><ol><li><p><strong>安装插件</strong>：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">// vite-plugin-pages</span><br><span class="line">pnpm install vite-plugin-pages -D</span><br><span class="line"></span><br><span class="line">// unplugin-vue-router</span><br><span class="line">pnpm install unplugin-vue-router -D</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p><strong>配置 vite.config.js</strong>：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// vite-plugin-pages</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Pages</span> <span class="keyword">from</span> <span class="string">&#x27;vite-plugin-pages&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title function_">vue</span>(),</span><br><span class="line">    <span class="title class_">Pages</span>(&#123;</span><br><span class="line">      <span class="comment">// 指定路由文件的目录</span></span><br><span class="line">      <span class="attr">dirs</span>: <span class="string">&#x27;src/views&#x27;</span>,</span><br><span class="line">      <span class="comment">// 可以自定义路由生成规则</span></span><br><span class="line">      <span class="attr">extensions</span>: [<span class="string">&#x27;vue&#x27;</span>], <span class="comment">// 仅识别 .vue 文件</span></span><br><span class="line">      <span class="attr">exclude</span>: [<span class="string">&#x27;**/components/**&#x27;</span>] <span class="comment">// 排除特定目录</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// unplugin-vue-router </span></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UnpluginVueRouter</span> <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-router/vite&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title function_">vue</span>(),</span><br><span class="line">    <span class="title class_">UnpluginVueRouter</span>(&#123;</span><br><span class="line">      <span class="attr">routesFolder</span>: <span class="string">&#x27;src/pages&#x27;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol><ol><li><p>使用</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// vite-plugin-pages</span></span><br><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> generatedRoutes <span class="keyword">from</span> <span class="string">&#x27;virtual:generated-pages&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(),</span><br><span class="line">  <span class="attr">routes</span>: generatedRoutes,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// unplugin-vue-router</span></span><br><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; routes &#125; <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-router&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(),</span><br><span class="line">  routes,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><h2 id="接受路由参数的三种方式"><a href="#接受路由参数的三种方式" class="headerlink" title="接受路由参数的三种方式"></a>接受路由参数的三种方式</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p><strong>最佳实践中，使用 <code>useRoute</code></strong></p><p>为什么推荐 <code>useRoute</code>？</p><ul><li><strong>语义化</strong>：<code>useRoute</code> 是 Vue 3 提供的组合式 API，它直接说明你是在获取当前路由的参数。使用 <code>useRoute</code> 可以让代码更具可读性和可维护性。</li><li><strong>响应式</strong>：<code>useRoute</code> 返回的是一个响应式对象，当路由参数发生变化时，组件会自动重新渲染，这对于动态路由特别有用。</li><li><strong>简洁</strong>：在组件内部，直接使用 <code>useRoute</code> 获取路由参数是最简洁的方式。</li></ul><p>假设 <code>receive_id.vue</code> 组件位于路径 <code>/message/:things_id/:receive_id</code> 下，可以在组件中按如下方式获取动态路由参数：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; useRoute &#125; from &#x27;vue-router&#x27;;</span><br><span class="line"></span><br><span class="line">// 获取当前路由对象</span><br><span class="line">const route = useRoute();</span><br><span class="line"></span><br><span class="line">// 获取路由参数</span><br><span class="line">const things_id = route.params.things_id;</span><br><span class="line">const receive_id = route.params.receive_id;</span><br><span class="line">// 在 Vue 3 中，useRoute 是一个非常常用的工具</span><br><span class="line">// 允许你访问路由的所有相关信息（如路径、查询参数、动态参数等）。</span><br><span class="line">// route.params 包含了当前路由的动态参数。在路由路径中使用的 :things_id 和 :receive_id 会自动出现在 route.params 中。</span><br><span class="line"></span><br><span class="line">console.log(things_id, receive_id);  // 打印路由参数</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;Things ID: &#123;&#123; things_id &#125;&#125;&lt;/h1&gt;</span><br><span class="line">    &lt;h2&gt;Receive ID: &#123;&#123; receive_id &#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p><strong>router.currentRoute.value 获取动态路由参数</strong></p><p>虽然 <code>router.currentRoute.value</code> 也可以用来获取动态路由参数，但它的使用场景相对较少。通常这种方式更多见于非组件上下文，或者你需要对路由做更细致的控制时（比如在 Vuex、全局状态管理等地方访问路由信息）。</p><p> 示例代码：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script setup lang=<span class="string">&quot;ts&quot;</span>&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; router &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router&#x27;</span>; <span class="comment">// 导入 router 实例</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取动态参数 id</span></span><br><span class="line"><span class="keyword">const</span> id = router.<span class="property">currentRoute</span>.<span class="property">value</span>.<span class="property">params</span>.<span class="property">id</span>; </span><br><span class="line"># params.<span class="property">id</span> 中的这个id 需要与具体文件结构一致、完全吻合</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;当前 ID:&#x27;</span>, id);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p> 使用场景：</p><ul><li>如果你需要手动访问路由实例，或者在非组件环境（如 Vuex、服务模块等）中获取路由参数时，<code>router.currentRoute.value</code> 会更适用。</li><li>需要直接操作或获取路由实例的情况下，适合使用这种方式。</li></ul><p>defineProps 也可以获取路由参数</p><p><code>defineProps</code> 主要用于从父组件获取数据或 props，而 <strong>vite-plugin-pages</strong> 会将动态路由参数自动作为 props 传递给组件。如果你通过 <code>vite-plugin-pages</code> 的自动路由系统来配置路由，并且路由参数会自动作为 props 传递给组件，那么你可以直接使用 <code>defineProps</code> 来获取。</p><p>根据项目实践，如果使用了 vite-plugin-pages 插件，不使用 defineProps 接受路由参数的话，控制台会给与相应提示！</p><p>示例代码：</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> &#123; id &#125; = defineProps&lt;&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">id</span>: string;</span></span><br><span class="line"><span class="language-javascript">&#125;&gt;();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;当前 ID:&#x27;</span>, id);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>使用场景：</p><ul><li>这种方式只适用于 <code>vite-plugin-pages</code> 等插件自动处理的场景。</li><li>如果路由参数会自动作为组件的 props 传递，那么使用 <code>defineProps</code> 是最简洁的方式。</li><li>不适合动态路由和非插件自动处理的情况。</li></ul>              </div>            </details><h2 id="组件封装-实用技巧"><a href="#组件封装-实用技巧" class="headerlink" title="组件封装 - 实用技巧"></a>组件封装 - 实用技巧</h2><details class="folding-tag" ><summary> 这里需要区分，有些组件例如 tabbar，需要写在项目根组件当中 </summary>              <div class='content'>              <p>否则，在 vant ui 框架中，会导致内部调用起冲突</p><p>另外，如果需要，可在 app.vue 根组件中，针对 tabbar 加上一个条件判断，例如：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;RouterView /&gt;</span><br><span class="line">  // 这样，就可以排除不需要tabbar组件的页面</span><br><span class="line">  &lt;FooterTabbar v-if=&quot;$route.path !== &#x27;/login&#x27;&quot;&gt;&lt;/FooterTabbar&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">组件的自动导入</button><button type="button" class="tab">Vue VSCode Snippets</button><button type="button" class="tab"><i class="fas fa-bomb"></i>炸弹</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>配置</strong></p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 自动导入配置  settings.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;workbench.settings.applyToAllProfiles&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;less.compile&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;out&quot;</span><span class="punctuation">:</span> <span class="string">&quot;css/&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;window.zoomLevel&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;workbench.iconTheme&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vscode-icons&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;vsicons.dontShowNewVersionMessage&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;security.allowedUNCHosts&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;iostation&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// 当保存的时候, eslint自动帮我们修复错误</span></span><br><span class="line">  <span class="attr">&quot;editor.codeActionsOnSave&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;source.fixAll&quot;</span><span class="punctuation">:</span> <span class="string">&quot;explicit&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;explorer.confirmDragAndDrop&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// 关闭保存自动格式化</span></span><br><span class="line">  <span class="attr">&quot;editor.formatOnSave&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span> <span class="comment">// eslint 配置好了以后, 改为false 防止冲突</span></span><br><span class="line">  <span class="attr">&quot;editor.tabSize&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;javascript.format.semicolons&quot;</span><span class="punctuation">:</span> <span class="string">&quot;remove&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;terminal.integrated.defaultProfile.windows&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Command Prompt&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;security.workspace.trust.untrustedFiles&quot;</span><span class="punctuation">:</span> <span class="string">&quot;open&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;editor.tabCompletion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;on&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;editor.fontLigatures&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;files.associations&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;*.vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;emmet.triggerExpansionOnTab&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;[vue]&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// &quot;editor.defaultFormatter&quot;: &quot;octref.vetur&quot; // 定义一个默认格式化程序</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;vetur.format.defaultFormatterOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;prettier&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;semi&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;singleQuote&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;explorer.compactFolders&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;notebook.compactView&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;vsicons.projectDetection.autoReload&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// 自动导入设置</span></span><br><span class="line">  <span class="attr">&quot;typescript.preferences.importModuleSpecifier&quot;</span><span class="punctuation">:</span> <span class="string">&quot;shortest&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;typescript.suggest.autoImports&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;javascript.suggest.autoImports&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p><strong>Vue VSCode Snippets</strong> 是一个 Visual Studio Code 插件，提供了一组 Vue.js 的代码片段，能够帮助开发者快速编写 Vue 组件和其他常用代码结构。这个插件非常有助于提高开发效率，特别是在使用 Vue 3 的项目中。</p></div><div class="tab-item-content"><p><strong>名字+icon</strong></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><h2 id="api-请求前的类型声明"><a href="#api-请求前的类型声明" class="headerlink" title="api 请求前的类型声明"></a>api 请求前的类型声明</h2><details class="folding-tag" ><summary> 点击查看步骤和技巧 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">interface & functions</button><button type="button" class="tab">返回数据类型按需声明</button><button type="button" class="tab"><i class="fas fa-bomb"></i>类型推断</button></div><div class="tab-contents"><div class="tab-item-content active"><details class="folding-tag" ><summary> 基本概念 - 如果一个东西长得想鸭子，可以像鸭子一样嘎嘎叫，那就认为它是鸭子 </summary>              <div class='content'>              <figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// interface </span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="keyword">readonly</span> <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  age?: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">viking</span>: <span class="title class_">Person</span> = &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;viking&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数参数和约定返回值类型声明</span></span><br><span class="line"><span class="keyword">const</span> add = (<span class="attr">x</span>: <span class="built_in">number</span>, <span class="attr">y</span>: <span class="built_in">number</span>, z?: <span class="built_in">number</span>): <span class="function"><span class="params">number</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> z === <span class="string">&#x27;number&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> x + y + z</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x + y</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ISum</span> &#123;</span><br><span class="line">  (<span class="attr">x</span>: <span class="built_in">number</span>, <span class="attr">y</span>: <span class="built_in">number</span>, z?: <span class="built_in">number</span>): <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">add2</span>: <span class="title class_">ISum</span> = add</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><p>步骤 1：定义请求参数的接口</p><p>​    首先，定义 API 请求参数的接口，以确保传入的参数符合要求。</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 请求参数类型定义</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">LoginData</span> &#123;</span><br><span class="line">  <span class="attr">accounts</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">code</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>步骤 2：定义 API 响应数据的接口</p><p>根据 API 返回的 JSON 结构定义接口，确保响应的数据类型安全：</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 返回参数的定义</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">UserInfo</span> &#123;</span><br><span class="line">  <span class="attr">role</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">birthday</span>: <span class="built_in">string</span> | <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">LoginResponse</span> &#123;</span><br><span class="line">  <span class="attr">errCode</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">msg</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">user_info</span>: <span class="title class_">UserInfo</span></span><br><span class="line">    <span class="attr">token</span>: <span class="built_in">string</span> <span class="comment">// 登录令牌</span></span><br><span class="line">    <span class="attr">expireTime</span>: <span class="built_in">number</span> <span class="comment">// 过期时间</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>步骤 3：封装 API 请求函数</p><p>在 Vue 项目中，通常使用 <code>axios</code> 发送请求。封装一个通用的请求方法，将参数和响应数据类型应用到请求中。</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">login</span>(<span class="params"><span class="attr">data</span>: <span class="title class_">LoginData</span></span>): <span class="title class_">Promise</span>&lt;<span class="title class_">LoginResponse</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>步骤 4：在 Vue 组件中使用 API 请求函数</p><p>在组件中调用该 API 函数时，使用 <code>async/await</code> 处理异步请求，并确保响应数据符合预期类型。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 根据数据的实际使用方式，ts 会倒过来自动推断 api 返回的数据类型，并给出声明建议</span><br></pre></td></tr></table></figure><p><strong>技巧：</strong></p><ol><li><strong>类型推导</strong>：尽量在 API 请求时显式定义接口，有助于类型推导，避免类型不匹配。</li><li><strong>分层设计</strong>：将 API 请求函数与业务逻辑分离，便于维护和测试。</li><li><strong>类型安全</strong>：使用接口描述请求参数和响应数据，确保数据符合预期。</li><li><strong>错误处理</strong>：在组件中进行错误捕获，以便向用户反馈错误信息。</li><li><strong>可选字段</strong>：对于返回结果中的非必需字段（如 <code>msg</code>），可用 <code>?</code> 标记为可选。</li></ol></div><div class="tab-item-content"><p><strong>即 - 部分类型定义</strong></p><p>允许只定义 <code>ApiResponse</code> 中需要的字段，而不必包含整个返回对象的所有字段。这种方式称为“部分类型定义”，它有助于简化代码，尤其在返回数据结构复杂的情况下。</p><p>但，虽不必包含返回对象的所有字段，但对于需要使用的返回数据，必须在 interface 中声明，如暂时无法确定其类型，可暂时将类型留空，将来在组件中根据实际的使用方法，ts 会自动未我们进行类型推断</p></div><div class="tab-item-content"><p><p><strong>ts编译器可以从上下文中推断出变量的结构和字段类型，它会根据你的使用模式自动推断出一个更准确的类型。</strong></p><br><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 例如，本项目中未在 /api/user.ts 中的 records</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">PolicyResponse</span> &#123;</span><br><span class="line">  # 返回的数据，必须在<span class="keyword">interface</span>中按需声明，否则在组件中会提示未声明类型</span><br><span class="line">  records // 未指定类型  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 协议文件接口</span><br><span class="line">export function getPolicy(data: &#123; <span class="attr">id</span>: <span class="built_in">number</span> &#125;): <span class="title class_">Promise</span>&lt;<span class="title class_">PolicyResponse</span>&gt; &#123; </span><br><span class="line">  # 使用：<span class="title class_">Promise</span>&lt;&gt;将声明的内容定义在函数体中 </span><br><span class="line">  # 如果直接使用 &lt;<span class="title class_">PolicyResponse</span>&gt; 而非 <span class="title class_">Promise</span>&lt;<span class="title class_">PolicyResponse</span>&gt;，则无法通过 <span class="keyword">await</span> 来控制数据加载的流程，可能导致数据未加载完成就尝试访问属性，从而引发错误。</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/policy_protocol/list&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">    <span class="attr">params</span>: data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><p>但是，在组件中，根据对返回数据的实际调用方式，ts 会帮我们推断出合适的类型声明</p><br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// /src/views/login/PrivatePolicy.vue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onClickLeft</span> = (<span class="params"></span>) =&gt; history.<span class="title function_">back</span>()</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getPolicyChange</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getPolicy</span>(&#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="number">16</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">if</span> (res) &#123;</span><br><span class="line">    state.<span class="property">value</span>.<span class="property">htmlText</span> = res.<span class="property">records</span>[<span class="number">0</span>].<span class="property">content</span> #根据对返回数据的实际调用方式</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Toast</span>(<span class="string">&#x27;这里出错啦&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><h2 id="state-amp-defineProps-中的数据类型声明"><a href="#state-amp-defineProps-中的数据类型声明" class="headerlink" title="state &amp; defineProps 中的数据类型声明"></a>state &amp; defineProps 中的数据类型声明</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">state 中的数据类型声明</button><button type="button" class="tab"><i class="fas fa-bomb"></i>defineProps</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>/src/stores/task.ts</strong></p><p>在 Vue 3 + TypeScript 项目中，通常建议对<code>store.state</code>中的数据进行类型声明，以便充分利用 TypeScript 的类型检查和代码提示功能。这不仅可以提高代码的可读性和可维护性，还有助于避免潜在的错误。</p><p>同样的，也是遵循按需声明的原则，即只声明将来会在组件中渲染的数据即可。</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义 City 类型</span></span><br><span class="line">interface <span class="title class_">City</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: string | <span class="literal">undefined</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向 state 存数据时, 同样需要对类型进行定义</span></span><br><span class="line"><span class="comment">// 这是 banner 数据类型声明</span></span><br><span class="line">interface getBanner &#123;</span><br><span class="line">  <span class="attr">url</span>: string | <span class="literal">undefined</span></span><br><span class="line">  <span class="attr">picture</span>: string | <span class="literal">undefined</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这是职位列表的 state 数据类型声明</span></span><br><span class="line">interface getPosition &#123;</span><br><span class="line">  name</span><br><span class="line">  children</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 筛选列表的数据类型声明</span></span><br><span class="line">interface getScreen &#123;</span><br><span class="line">  serviceMode</span><br><span class="line">  taskCycle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> taskStore = <span class="title function_">defineStore</span>(&#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="string">&#x27;task&#x27;</span>,</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">cityValue</span>: <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;city&#x27;</span>) || <span class="string">&#x27;北京&#x27;</span>,</span><br><span class="line">      <span class="attr">cityList</span>: [] <span class="keyword">as</span> <span class="title class_">City</span>[], <span class="comment">// 使用 City 数组类型</span></span><br><span class="line">      <span class="attr">bannerList</span>: [] <span class="keyword">as</span> getBanner[],</span><br><span class="line">      <span class="attr">positionValue</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 从 localStorage 获取初始值</span></span><br><span class="line">      <span class="attr">positionList</span>: [] <span class="keyword">as</span> getPosition[],</span><br><span class="line">      <span class="attr">screenList</span>: &#123;&#125; <span class="keyword">as</span> getScreen</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">setCityValue</span>(<span class="params">value: string</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">cityValue</span> = value</span><br><span class="line">      <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;city&#x27;</span>, value) <span class="comment">// 将新的 cityValue 存入 localStorage</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">setCityList</span>(<span class="params">data</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">cityList</span> = data</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">setBannerList</span>(<span class="params">data</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">bannerList</span> = data</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">setPositionList</span>(<span class="params">data</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">positionList</span> = data</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">setPositionValue</span>(<span class="params">p: string</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">positionValue</span> = p</span><br><span class="line">      <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;positionValue&#x27;</span>, p)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">setScreenList</span>(<span class="params">data: getScreen</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">screenList</span> = data</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>父组件中，在子组件标签中，直接使用冒号（v-bind）增加动态属性</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 对于 向子组件传递的数据，像以往那样，需要在组合式 api 当中声明其数据类型</span><br><span class="line">// 像这样</span><br><span class="line"># 实践发现，父组件用不到的有关类型声明，可以不写，即只在具体渲染组件中进行有关类型声明即可</span><br><span class="line"># 然而实际开发中，经常出现的情况是：父组件需要用到部分数据，子组件也需要用到部分数据</span><br><span class="line"># 这种情况下，仅各自声明需要使用的数据类型即可</span><br><span class="line">interface DetailItem &#123;</span><br><span class="line">  task_name</span><br><span class="line">  head_img</span><br><span class="line">  company_id</span><br><span class="line">  company_name</span><br><span class="line">  user_name</span><br><span class="line">  city</span><br><span class="line">  position_name</span><br><span class="line">  task_budget</span><br><span class="line">  task_cycle</span><br><span class="line">  service_mode</span><br><span class="line">  task_ask</span><br><span class="line">  task_id</span><br><span class="line">  user_id</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const state = reactive(&#123;</span><br><span class="line">  item: &#123;&#125; as DetailItem,</span><br><span class="line">  status: 0</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 然后才可以使用 v-bind 为子组件添加动态属性</span><br><span class="line">&lt;TaskDetail v-if=&quot;state.item&quot; :item=&quot;state.item&quot;&gt;&lt;/TaskDetail&gt;</span><br></pre></td></tr></table></figure><p>然后子组件中，像这样</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 首先对传递进来的数据类型进行声明</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">TaskItem</span> &#123;</span><br><span class="line">  task_name</span><br><span class="line">  is_emergency</span><br><span class="line">  task_budget</span><br><span class="line">  task_cycle</span><br><span class="line">  task_ask</span><br><span class="line">  company_name</span><br><span class="line">  city</span><br><span class="line">  service_mode</span><br><span class="line">  task_id</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 然后进行接收 </span></span><br><span class="line"><span class="keyword">const</span> &#123; taskList &#125; = defineProps&lt;&#123;</span><br><span class="line">  <span class="attr">taskList</span>: <span class="title class_">TaskItem</span>[]</span><br><span class="line">&#125;&gt;()</span><br><span class="line">  </span><br><span class="line"># 根据实际测试，在本项目的开发规范中，父组件对 v-bind 传递的数据类型进行定义后</span><br><span class="line"># 子组件可以隐式声明数据，即只声明父组件 v-bind 传递进来的父级元素而无需显式的声明其类型</span><br><span class="line"># 例如：</span><br><span class="line"><span class="keyword">const</span> &#123; item &#125; = defineProps&lt;&#123;</span><br><span class="line">  item</span><br><span class="line">&#125;&gt;()</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 然后就能供子组件使用了，props 数据是单向动态流，即父组件向子组件流动</span></span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"># 进一步实际测试发现，使用 defineProps 接受父组件的数据时</span><br><span class="line"># 采取直接解构的方式进行隐式声明也是可以的</span><br><span class="line"></span><br><span class="line"><span class="comment">// 例如：子组件中，直接</span></span><br><span class="line"><span class="keyword">const</span> &#123; contractList &#125; = defineProps&lt;&#123;</span><br><span class="line">  contractList</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这样，就可以在子组件使用了，无论数据在第几层</span></span><br><span class="line"></span><br><span class="line"># 而无需对要使用的数据进行具体的 <span class="keyword">interface</span> 声明</span><br></pre></td></tr></table></figure><p><strong>defineProps 泛型参数 &lt;{ messageList }&gt;</strong>：</p><ul><li>泛型定义了 <code>props</code> 的类型，帮助 TypeScript 提供更好的类型推断。</li><li>在这个例子中，泛型 <code>{ messageList }</code> 表示组件的 <code>props</code> 中应该有一个名为 <code>messageList</code> 的属性。</li><li><strong>未指定 messageList 的具体类型</strong>，所以默认会是 <code>any</code> 类型。</li></ul><p>使用 defineProps 接收路由参数</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 通过 vite-plugin-pages 插件，路由参数（如 id）会自动作为 props 传递给组件</span></span><br><span class="line"><span class="comment">// 在组件中只需要使用 defineProps 来定义 id，然后通过 props.id 来访问该值。</span></span><br><span class="line"><span class="comment">// 而无需使用 const taskId = router.currentRoute.value.params.id</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">id</span>: taskId &#125; = defineProps&lt;&#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line"><span class="comment">// const &#123; id: taskId &#125;：这部分代码是 JavaScript 的解构赋值语法。它将 props 中的 id 属性重命名为 taskId，这样你在组件内部就可以使用 taskId 来引用该值。</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><h2 id="provide-inject-依赖注入-父组件向子组件提供方法时的类型声明"><a href="#provide-inject-依赖注入-父组件向子组件提供方法时的类型声明" class="headerlink" title="provide / inject 依赖注入 - 父组件向子组件提供方法时的类型声明"></a>provide / inject 依赖注入 - 父组件向子组件提供方法时的类型声明</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p><img src="" alt="https://cn.vuejs.org/assets/prop-drilling.XJXa8UE-.png"></p><p>在 Vue 中，父组件通过 <code>provide</code> 提供的函数在子组件中调用时，子组件不会自动继承该函数的类型声明。这是因为 TypeScript 的类型系统是静态的，类型信息并不会随着函数的传递而自动传播。以下是一些相关的要点：</p><ol><li><strong>提供与注入</strong><ul><li>父组件使用 <code>provide</code> 提供数据或函数，子组件使用 <code>inject</code> 注入这些数据或函数。虽然父组件提供了函数，但 TypeScript 仍需要明确这些函数在子组件中的类型，以确保调用时的类型安全。</li></ul></li><li><strong>类型声明的重要性</strong><ul><li>当子组件调用从父组件提供的函数时，TypeScript 不会自动推断出该函数的参数和返回值类型。子组件必须显式地声明这些类型，以确保在调用时符合预期的类型。这是因为 TypeScript 只在定义时检查类型，而不是在运行时。</li></ul></li><li><strong>接口或类型的使用</strong><ul><li>为了提高代码的可维护性和可读性，通常会在父组件中定义一个接口（如 <code>PopupContext</code>），描述提供的函数的类型。子组件在使用 <code>inject</code> 时，可以将这个接口作为类型断言，从而明确调用该函数时应遵循的类型约定。</li></ul></li><li><p><strong>示例</strong></p><p>在使用 provide 时，进行类型检查，以使其只能传入特定类型的数据</p><p>在使用 inject 时，能够获取数据类型</p><p>假设在父组件中定义了一个函数并提供了类型：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 父组件定义方法</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">closeCitySwitch</span> = (<span class="params">name: string</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (name) &#123;</span><br><span class="line">    store.<span class="title function_">setCityValue</span>(name)</span><br><span class="line">  &#125;</span><br><span class="line">  state.<span class="property">citySwitch</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"># 通过<span class="string">&#x27;popup&#x27;</span>向子组件暴露这个方法</span><br><span class="line"><span class="title function_">provide</span>(<span class="string">&#x27;popup&#x27;</span>, &#123;</span><br><span class="line">  closeCitySwitch</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>在子组件中，需要显式地声明其类型：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 子组件中，需要再次声明一个函数的类型</span></span><br><span class="line">interface <span class="title class_">PopupContext</span> &#123;</span><br><span class="line">  <span class="attr">closeCitySwitch</span>: <span class="function">(<span class="params">cityName?: string</span>) =&gt;</span> <span class="keyword">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注入父组件暴露出来的 &#x27;popup&#x27; 函数，并进行类型断言</span></span><br><span class="line"><span class="keyword">const</span> popupContext = <span class="title function_">inject</span>(<span class="string">&#x27;popup&#x27;</span>) <span class="keyword">as</span> <span class="title class_">PopupContext</span> | <span class="literal">null</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查 popupContext 是否存在</span></span><br><span class="line"><span class="keyword">if</span> (!popupContext) &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;popup is not provided&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; closeCitySwitch &#125; = popupContext <span class="comment">// 解构出 closeCitySwitch，在子组件调用</span></span><br></pre></td></tr></table></figure></li><li><p><strong>总结</strong></p><p>在 TypeScript 中，尽管父组件通过 <code>provide</code> 提供了函数，子组件仍然需要显式声明类型。这并不是因为语言的局限性，而是为了确保类型的明确性和代码的可维护性。这种方式使得代码更健壮，开发者能够快速了解和检查函数的使用方式。</p></li></ol><details class="folding-tag" ><summary> 实战中的使用技巧 </summary>              <div class='content'>              <p><code>provide</code> 可以直接将父组件中定义的接口类型实例传递出去，这样子组件在 <code>inject</code> 时也可以利用同样的类型接口。这里是一个完整示例：</p><p><strong>示例：父组件中定义并提供接口实例</strong></p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 定义接口</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">UserContext</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">updateUser</span>: <span class="function">(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span>, <span class="attr">age</span>: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 父组件中创建一个符合接口的对象</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">userContext</span>: <span class="title class_">UserContext</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Alice&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">30</span>,</span><br><span class="line">  <span class="attr">updateUser</span>: <span class="function">(<span class="params">name, age</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`User updated to <span class="subst">$&#123;name&#125;</span>, <span class="subst">$&#123;age&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 provide 传递接口实例</span></span><br><span class="line"><span class="title function_">provide</span>(<span class="string">&quot;userContext&quot;</span>, userContext)</span><br></pre></td></tr></table></figure><p><strong>子组件中接收并使用</strong></p><p>在子组件中使用 <code>inject</code> 时，可以直接将 <code>inject</code> 的类型声明为 <code>UserContext</code>，确保代码安全并享受类型推导的好处。</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在子组件中 inject 并指定类型</span></span><br><span class="line"><span class="keyword">const</span> userContext = inject&lt;<span class="title class_">UserContext</span>&gt;(<span class="string">&quot;userContext&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (userContext) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(userContext.<span class="property">name</span>)       <span class="comment">// 自动提示 name 属性</span></span><br><span class="line">  userContext.<span class="title function_">updateUser</span>(<span class="string">&quot;Bob&quot;</span>, <span class="number">25</span>)   <span class="comment">// 自动提示 updateUser 方法和其参数类型</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>工作原理：</p><ul><li><strong>父组件</strong>通过 <code>provide</code> 将 <code>userContext</code> 作为类型为 <code>UserContext</code> 的对象传出。</li><li><strong>子组件</strong>通过 <code>inject&lt;UserContext&gt;</code> 使用该类型，使 TypeScript 知道 <code>userContext</code> 的属性和方法类型。</li></ul><p>好处：</p><p>这种方式的好处在于：</p><ul><li>子组件直接继承了父组件的类型定义，避免重复声明。</li><li>IDE 和 TypeScript 提供的自动补全和类型检查功能在子组件中也能正常工作。</li></ul><p>这种做法让父子组件在 <code>provide</code>/<code>inject</code> 的类型上保持一致，确保了良好的代码可维护性和类型安全性。</p>              </div>            </details><details class="folding-tag" ><summary> symbol 处理 </summary>              <div class='content'>              <p><strong>为什么使用 <code>Symbol</code>？</strong></p><ol><li><p><strong>避免命名冲突：</strong></p><ul><li>如果你的应用中有多个 <code>provide</code> 使用了相同的键，可能会导致冲突。</li><li><code>Symbol</code> 生成的是唯一的标识符，能有效避免这种问题。</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const MyKey = Symbol(&#x27;MyUniqueKey&#x27;);</span><br><span class="line">app.provide(MyKey, someValue);</span><br></pre></td></tr></table></figure></li><li><p><strong>代码安全性：</strong></p><ul><li>使用字符串作为键时，可能被无意间覆盖。</li><li><code>Symbol</code> 键能降低被误用或覆盖的风险。</li></ul></li><li><p><strong>提升代码可维护性：</strong></p><ul><li>使用 <code>Symbol</code> 时，键通常会用常量声明，使代码更加规范。</li></ul></li></ol><hr><p>是否必须使用 <code>Symbol</code>？</p><ul><li><p><strong>不是必须的。</strong></p><ul><li>如果你只是在一个简单的上下文中使用（如没有深层嵌套或复杂依赖），字符串键是完全可以的。</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 提供一个值</span><br><span class="line">app.provide(&#x27;myKey&#x27;, someValue);</span><br><span class="line"></span><br><span class="line">// 子组件注入</span><br><span class="line">const injectedValue = inject(&#x27;myKey&#x27;);</span><br></pre></td></tr></table></figure></li><li><p><strong>推荐使用 Symbol 的场景：</strong></p><ol><li><strong>大型应用或复杂组件树：</strong> 有很多依赖注入的场景。</li><li><strong>第三方库开发：</strong> 避免用户无意中覆盖注入的值。</li><li><strong>共享依赖：</strong> 不同的开发者团队可能会定义相同的字符串键。</li></ol></li></ul><hr><p>使用示例</p><p>使用字符串键</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 父组件</span><br><span class="line">app.provide(&#x27;myKey&#x27;, &#x27;someValue&#x27;);</span><br><span class="line"></span><br><span class="line">// 子组件</span><br><span class="line">const value = inject(&#x27;myKey&#x27;); // &#x27;someValue&#x27;</span><br></pre></td></tr></table></figure><p>使用 Symbol 键</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 定义唯一的 Symbol</span><br><span class="line">const MyKey = Symbol(&#x27;MyUniqueKey&#x27;);</span><br><span class="line"></span><br><span class="line">// 父组件</span><br><span class="line">app.provide(MyKey, &#x27;someValue&#x27;);</span><br><span class="line"></span><br><span class="line">// 子组件</span><br><span class="line">const value = inject(MyKey); // &#x27;someValue&#x27;</span><br></pre></td></tr></table></figure><hr><p>结论</p><ul><li><strong>简单应用</strong>：可以直接使用字符串。</li><li><strong>复杂或潜在冲突场景</strong>：建议使用 <code>Symbol</code>，更安全且维护性更好。</li></ul><p>ps: 中大型项目或多人协作</p><ul><li><strong>推荐将 Symbol 键集中管理</strong>：新建一个专门的文件存放所有的 <code>Symbol</code> 键，可以避免键重复、命名混乱和跨模块依赖问题。</li><li>文件结构建议：<ul><li>将所有 <code>Symbol</code> 键集中定义在一个文件中，例如 <code>keys.js</code> 或 <code>injectionKeys.js</code>。</li><li>根据功能模块，适当分层管理。</li></ul></li></ul>              </div>            </details>              </div>            </details><p>数据的本地化存储</p><details class="folding-tag" ><summary> 基于 pinia defineStore </summary>              <div class='content'>              <p>首先，基于 pinia 的 defineStore 创建一个独立的 store 模块</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 本项目实战中 /src/stores/task.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 既然是 ts ，那就需要对存进来的数据类型进行声明</span></span><br><span class="line"><span class="comment">// 定义 City 类型</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">City</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span> | <span class="literal">undefined</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向 state 存数据时, 同样需要对类型进行定义</span></span><br><span class="line"><span class="comment">// 这是 banner 数据类型声明</span></span><br><span class="line"><span class="keyword">interface</span> getBanner &#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="built_in">string</span> | <span class="literal">undefined</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span> | <span class="literal">undefined</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这是职位列表的 state 数据类型声明</span></span><br><span class="line"><span class="keyword">interface</span> getPosition &#123;</span><br><span class="line">  name</span><br><span class="line">  children</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 正如下面展示的那样，分别提供了 state 和 actions</span><br><span class="line"># 在 <span class="title class_">Pinia</span> 中，state 和 actions 之间的关系类似于 <span class="title class_">Vuex</span> 中的 state 和 mutations/actions。<span class="title class_">Pinia</span> 是一种更轻量、模块化的状态管理工具，用于替代 <span class="title class_">Vuex</span>。</span><br><span class="line"></span><br><span class="line"><span class="comment">// 简单来说，state 用来存储数据，而 actions 是用于定义业务逻辑和对 state 数据进行更新的地方，在 Pinia 中，不需要像 Vuex 那样通过 mutations 来更新 state，可以直接在 actions 中修改 state。</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> taskStore = <span class="title function_">defineStore</span>(&#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="string">&#x27;task&#x27;</span>,</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">cityValue</span>: <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;city&#x27;</span>) || <span class="string">&#x27;東京都&#x27;</span>,</span><br><span class="line">      <span class="attr">cityList</span>: [] <span class="keyword">as</span> <span class="title class_">City</span>[], <span class="comment">// 使用 City 数组类型</span></span><br><span class="line">      <span class="attr">bannerList</span>: [] <span class="keyword">as</span> getBanner[],</span><br><span class="line">      <span class="attr">positionValue</span>: <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;positionValue&#x27;</span>) || <span class="string">&#x27;フランドエンド&#x27;</span>, <span class="comment">// 从 localStorage 获取初始值</span></span><br><span class="line">      <span class="attr">positionList</span>: [] <span class="keyword">as</span> getPosition[]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">setCityValue</span>(<span class="params"><span class="attr">value</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">cityValue</span> = value</span><br><span class="line">      <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;city&#x27;</span>, value) <span class="comment">// 将新的 cityValue 存入 localStorage</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">setCityList</span>(<span class="params">data</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">cityList</span> = data</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">setBannerList</span>(<span class="params">data</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">bannerList</span> = data</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">setPositionList</span>(<span class="params">data</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">positionList</span> = data</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">setPositionValue</span>(<span class="params"><span class="attr">p</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">positionValue</span> = p</span><br><span class="line">      <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;positionValue&#x27;</span>, p)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>组件中，通过定义请求函数拿到返回结果之后，通过 store 暴露出来的方法，更新 state 中的数据</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 组件中发起 api 请求，拿到数据</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getPositionList</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">positionList</span>()</span><br><span class="line">  <span class="keyword">if</span> (res) &#123;</span><br><span class="line">    store.<span class="title function_">setPositionList</span>(res) # 调用 pinia 组件中的 actions 方法</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Toast</span>(<span class="string">&#x27;到这里出错了&#x27;</span>)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>前面这些步骤做好了之后，即可以在 actions 中，轻松的实现本地化存储</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 例如，本项目实战中 /src/stores/task.ts </span></span><br><span class="line"><span class="title function_">setPositionValue</span>(<span class="params">p: string</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">positionValue</span> = p # 组件中获取的数据传回 store 模块，并使用 actions 中的方法将数据更新至 state，这一步，是为了实现页面中的数据实时更新</span><br><span class="line">  <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;positionValue&#x27;</span>, p) # 与此同时，将新数据本地化存储</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>state 中：虽然实时更新了数据，但，当页面刷新后，state 会优先从本地取先前存进去的数据。</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">state</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">cityValue</span>: <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;city&#x27;</span>) || <span class="string">&#x27;東京都&#x27;</span>,</span><br><span class="line">      <span class="attr">cityList</span>: [] <span class="keyword">as</span> <span class="title class_">City</span>[], <span class="comment">// 使用 City 数组类型</span></span><br><span class="line">      <span class="attr">bannerList</span>: [] <span class="keyword">as</span> getBanner[],</span><br><span class="line">      <span class="attr">positionValue</span>: <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;positionValue&#x27;</span>) || <span class="string">&#x27;フランドエンド&#x27;</span>, <span class="comment">// 从 localStorage 获取初始值</span></span><br><span class="line">      </span><br><span class="line">      # 需要充分考虑这种情况, 有些数据并无必要存在本地, 例如刷新页面后希望显示全部数据的这种情况, 本项目中, 如positionValue 存在本地, 且设置优先取用本地存储的 value 值, 这么刷新页面后, 无法加载全部数据, 对于本身数据就不多的测试项目而言, 是不利于项目展示和测试的, 因此在实际项目中不再将 positionValue 存在本地</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="下拉刷新和滚动加载"><a href="#下拉刷新和滚动加载" class="headerlink" title="下拉刷新和滚动加载"></a>下拉刷新和滚动加载</h2><details class="folding-tag" ><summary> 借助 vant ui 中的 组件实现这一功能 - 点击查看详情 </summary>              <div class='content'>              <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 页面结构如下</span></span><br><span class="line"><span class="comment">// List 会监听浏览器的滚动事件并计算列表的位置 - @load=&quot;onLoad&quot;</span></span><br><span class="line"><span class="comment">// 当列表底部与可视区域的距离小于 offset（默认值为 300 ）时</span></span><br><span class="line"><span class="comment">// List 会触发一次 load 事件</span></span><br><span class="line"><span class="comment">// 最佳实践中, 还可以将父组件 pull-refresh 中的 -v-model 和 list 组件中的 v-model 合并成一个状态变量，以简化代码</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 父组件 v-model 的作用: 控制下拉的刷新状态, 当达到触发条件后, 组件自动将 v-model 的值设置为 true ,实测并不会触发 @refresh 方法, 该方法仅在下拉时触发,因此推断 v-model 仅用来控制下拉效果的, 在该方法的最后, 需要手动设置 v-model 的值为 false 通知组件刷新结束并复位，如果没有手动设置这个值，那么下拉组件会持续停在下拉状态而不能复位，特此留个记号</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 子组件 list 中的 v-model作用: 控制组件列表的加载状态, 当列表滚动到底部时，组件会自动将 loading 设置为 true 并触发 @load 事件。处理完加载逻辑后，开发者需要手动将 loading 设置为 false，以告知组件加载完成，允许继续触发新的加载请求。</span></span><br><span class="line">&lt;van-pull-refresh v-model=<span class="string">&quot;state.loading&quot;</span> success-text=<span class="string">&quot;刷新成功&quot;</span> @refresh=<span class="string">&quot;onRefresh&quot;</span>&gt;</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">van-list</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">v-model:loading</span>=<span class="string">&quot;state.loading&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:finished</span>=<span class="string">&quot;state.finished&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">finished-text</span>=<span class="string">&quot;没有更多了&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        @<span class="attr">load</span>=<span class="string">&quot;onLoad&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">TaskList</span> <span class="attr">:task-list</span>=<span class="string">&quot;state.taskList&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">TaskList</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;!state.loading &amp;&amp; state.taskList.length == 0&quot;</span> <span class="attr">class</span>=<span class="string">&quot;wy-no-data&quot;</span>&gt;</span>暂无数据<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">van-list</span>&gt;</span></span></span><br><span class="line">    &lt;/van-pull-refresh&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// List 会监听浏览器的滚动事件并计算列表的位置 - @load=&quot;onLoad&quot;</span></span><br><span class="line"><span class="comment">// 当列表底部与可视区域的距离小于 offset 时，List 会触发一次 load 事件</span></span><br><span class="line"><span class="comment">// 经过实测, onLoad 函数在页面加载时会首先自动执行一次</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onLoad</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  state.<span class="property">pageNum</span> = state.<span class="property">pageNum</span> + <span class="number">1</span> </span><br><span class="line">  <span class="comment">// 正因为 onLoad 的自动执行, 导致首次调用 getTaskAllList() 函数前</span></span><br><span class="line">  <span class="comment">// 给 pageNum 赋值为 1 , 因此应设置state中 pageNum 的值为 0 </span></span><br><span class="line">  <span class="comment">// 这样一来, 首次请求既可以获取 pageSize 中规定的第一页数据量</span></span><br><span class="line">  <span class="title function_">getTaskAllList</span>()</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;看看onLoad是否一进页面就执行&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onRefresh</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;onRefresh执行了&#x27;</span>)</span><br><span class="line">  state.<span class="property">pageNum</span> = <span class="number">1</span></span><br><span class="line">  <span class="title function_">getTaskAllList</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// @finished: 是否已加载完成，加载完成后不再触发 load 事件, 默认值为 false (表示状态为可触发) /</span></span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="底部tabbar-向下滑动时的隐藏效果设计与实现"><a href="#底部tabbar-向下滑动时的隐藏效果设计与实现" class="headerlink" title="底部tabbar - 向下滑动时的隐藏效果设计与实现"></a>底部tabbar - 向下滑动时的隐藏效果设计与实现</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">&lt;script setup lang=<span class="string">&quot;ts&quot;</span>&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; ref, onMounted, onUnmounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="comment">// 控制 FooterTabbar 的显示与隐藏</span></span><br><span class="line"><span class="keyword">const</span> showFooter = <span class="title function_">ref</span>(<span class="literal">true</span>)</span><br><span class="line"><span class="keyword">let</span> lastScrollTop = <span class="number">0</span> <span class="comment">// 上一次的滚动位置</span></span><br><span class="line"><span class="comment">// eslint-disable-next-line no-undef</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">scrollTimeout</span>: <span class="title class_">NodeJS</span>.<span class="property">Timeout</span> | <span class="literal">null</span> = <span class="literal">null</span> <span class="comment">// 用于监听停止滚动的定时器</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 滚动事件逻辑</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleScroll</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> scrollTop = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollTop</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (scrollTop &gt; lastScrollTop) &#123;</span><br><span class="line">    <span class="comment">// 向下滚动，隐藏 Footer</span></span><br><span class="line">    showFooter.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (scrollTop &lt; lastScrollTop) &#123;</span><br><span class="line">    <span class="comment">// 向上滚动，显示 Footer</span></span><br><span class="line">    showFooter.<span class="property">value</span> = <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置停止滚动后的逻辑</span></span><br><span class="line">  <span class="keyword">if</span> (scrollTimeout) <span class="built_in">clearTimeout</span>(scrollTimeout)</span><br><span class="line">  scrollTimeout = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    showFooter.<span class="property">value</span> = <span class="literal">true</span> <span class="comment">// 停止滚动后归位</span></span><br><span class="line">  &#125;, <span class="number">900</span>)</span><br><span class="line"></span><br><span class="line">  lastScrollTop = scrollTop</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听滚动事件</span></span><br><span class="line"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, handleScroll)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">onUnmounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, handleScroll)</span><br><span class="line">  <span class="keyword">if</span> (scrollTimeout) <span class="built_in">clearTimeout</span>(scrollTimeout)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">RouterView</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">&quot;footer-transition&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 动态显示 FooterTabbar --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">FooterTabbar</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">v-show</span>=<span class="string">&quot;</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml">        showFooter &amp;&amp;</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml">        !$route.path.startsWith(&#x27;/login&#x27;) &amp;&amp;</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml">        !$route.path.startsWith(&#x27;/task/TaskDetails&#x27;)</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml">      &quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="comment">/* 过渡动画 */</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.footer-transition-enter-active</span>,</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.footer-transition-leave-active</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">transition</span>:</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    transform <span class="number">1s</span> ease,</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    opacity <span class="number">1s</span> ease;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="comment">/* 隐藏时向下滑动并变透明 */</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.footer-transition-enter-from</span>,</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.footer-transition-leave-to</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">100%</span>);</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="comment">/* 显示时恢复正常位置 */</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.footer-transition-enter-to</span>,</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.footer-transition-leave-from</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>ps : 需要在 env.d.ts 文件中进行node类型声明</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/// &lt;reference types=&quot;vite/client&quot; /&gt;</span><br><span class="line">/// &lt;reference types=&quot;node&quot; /&gt;</span><br></pre></td></tr></table></figure><p><code>onMounted</code> 和 <code>onUnmounted</code> 是 Vue 3 中的生命周期钩子，分别用于在组件挂载（即插入 DOM）和卸载（即从 DOM 中移除）时执行特定的操作。</p><p>在组件挂载时添加事件监听器（比如监听滚动事件）并在组件卸载时移除它们，此时的 <code>onMounted</code> 和 <code>onUnmounted</code> 是必须的。否则，当页面跳转或组件销毁时，这些事件监听器就会留下来，可能会导致内存泄漏或不必要的性能开销。</p><p>如果你不需要做类似的初始化或清理操作，那么可以删去 <code>onMounted</code> 和 <code>onUnmounted</code>，不影响功能。</p><p>但，根据最佳实践，肯定是要保留的啦！</p>              </div>            </details><h2 id="常见报错"><a href="#常见报错" class="headerlink" title="常见报错"></a>常见报错</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <details class="folding-tag" ><summary> - 类型“AxiosResponse<any>”上不存在属性“errCode”。ts-plugin(2339) </summary>              <div class='content'>              <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 根据 chatgpt 最佳实践</span></span><br><span class="line"><span class="comment">// 在项目根目录创建 axios.d.ts 文件：</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"></span><br><span class="line">declare <span class="variable language_">module</span> <span class="string">&#x27;axios&#x27;</span> &#123;</span><br><span class="line">  <span class="keyword">export</span> interface <span class="title class_">AxiosResponse</span>&lt;T = any&gt; &#123;</span><br><span class="line">    errCode?: number;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在 axios.d.ts 文件中的代码即使添加了注释也会生效，因为 d.ts 文件的主要作用是声明类型，并不会参与实际的运行时逻辑。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 在 d.ts 文件中，注释的内容通常不会影响 TypeScript 对类型的理解。声明文件中的类型声明会自动被 TypeScript 拓展到项目中的所有代码，因此即便在 axios.d.ts 文件里加注释，TypeScript 仍会识别其中的类型扩展。</span></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> -无法找到模块 vite-plugin-eslint 插件中的 TS 声明文件 </summary>              <div class='content'>              <p>关于在 vite.config.ts 中引入 vite-plugin-eslint 插件，出现如下报错：<br>无法找到模块 vite-plugin-eslint 插件中的 TS 声明文件，隐式含有 “any” 类型。</p><p>我们可以得到在该插件中是含有 TS 声明文件的，vite-plugin-eslint/dist/index.d.ts，但是由于 TypeScript 的变更，导致新版本的 typescript 与依赖包中 package.json 指明 TS 声明文件位置的 types 配置项不匹配，最终导致新版本的 TypeScript 找不到 vite-plugin-eslint 插件中的 TS 声明文件。<br>在新版的 TypeScript 中，已经不再使用 package.json 文件中根结构中的 types 字段指明 TS 声明文件位置，而是在 exprots 中相应的导入方式中添加 typs 字段指明 TS 声明文件位置。</p><p>我这里的解决方法是<span class="hidden-anchor" id="referto_[1]">&lt;/span&gt;<sup class="reference"><a href="#referfrom_[1]">[1]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">vite-plugin-eslint 插件报错</span><span class="reference-title">参考资料</span>&lt;/span&gt;&lt;/span&gt;，在 node_modules 中找到 vite-plugin-eslint 插件的 package.json 文件，将其中的 exports 字段修改为如下内容，让新版的 TypeScript 在使用 import 导入时能够找到 vite-plugin-eslint 插件中的 TS 声明文件。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;exports&quot;: &#123;</span><br><span class="line">  &quot;.&quot;: &#123;</span><br><span class="line">    &quot;import&quot;: &#123;</span><br><span class="line">      &quot;types&quot;: &quot;./dist/index.d.ts&quot;,</span><br><span class="line">      &quot;default&quot;: &quot;./dist/index.mjs&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;require&quot;: &quot;./dist/index.js&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>修改完成后，重启 ide 就不报错了。</p><div class="reference-source"><span class="hidden-anchor" id="referfrom_[1]"></span><a class="reference-anchor" href="#referto_[1]">[1]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://blog.csdn.net/m0_53022813/article/details/137379480">vite-plugin-eslint 插件报错</a></div>              </div>            </details>              </div>            </details><p>到这里，项目的创建和最基础的开发配置已经完成了，后面继续整理项目的具体业务逻辑实现！</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git 常用命令</title>
      <link href="/posts/48e28a7b/"/>
      <url>/posts/48e28a7b/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><h1 id="Git-多人协作常用命令"><a href="#Git-多人协作常用命令" class="headerlink" title="Git 多人协作常用命令"></a>Git 多人协作常用命令</h1><h2 id="1-初始化和克隆仓库"><a href="#1-初始化和克隆仓库" class="headerlink" title="1. 初始化和克隆仓库"></a>1. 初始化和克隆仓库</h2><ul><li><strong><code>git init</code></strong>：初始化一个新的 Git 仓库。</li><li><strong><code>git clone &lt;repository-url&gt;</code></strong>：克隆远程仓库到本地。</li></ul><h2 id="2-查看仓库状态"><a href="#2-查看仓库状态" class="headerlink" title="2. 查看仓库状态"></a>2. 查看仓库状态</h2><ul><li><strong><code>git status</code></strong>：查看当前分支的状态，显示已修改但未提交的文件。</li><li><strong><code>git log</code></strong>：查看提交历史。</li><li><strong><code>git diff</code></strong>：显示未提交的变更。</li></ul><h2 id="3-分支操作"><a href="#3-分支操作" class="headerlink" title="3. 分支操作"></a>3. 分支操作</h2><ul><li><strong><code>git branch</code></strong>：列出本地分支。</li><li><strong><code>git branch &lt;branch-name&gt;</code></strong>：创建新分支。</li><li><strong><code>git checkout &lt;branch-name&gt;</code></strong>：切换到指定分支。</li><li><strong><code>git checkout -b &lt;branch-name&gt;</code></strong>：创建并切换到新分支。</li><li><strong><code>git merge &lt;branch-name&gt;</code></strong>：合并其他分支到当前分支。</li><li><strong><code>git branch -d &lt;branch-name&gt;</code></strong>：删除本地分支。</li></ul><h2 id="4-提交和推送代码"><a href="#4-提交和推送代码" class="headerlink" title="4. 提交和推送代码"></a>4. 提交和推送代码</h2><ul><li><strong><code>git add &lt;file&gt;</code></strong>：添加文件到暂存区。</li><li><strong><code>git add .</code></strong>：添加所有修改的文件到暂存区。</li><li><strong><code>git commit -m &quot;&lt;message&gt;&quot;</code></strong>：提交暂存区中的文件，附带提交信息。</li><li><strong><code>git push</code></strong>：将本地分支推送到远程仓库。</li><li><strong><code>git push origin &lt;branch-name&gt;</code></strong>：将指定分支推送到远程仓库。</li></ul><h2 id="5-更新和拉取代码"><a href="#5-更新和拉取代码" class="headerlink" title="5. 更新和拉取代码"></a>5. 更新和拉取代码</h2><ul><li><strong><code>git pull</code></strong>：从远程仓库拉取最新的更改，并合并到当前分支。</li><li><strong><code>git fetch</code></strong>：拉取远程仓库的最新内容但不合并，通常与 <code>git merge</code> 一起使用。</li></ul><h2 id="6-冲突解决"><a href="#6-冲突解决" class="headerlink" title="6. 冲突解决"></a>6. 冲突解决</h2><ul><li><strong><code>git mergetool</code></strong>：使用外部工具来帮助解决合并冲突。</li><li><strong><code>git diff --base &lt;file&gt;</code></strong>：查看冲突文件的基础版本。</li><li><strong><code>git add &lt;file&gt;</code></strong>：在解决冲突后，使用该命令标记冲突已解决。</li></ul><h2 id="7-远程仓库管理"><a href="#7-远程仓库管理" class="headerlink" title="7. 远程仓库管理"></a>7. 远程仓库管理</h2><ul><li><strong><code>git remote -v</code></strong>：查看当前配置的远程仓库。</li><li><strong><code>git remote add &lt;name&gt; &lt;url&gt;</code></strong>：添加新的远程仓库。</li><li><strong><code>git remote rm &lt;name&gt;</code></strong>：删除指定的远程仓库。</li></ul><h2 id="8-回滚和撤销"><a href="#8-回滚和撤销" class="headerlink" title="8. 回滚和撤销"></a>8. 回滚和撤销</h2><ul><li><strong><code>git reset --hard &lt;commit-hash&gt;</code></strong>：将当前分支重置到指定提交。</li><li><strong><code>git revert &lt;commit-hash&gt;</code></strong>：撤销指定提交，并生成一个新的提交来记录此次撤销。</li><li><strong><code>git reset HEAD &lt;file&gt;</code></strong>：将文件从暂存区移除，但保留修改。</li></ul><h2 id="9-协作工作流相关"><a href="#9-协作工作流相关" class="headerlink" title="9. 协作工作流相关"></a>9. 协作工作流相关</h2><ul><li><strong><code>git stash</code></strong>：临时保存当前工作区的修改，用于切换分支或拉取代码时避免冲突。</li><li><strong><code>git stash pop</code></strong>：恢复保存的工作区修改。</li><li><strong><code>git rebase &lt;branch-name&gt;</code></strong>：将当前分支变基到指定分支之上。</li></ul><h2 id="10-标签"><a href="#10-标签" class="headerlink" title="10. 标签"></a>10. 标签</h2><ul><li><strong><code>git tag &lt;tag-name&gt;</code></strong>：为当前提交打标签。</li><li><strong><code>git push origin &lt;tag-name&gt;</code></strong>：将标签推送到远程仓库。</li></ul>]]></content>
      
      
      <categories>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>后台数据管理系统-项目架构设计</title>
      <link href="/posts/976198b4/"/>
      <url>/posts/976198b4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="/hexo-ai-summaries/gemini.css"><div class="post-gemini-ai">  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="126" height="20" role="img" class="ai-summary-trigger">    <style>      .ai-summary-active .ai-summary-icon-title text:first-of-type {        display: none !important;      }      .ai-summary-active .ai-summary-icon-title text:last-child {        display: initial !important;      }      .ai-summary-active #r rect {        width: 105px !important;      }      .ai-summary-active .ai-summary-rect {        width: 80px !important;      }      .ai-summary-pen {        opacity: 1;        animation: ai-wink 2s infinite;      }      @keyframes ai-wink {        from {          opacity: 0;        }        to {          opacity: 1;        }      }    </style>    <linearGradient id="s" x2="0" y2="100%">      <stop offset="0" stop-color="#bbb" stop-opacity=".1" />      <stop offset="1" stop-opacity=".1" />    </linearGradient>    <clipPath id="r">      <rect width="125" height="20" rx="3" fill="#fff" />    </clipPath>    <g clip-path="url(#r)">      <rect width="25" height="20" fill="#555" />      <rect class="ai-summary-rect" x="25" width="100" height="20" fill="#007ec6" />      <rect width="25" height="20" fill="url(#s)" />    </g>    <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="110" class="ai-summary-icon-title">      <image class="ai-summary-pen" x="5" y="3" width="14" height="14" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Im0yMS42NCAzLjY0bC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzJNMTQgN2wzIDNNNSA2djRtMTQgNHY0TTEwIDJ2Mk03IDhIM20xOCA4aC00TTExIDNIOSIvPjwvc3ZnPg==" />      <text x="750" y="140" transform="scale(.1)" fill="#fff" textLength="900">ai-要約を取得</text>      <text style="display: none" x="650" y="140" transform="scale(.1)" fill="#fff" textLength="600">文章摘要</text>    </g>  </svg></div><script src="/hexo-ai-summaries/gemini.js"></script><h1 id="后台数据管理系统-项目架构设计"><a href="#后台数据管理系统-项目架构设计" class="headerlink" title="后台数据管理系统 - 项目架构设计"></a>后台数据管理系统 - 项目架构设计</h1><p>在线演示：<a href="https://fe-bigevent-web.itheima.net/login">https://fe-bigevent-web.itheima.net/login</a></p><p>接口文档:   <a href="https://apifox.com/apidoc/shared-26c67aee-0233-4d23-aab7-08448fdf95ff/api-93850835">https://apifox.com/apidoc/shared-26c67aee-0233-4d23-aab7-08448fdf95ff/api-93850835</a></p><p><strong>接口根路径：</strong>  <a href="http://big-event-vue-api-t.itheima.net">http://big-event-vue-api-t.itheima.net</a></p><p>本项目的技术栈 本项目技术栈基于 <a href="http://es6.ruanyifeng.com/">ES6</a>、<a href="https://cn.vuejs.org/index.html">vue3</a>、<a href="https://pinia.web3doc.top/">pinia</a>、<a href="https://router.vuejs.org/">vue-router</a> 、vite 、axios 和 <a href="https://element-plus.org/">element-plus</a></p><p><img src="image-20230711003405635.png" alt="image-20230711003405635"></p><h2 id="项目页面介绍"><a href="#项目页面介绍" class="headerlink" title="项目页面介绍"></a>项目页面介绍</h2><p><img src="image-20230706205300370.png" alt="image-20230706205300370"></p><p><img src="image-20230706210947086.png" alt="image-20230706210947086"></p><p><img src="image-20230706211055251.png" alt="image-20230706211055251"></p><p><img src="image-20230706211033589.png" alt="image-20230706211033589"></p><h2 id="pnpm-包管理器-创建项目"><a href="#pnpm-包管理器-创建项目" class="headerlink" title="pnpm 包管理器 - 创建项目"></a>pnpm 包管理器 - 创建项目</h2><p>一些优势：比同类工具快 2倍 左右、节省磁盘空间… <a href="https://www.pnpm.cn/">https://www.pnpm.cn/</a></p><p>安装方式：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install -g pnpm</span><br></pre></td></tr></table></figure><p>创建项目：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pnpm create vue</span><br></pre></td></tr></table></figure><p><img src="image-20230710172832242.png" alt="image-20230710172832242"></p><h2 id="ESLint-amp-prettier-配置代码风格"><a href="#ESLint-amp-prettier-配置代码风格" class="headerlink" title="ESLint &amp; prettier 配置代码风格"></a>ESLint &amp; prettier 配置代码风格</h2><p><strong>环境同步：</strong></p><ol><li><p><strong>安装了插件 ESlint，开启保存自动修复</strong></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// settings.json 中设置</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;workbench.settings.applyToAllProfiles&quot;</span>: [</span><br><span class="line">    </span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;less.compile&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;out&quot;</span>: <span class="string">&quot;css/&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;window.zoomLevel&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="string">&quot;workbench.iconTheme&quot;</span>: <span class="string">&quot;vscode-icons&quot;</span>,</span><br><span class="line">  <span class="string">&quot;vsicons.dontShowNewVersionMessage&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="string">&quot;security.allowedUNCHosts&quot;</span>: [<span class="string">&quot;iostation&quot;</span>],</span><br><span class="line">  <span class="comment">// 当保存的时候, eslint自动帮我们修复错误</span></span><br><span class="line">  <span class="comment">// ESlint插件 + Vscode 配置 实现自动格式化修复</span></span><br><span class="line">  <span class="string">&quot;editor.codeActionsOnSave&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;source.fixAll&quot;</span>: <span class="string">&quot;explicit&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;explorer.confirmDragAndDrop&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="comment">// 关闭保存自动格式化</span></span><br><span class="line">  <span class="string">&quot;editor.formatOnSave&quot;</span>: <span class="literal">false</span>, <span class="comment">// eslint 配置好了以后, 改为false 防止冲突</span></span><br><span class="line">  <span class="string">&quot;editor.tabSize&quot;</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="string">&quot;javascript.format.semicolons&quot;</span>: <span class="string">&quot;remove&quot;</span>,</span><br><span class="line">  <span class="string">&quot;terminal.integrated.defaultProfile.windows&quot;</span>: <span class="string">&quot;Command Prompt&quot;</span>,</span><br><span class="line">  <span class="string">&quot;security.workspace.trust.untrustedFiles&quot;</span>: <span class="string">&quot;open&quot;</span>,</span><br><span class="line">  <span class="string">&quot;editor.tabCompletion&quot;</span>: <span class="string">&quot;on&quot;</span>,</span><br><span class="line">  <span class="string">&quot;editor.fontLigatures&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="string">&quot;files.associations&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;*.vue&quot;</span>: <span class="string">&quot;vue&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;emmet.triggerExpansionOnTab&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="string">&quot;[vue]&quot;</span>: &#123;</span><br><span class="line">    <span class="comment">// &quot;editor.defaultFormatter&quot;: &quot;octref.vetur&quot; // 定义一个默认格式化程序</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;vetur.format.defaultFormatterOptions&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;prettier&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;semi&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;singleQuote&quot;</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;explorer.compactFolders&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="string">&quot;notebook.compactView&quot;</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>​</p></li><li><p><strong>禁用了插件 Prettier，并关闭保存自动格式化</strong></p></li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ESlint插件 + Vscode配置 实现自动格式化修复</span></span><br><span class="line"><span class="string">&quot;editor.codeActionsOnSave&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;source.fixAll&quot;</span>: <span class="literal">true</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="string">&quot;editor.formatOnSave&quot;</span>: <span class="literal">false</span>,</span><br></pre></td></tr></table></figure><p><strong>配置文件 .eslintrc.cjs</strong></p><ol><li><p>prettier 风格配置 <a href="https://prettier.io/docs/en/options.html">https://prettier.io</a></p><ol><li><p>单引号</p></li><li><p>不使用分号</p></li><li><p>每行宽度至多80字符</p></li><li><p>不加对象|数组最后逗号</p></li><li><p>换行符号不限制（win mac 不一致）</p></li></ol></li><li><p>vue组件名称多单词组成（忽略index.vue）</p></li><li><p>props解构（关闭）</p></li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="attr">rules</span>: &#123;</span><br><span class="line">  <span class="comment">// pretter 专注于代码的美观度 （格式化工具）</span></span><br><span class="line">  <span class="string">&#x27;prettier/prettier&#x27;</span>: [</span><br><span class="line">    <span class="string">&#x27;warn&#x27;</span>,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">singleQuote</span>: <span class="literal">true</span>, <span class="comment">// 单引号</span></span><br><span class="line">      <span class="attr">semi</span>: <span class="literal">false</span>, <span class="comment">// 无分号</span></span><br><span class="line">      <span class="attr">printWidth</span>: <span class="number">80</span>, <span class="comment">// 每行宽度至多80字符</span></span><br><span class="line">      <span class="attr">trailingComma</span>: <span class="string">&#x27;none&#x27;</span>, <span class="comment">// 不加对象|数组最后逗号</span></span><br><span class="line">      <span class="attr">endOfLine</span>: <span class="string">&#x27;auto&#x27;</span> <span class="comment">// 换行符号不限制（win mac 不一致）</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// ESLint 关注于规范</span></span><br><span class="line">  <span class="string">&#x27;vue/multi-word-component-names&#x27;</span>: [</span><br><span class="line">    <span class="string">&#x27;warn&#x27;</span>,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">ignores</span>: [<span class="string">&#x27;index&#x27;</span>] <span class="comment">// vue组件名称多单词组成（忽略index.vue）</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&#x27;vue/no-setup-props-destructure&#x27;</span>: [<span class="string">&#x27;off&#x27;</span>], <span class="comment">// 关闭 props 解构的校验</span></span><br><span class="line">  <span class="comment">// 💡 添加未定义变量错误提示，create-vue@3.6.3 关闭，这里加上是为了支持下一个章节演示。</span></span><br><span class="line">  <span class="string">&#x27;no-undef&#x27;</span>: <span class="string">&#x27;error&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="基于-husky-的代码检查工作流"><a href="#基于-husky-的代码检查工作流" class="headerlink" title="基于 husky  的代码检查工作流"></a>基于 husky  的代码检查工作流</h2><p>husky 是一个 git hooks 工具  ( git的钩子工具，可以在特定时机执行特定的命令 )</p><p><strong>husky 配置</strong></p><ol><li><p>git初始化 git init</p></li><li><p>初始化 husky 工具配置  <a href="https://typicode.github.io/husky/">https://typicode.github.io/husky/</a></p></li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">pnpm dlx husky-init &amp;&amp; pnpm install</span><br></pre></td></tr></table></figure><ol><li>修改 .husky/pre-commit 文件</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">pnpm lint</span><br></pre></td></tr></table></figure><p><strong>问题：</strong>默认进行的是全量检查，耗时问题，历史问题。</p><p><strong>lint-staged 配置</strong></p><ol><li>安装</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">pnpm i lint-staged -D</span><br></pre></td></tr></table></figure><ol><li>配置 <code>package.json</code></li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ... 省略 ...</span></span><br><span class="line">  <span class="string">&quot;lint-staged&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;*.&#123;js,ts,vue&#125;&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;eslint --fix&quot;</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="comment">// ... 省略 ...</span></span><br><span class="line">    <span class="string">&quot;lint-staged&quot;</span>: <span class="string">&quot;lint-staged&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>修改 .husky/pre-commit 文件</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">pnpm lint-staged</span><br></pre></td></tr></table></figure><hr><p>上面这个处理的结果，是只会校验新写的代码，对于之前的代码不会进行校验  /</p><h2 id="调整项目目录"><a href="#调整项目目录" class="headerlink" title="调整项目目录"></a>调整项目目录</h2><p>默认生成的目录结构不满足我们的开发需求，所以这里需要做一些自定义改动。主要是两个工作：</p><ul><li>删除初始化的默认文件</li><li>修改剩余代码内容</li><li>新增调整我们需要的目录结构</li><li>拷贝初始化资源文件，安装预处理器插件</li></ul><ol><li><p>删除文件</p></li><li><p>修改内容</p></li></ol><p><code>src/router/index.js</code></p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">BASE_URL</span>),</span><br><span class="line">  <span class="attr">routes</span>: []</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure><p><code>src/App.vue</code></p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><code>src/main.js</code></p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">createPinia</span>())</span><br><span class="line">app.<span class="title function_">use</span>(router)</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li>新增需要目录 api  utils</li></ol><p><img src="image-20230710215822678.png" alt="image-20230710215822678"></p><ol><li>将项目需要的全局样式 和 图片文件，复制到 assets 文件夹中,  并将全局样式在main.js中引入</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@/main.scss&#x27;</span></span><br></pre></td></tr></table></figure><ul><li>安装 sass 依赖</li></ul><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">pnpm add sass -D</span><br></pre></td></tr></table></figure><h2 id="VueRouter4-路由代码解析"><a href="#VueRouter4-路由代码解析" class="headerlink" title="VueRouter4 路由代码解析"></a>VueRouter4 路由代码解析</h2><p>基础代码解析</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// createRouter 创建路由实例，===&gt; new VueRouter()</span></span><br><span class="line"><span class="comment">// 1. history模式: createWebHistory()   http://xxx/user</span></span><br><span class="line"><span class="comment">// 2. hash模式: createWebHashHistory()  http://xxx/#/user</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// vite 的配置 import.meta.env.BASE_URL 是路由的基准地址，默认是 ’/‘</span></span><br><span class="line"><span class="comment">// https://vitejs.dev/guide/build.html#public-base-path</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果将来你部署的域名路径是：http://xxx/my-path/user</span></span><br><span class="line"><span class="comment">// vite.config.ts  添加配置  base: my-path，路由这就会加上 my-path 前缀了</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">BASE_URL</span>),</span><br><span class="line">  <span class="attr">routes</span>: []</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure><p>import.meta.env.BASE_URL 是Vite 环境变量，目的是为了在后期方便集中进行更改方便。详见官网介绍：<a href="https://cn.vitejs.dev/guide/env-and-mode.html">https://cn.vitejs.dev/guide/env-and-mode.html</a></p><h2 id="引入-element-ui-组件库"><a href="#引入-element-ui-组件库" class="headerlink" title="引入 element-ui 组件库"></a>引入 element-ui 组件库</h2><p><strong>官方文档：</strong> <a href="https://element-plus.org/zh-CN/">https://element-plus.org/zh-CN/</a></p><ul><li>安装</li></ul><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">$ pnpm add element-plus</span><br></pre></td></tr></table></figure><p><strong>自动按需：</strong></p><ol><li>安装插件</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">pnpm add -D unplugin-vue-components unplugin-auto-<span class="keyword">import</span></span><br></pre></td></tr></table></figure><ol><li>然后把下列代码插入到你的 <code>Vite</code> 或 <code>Webpack</code> 的配置文件中</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AutoImport</span> <span class="keyword">from</span> <span class="string">&#x27;unplugin-auto-import/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Components</span> <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ElementPlusResolver</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/resolvers&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    ...</span><br><span class="line">    <span class="title class_">AutoImport</span>(&#123;</span><br><span class="line">      <span class="attr">resolvers</span>: [<span class="title class_">ElementPlusResolver</span>()]</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="title class_">Components</span>(&#123;</span><br><span class="line">      <span class="attr">resolvers</span>: [<span class="title class_">ElementPlusResolver</span>()]</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li>直接使用</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>Primary<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span>&gt;</span>Success<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;info&quot;</span>&gt;</span>Info<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;warning&quot;</span>&gt;</span>Warning<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span>&gt;</span>Danger<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    ...</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p><img src="image-20230710225018162.png" alt="image-20230710225018162"></p><p><strong>彩蛋：</strong>默认 components 下的文件也会被自动注册~</p><h2 id="Pinia-构建用户仓库-和-持久化"><a href="#Pinia-构建用户仓库-和-持久化" class="headerlink" title="Pinia - 构建用户仓库 和 持久化"></a>Pinia - 构建用户仓库 和 持久化</h2><p>官方文档：<a href="https://prazdevs.github.io/pinia-plugin-persistedstate/zh/">https://prazdevs.github.io/pinia-plugin-persistedstate/zh/</a></p><ol><li>安装插件 pinia-plugin-persistedstate</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">pnpm add pinia-plugin-persistedstate -D</span><br></pre></td></tr></table></figure><ol><li>使用 main.js</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> persist <span class="keyword">from</span> <span class="string">&#x27;pinia-plugin-persistedstate&#x27;</span></span><br><span class="line">...</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">createPinia</span>().<span class="title function_">use</span>(persist))</span><br></pre></td></tr></table></figure><ol><li>配置 stores/user.js</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 用户模块</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useUserStore = <span class="title function_">defineStore</span>(</span><br><span class="line">  <span class="string">&#x27;big-user&#x27;</span>,</span><br><span class="line">  <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> token = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>) <span class="comment">// 定义 token</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">setToken</span> = (<span class="params">t</span>) =&gt; (token.<span class="property">value</span> = t) <span class="comment">// 设置 token</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123; token, setToken &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">persist</span>: <span class="literal">true</span> <span class="comment">// 持久化</span></span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Pinia-配置仓库统一管理"><a href="#Pinia-配置仓库统一管理" class="headerlink" title="Pinia - 配置仓库统一管理"></a>Pinia - 配置仓库统一管理</h2><p>pinia 独立维护</p><p>- 现在：初始化代码在 main.js 中，仓库代码在 stores 中，代码分散职能不单一</p><p>- 优化：由 stores 统一维护，在 stores/index.js 中完成 pinia 初始化，交付 main.js 使用</p><p>仓库 统一导出</p><p>- 现在：使用一个仓库 import { useUserStore } from <code>./stores/user.js</code> 不同仓库路径不一致</p><p>- 优化：由 stores/index.js 统一导出，导入路径统一 <code>./stores</code>，而且仓库维护在 stores/modules 中</p><h2 id="数据交互-请求工具设计"><a href="#数据交互-请求工具设计" class="headerlink" title="数据交互 - 请求工具设计"></a>数据交互 - 请求工具设计</h2><p><img src="image-20230711071913061.png" alt="image-20230711071913061"></p><h3 id="1-创建-axios-实例"><a href="#1-创建-axios-实例" class="headerlink" title="1. 创建 axios 实例"></a>1. 创建 axios 实例</h3><p>们会使用 axios 来请求后端接口, 一般都会对 axios 进行一些配置 (比如: 配置基础地址等)</p><p>一般项目开发中, 都会对 axios 进行基本的二次封装, 单独封装到一个模块中, 便于使用</p><ol><li>安装 axios</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pnpm add axios</span><br></pre></td></tr></table></figure><ol><li><p>新建 <code>utils/request.js</code> 封装 axios 模块</p><p>利用 axios.create 创建一个自定义的 axios 来使用</p><p><a href="http://www.axios-js.com/zh-cn/docs/#axios-create-config">http://www.axios-js.com/zh-cn/docs/#axios-create-config</a></p></li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> baseURL = <span class="string">&#x27;http://big-event-vue-api-t.itheima.net&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="comment">// TODO 1. 基础地址，超时时间</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// TODO 2. 携带token</span></span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err</span>) =&gt;</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// TODO 3. 处理业务失败</span></span><br><span class="line">    <span class="comment">// TODO 4. 摘取核心响应数据</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// TODO 5. 处理401错误</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> instance</span><br></pre></td></tr></table></figure><h3 id="2-完成-axios-基本配置"><a href="#2-完成-axios-基本配置" class="headerlink" title="2. 完成 axios 基本配置"></a>2. 完成 axios 基本配置</h3><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useUserStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores/user&#x27;</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;@/router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> baseURL = <span class="string">&#x27;http://big-event-vue-api-t.itheima.net&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  baseURL,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">100000</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> userStore = <span class="title function_">useUserStore</span>()</span><br><span class="line">    <span class="keyword">if</span> (userStore.<span class="property">token</span>) &#123;</span><br><span class="line">      config.<span class="property">headers</span>.<span class="property">Authorization</span> = userStore.<span class="property">token</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err</span>) =&gt;</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">code</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> res</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">ElMessage</span>(&#123; <span class="attr">message</span>: res.<span class="property">data</span>.<span class="property">message</span> || <span class="string">&#x27;服务异常&#x27;</span>, <span class="attr">type</span>: <span class="string">&#x27;error&#x27;</span> &#125;)</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(res.<span class="property">data</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title class_">ElMessage</span>(&#123; <span class="attr">message</span>: err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">message</span> || <span class="string">&#x27;服务异常&#x27;</span>, <span class="attr">type</span>: <span class="string">&#x27;error&#x27;</span> &#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err)</span><br><span class="line">    <span class="keyword">if</span> (err.<span class="property">response</span>?.<span class="property">status</span> === <span class="number">401</span>) &#123;</span><br><span class="line">      router.<span class="title function_">push</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> instance</span><br><span class="line"><span class="keyword">export</span> &#123; baseURL &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="首页整体路由设计"><a href="#首页整体路由设计" class="headerlink" title="首页整体路由设计"></a>首页整体路由设计</h2><p><strong>实现目标:</strong></p><ul><li>完成整体路由规划【搞清楚要做几个页面，它们分别在哪个路由下面，怎么跳转的…..】</li><li>通过观察,  点击左侧导航,  右侧区域在切换,  那右侧区域内容一直在变,  那这个地方就是一个路由的出口</li><li>我们需要搭建嵌套路由</li></ul><p>目标：</p><ul><li>把项目中所有用到的组件及路由表, 约定下来</li></ul><p><strong>约定路由规则</strong></p><div class="table-container"><table><thead><tr><th>path</th><th>文件</th><th>功能</th><th>组件名</th><th>路由级别</th></tr></thead><tbody><tr><td>/login</td><td>views/login/LoginPage.vue</td><td>登录&amp;注册</td><td>LoginPage</td><td>一级路由</td></tr><tr><td>/</td><td>views/layout/LayoutContainer.vue</td><td>布局架子</td><td>LayoutContainer</td><td>一级路由</td></tr><tr><td>├─ /article/manage</td><td>views/article/ArticleManage.vue</td><td>文章管理</td><td>ArticleManage</td><td>二级路由</td></tr><tr><td>├─ /article/channel</td><td>views/article/ArticleChannel.vue</td><td>频道管理</td><td>ArticleChannel</td><td>二级路由</td></tr><tr><td>├─ /user/profile</td><td>views/user/UserProfile.vue</td><td>个人详情</td><td>UserProfile</td><td>二级路由</td></tr><tr><td>├─ /user/avatar</td><td>views/user/UserAvatar.vue</td><td>更换头像</td><td>UserAvatar</td><td>二级路由</td></tr><tr><td>├─ /user/password</td><td>views/user/UserPassword.vue</td><td>重置密码</td><td>UserPassword</td><td>二级路由</td></tr></tbody></table></div><p>明确了路由规则，可以全部配完，也可以边写边配。</p><h1 id="登录注册页面-element-plus-表单-amp-表单校验"><a href="#登录注册页面-element-plus-表单-amp-表单校验" class="headerlink" title="登录注册页面 [element-plus 表单 &amp; 表单校验]"></a>登录注册页面 [element-plus 表单 &amp; 表单校验]</h1><h2 id="注册登录-静态结构-amp-基本切换"><a href="#注册登录-静态结构-amp-基本切换" class="headerlink" title="注册登录 静态结构 &amp; 基本切换"></a>注册登录 静态结构 &amp; 基本切换</h2><ol><li>安装 element-plus 图标库</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">pnpm i @element-plus/icons-vue</span><br></pre></td></tr></table></figure><ol><li>静态结构准备</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">User</span>, <span class="title class_">Lock</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@element-plus/icons-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> isRegister = <span class="title function_">ref</span>(<span class="literal">true</span>)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">el-row</span> <span class="attr">class</span>=<span class="string">&quot;login-page&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:span</span>=<span class="string">&quot;12&quot;</span> <span class="attr">class</span>=<span class="string">&quot;bg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:span</span>=<span class="string">&quot;6&quot;</span> <span class="attr">:offset</span>=<span class="string">&quot;3&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">ref</span>=<span class="string">&quot;form&quot;</span> <span class="attr">size</span>=<span class="string">&quot;large&quot;</span> <span class="attr">autocomplete</span>=<span class="string">&quot;off&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;isRegister&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">h1</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">:prefix-icon</span>=<span class="string">&quot;User&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入用户名&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">:prefix-icon</span>=<span class="string">&quot;Lock&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">type</span>=<span class="string">&quot;password&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">placeholder</span>=<span class="string">&quot;请输入密码&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">:prefix-icon</span>=<span class="string">&quot;Lock&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">type</span>=<span class="string">&quot;password&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">placeholder</span>=<span class="string">&quot;请输入再次密码&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">auto-insert-space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            注册</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">class</span>=<span class="string">&quot;flex&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-link</span> <span class="attr">type</span>=<span class="string">&quot;info&quot;</span> <span class="attr">:underline</span>=<span class="string">&quot;false&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;isRegister = false&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            ← 返回</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">ref</span>=<span class="string">&quot;form&quot;</span> <span class="attr">size</span>=<span class="string">&quot;large&quot;</span> <span class="attr">autocomplete</span>=<span class="string">&quot;off&quot;</span> <span class="attr">v-else</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">h1</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">:prefix-icon</span>=<span class="string">&quot;User&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入用户名&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">name</span>=<span class="string">&quot;password&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">:prefix-icon</span>=<span class="string">&quot;Lock&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">type</span>=<span class="string">&quot;password&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">placeholder</span>=<span class="string">&quot;请输入密码&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">class</span>=<span class="string">&quot;flex&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-checkbox</span>&gt;</span>记住我<span class="tag">&lt;/<span class="name">el-checkbox</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-link</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">:underline</span>=<span class="string">&quot;false&quot;</span>&gt;</span>忘记密码？<span class="tag">&lt;/<span class="name">el-link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">auto-insert-space</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &gt;</span>登录&lt;/el-button</span></span><br><span class="line"><span class="language-xml">          &gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">class</span>=<span class="string">&quot;flex&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-link</span> <span class="attr">type</span>=<span class="string">&quot;info&quot;</span> <span class="attr">:underline</span>=<span class="string">&quot;false&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;isRegister = true&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            注册 →</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.login-page</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.bg</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">&#x27;@/logo2.png&#x27;</span>) no-repeat <span class="number">60%</span> center / <span class="number">240px</span> auto,</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="built_in">url</span>(<span class="string">&#x27;@/login_bg.jpg&#x27;</span>) no-repeat center / cover;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">border-radius</span>: <span class="number">0</span> <span class="number">20px</span> <span class="number">20px</span> <span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.form</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">display</span>: flex;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">flex-direction</span>: column;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">justify-content</span>: center;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    user-<span class="selector-tag">select</span>: none;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.title</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">margin</span>: <span class="number">0</span> auto;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.button</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.flex</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">display</span>: flex;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">justify-content</span>: space-between;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="注册功能"><a href="#注册功能" class="headerlink" title="注册功能"></a>注册功能</h2><h3 id="实现注册校验"><a href="#实现注册校验" class="headerlink" title="实现注册校验"></a>实现注册校验</h3><p>【需求】注册页面基本校验</p><ol><li>用户名非空，长度校验5-10位</li><li>密码非空，长度校验6-15位</li><li>再次输入密码，非空，长度校验6-15位</li></ol><p>【进阶】再次输入密码需要自定义校验规则，和密码框值一致（可选）</p><p>注意：</p><ol><li>model 属性绑定 form 数据对象</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> formModel = <span class="title function_">ref</span>(&#123;</span><br><span class="line">  <span class="attr">username</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">password</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">repassword</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;el-form :model=<span class="string">&quot;formModel&quot;</span> &gt;</span><br></pre></td></tr></table></figure><ol><li>v-model 绑定 form 数据对象的子属性</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-input</span><br><span class="line">  v-model=<span class="string">&quot;formModel.username&quot;</span></span><br><span class="line">  :prefix-icon=<span class="string">&quot;User&quot;</span></span><br><span class="line">  placeholder=<span class="string">&quot;请输入用户名&quot;</span></span><br><span class="line">&gt;&lt;/el-input&gt;</span><br><span class="line">... </span><br><span class="line">(其他两个也要绑定)</span><br></pre></td></tr></table></figure><ol><li>rules 配置校验规则</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-form :rules=<span class="string">&quot;rules&quot;</span> &gt;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">const</span> rules = &#123;</span><br><span class="line">  <span class="attr">username</span>: [</span><br><span class="line">    &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入用户名&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">min</span>: <span class="number">5</span>, <span class="attr">max</span>: <span class="number">10</span>, <span class="attr">message</span>: <span class="string">&#x27;用户名必须是5-10位的字符&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">password</span>: [</span><br><span class="line">    &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入密码&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">pattern</span>: <span class="regexp">/^\S&#123;6,15&#125;$/</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;密码必须是6-15位的非空字符&#x27;</span>,</span><br><span class="line">      <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">repassword</span>: [</span><br><span class="line">    &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请再次输入密码&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">pattern</span>: <span class="regexp">/^\S&#123;6,15&#125;$/</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;密码必须是6-15的非空字符&#x27;</span>,</span><br><span class="line">      <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">validator</span>: <span class="function">(<span class="params">rule, value, callback</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (value !== formModel.<span class="property">value</span>.<span class="property">password</span>) &#123;</span><br><span class="line">          <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;两次输入密码不一致!&#x27;</span>))</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="title function_">callback</span>()</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>prop 绑定校验规则</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-form-item prop=<span class="string">&quot;username&quot;</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">v-model</span>=<span class="string">&quot;formModel.username&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">:prefix-icon</span>=<span class="string">&quot;User&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">placeholder</span>=<span class="string">&quot;请输入用户名&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  &gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br><span class="line">&lt;/el-form-item&gt;</span><br><span class="line">... </span><br><span class="line">(其他两个也要绑定prop)</span><br></pre></td></tr></table></figure><h3 id="注册前的预校验"><a href="#注册前的预校验" class="headerlink" title="注册前的预校验"></a>注册前的预校验</h3><p>需求：点击注册按钮，注册之前，需要先校验</p><ol><li>通过 ref 获取到 表单组件</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> form = <span class="title function_">ref</span>()</span><br><span class="line"></span><br><span class="line">&lt;el-form ref=<span class="string">&quot;form&quot;</span>&gt;</span><br></pre></td></tr></table></figure><ol><li>注册之前进行校验</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-button</span><br><span class="line">  @click=<span class="string">&quot;register&quot;</span></span><br><span class="line">  <span class="keyword">class</span>=<span class="string">&quot;button&quot;</span></span><br><span class="line">  type=<span class="string">&quot;primary&quot;</span></span><br><span class="line">  auto-insert-space</span><br><span class="line">&gt;</span><br><span class="line">  注册</span><br><span class="line">&lt;/el-button&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">register</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> form.<span class="property">value</span>.<span class="title function_">validate</span>()</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;开始注册请求&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="封装-api-实现注册功能"><a href="#封装-api-实现注册功能" class="headerlink" title="封装 api 实现注册功能"></a>封装 api 实现注册功能</h3><p>需求：封装注册api，进行注册，注册成功切换到登录</p><ol><li>新建 api/user.js 封装</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">userRegisterService</span> = (<span class="params">&#123; username, password, repassword &#125;</span>) =&gt;</span><br><span class="line">  request.<span class="title function_">post</span>(<span class="string">&#x27;/api/reg&#x27;</span>, &#123; username, password, repassword &#125;)</span><br></pre></td></tr></table></figure><ol><li>页面中调用</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">register</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> form.<span class="property">value</span>.<span class="title function_">validate</span>()</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">userRegisterService</span>(formModel.<span class="property">value</span>)</span><br><span class="line">  <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&#x27;注册成功&#x27;</span>)</span><br><span class="line">  <span class="comment">// 切换到登录</span></span><br><span class="line">  isRegister.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>eslintrc 中声明全局变量名,  解决 ElMessage 报错问题</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="attr">globals</span>: &#123;</span><br><span class="line">    <span class="title class_">ElMessage</span>: <span class="string">&#x27;readonly&#x27;</span>,</span><br><span class="line">    <span class="title class_">ElMessageBox</span>: <span class="string">&#x27;readonly&#x27;</span>,</span><br><span class="line">    <span class="title class_">ElLoading</span>: <span class="string">&#x27;readonly&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="登录功能"><a href="#登录功能" class="headerlink" title="登录功能"></a>登录功能</h2><h3 id="实现登录校验"><a href="#实现登录校验" class="headerlink" title="实现登录校验"></a>实现登录校验</h3><p>【需求说明】给输入框添加表单校验</p><ol><li>用户名不能为空，用户名必须是5-10位的字符，失去焦点 和 修改内容时触发校验</li><li>密码不能为空，密码必须是6-15位的字符，失去焦点 和 修改内容时触发校验</li></ol><p>操作步骤：</p><ol><li>model 属性绑定 form 数据对象，直接绑定之前提供好的数据对象即可</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-form :model=<span class="string">&quot;formModel&quot;</span> &gt;</span><br></pre></td></tr></table></figure><ol><li>rules 配置校验规则，共用注册的规则即可</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-form :rules=<span class="string">&quot;rules&quot;</span> &gt;</span><br></pre></td></tr></table></figure><ol><li>v-model 绑定 form 数据对象的子属性</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-input</span><br><span class="line">  v-model=<span class="string">&quot;formModel.username&quot;</span></span><br><span class="line">  :prefix-icon=<span class="string">&quot;User&quot;</span></span><br><span class="line">  placeholder=<span class="string">&quot;请输入用户名&quot;</span></span><br><span class="line">&gt;&lt;/el-input&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">el-input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">v-model</span>=<span class="string">&quot;formModel.password&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">name</span>=<span class="string">&quot;password&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">:prefix-icon</span>=<span class="string">&quot;Lock&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">type</span>=<span class="string">&quot;password&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">placeholder</span>=<span class="string">&quot;请输入密码&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ol><li>prop 绑定校验规则</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-form-item prop=<span class="string">&quot;username&quot;</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">v-model</span>=<span class="string">&quot;formModel.username&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">:prefix-icon</span>=<span class="string">&quot;User&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">placeholder</span>=<span class="string">&quot;请输入用户名&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  &gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br><span class="line">&lt;/el-form-item&gt;</span><br><span class="line">... </span><br></pre></td></tr></table></figure><ol><li>切换的时候重置</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="title function_">watch</span>(isRegister, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  formModel.<span class="property">value</span> = &#123;</span><br><span class="line">    <span class="attr">username</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">repassword</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="登录前的预校验-amp-登录成功"><a href="#登录前的预校验-amp-登录成功" class="headerlink" title="登录前的预校验 &amp; 登录成功"></a>登录前的预校验 &amp; 登录成功</h3><p>【需求说明1】登录之前的预校验</p><ul><li>登录请求之前，需要对用户的输入内容，进行校验</li><li>校验通过才发送请求</li></ul><p>【需求说明2】<strong>登录功能</strong></p><ol><li>封装登录API，点击按钮发送登录请求</li><li>登录成功存储token，存入pinia 和 持久化本地storage</li><li>跳转到首页，给提示</li></ol><p>【测试账号】</p><ul><li><p>登录的测试账号:  shuaipeng</p></li><li><p>登录测试密码:  123456</p></li></ul><p>PS: 每天账号会重置，如果被重置了，可以去注册页，注册一个新号</p><p>实现步骤：</p><ol><li>注册事件，进行登录前的预校验 (获取到组件调用方法)</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-form ref=<span class="string">&quot;form&quot;</span>&gt;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">const</span> <span class="title function_">login</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> form.<span class="property">value</span>.<span class="title function_">validate</span>()</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;开始登录&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>封装接口 API</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">userLoginService</span> = (<span class="params">&#123; username, password &#125;</span>) =&gt;</span><br><span class="line">  request.<span class="title function_">post</span>(<span class="string">&#x27;api/login&#x27;</span>, &#123; username, password &#125;)</span><br></pre></td></tr></table></figure><ol><li>调用方法将 token 存入 pinia 并 自动持久化本地</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> userStore = <span class="title function_">useUserStore</span>()</span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">login</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> form.<span class="property">value</span>.<span class="title function_">validate</span>()</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">userLoginService</span>(formModel.<span class="property">value</span>)</span><br><span class="line">  userStore.<span class="title function_">setToken</span>(res.<span class="property">data</span>.<span class="property">token</span>)</span><br><span class="line">  <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&#x27;登录成功&#x27;</span>)</span><br><span class="line">  router.<span class="title function_">push</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="首页-layout-架子-element-plus-菜单"><a href="#首页-layout-架子-element-plus-菜单" class="headerlink" title="首页 layout 架子 [element-plus 菜单]"></a>首页 layout 架子 [element-plus 菜单]</h1><h2 id="基本架子拆解"><a href="#基本架子拆解" class="headerlink" title="基本架子拆解"></a>基本架子拆解</h2><p><strong>架子组件列表：</strong></p><p>el-container</p><ul><li><p>el-aside 左侧</p><ul><li>el-menu 左侧边栏菜单</li></ul></li><li><p>el-container  右侧</p><ul><li>el-header  右侧头部<ul><li>el-dropdown</li></ul></li><li>el-main  右侧主体<ul><li>router-view</li></ul></li></ul></li></ul><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">Management</span>,</span><br><span class="line">  <span class="title class_">Promotion</span>,</span><br><span class="line">  <span class="title class_">UserFilled</span>,</span><br><span class="line">  <span class="title class_">User</span>,</span><br><span class="line">  <span class="title class_">Crop</span>,</span><br><span class="line">  <span class="title class_">EditPen</span>,</span><br><span class="line">  <span class="title class_">SwitchButton</span>,</span><br><span class="line">  <span class="title class_">CaretBottom</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@element-plus/icons-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> avatar <span class="keyword">from</span> <span class="string">&#x27;@/default.png&#x27;</span></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-container class=&quot;layout-container&quot;&gt;</span><br><span class="line">    &lt;el-aside width=&quot;200px&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;el-aside__logo&quot;&gt;&lt;/div&gt;</span><br><span class="line">      &lt;el-menu</span><br><span class="line">        active-text-color=&quot;#ffd04b&quot;</span><br><span class="line">        background-color=&quot;#232323&quot;</span><br><span class="line">        :default-active=&quot;$route.path&quot;</span><br><span class="line">        text-color=&quot;#fff&quot;</span><br><span class="line">        router</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;el-menu-item index=&quot;/article/channel&quot;&gt;</span><br><span class="line">          &lt;el-icon&gt;&lt;Management /&gt;&lt;/el-icon&gt;</span><br><span class="line">          &lt;span&gt;文章分类&lt;/span&gt;</span><br><span class="line">        &lt;/el-menu-item&gt;</span><br><span class="line">        &lt;el-menu-item index=&quot;/article/manage&quot;&gt;</span><br><span class="line">          &lt;el-icon&gt;&lt;Promotion /&gt;&lt;/el-icon&gt;</span><br><span class="line">          &lt;span&gt;文章管理&lt;/span&gt;</span><br><span class="line">        &lt;/el-menu-item&gt;</span><br><span class="line">        &lt;el-sub-menu index=&quot;/user&quot;&gt;</span><br><span class="line">          &lt;template #title&gt;</span><br><span class="line">            &lt;el-icon&gt;&lt;UserFilled /&gt;&lt;/el-icon&gt;</span><br><span class="line">            &lt;span&gt;个人中心&lt;/span&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">          &lt;el-menu-item index=&quot;/user/profile&quot;&gt;</span><br><span class="line">            &lt;el-icon&gt;&lt;User /&gt;&lt;/el-icon&gt;</span><br><span class="line">            &lt;span&gt;基本资料&lt;/span&gt;</span><br><span class="line">          &lt;/el-menu-item&gt;</span><br><span class="line">          &lt;el-menu-item index=&quot;/user/avatar&quot;&gt;</span><br><span class="line">            &lt;el-icon&gt;&lt;Crop /&gt;&lt;/el-icon&gt;</span><br><span class="line">            &lt;span&gt;更换头像&lt;/span&gt;</span><br><span class="line">          &lt;/el-menu-item&gt;</span><br><span class="line">          &lt;el-menu-item index=&quot;/user/password&quot;&gt;</span><br><span class="line">            &lt;el-icon&gt;&lt;EditPen /&gt;&lt;/el-icon&gt;</span><br><span class="line">            &lt;span&gt;重置密码&lt;/span&gt;</span><br><span class="line">          &lt;/el-menu-item&gt;</span><br><span class="line">        &lt;/el-sub-menu&gt;</span><br><span class="line">      &lt;/el-menu&gt;</span><br><span class="line">    &lt;/el-aside&gt;</span><br><span class="line">    &lt;el-container&gt;</span><br><span class="line">      &lt;el-header&gt;</span><br><span class="line">        &lt;div&gt;黑马程序员：&lt;strong&gt;小帅鹏&lt;/strong&gt;&lt;/div&gt;</span><br><span class="line">        &lt;el-dropdown placement=&quot;bottom-end&quot;&gt;</span><br><span class="line">          &lt;span class=&quot;el-dropdown__box&quot;&gt;</span><br><span class="line">            &lt;el-avatar :src=&quot;avatar&quot; /&gt;</span><br><span class="line">            &lt;el-icon&gt;&lt;CaretBottom /&gt;&lt;/el-icon&gt;</span><br><span class="line">          &lt;/span&gt;</span><br><span class="line">          &lt;template #dropdown&gt;</span><br><span class="line">            &lt;el-dropdown-menu&gt;</span><br><span class="line">              &lt;el-dropdown-item command=&quot;profile&quot; :icon=&quot;User&quot;</span><br><span class="line">                &gt;基本资料&lt;/el-dropdown-item</span><br><span class="line">              &gt;</span><br><span class="line">              &lt;el-dropdown-item command=&quot;avatar&quot; :icon=&quot;Crop&quot;</span><br><span class="line">                &gt;更换头像&lt;/el-dropdown-item</span><br><span class="line">              &gt;</span><br><span class="line">              &lt;el-dropdown-item command=&quot;password&quot; :icon=&quot;EditPen&quot;</span><br><span class="line">                &gt;重置密码&lt;/el-dropdown-item</span><br><span class="line">              &gt;</span><br><span class="line">              &lt;el-dropdown-item command=&quot;logout&quot; :icon=&quot;SwitchButton&quot;</span><br><span class="line">                &gt;退出登录&lt;/el-dropdown-item</span><br><span class="line">              &gt;</span><br><span class="line">            &lt;/el-dropdown-menu&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/el-dropdown&gt;</span><br><span class="line">      &lt;/el-header&gt;</span><br><span class="line">      &lt;el-main&gt;</span><br><span class="line">        &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">      &lt;/el-main&gt;</span><br><span class="line">      &lt;el-footer&gt;大事件 ©2023 Created by 黑马程序员&lt;/el-footer&gt;</span><br><span class="line">    &lt;/el-container&gt;</span><br><span class="line">  &lt;/el-container&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.layout-container &#123;</span><br><span class="line">  height: 100vh;</span><br><span class="line">  .el-aside &#123;</span><br><span class="line">    background-color: #232323;</span><br><span class="line">    &amp;__logo &#123;</span><br><span class="line">      height: 120px;</span><br><span class="line">      background: url(&#x27;@/logo.png&#x27;) no-repeat center / 120px auto;</span><br><span class="line">    &#125;</span><br><span class="line">    .el-menu &#123;</span><br><span class="line">      border-right: none;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .el-header &#123;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    .el-dropdown__box &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      align-items: center;</span><br><span class="line">      .el-icon &#123;</span><br><span class="line">        color: #999;</span><br><span class="line">        margin-left: 10px;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;:active,</span><br><span class="line">      &amp;:focus &#123;</span><br><span class="line">        outline: none;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .el-footer &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    color: #666;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h2 id="登录访问拦截"><a href="#登录访问拦截" class="headerlink" title="登录访问拦截"></a>登录访问拦截</h2><p>需求：只有登录页，可以未授权的时候访问，其他所有页面，都需要先登录再访问</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 登录访问拦截</span></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> userStore = <span class="title function_">useUserStore</span>()</span><br><span class="line">  <span class="keyword">if</span> (!userStore.<span class="property">token</span> &amp;&amp; to.<span class="property">path</span> !== <span class="string">&#x27;/login&#x27;</span>) <span class="keyword">return</span> <span class="string">&#x27;/login&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="用户基本信息获取-amp-渲染"><a href="#用户基本信息获取-amp-渲染" class="headerlink" title="用户基本信息获取&amp;渲染"></a>用户基本信息获取&amp;渲染</h2><ol><li><code>api/user.js</code>封装接口</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">userGetInfoService</span> = (<span class="params"></span>) =&gt; request.<span class="title function_">get</span>(<span class="string">&#x27;/my/userinfo&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li>stores/modules/user.js 定义数据</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> user = <span class="title function_">ref</span>(&#123;&#125;)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getUser</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">userGetInfoService</span>() <span class="comment">// 请求获取数据</span></span><br><span class="line">  user.<span class="property">value</span> = res.<span class="property">data</span>.<span class="property">data</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li><code>layout/LayoutContainer</code>页面中调用</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useUserStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores&#x27;</span></span><br><span class="line"><span class="keyword">const</span> userStore = <span class="title function_">useUserStore</span>()</span><br><span class="line"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  userStore.<span class="title function_">getUser</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol><li>动态渲染</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  黑马程序员：&lt;strong&gt;&#123;&#123; userStore.<span class="property">user</span>.<span class="property">nickname</span> || userStore.<span class="property">user</span>.<span class="property">username</span> &#125;&#125;&lt;/strong&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">el-avatar</span> <span class="attr">:src</span>=<span class="string">&quot;userStore.user.user_pic || avatar&quot;</span> /&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="退出功能-element-plus-确认框"><a href="#退出功能-element-plus-确认框" class="headerlink" title="退出功能 [element-plus 确认框]"></a>退出功能 [element-plus 确认框]</h2><ol><li>注册点击事件</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-dropdown placement=<span class="string">&quot;bottom-end&quot;</span> @command=<span class="string">&quot;onCommand&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">el-dropdown-menu</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">el-dropdown-item</span> <span class="attr">command</span>=<span class="string">&quot;profile&quot;</span> <span class="attr">:icon</span>=<span class="string">&quot;User&quot;</span>&gt;</span>基本资料<span class="tag">&lt;/<span class="name">el-dropdown-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">el-dropdown-item</span> <span class="attr">command</span>=<span class="string">&quot;avatar&quot;</span> <span class="attr">:icon</span>=<span class="string">&quot;Crop&quot;</span>&gt;</span>更换头像<span class="tag">&lt;/<span class="name">el-dropdown-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">el-dropdown-item</span> <span class="attr">command</span>=<span class="string">&quot;password&quot;</span> <span class="attr">:icon</span>=<span class="string">&quot;EditPen&quot;</span>&gt;</span>重置密码<span class="tag">&lt;/<span class="name">el-dropdown-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">el-dropdown-item</span> <span class="attr">command</span>=<span class="string">&quot;logout&quot;</span> <span class="attr">:icon</span>=<span class="string">&quot;SwitchButton&quot;</span>&gt;</span>退出登录<span class="tag">&lt;/<span class="name">el-dropdown-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">el-dropdown-menu</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ol><li>添加退出功能</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">onCommand</span> = <span class="keyword">async</span> (<span class="params">command</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (command === <span class="string">&#x27;logout&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title class_">ElMessageBox</span>.<span class="title function_">confirm</span>(<span class="string">&#x27;你确认退出大事件吗？&#x27;</span>, <span class="string">&#x27;温馨提示&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;warning&#x27;</span>,</span><br><span class="line">      <span class="attr">confirmButtonText</span>: <span class="string">&#x27;确认&#x27;</span>,</span><br><span class="line">      <span class="attr">cancelButtonText</span>: <span class="string">&#x27;取消&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    userStore.<span class="title function_">removeToken</span>()</span><br><span class="line">    userStore.<span class="title function_">setUser</span>(&#123;&#125;)</span><br><span class="line">    router.<span class="title function_">push</span>(<span class="string">`/login`</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    router.<span class="title function_">push</span>(<span class="string">`/user/<span class="subst">$&#123;command&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>pinia  user.js 模块 提供 setUser 方法</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">setUser</span> = (<span class="params">obj</span>) =&gt; (user.<span class="property">value</span> = obj)</span><br></pre></td></tr></table></figure><h1 id="文章分类页面-element-plus-表格"><a href="#文章分类页面-element-plus-表格" class="headerlink" title="文章分类页面 - [element-plus 表格]"></a>文章分类页面 - [element-plus 表格]</h1><h2 id="基本架子-PageContainer"><a href="#基本架子-PageContainer" class="headerlink" title="基本架子 - PageContainer"></a>基本架子 - PageContainer</h2><ol><li>基本结构样式，用到了 el-card 组件</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-card</span> <span class="attr">class</span>=<span class="string">&quot;page-container&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>文章分类<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;extra&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>添加分类<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     ...</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-card</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.page-container</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">min-height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">box-sizing</span>: border-box;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.header</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">display</span>: flex;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">align-items</span>: center;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">justify-content</span>: space-between;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ol><li>考虑到多个页面复用，封装成组件<ul><li>props 定制标题</li><li>默认插槽 default 定制内容主体</li><li>具名插槽 extra  定制头部右侧额外的按钮</li></ul></li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="title function_">defineProps</span>(&#123;</span><br><span class="line">  <span class="attr">title</span>: &#123;</span><br><span class="line">    <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">el-card</span> <span class="attr">class</span>=<span class="string">&quot;page-container&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;extra&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;extra&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-card</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.page-container</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">min-height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">box-sizing</span>: border-box;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.header</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">display</span>: flex;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">align-items</span>: center;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">justify-content</span>: space-between;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ol><li>页面中直接使用测试 ( unplugin-vue-components 会自动注册)</li></ol><ul><li>文章分类测试：</li></ul><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">page-container</span> <span class="attr">title</span>=<span class="string">&quot;文章分类&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">extra</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span> 添加分类 <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    主体部分</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">page-container</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><ul><li>文章管理测试：</li></ul><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">page-container</span> <span class="attr">title</span>=<span class="string">&quot;文章管理&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">extra</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>发布文章<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    主体部分</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">page-container</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h2 id="文章分类渲染"><a href="#文章分类渲染" class="headerlink" title="文章分类渲染"></a>文章分类渲染</h2><h3 id="封装API-请求获取表格数据"><a href="#封装API-请求获取表格数据" class="headerlink" title="封装API - 请求获取表格数据"></a>封装API - 请求获取表格数据</h3><ol><li>新建 <code>api/article.js</code> 封装获取频道列表的接口</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">artGetChannelsService</span> = (<span class="params"></span>) =&gt; request.<span class="title function_">get</span>(<span class="string">&#x27;/my/cate/list&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li>页面中调用接口，获取数据存储</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> channelList = <span class="title function_">ref</span>([])</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getChannelList</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">artGetChannelsService</span>()</span><br><span class="line">  channelList.<span class="property">value</span> = res.<span class="property">data</span>.<span class="property">data</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="el-table-表格动态渲染"><a href="#el-table-表格动态渲染" class="headerlink" title="el-table 表格动态渲染"></a>el-table 表格动态渲染</h3><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-table :data=<span class="string">&quot;channelList&quot;</span> style=<span class="string">&quot;width: 100%&quot;</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;序号&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span> <span class="attr">type</span>=<span class="string">&quot;index&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;分类名称&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;cate_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;分类别名&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;cate_alias&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; row &#125;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:icon</span>=<span class="string">&quot;Edit&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">circle</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">plain</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        @<span class="attr">click</span>=<span class="string">&quot;onEditChannel(row)&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span><span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:icon</span>=<span class="string">&quot;Delete&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">circle</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">plain</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        @<span class="attr">click</span>=<span class="string">&quot;onDelChannel(row)&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span><span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">template</span> #<span class="attr">empty</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-empty</span> <span class="attr">description</span>=<span class="string">&quot;没有数据&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line">&lt;/el-table&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onEditChannel</span> = (<span class="params">row</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(row)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onDelChannel</span> = (<span class="params">row</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(row)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="el-table-表格-loading-效果"><a href="#el-table-表格-loading-效果" class="headerlink" title="el-table 表格 loading 效果"></a>el-table 表格 loading 效果</h3><ol><li>定义变量，v-loading绑定</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> loading = <span class="title function_">ref</span>(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">&lt;el-table v-loading=<span class="string">&quot;loading&quot;</span>&gt;</span><br></pre></td></tr></table></figure><ol><li>发送请求前开启，请求结束关闭</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">getChannelList</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  loading.<span class="property">value</span> = <span class="literal">true</span></span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">artGetChannelsService</span>()</span><br><span class="line">  channelList.<span class="property">value</span> = res.<span class="property">data</span>.<span class="property">data</span></span><br><span class="line">  loading.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="文章分类添加编辑-element-plus-弹层"><a href="#文章分类添加编辑-element-plus-弹层" class="headerlink" title="文章分类添加编辑 [element-plus 弹层]"></a>文章分类添加编辑 [element-plus 弹层]</h2><h3 id="点击显示弹层"><a href="#点击显示弹层" class="headerlink" title="点击显示弹层"></a>点击显示弹层</h3><ol><li>准备弹层</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> dialogVisible = <span class="title function_">ref</span>(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">&lt;el-dialog v-model=<span class="string">&quot;dialogVisible&quot;</span> title=<span class="string">&quot;添加弹层&quot;</span> width=<span class="string">&quot;30%&quot;</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>我是内容部分<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">template</span> #<span class="attr">footer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;dialog-footer&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;dialogVisible = false&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span> 确认 <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line">&lt;/el-dialog&gt;</span><br></pre></td></tr></table></figure><ol><li>点击事件</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;template #extra&gt;<span class="language-xml"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;onAddChannel&quot;</span>&gt;</span>添加分类<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span>&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onAddChannel</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  dialogVisible.<span class="property">value</span> = <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="封装弹层组件-ChannelEdit"><a href="#封装弹层组件-ChannelEdit" class="headerlink" title="封装弹层组件 ChannelEdit"></a>封装弹层组件 ChannelEdit</h3><p>添加 和 编辑，可以共用一个弹层，所以可以将弹层封装成一个组件</p><p>组件对外暴露一个方法 open,  基于 open 的参数，初始化表单数据，并判断区分是添加 还是 编辑</p><ol><li>open({ })                   =&gt;  添加操作，添加表单初始化无数据</li><li>open({ id: xx,  …  })  =&gt;  编辑操作，编辑表单初始化需回显</li></ol><p>具体实现：</p><ol><li>封装组件 <code>article/components/ChannelEdit.vue</code></li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> dialogVisible = <span class="title function_">ref</span>(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">open</span> = <span class="keyword">async</span> (<span class="params">row</span>) =&gt; &#123;</span><br><span class="line">  dialogVisible.<span class="property">value</span> = <span class="literal">true</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(row)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">defineExpose</span>(&#123;</span><br><span class="line">  open</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">v-model</span>=<span class="string">&quot;dialogVisible&quot;</span> <span class="attr">title</span>=<span class="string">&quot;添加弹层&quot;</span> <span class="attr">width</span>=<span class="string">&quot;30%&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>我是内容部分<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">footer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;dialog-footer&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;dialogVisible = false&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span> 确认 <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ol><li>通过 ref 绑定</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> dialog = <span class="title function_">ref</span>()</span><br><span class="line"></span><br><span class="line">&lt;!-- 弹窗 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">channel-edit</span> <span class="attr">ref</span>=<span class="string">&quot;dialog&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">channel-edit</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ol><li>点击调用方法显示弹窗</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">onAddChannel</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  dialog.<span class="property">value</span>.<span class="title function_">open</span>(&#123;&#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onEditChannel</span> = (<span class="params">row</span>) =&gt; &#123;</span><br><span class="line">  dialog.<span class="property">value</span>.<span class="title function_">open</span>(row)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="准备弹层表单"><a href="#准备弹层表单" class="headerlink" title="准备弹层表单"></a>准备弹层表单</h3><ol><li>准备数据 和 校验规则</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> formModel = <span class="title function_">ref</span>(&#123;</span><br><span class="line">  <span class="attr">cate_name</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">cate_alias</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> rules = &#123;</span><br><span class="line">  <span class="attr">cate_name</span>: [</span><br><span class="line">    &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入分类名称&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">pattern</span>: <span class="regexp">/^\S&#123;1,10&#125;$/</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;分类名必须是1-10位的非空字符&#x27;</span>,</span><br><span class="line">      <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">cate_alias</span>: [</span><br><span class="line">    &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入分类别名&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">pattern</span>: <span class="regexp">/^[a-zA-Z0-9]&#123;1,15&#125;$/</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;分类别名必须是1-15位的字母数字&#x27;</span>,</span><br><span class="line">      <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>准备表单</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-form</span><br><span class="line">  :model=<span class="string">&quot;formModel&quot;</span></span><br><span class="line">  :rules=<span class="string">&quot;rules&quot;</span></span><br><span class="line">  label-width=<span class="string">&quot;100px&quot;</span></span><br><span class="line">  style=<span class="string">&quot;padding-right: 30px&quot;</span></span><br><span class="line">&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;分类名称&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;cate_name&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">v-model</span>=<span class="string">&quot;formModel.cate_name&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">minlength</span>=<span class="string">&quot;1&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">maxlength</span>=<span class="string">&quot;10&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;分类别名&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;cate_alias&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">v-model</span>=<span class="string">&quot;formModel.cate_alias&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">minlength</span>=<span class="string">&quot;1&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">maxlength</span>=<span class="string">&quot;15&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line">&lt;/el-form&gt;</span><br></pre></td></tr></table></figure><ol><li>编辑需要回显，表单数据需要初始化</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">open</span> = <span class="keyword">async</span> (<span class="params">row</span>) =&gt; &#123;</span><br><span class="line">  dialogVisible.<span class="property">value</span> = <span class="literal">true</span></span><br><span class="line">  formModel.<span class="property">value</span> = &#123; ...row &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>基于传过来的表单数据，进行标题控制，有 id 的是编辑</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">:title=<span class="string">&quot;formModel.id ? &#x27;编辑分类&#x27; : &#x27;添加分类&#x27;&quot;</span></span><br></pre></td></tr></table></figure><h3 id="确认提交"><a href="#确认提交" class="headerlink" title="确认提交"></a>确认提交</h3><ol><li><code>api/article.js</code>  封装请求 API</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 添加文章分类</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">artAddChannelService</span> = (<span class="params">data</span>) =&gt; request.<span class="title function_">post</span>(<span class="string">&#x27;/my/cate/add&#x27;</span>, data)</span><br><span class="line"><span class="comment">// 编辑文章分类</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">artEditChannelService</span> = (<span class="params">data</span>) =&gt;</span><br><span class="line">  request.<span class="title function_">put</span>(<span class="string">&#x27;/my/cate/info&#x27;</span>, data)</span><br></pre></td></tr></table></figure><ol><li>页面中校验，判断，提交请求</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-form ref=<span class="string">&quot;formRef&quot;</span>&gt;</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> formRef = <span class="title function_">ref</span>()</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onSubmit</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> formRef.<span class="property">value</span>.<span class="title function_">validate</span>()</span><br><span class="line">  formModel.<span class="property">value</span>.<span class="property">id</span></span><br><span class="line">    ? <span class="keyword">await</span> <span class="title function_">artEditChannelService</span>(formModel.<span class="property">value</span>)</span><br><span class="line">    : <span class="keyword">await</span> <span class="title function_">artAddChannelService</span>(formModel.<span class="property">value</span>)</span><br><span class="line">  <span class="title class_">ElMessage</span>(&#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">    <span class="attr">message</span>: formModel.<span class="property">value</span>.<span class="property">id</span> ? <span class="string">&#x27;编辑成功&#x27;</span> : <span class="string">&#x27;添加成功&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">  dialogVisible.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>通知父组件进行回显</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> emit = <span class="title function_">defineEmits</span>([<span class="string">&#x27;success&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onSubmit</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="title function_">emit</span>(<span class="string">&#x27;success&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>父组件监听 success 事件，进行调用回显</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;channel-edit ref=<span class="string">&quot;dialog&quot;</span> @success=<span class="string">&quot;onSuccess&quot;</span>&gt;&lt;/channel-edit&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onSuccess</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">getChannelList</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="文章分类删除"><a href="#文章分类删除" class="headerlink" title="文章分类删除"></a>文章分类删除</h2><ol><li><code>api/article.js</code>封装接口 api</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 删除文章分类</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">artDelChannelService</span> = (<span class="params">id</span>) =&gt;</span><br><span class="line">  request.<span class="title function_">delete</span>(<span class="string">&#x27;/my/cate/del&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">params</span>: &#123; id &#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><ol><li>页面中添加确认框，调用接口进行提示</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">onDelChannel</span> = <span class="keyword">async</span> (<span class="params">row</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="title class_">ElMessageBox</span>.<span class="title function_">confirm</span>(<span class="string">&#x27;你确认删除该分类信息吗？&#x27;</span>, <span class="string">&#x27;温馨提示&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;warning&#x27;</span>,</span><br><span class="line">    <span class="attr">confirmButtonText</span>: <span class="string">&#x27;确认&#x27;</span>,</span><br><span class="line">    <span class="attr">cancelButtonText</span>: <span class="string">&#x27;取消&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">artDelChannelService</span>(row.<span class="property">id</span>)</span><br><span class="line">  <span class="title class_">ElMessage</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;success&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;删除成功&#x27;</span> &#125;)</span><br><span class="line">  <span class="title function_">getChannelList</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="文章管理页面-element-plus-强化"><a href="#文章管理页面-element-plus-强化" class="headerlink" title="文章管理页面 - [element-plus 强化]"></a>文章管理页面 - [element-plus 强化]</h1><h2 id="文章列表渲染"><a href="#文章列表渲染" class="headerlink" title="文章列表渲染"></a>文章列表渲染</h2><h3 id="基本架子搭建"><a href="#基本架子搭建" class="headerlink" title="基本架子搭建"></a>基本架子搭建</h3><p><img src="image-20230724224754131.png" alt="image-20230724224754131"></p><ol><li>搜索表单</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-form inline&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;文章分类：&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;新闻&quot;</span> <span class="attr">value</span>=<span class="string">&quot;111&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;体育&quot;</span> <span class="attr">value</span>=<span class="string">&quot;222&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;发布状态：&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;已发布&quot;</span> <span class="attr">value</span>=<span class="string">&quot;已发布&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;草稿&quot;</span> <span class="attr">value</span>=<span class="string">&quot;草稿&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>搜索<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-button</span>&gt;</span>重置<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line">&lt;/el-form&gt;</span><br></pre></td></tr></table></figure><ol><li>表格准备，模拟假数据渲染</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Delete</span>, <span class="title class_">Edit</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@element-plus/icons-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="comment">// 假数据</span></span><br><span class="line"><span class="keyword">const</span> articleList = <span class="title function_">ref</span>([</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="number">5961</span>,</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;新的文章啊&#x27;</span>,</span><br><span class="line">    <span class="attr">pub_date</span>: <span class="string">&#x27;2022-07-10 14:53:52.604&#x27;</span>,</span><br><span class="line">    <span class="attr">state</span>: <span class="string">&#x27;已发布&#x27;</span>,</span><br><span class="line">    <span class="attr">cate_name</span>: <span class="string">&#x27;体育&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="number">5962</span>,</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;新的文章啊&#x27;</span>,</span><br><span class="line">    <span class="attr">pub_date</span>: <span class="string">&#x27;2022-07-10 14:54:30.904&#x27;</span>,</span><br><span class="line">    <span class="attr">state</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">cate_name</span>: <span class="string">&#x27;体育&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-table :data=<span class="string">&quot;articleList&quot;</span> style=<span class="string">&quot;width: 100%&quot;</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;文章标题&quot;</span> <span class="attr">width</span>=<span class="string">&quot;400&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; row &#125;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-link</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">:underline</span>=<span class="string">&quot;false&quot;</span>&gt;</span>&#123;&#123; row.title &#125;&#125;<span class="tag">&lt;/<span class="name">el-link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;分类&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;cate_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;发表时间&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;pub_date&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;状态&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;state&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; row &#125;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:icon</span>=<span class="string">&quot;Edit&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">circle</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">plain</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        @<span class="attr">click</span>=<span class="string">&quot;onEditArticle(row)&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span><span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:icon</span>=<span class="string">&quot;Delete&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">circle</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">plain</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        @<span class="attr">click</span>=<span class="string">&quot;onDeleteArticle(row)&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span><span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">template</span> #<span class="attr">empty</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-empty</span> <span class="attr">description</span>=<span class="string">&quot;没有数据&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line">&lt;/el-table&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onEditArticle</span> = (<span class="params">row</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(row)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onDeleteArticle</span> = (<span class="params">row</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(row)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="中英国际化处理"><a href="#中英国际化处理" class="headerlink" title="中英国际化处理"></a>中英国际化处理</h3><p>默认是英文的，由于这里不涉及切换， 所以在 App.vue 中直接导入设置成中文即可，</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> zh <span class="keyword">from</span> <span class="string">&#x27;element-plus/es/locale/lang/zh-cn.mjs&#x27;</span></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!-- 国际化处理 --&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">el-config-provider</span> <span class="attr">:locale</span>=<span class="string">&quot;zh&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">router-view</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-config-provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="文章分类选择"><a href="#文章分类选择" class="headerlink" title="文章分类选择"></a>文章分类选择</h3><p>为了便于维护，直接拆分成一个小组件 ChannelSelect.vue</p><ol><li>新建 article/components/ChannelSelect.vue</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;新闻&quot;</span> <span class="attr">value</span>=<span class="string">&quot;新闻&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;体育&quot;</span> <span class="attr">value</span>=<span class="string">&quot;体育&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><ol><li>页面中导入渲染</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import ChannelSelect from &#x27;./components/ChannelSelect.vue&#x27;</span><br><span class="line"></span><br><span class="line">&lt;el-form-item label=&quot;文章分类：&quot;&gt;</span><br><span class="line">  &lt;channel-select&gt;&lt;/channel-select&gt;</span><br><span class="line">&lt;/el-form-item&gt;</span><br></pre></td></tr></table></figure><ol><li>调用接口，动态渲染下拉分类，设计成 v-model 的使用方式</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; artGetChannelsService &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/article&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">defineProps</span>(&#123;</span><br><span class="line">  <span class="attr">modelValue</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: [<span class="title class_">Number</span>, <span class="title class_">String</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> emit = <span class="title function_">defineEmits</span>([<span class="string">&#x27;update:modelValue&#x27;</span>])</span><br><span class="line"><span class="keyword">const</span> channelList = <span class="title function_">ref</span>([])</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getChannelList</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">artGetChannelsService</span>()</span><br><span class="line">  channelList.<span class="property">value</span> = res.<span class="property">data</span>.<span class="property">data</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">getChannelList</span>()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">el-select</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">:modelValue</span>=<span class="string">&quot;modelValue&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    @<span class="attr">update:modelValue</span>=<span class="string">&quot;emit(&#x27;update:modelValue&#x27;, $event)&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  &gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-option</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">v-for</span>=<span class="string">&quot;channel in channelList&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:key</span>=<span class="string">&quot;channel.id&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:label</span>=<span class="string">&quot;channel.cate_name&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:value</span>=<span class="string">&quot;channel.id&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span><span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ol><li>父组件定义参数绑定</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> params = <span class="title function_">ref</span>(&#123;</span><br><span class="line">  <span class="attr">pagenum</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">pagesize</span>: <span class="number">5</span>,</span><br><span class="line">  <span class="attr">cate_id</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">state</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;channel-select v-model=<span class="string">&quot;params.cate_id&quot;</span>&gt;&lt;/channel-select&gt;</span><br></pre></td></tr></table></figure><ol><li>发布状态，也绑定一下，便于将来提交表单</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-select v-model=<span class="string">&quot;params.state&quot;</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;已发布&quot;</span> <span class="attr">value</span>=<span class="string">&quot;已发布&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;草稿&quot;</span> <span class="attr">value</span>=<span class="string">&quot;草稿&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line">&lt;/el-select&gt;</span><br></pre></td></tr></table></figure><h3 id="封装-API-接口，请求渲染"><a href="#封装-API-接口，请求渲染" class="headerlink" title="封装 API 接口，请求渲染"></a>封装 API 接口，请求渲染</h3><p><strong>没有数据，可以登录已完成的系统，添加几条数据</strong></p><ol><li><code>api/article.js</code>封装接口</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">artGetListService</span> = (<span class="params">params</span>) =&gt;</span><br><span class="line">  request.<span class="title function_">get</span>(<span class="string">&#x27;/my/article/list&#x27;</span>, &#123; params &#125;)</span><br></pre></td></tr></table></figure><ol><li>页面中调用保存数据</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> articleList = <span class="title function_">ref</span>([])</span><br><span class="line"><span class="keyword">const</span> total = <span class="title function_">ref</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getArticleList</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">artGetListService</span>(params.<span class="property">value</span>)</span><br><span class="line">  articleList.<span class="property">value</span> = res.<span class="property">data</span>.<span class="property">data</span></span><br><span class="line">  total.<span class="property">value</span> = res.<span class="property">data</span>.<span class="property">total</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">getArticleList</span>()</span><br></pre></td></tr></table></figure><ol><li>新建 <code>utils/format.js</code> 封装格式化日期函数</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; dayjs &#125; <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">formatTime</span> = (<span class="params">time</span>) =&gt; <span class="title function_">dayjs</span>(time).<span class="title function_">format</span>(<span class="string">&#x27;YYYY年MM月DD日&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li>导入使用</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; formatTime &#125; from &#x27;@/utils/format&#x27;</span><br><span class="line"></span><br><span class="line">&lt;el-table-column label=&quot;发表时间&quot;&gt;</span><br><span class="line">  &lt;template #default=&quot;&#123; row &#125;&quot;&gt;</span><br><span class="line">    &#123;&#123; formatTime(row.pub_date) &#125;&#125;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">&lt;/el-table-column&gt;</span><br></pre></td></tr></table></figure><h3 id="分页渲染-element-plus-分页"><a href="#分页渲染-element-plus-分页" class="headerlink" title="分页渲染 [element-plus 分页]"></a>分页渲染 [element-plus 分页]</h3><ol><li>分页组件</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-pagination</span><br><span class="line">  v-<span class="attr">model</span>:current-page=<span class="string">&quot;params.pagenum&quot;</span></span><br><span class="line">  v-<span class="attr">model</span>:page-size=<span class="string">&quot;params.pagesize&quot;</span></span><br><span class="line">  :page-sizes=<span class="string">&quot;[2, 3, 4, 5, 10]&quot;</span></span><br><span class="line">  layout=<span class="string">&quot;jumper, total, sizes, prev, pager, next&quot;</span></span><br><span class="line">  background</span><br><span class="line">  :total=<span class="string">&quot;total&quot;</span></span><br><span class="line">  @size-change=<span class="string">&quot;onSizeChange&quot;</span></span><br><span class="line">  @current-change=<span class="string">&quot;onCurrentChange&quot;</span></span><br><span class="line">  style=<span class="string">&quot;margin-top: 20px; justify-content: flex-end&quot;</span></span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure><ol><li>提供分页修改逻辑</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">onSizeChange</span> = (<span class="params">size</span>) =&gt; &#123;</span><br><span class="line">  params.<span class="property">value</span>.<span class="property">pagenum</span> = <span class="number">1</span></span><br><span class="line">  params.<span class="property">value</span>.<span class="property">pagesize</span> = size</span><br><span class="line">  <span class="title function_">getArticleList</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onCurrentChange</span> = (<span class="params">page</span>) =&gt; &#123;</span><br><span class="line">  params.<span class="property">value</span>.<span class="property">pagenum</span> = page</span><br><span class="line">  <span class="title function_">getArticleList</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="添加-loading-处理"><a href="#添加-loading-处理" class="headerlink" title="添加 loading 处理"></a>添加 loading 处理</h3><ol><li>准备数据</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> loading = <span class="title function_">ref</span>(<span class="literal">false</span>)</span><br></pre></td></tr></table></figure><ol><li>el-table上面绑定</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-table v-loading=<span class="string">&quot;loading&quot;</span> &gt; ... &lt;/el-table&gt;</span><br></pre></td></tr></table></figure><ol><li>发送请求时添加 loading</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">getArticleList</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  loading.<span class="property">value</span> = <span class="literal">true</span></span><br><span class="line">    </span><br><span class="line">  ...</span><br><span class="line">  </span><br><span class="line">  loading.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">getArticleList</span>()</span><br></pre></td></tr></table></figure><h3 id="搜索-和-重置功能"><a href="#搜索-和-重置功能" class="headerlink" title="搜索 和 重置功能"></a>搜索 和 重置功能</h3><ol><li>注册事件</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-form-item&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;onSearch&quot;</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>搜索<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;onReset&quot;</span>&gt;</span>重置<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line">&lt;/el-form-item&gt;</span><br></pre></td></tr></table></figure><ol><li>绑定处理</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">onSearch</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  params.<span class="property">value</span>.<span class="property">pagenum</span> = <span class="number">1</span></span><br><span class="line">  <span class="title function_">getArticleList</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onReset</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  params.<span class="property">value</span>.<span class="property">pagenum</span> = <span class="number">1</span></span><br><span class="line">  params.<span class="property">value</span>.<span class="property">cate_id</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  params.<span class="property">value</span>.<span class="property">state</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="title function_">getArticleList</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="文章发布-amp-修改-element-plus-抽屉"><a href="#文章发布-amp-修改-element-plus-抽屉" class="headerlink" title="文章发布&amp;修改 [element-plus - 抽屉]"></a>文章发布&amp;修改 [element-plus - 抽屉]</h2><h3 id="点击显示抽屉"><a href="#点击显示抽屉" class="headerlink" title="点击显示抽屉"></a>点击显示抽屉</h3><ol><li>准备数据</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> visibleDrawer = <span class="title function_">ref</span>(<span class="literal">false</span>)</span><br></pre></td></tr></table></figure><ol><li>准备抽屉容器</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-drawer</span><br><span class="line">  v-model=<span class="string">&quot;visibleDrawer&quot;</span></span><br><span class="line">  title=<span class="string">&quot;大标题&quot;</span></span><br><span class="line">  direction=<span class="string">&quot;rtl&quot;</span></span><br><span class="line">  size=<span class="string">&quot;50%&quot;</span></span><br><span class="line">&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>Hi there!<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">&lt;/el-drawer&gt;</span><br></pre></td></tr></table></figure><ol><li>点击修改布尔值显示抽屉</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-button type=<span class="string">&quot;primary&quot;</span> @click=<span class="string">&quot;onAddArticle&quot;</span>&gt;发布文章&lt;/el-button&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> visibleDrawer = <span class="title function_">ref</span>(<span class="literal">false</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onAddArticle</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  visibleDrawer.<span class="property">value</span> = <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="封装抽屉组件-ArticleEdit"><a href="#封装抽屉组件-ArticleEdit" class="headerlink" title="封装抽屉组件 ArticleEdit"></a>封装抽屉组件 ArticleEdit</h3><p>添加 和 编辑，可以共用一个抽屉，所以可以将抽屉封装成一个组件</p><p>组件对外暴露一个方法 open,  基于 open 的参数，初始化表单数据，并判断区分是添加 还是 编辑</p><ol><li>open({ })                   =&gt;  添加操作，添加表单初始化无数据</li><li>open({ id: xx,  …  })  =&gt;  编辑操作，编辑表单初始化需回显</li></ol><p>具体实现：</p><ol><li>封装组件 <code>article/components/ArticleEdit.vue</code></li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> visibleDrawer = <span class="title function_">ref</span>(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">open</span> = (<span class="params">row</span>) =&gt; &#123;</span><br><span class="line">  visibleDrawer.<span class="property">value</span> = <span class="literal">true</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(row)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">defineExpose</span>(&#123;</span><br><span class="line">  open</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!-- 抽屉 --&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">el-drawer</span> <span class="attr">v-model</span>=<span class="string">&quot;visibleDrawer&quot;</span> <span class="attr">title</span>=<span class="string">&quot;大标题&quot;</span> <span class="attr">direction</span>=<span class="string">&quot;rtl&quot;</span> <span class="attr">size</span>=<span class="string">&quot;50%&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>Hi there!<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-drawer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ol><li>通过 ref 绑定</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> articleEditRef = <span class="title function_">ref</span>()</span><br><span class="line"></span><br><span class="line">&lt;!-- 弹窗 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">article-edit</span> <span class="attr">ref</span>=<span class="string">&quot;articleEditRef&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">article-edit</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ol><li>点击调用方法显示弹窗</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 编辑新增逻辑</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onAddArticle</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  articleEditRef.<span class="property">value</span>.<span class="title function_">open</span>(&#123;&#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onEditArticle</span> = (<span class="params">row</span>) =&gt; &#123;</span><br><span class="line">  articleEditRef.<span class="property">value</span>.<span class="title function_">open</span>(row)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="完善抽屉表单结构"><a href="#完善抽屉表单结构" class="headerlink" title="完善抽屉表单结构"></a>完善抽屉表单结构</h3><ol><li>准备数据</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> formModel = <span class="title function_">ref</span>(&#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">cate_id</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">cover_img</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">content</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">state</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">open</span> = <span class="keyword">async</span> (<span class="params">row</span>) =&gt; &#123;</span><br><span class="line">  visibleDrawer.<span class="property">value</span> = <span class="literal">true</span></span><br><span class="line">  <span class="keyword">if</span> (row.<span class="property">id</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;编辑回显&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;添加功能&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>准备 form 表单结构</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ChannelSelect</span> <span class="keyword">from</span> <span class="string">&#x27;./ChannelSelect.vue&#x27;</span></span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-drawer</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">v-model</span>=<span class="string">&quot;visibleDrawer&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">:title</span>=<span class="string">&quot;formModel.id ? &#x27;编辑文章&#x27; : &#x27;添加文章&#x27;&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">direction</span>=<span class="string">&quot;rtl&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">size</span>=<span class="string">&quot;50%&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  &gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 发表文章表单 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;formModel&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;formRef&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;100px&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;文章标题&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;formModel.title&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入标题&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;文章分类&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;cate_id&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">channel-select</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">v-model</span>=<span class="string">&quot;formModel.cate_id&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span><span class="tag">&lt;/<span class="name">channel-select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;文章封面&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;cover_img&quot;</span>&gt;</span> 文件上传 <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;文章内容&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;editor&quot;</span>&gt;</span>富文本编辑器<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>发布<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;info&quot;</span>&gt;</span>草稿<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">el-drawer</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><ol><li>一打开默认重置添加的 form 表单数据</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> defaultForm = &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">cate_id</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">cover_img</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">content</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">state</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> formModel = <span class="title function_">ref</span>(&#123; ...defaultForm &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">open</span> = <span class="keyword">async</span> (<span class="params">row</span>) =&gt; &#123;</span><br><span class="line">  visibleDrawer.<span class="property">value</span> = <span class="literal">true</span></span><br><span class="line">  <span class="keyword">if</span> (row.<span class="property">id</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;编辑回显&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;添加功能&#x27;</span>)</span><br><span class="line">    formModel.<span class="property">value</span> = &#123; ...defaultForm &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>扩展 下拉菜单 width props</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="title function_">defineProps</span>(&#123;</span><br><span class="line">  <span class="attr">modelValue</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: [<span class="title class_">Number</span>, <span class="title class_">String</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">width</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;el-select</span><br><span class="line"> ...</span><br><span class="line"> :style=<span class="string">&quot;&#123; width &#125;&quot;</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><h3 id="上传文件-element-plus-文件预览"><a href="#上传文件-element-plus-文件预览" class="headerlink" title="上传文件 [element-plus - 文件预览]"></a>上传文件 [element-plus - 文件预览]</h3><ol><li>关闭自动上传，准备结构</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Plus</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@element-plus/icons-vue&#x27;</span></span><br><span class="line"></span><br><span class="line">&lt;el-upload</span><br><span class="line">  <span class="keyword">class</span>=<span class="string">&quot;avatar-uploader&quot;</span></span><br><span class="line">  :auto-upload=<span class="string">&quot;false&quot;</span></span><br><span class="line">  :show-file-list=<span class="string">&quot;false&quot;</span></span><br><span class="line">  :on-change=<span class="string">&quot;onUploadFile&quot;</span></span><br><span class="line">&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">v-if</span>=<span class="string">&quot;imgUrl&quot;</span> <span class="attr">:src</span>=<span class="string">&quot;imgUrl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;avatar&quot;</span> /&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-icon</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">&quot;avatar-uploader-icon&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">Plus</span> /&gt;</span><span class="tag">&lt;/<span class="name">el-icon</span>&gt;</span></span></span><br><span class="line">&lt;/el-upload&gt;</span><br></pre></td></tr></table></figure><ol><li>准备数据 和 选择图片的处理逻辑</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> imgUrl = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onUploadFile</span> = (<span class="params">uploadFile</span>) =&gt; &#123;</span><br><span class="line">  imgUrl.<span class="property">value</span> = <span class="variable constant_">URL</span>.<span class="title function_">createObjectURL</span>(uploadFile.<span class="property">raw</span>)</span><br><span class="line">  formModel.<span class="property">value</span>.<span class="property">cover_img</span> = uploadFile.<span class="property">raw</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>样式美化</li></ol><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.avatar-uploader</span> &#123;</span><br><span class="line">  :<span class="built_in">deep</span>() &#123;</span><br><span class="line">    <span class="selector-class">.avatar</span> &#123;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">178px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">178px</span>;</span><br><span class="line">      <span class="attribute">display</span>: block;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.el-upload</span> &#123;</span><br><span class="line">      <span class="attribute">border</span>: <span class="number">1px</span> dashed <span class="built_in">var</span>(--el-border-color);</span><br><span class="line">      <span class="attribute">border-radius</span>: <span class="number">6px</span>;</span><br><span class="line">      <span class="attribute">cursor</span>: pointer;</span><br><span class="line">      <span class="attribute">position</span>: relative;</span><br><span class="line">      <span class="attribute">overflow</span>: hidden;</span><br><span class="line">      <span class="attribute">transition</span>: <span class="built_in">var</span>(--el-transition-duration-fast);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.el-upload</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">      <span class="attribute">border-color</span>: <span class="built_in">var</span>(--el-color-primary);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.el-icon</span><span class="selector-class">.avatar-uploader-icon</span> &#123;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">28px</span>;</span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#8c939d</span>;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">178px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">178px</span>;</span><br><span class="line">      <span class="attribute">text-align</span>: center;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="富文本编辑器-vue-quill"><a href="#富文本编辑器-vue-quill" class="headerlink" title="富文本编辑器 [ vue-quill ]"></a>富文本编辑器 [ vue-quill ]</h3><p>官网地址：<a href="https://vueup.github.io/vue-quill/">https://vueup.github.io/vue-quill/</a></p><ol><li>安装包</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">pnpm add @vueup/vue-quill@latest</span><br></pre></td></tr></table></figure><ol><li>注册成局部组件</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">QuillEditor</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@vueup/vue-quill&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@vueup/vue-quill/dist/vue-quill.snow.css&#x27;</span></span><br></pre></td></tr></table></figure><ol><li>页面中使用绑定</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">&quot;editor&quot;</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">quill-editor</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">theme</span>=<span class="string">&quot;snow&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">v-model:content</span>=<span class="string">&quot;formModel.content&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">contentType</span>=<span class="string">&quot;html&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  &gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">quill-editor</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><ol><li>样式美化</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">.<span class="property">editor</span> &#123;</span><br><span class="line">  <span class="attr">width</span>: <span class="number">100</span>%;</span><br><span class="line">  :<span class="title function_">deep</span>(<span class="params">.ql-editor</span>) &#123;</span><br><span class="line">    min-<span class="attr">height</span>: 200px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="添加文章功能"><a href="#添加文章功能" class="headerlink" title="添加文章功能"></a>添加文章功能</h3><ol><li>封装添加接口</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">artPublishService</span> = (<span class="params">data</span>) =&gt;</span><br><span class="line">  request.<span class="title function_">post</span>(<span class="string">&#x27;/my/article/add&#x27;</span>, data)</span><br></pre></td></tr></table></figure><ol><li>注册点击事件调用</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;el-form-item&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;onPublish(&#x27;已发布&#x27;)&quot;</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>发布<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;onPublish(&#x27;草稿&#x27;)&quot;</span> <span class="attr">type</span>=<span class="string">&quot;info&quot;</span>&gt;</span>草稿<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line">&lt;/el-form-item&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发布文章</span></span><br><span class="line"><span class="keyword">const</span> emit = <span class="title function_">defineEmits</span>([<span class="string">&#x27;success&#x27;</span>])</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onPublish</span> = <span class="keyword">async</span> (<span class="params">state</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 将已发布还是草稿状态，存入 state</span></span><br><span class="line">  formModel.<span class="property">value</span>.<span class="property">state</span> = state</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 转换 formData 数据</span></span><br><span class="line">  <span class="keyword">const</span> fd = <span class="keyword">new</span> <span class="title class_">FormData</span>()</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> formModel.<span class="property">value</span>) &#123;</span><br><span class="line">    fd.<span class="title function_">append</span>(key, formModel.<span class="property">value</span>[key])</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (formModel.<span class="property">value</span>.<span class="property">id</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;编辑操作&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 添加请求</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">artPublishService</span>(fd)</span><br><span class="line">    <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&#x27;添加成功&#x27;</span>)</span><br><span class="line">    visibleDrawer.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">    <span class="title function_">emit</span>(<span class="string">&#x27;success&#x27;</span>, <span class="string">&#x27;add&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>父组件监听事件，重新渲染</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;article-edit ref=<span class="string">&quot;articleEditRef&quot;</span> @success=<span class="string">&quot;onSuccess&quot;</span>&gt;&lt;/article-edit&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加修改成功</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onSuccess</span> = (<span class="params">type</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (type === <span class="string">&#x27;add&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// 如果是添加，需要跳转渲染最后一页，编辑直接渲染当前页</span></span><br><span class="line">    <span class="keyword">const</span> lastPage = <span class="title class_">Math</span>.<span class="title function_">ceil</span>((total.<span class="property">value</span> + <span class="number">1</span>) / params.<span class="property">value</span>.<span class="property">pagesize</span>)</span><br><span class="line">    params.<span class="property">value</span>.<span class="property">pagenum</span> = lastPage</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">getArticleList</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="添加完成后的内容重置"><a href="#添加完成后的内容重置" class="headerlink" title="添加完成后的内容重置"></a>添加完成后的内容重置</h3><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> formRef = <span class="title function_">ref</span>()</span><br><span class="line"><span class="keyword">const</span> editorRef = <span class="title function_">ref</span>()</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">open</span> = <span class="keyword">async</span> (<span class="params">row</span>) =&gt; &#123;</span><br><span class="line">  visibleDrawer.<span class="property">value</span> = <span class="literal">true</span></span><br><span class="line">  <span class="keyword">if</span> (row.<span class="property">id</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;编辑回显&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    formModel.<span class="property">value</span> = &#123; ...defaultForm &#125;</span><br><span class="line">    imgUrl.<span class="property">value</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    editorRef.<span class="property">value</span>.<span class="title function_">setHTML</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="编辑文章回显"><a href="#编辑文章回显" class="headerlink" title="编辑文章回显"></a>编辑文章回显</h3><p>如果是编辑操作，一打开抽屉，就需要发送请求，获取数据进行回显</p><ol><li>封装接口，根据 id 获取详情数据</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">artGetDetailService</span> = (<span class="params">id</span>) =&gt;</span><br><span class="line">  request.<span class="title function_">get</span>(<span class="string">&#x27;my/article/info&#x27;</span>, &#123; <span class="attr">params</span>: &#123; id &#125; &#125;)</span><br></pre></td></tr></table></figure><ol><li>页面中调用渲染</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">open</span> = <span class="keyword">async</span> (<span class="params">row</span>) =&gt; &#123;</span><br><span class="line">  visibleDrawer.<span class="property">value</span> = <span class="literal">true</span></span><br><span class="line">  <span class="keyword">if</span> (row.<span class="property">id</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;编辑回显&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">artGetDetailService</span>(row.<span class="property">id</span>)</span><br><span class="line">    formModel.<span class="property">value</span> = res.<span class="property">data</span>.<span class="property">data</span></span><br><span class="line">    imgUrl.<span class="property">value</span> = baseURL + formModel.<span class="property">value</span>.<span class="property">cover_img</span></span><br><span class="line">    <span class="comment">// 提交给后台，需要的是 file 格式的，将网络图片，转成 file 格式</span></span><br><span class="line">    <span class="comment">// 网络图片转成 file 对象, 需要转换一下</span></span><br><span class="line">    formModel.<span class="property">value</span>.<span class="property">cover_img</span> = <span class="keyword">await</span> <span class="title function_">imageUrlToFile</span>(imgUrl.<span class="property">value</span>, formModel.<span class="property">value</span>.<span class="property">cover_img</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;添加功能&#x27;</span>)</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>chatGPT prompt：封装一个函数，基于 axios， 网络图片地址，转 file 对象， 请注意：写中文注释</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 将网络图片地址转换为File对象</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">imageUrlToFile</span>(<span class="params">url, fileName</span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 第一步：使用axios获取网络图片数据</span></span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(url, &#123; <span class="attr">responseType</span>: <span class="string">&#x27;arraybuffer&#x27;</span> &#125;);</span><br><span class="line">    <span class="keyword">const</span> imageData = response.<span class="property">data</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 第二步：将图片数据转换为Blob对象</span></span><br><span class="line">    <span class="keyword">const</span> blob = <span class="keyword">new</span> <span class="title class_">Blob</span>([imageData], &#123; <span class="attr">type</span>: response.<span class="property">headers</span>[<span class="string">&#x27;content-type&#x27;</span>] &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 第三步：创建一个新的File对象</span></span><br><span class="line">    <span class="keyword">const</span> file = <span class="keyword">new</span> <span class="title class_">File</span>([blob], fileName, &#123; <span class="attr">type</span>: blob.<span class="property">type</span> &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> file;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;将图片转换为File对象时发生错误:&#x27;</span>, error);</span><br><span class="line">    <span class="keyword">throw</span> error;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="编辑文章功能"><a href="#编辑文章功能" class="headerlink" title="编辑文章功能"></a>编辑文章功能</h3><ol><li>封装编辑接口</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">artEditService</span> = (<span class="params">data</span>) =&gt; request.<span class="title function_">put</span>(<span class="string">&#x27;my/article/info&#x27;</span>, data)</span><br></pre></td></tr></table></figure><ol><li>提交时调用</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">onPublish</span> = <span class="keyword">async</span> (<span class="params">state</span>) =&gt; &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">if</span> (formModel.<span class="property">value</span>.<span class="property">id</span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">artEditService</span>(fd)</span><br><span class="line">    <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&#x27;编辑成功&#x27;</span>)</span><br><span class="line">    visibleDrawer.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">    <span class="title function_">emit</span>(<span class="string">&#x27;success&#x27;</span>, <span class="string">&#x27;edit&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 添加请求</span></span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="文章删除"><a href="#文章删除" class="headerlink" title="文章删除"></a>文章删除</h2><ol><li>封装删除接口</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">artDelService</span> = (<span class="params">id</span>) =&gt; request.<span class="title function_">delete</span>(<span class="string">&#x27;my/article/info&#x27;</span>, &#123; <span class="attr">params</span>: &#123; id &#125; &#125;)</span><br></pre></td></tr></table></figure><ol><li>页面中添加确认框调用</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">onDeleteArticle</span> = <span class="keyword">async</span> (<span class="params">row</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="title class_">ElMessageBox</span>.<span class="title function_">confirm</span>(<span class="string">&#x27;你确认删除该文章信息吗？&#x27;</span>, <span class="string">&#x27;温馨提示&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;warning&#x27;</span>,</span><br><span class="line">    <span class="attr">confirmButtonText</span>: <span class="string">&#x27;确认&#x27;</span>,</span><br><span class="line">    <span class="attr">cancelButtonText</span>: <span class="string">&#x27;取消&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">artDelService</span>(row.<span class="property">id</span>)</span><br><span class="line">  <span class="title class_">ElMessage</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;success&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;删除成功&#x27;</span> &#125;)</span><br><span class="line">  <span class="title function_">getArticleList</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ChatGPT-amp-Copilot"><a href="#ChatGPT-amp-Copilot" class="headerlink" title="ChatGPT &amp; Copilot"></a>ChatGPT &amp; Copilot</h1><h2 id="AI-的认知-amp-讲解内容说明"><a href="#AI-的认知-amp-讲解内容说明" class="headerlink" title="AI 的认知 &amp; 讲解内容说明"></a>AI 的认知 &amp; 讲解内容说明</h2><p>认知同步：</p><ol><li>AI 早已不是新事物 (接受)  =&gt;  语音识别，人脸识别，无人驾驶，智能机器人…    (包括 ChatGPT 也是研发了多年的产物)</li><li>AI 本质是智能工具 (认识)  =&gt;  人工智能辅助，可以提升效率，但不具备思想意识，无法从零到一取代人类工作</li><li>AI 一定会淘汰掉一部分人  =&gt;  逆水行舟，不进则退；学会拥抱变化，尽早上车</li></ol><p>两个工具：</p><ol><li><p>ChatGPT 3.5 的使用   (4.0 使用方式一致，回答准确度更高，但付费，且每3小时，有次数限制)</p><ol><li><p>正常注册流程  (IP限制，手机号限制)</p></li><li><p>三方整合产品</p><ul><li><p>谷歌搜索：chatgpt 免费网站列表</p></li><li><p><a href="https://github.com/LiLittleCat/awesome-free-chatgpt">https://github.com/LiLittleCat/awesome-free-chatgpt</a></p></li></ul></li></ol></li><li><p>工具 Github Copilot 智能生成代码</p></li></ol><h2 id="ChatGPT-的基本使用-Prompt-优化"><a href="#ChatGPT-的基本使用-Prompt-优化" class="headerlink" title="ChatGPT 的基本使用 - Prompt 优化"></a>ChatGPT 的基本使用 - Prompt 优化</h2><p>AI 互动的过程中，容易出现的问题：</p><ul><li>AI未能理解问题的核心要点</li><li>AI的回答过于宽泛 或 过于具体</li><li>AI提供了错误的信息或观点</li><li>AI未能提供有价值的建议或解决方案</li></ul><p>在识别了问题所在之后，我们可以尝试以下策略来优化我们的Prompt：</p><ul><li><p><strong>明确提问</strong>：</p><p>确保问题表述清晰明确，关键字的准确度，决定了AI 对于需求的理解。</p></li><li><p><strong>细化需求：</strong></p><p>将问题拆分成多个小问题，可以帮助AI更具针对性地回答，也利于即时纠错。</p></li><li><p><strong>添加背景信息：</strong></p><p>提供有关问题背景的详细信息，也可以给 AI 预设一个角色，将有助于AI生成更具深度和价值的回答。</p></li><li><p><strong>适当引导：</strong></p><p>比如：“例如”、“请注意”、“请使用”等，来告诉模型你期望它做什么 或者 不做什么</p></li><li><p><strong>限制范围：</strong></p><p>通过限定回答的范围和长度，可以引导AI生成更精炼的回答</p><pre><code>  ...</code></pre></li></ul><h3 id="案例-前端简历"><a href="#案例-前端简历" class="headerlink" title="案例 - 前端简历"></a>案例 - 前端简历</h3><h4 id="Prompt-优化前："><a href="#Prompt-优化前：" class="headerlink" title="Prompt 优化前："></a>Prompt 优化前：</h4><p>Prompt1:  </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">前端简历</span><br></pre></td></tr></table></figure><h4 id="Prompt-优化后："><a href="#Prompt-优化后：" class="headerlink" title="Prompt 优化后："></a>Prompt 优化后：</h4><p>Prompt1:  </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">背景：你是一名【具有三年开发经验】的前端开发工程师，这三年期间，前两年，你做的【金融】相关四个项目，最后一年做的是【医疗】相关领域的两个项目，且有一定的管理 10人+ 团队的经验。主要的技术栈：【Vue】 和 【小程序】。由于你是计算机软件工程专业，所以你具备一些Java后台、Mysql数据库的知识，也掌握一些基础的算法。</span><br><span class="line"></span><br><span class="line">问题：你会如何编写你的简历个人技能介绍</span><br><span class="line"></span><br><span class="line">要求：8条技能介绍，请注意：你不会 angular。</span><br></pre></td></tr></table></figure><p>Prompt2：</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">基于上文情境，你会如何编写你的项目经验介绍</span><br></pre></td></tr></table></figure><p>Prompt3：</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">你刚才说的方向完全没有问题，但是我想看到更多的项目技术亮点，项目业务解决方案。</span><br><span class="line">请注意：每个项目<span class="number">3</span>个技术亮点，<span class="number">3</span>个业务解决方案。</span><br></pre></td></tr></table></figure><h2 id="工具-Github-Copilot-智能生成代码的使用"><a href="#工具-Github-Copilot-智能生成代码的使用" class="headerlink" title="工具 Github Copilot 智能生成代码的使用"></a>工具 Github Copilot 智能生成代码的使用</h2><h3 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h3><ul><li>登录 github，试用 Copilot</li><li>打开 vscode， 搜索并安装插件 Copilot</li></ul><h3 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h3><ul><li>删除键：不接受</li><li>Tab键：接收</li><li>Ctrl + enter： 查看更多方案</li></ul><h2 id="个人中心项目实战-基本资料"><a href="#个人中心项目实战-基本资料" class="headerlink" title="个人中心项目实战 - 基本资料"></a>个人中心项目实战 - 基本资料</h2><h3 id="静态结构-校验处理"><a href="#静态结构-校验处理" class="headerlink" title="静态结构 + 校验处理"></a>静态结构 + 校验处理</h3><p>chatgpt prompt 提示词参考：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">请基于 elementPlus 和 Vue3 的语法，生成组件代码</span><br><span class="line">要求：</span><br><span class="line">一、表单结构要求</span><br><span class="line">1.  组件中包含一个el-form表单，有四行内容，前三行是输入框，第四行是按钮</span><br><span class="line">2. 第一行 label 登录名称，输入框禁用不可输入状态</span><br><span class="line">3. 第二行 label 用户昵称，输入框可输入</span><br><span class="line">4. 第三行 label 用户邮箱，输入框可输入</span><br><span class="line">5. 第四行按钮，提交修改</span><br><span class="line"></span><br><span class="line">二、校验需求</span><br><span class="line">给昵称 和 邮箱添加校验</span><br><span class="line">1. 昵称 nickname 必须是2-10位的非空字符串</span><br><span class="line">2. 邮箱 email 符合邮箱格式即可，且不能为空</span><br></pre></td></tr></table></figure><p>参考目标代码：</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; useUserStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> &#123;</span><br><span class="line">  <span class="attr">user</span>: &#123; username, nickname, email, id &#125;</span><br><span class="line">&#125; = <span class="title function_">useUserStore</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userInfo = <span class="title function_">ref</span>(&#123; username, nickname, email, id &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rules = &#123;</span><br><span class="line">  <span class="attr">nickname</span>: [</span><br><span class="line">    &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入用户昵称&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">pattern</span>: <span class="regexp">/^\S&#123;2,10&#125;$/</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;昵称必须是2-10位的非空字符串&#x27;</span>,</span><br><span class="line">      <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">email</span>: [</span><br><span class="line">    &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入用户邮箱&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">type</span>: <span class="string">&#x27;email&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;邮箱格式不正确&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">page-container</span> <span class="attr">title</span>=<span class="string">&quot;基本资料&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:span</span>=<span class="string">&quot;12&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-form</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">:model</span>=<span class="string">&quot;userInfo&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">:rules</span>=<span class="string">&quot;rules&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">ref</span>=<span class="string">&quot;formRef&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">label-width</span>=<span class="string">&quot;100px&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">size</span>=<span class="string">&quot;large&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;登录名称&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;userInfo.username&quot;</span> <span class="attr">disabled</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;用户昵称&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;nickname&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;userInfo.nickname&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;用户邮箱&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;email&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;userInfo.email&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>提交修改<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">page-container</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="封装接口，更新个人信息"><a href="#封装接口，更新个人信息" class="headerlink" title="封装接口，更新个人信息"></a>封装接口，更新个人信息</h3><ol><li>封装接口</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">userUpdateInfoService</span> = (<span class="params">&#123; id, nickname, email &#125;</span>) =&gt;</span><br><span class="line">  request.<span class="title function_">put</span>(<span class="string">&#x27;/my/userinfo&#x27;</span>, &#123; id, nickname, email &#125;)</span><br></pre></td></tr></table></figure><ol><li>页面中校验后，封装调用</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> formRef = <span class="title function_">ref</span>()</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onSubmit</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> valid = <span class="keyword">await</span> formRef.<span class="property">value</span>.<span class="title function_">validate</span>()</span><br><span class="line">  <span class="keyword">if</span> (valid) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">userUpdateInfoService</span>(userInfo.<span class="property">value</span>)</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">getUser</span>()</span><br><span class="line">    <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&#x27;修改成功&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="个人中心项目实战-更换头像"><a href="#个人中心项目实战-更换头像" class="headerlink" title="个人中心项目实战 - 更换头像"></a>个人中心项目实战 - 更换头像</h2><h3 id="静态结构"><a href="#静态结构" class="headerlink" title="静态结构"></a>静态结构</h3><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Plus</span>, <span class="title class_">Upload</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@element-plus/icons-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useUserStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userStore = <span class="title function_">useUserStore</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> imgUrl = <span class="title function_">ref</span>(userStore.<span class="property">user</span>.<span class="property">user_pic</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onUploadFile</span> = (<span class="params">file</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(file)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">page-container</span> <span class="attr">title</span>=<span class="string">&quot;更换头像&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:span</span>=<span class="string">&quot;12&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-upload</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">ref</span>=<span class="string">&quot;uploadRef&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">class</span>=<span class="string">&quot;avatar-uploader&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">:auto-upload</span>=<span class="string">&quot;false&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">:show-file-list</span>=<span class="string">&quot;false&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">:on-change</span>=<span class="string">&quot;onUploadFile&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-if</span>=<span class="string">&quot;imgUrl&quot;</span> <span class="attr">:src</span>=<span class="string">&quot;imgUrl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;avatar&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-else</span> <span class="attr">src</span>=<span class="string">&quot;@/avatar.jpg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;278&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-upload</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">:icon</span>=<span class="string">&quot;Plus&quot;</span> <span class="attr">size</span>=<span class="string">&quot;large&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          选择图片</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span> <span class="attr">:icon</span>=<span class="string">&quot;Upload&quot;</span> <span class="attr">size</span>=<span class="string">&quot;large&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          上传头像</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">page-container</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.avatar-uploader</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  :<span class="built_in">deep</span>() &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.avatar</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">width</span>: <span class="number">278px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">height</span>: <span class="number">278px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">display</span>: block;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.el-upload</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">border</span>: <span class="number">1px</span> dashed <span class="built_in">var</span>(--el-border-color);</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">border-radius</span>: <span class="number">6px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">cursor</span>: pointer;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">position</span>: relative;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">overflow</span>: hidden;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">transition</span>: <span class="built_in">var</span>(--el-transition-duration-fast);</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.el-upload</span><span class="selector-pseudo">:hover</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">border-color</span>: <span class="built_in">var</span>(--el-color-primary);</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.el-icon</span><span class="selector-class">.avatar-uploader-icon</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">font-size</span>: <span class="number">28px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">color</span>: <span class="number">#8c939d</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">width</span>: <span class="number">278px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">height</span>: <span class="number">278px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">text-align</span>: center;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="选择预览图片"><a href="#选择预览图片" class="headerlink" title="选择预览图片"></a>选择预览图片</h3><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> uploadRef = <span class="title function_">ref</span>()</span><br><span class="line"><span class="keyword">const</span> imgUrl = <span class="title function_">ref</span>(userStore.<span class="property">user</span>.<span class="property">user_pic</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onUploadFile</span> = (<span class="params">file</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>()</span><br><span class="line">  reader.<span class="title function_">readAsDataURL</span>(file.<span class="property">raw</span>)</span><br><span class="line">  reader.<span class="property">onload</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    imgUrl.<span class="property">value</span> = reader.<span class="property">result</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;el-upload ref=<span class="string">&quot;uploadRef&quot;</span>&gt;&lt;/el-upload&gt; </span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">el-button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  @<span class="attr">click</span>=<span class="string">&quot;uploadRef.$el.querySelector(&#x27;input&#x27;).click()&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">:icon</span>=<span class="string">&quot;Plus&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">size</span>=<span class="string">&quot;large&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  &gt;</span>选择图片&lt;/el-button</span></span><br><span class="line"><span class="language-xml">&gt;</span></span><br></pre></td></tr></table></figure><h3 id="上传头像"><a href="#上传头像" class="headerlink" title="上传头像"></a>上传头像</h3><ol><li>封装接口</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">userUploadAvatarService</span> = (<span class="params">avatar</span>) =&gt; request.<span class="title function_">patch</span>(<span class="string">&#x27;/my/update/avatar&#x27;</span>, &#123; avatar &#125;)</span><br></pre></td></tr></table></figure><ol><li>调用接口</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">onUpdateAvatar</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">userUploadAvatarService</span>(imgUrl.<span class="property">value</span>)</span><br><span class="line">  <span class="keyword">await</span> userStore.<span class="title function_">getUser</span>()</span><br><span class="line">  <span class="title class_">ElMessage</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;success&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;更换头像成功&#x27;</span> &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="个人中心项目实战-重置密码"><a href="#个人中心项目实战-重置密码" class="headerlink" title="个人中心项目实战 - 重置密码"></a>个人中心项目实战 - 重置密码</h2><p>chatgpt  prompt</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">请基于 elementPlus 和 <span class="title class_">Vue3</span> 的语法，生成组件代码</span><br><span class="line">要求：</span><br><span class="line">一、表单结构要求</span><br><span class="line"><span class="number">1.</span> 组件中包含一个el-form表单，有四行内容，前三行是表单输入框，第四行是两个按钮</span><br><span class="line"><span class="number">2.</span> 第一行 label 原密码</span><br><span class="line"><span class="number">3.</span> 第二行 label 新密码</span><br><span class="line"><span class="number">4.</span> 第三行 label 确认密码</span><br><span class="line"><span class="number">5.</span> 第四行两个按钮，修改密码 和 重置</span><br><span class="line"></span><br><span class="line">二、form绑定字段如下：</span><br><span class="line"><span class="keyword">const</span> pwdForm = <span class="title function_">ref</span>(&#123;</span><br><span class="line">  <span class="attr">old_pwd</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">new_pwd</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">re_pwd</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">三、校验需求</span><br><span class="line">所有字段，都是 <span class="number">6</span>-<span class="number">15</span>位 非空</span><br><span class="line">自定义校验<span class="number">1</span>：原密码 和 新密码不能一样</span><br><span class="line">自定义校验<span class="number">2</span>：新密码 和 确认密码必须一样</span><br></pre></td></tr></table></figure><h3 id="静态结构-校验处理-1"><a href="#静态结构-校验处理-1" class="headerlink" title="静态结构 + 校验处理"></a>静态结构 + 校验处理</h3><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> pwdForm = <span class="title function_">ref</span>(&#123;</span><br><span class="line">  <span class="attr">old_pwd</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">new_pwd</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">re_pwd</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">checkOldSame</span> = (<span class="params">rule, value, cb</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (value === pwdForm.<span class="property">value</span>.<span class="property">old_pwd</span>) &#123;</span><br><span class="line">    <span class="title function_">cb</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;原密码和新密码不能一样!&#x27;</span>))</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">cb</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">checkNewSame</span> = (<span class="params">rule, value, cb</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (value !== pwdForm.<span class="property">value</span>.<span class="property">new_pwd</span>) &#123;</span><br><span class="line">    <span class="title function_">cb</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;新密码和确认再次输入的新密码不一样!&#x27;</span>))</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">cb</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> rules = &#123;</span><br><span class="line">  <span class="comment">// 原密码</span></span><br><span class="line">  <span class="attr">old_pwd</span>: [</span><br><span class="line">    &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入密码&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">pattern</span>: <span class="regexp">/^\S&#123;6,15&#125;$/</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;密码长度必须是6-15位的非空字符串&#x27;</span>,</span><br><span class="line">      <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// 新密码</span></span><br><span class="line">  <span class="attr">new_pwd</span>: [</span><br><span class="line">    &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入新密码&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">pattern</span>: <span class="regexp">/^\S&#123;6,15&#125;$/</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;密码长度必须是6-15位的非空字符串&#x27;</span>,</span><br><span class="line">      <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123; <span class="attr">validator</span>: checkOldSame, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// 确认新密码</span></span><br><span class="line">  <span class="attr">re_pwd</span>: [</span><br><span class="line">    &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请再次确认新密码&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">pattern</span>: <span class="regexp">/^\S&#123;6,15&#125;$/</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;密码长度必须是6-15位的非空字符串&#x27;</span>,</span><br><span class="line">      <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123; <span class="attr">validator</span>: checkNewSame, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">page-container</span> <span class="attr">title</span>=<span class="string">&quot;重置密码&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:span</span>=<span class="string">&quot;12&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-form</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">:model</span>=<span class="string">&quot;pwdForm&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">:rules</span>=<span class="string">&quot;rules&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">ref</span>=<span class="string">&quot;formRef&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">label-width</span>=<span class="string">&quot;100px&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">size</span>=<span class="string">&quot;large&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;原密码&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;old_pwd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;pwdForm.old_pwd&quot;</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;新密码&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;new_pwd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;pwdForm.new_pwd&quot;</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;确认新密码&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;re_pwd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;pwdForm.re_pwd&quot;</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;onSubmit&quot;</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>修改密码<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;onReset&quot;</span>&gt;</span>重置<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">page-container</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="封装接口，更新密码信息"><a href="#封装接口，更新密码信息" class="headerlink" title="封装接口，更新密码信息"></a>封装接口，更新密码信息</h3><ol><li>封装接口</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">userUpdatePassService</span> = (<span class="params">&#123; old_pwd, new_pwd, re_pwd &#125;</span>) =&gt;</span><br><span class="line">  request.<span class="title function_">patch</span>(<span class="string">&#x27;/my/updatepwd&#x27;</span>, &#123; old_pwd, new_pwd, re_pwd &#125;)</span><br></pre></td></tr></table></figure><ol><li>页面中调用</li></ol><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> formRef = <span class="title function_">ref</span>()</span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span><br><span class="line"><span class="keyword">const</span> userStore = <span class="title function_">useUserStore</span>()</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onSubmit</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> valid = <span class="keyword">await</span> formRef.<span class="property">value</span>.<span class="title function_">validate</span>()</span><br><span class="line">  <span class="keyword">if</span> (valid) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">userUpdatePassService</span>(pwdForm.<span class="property">value</span>)</span><br><span class="line">    <span class="title class_">ElMessage</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;success&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;更换密码成功&#x27;</span> &#125;)</span><br><span class="line">    userStore.<span class="title function_">setToken</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    userStore.<span class="title function_">setUser</span>(&#123;&#125;)</span><br><span class="line">    router.<span class="title function_">push</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onReset</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  formRef.<span class="property">value</span>.<span class="title function_">resetFields</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 前端 </tag>
            
            <tag> 后台管理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>日本語勉強している·頑張れ！</title>
      <link href="/posts/d711a81c/"/>
      <url>/posts/d711a81c/</url>
      
        <content type="html"><![CDATA[<style>#web_bg{  /* background: url(/img/newbg.png)!important; */  /*重新定义background会导致原有定位属性失效，所以也需要再声明一次加权的定位属性*/  /* background-position: center !important;  background-size: cover !important;  background-repeat: no-repeat !important; */}</style><div class="note blue no-icon flat"><p>日本語の勉強すればするほど、楽しいに感じになりました。ここで、全过程系列导航～</p><ol><li>新标准日本语文法要点（上） ⇦当前位置🪂</li><li><a href="/posts/ff180d2/">新标准日本语文法要点（中）</a> </li><li>新标准日本语文法要点（下）</li><li><a href="/posts/42edf4c9/">日本語能力練習</a></li></ol></div><div class="note info flat"><p>参考：<a href="https://www.bilibili.com/video/BV1LC4y1R7LY/?vd_source=5ac94e646d89dc77f2f8cadbb767d053">新标准日本语初级上</a></p></div><div class="note warning flat"><p>注意：此页面偶尔会存在CSS冲突问题!</p></div><h1 id="2-日本語の日常交流"><a href="#2-日本語の日常交流" class="headerlink" title="2.日本語の日常交流"></a>2.日本語の日常交流</h1><h2 id="初级上册-第十二单元"><a href="#初级上册-第十二单元" class="headerlink" title="初级上册-第十二单元"></a>初级上册-第十二单元</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p>1.45 「少子化｜しょうしか」が進んで、日本の人口はだんだん「減って｜へって」行くでしょうか</p><details class="folding-tag" ><summary> ていきます・きました、例举，ば..ほど </summary>              <div class='content'>              <p>1.45.1　文法説明</p><ol><li><p>「动」ていきます／きました [持续].[变化]：39课学习了动词て形+いきます／きます表示空间移动的用法。现在学习其表示从基准时间观察的动作一直持续或性质、状态的变化的用法。</p><p>动作的持续或性质、状态的变化在基准时间以前用~てきました，在基准时间以后时，用~ていきます；</p><p>少子化が進んで，日本の人口はだんだん減っていくでしょう。最近，中国へ旅行に行く日本人が増えてきましたね。</p><p>20年間ずっと日本語を勉強してきました。これからもずっと日本語を勉強していきます。</p><p>学习了20年日语，今后也会一直学习日语。</p></li><li><p>「动」てきました　[出现]：还有表示某种状态的开始或出现的用法。只限于前接非意志动词；    </p><p>ずっと本を読んでいたので，目が疲れできました。    お母さん，雨が降ってきたよ。    </p><p>【おなか|お腹】が　「すいて｜すく： 是日语中的动词，原意是指“空、空虚、空旷”。」きたんですが，そろそろ食事に行きませんか。（ 空く （すく） 饿了的意思。惯用语）</p></li><li><p>「小句1」し，「小句2」し，「小句3」：在叙述并列的几个事项时，可以用这种表述方式。し前面既可以是简体形也可以是敬体形。另外，小句1和小句2的主语が多用も替换；    </p><p>おいしいし，「手軽｜てがる：表示“简单、方便、轻松”，用来形容事物操作简便、不复杂。」「だし｜与<strong>おいしいし</strong>一样，表示列举原因或列举特征的连接词。所以<strong>手軽だし</strong>表示“方便”或“简单”。」，わたしは冷凍食品をよく食べます。    </p><p>休みだし，天気もいいし，どこかに出かけませんか。    </p><p>にぎやかだし，高いビルが多いし，なんか東京に＊「似ています｜にている：表示“相似、像、相像”，用于描述两者在外观、性质、特点等方面的相似性。」ね。    </p><p>にぎやかだし，高いビルも多いし，なんか東京に似ていますね。    </p><p>電気も消えているし，かぎも「かかっている｜是动词“かかる”（锁上、扣住）的现在进行时，表示“已经锁上了”。」し，【きっと|一定】「留守｜るす：表示“没人（家）”，指某人不在家、家里空无一人」ですよ。    </p><p>ここは空気がきれいですし，「静か｜しずか」ですし，住むのにとてもいい所ですね。</p><p>＊注意：16课学习了表示并列的て形用法。て形并列和～し，～し，～的区别有两点：    </p><p>①て形一般只用于连接形容词和名词，而～し可以用于连接动词；    </p><p>②～し，～し，～一般用于陈述原因、理由，而て形则可以用于各种场合；</p></li><li><p>「动/一类形」ば「动/一类形」ほど「小句」：表示某性质的程度与其相关的动作、性质成正比例关系；    </p><p>この本は　読め　ば　読む　ほど，おもしろいです。    住めば住むほど上海の＊よさが分かりますよ。    </p><p>商品は｢安ければ|是形容词“安い”（便宜）的假设条件形态，即“如果便宜的话”。这里使用的是“安ければ”，表示一种假设或条件。｣安い[ほど|表示程度的词，通常用于“越…越…”的结构中。]売れるんでしょう？    </p><p>【結婚式|けっこんしき】のスピーチは，「短｜短い：みじかい」ければ，短いほどいい　と言われていますね。（言います的被动形式）</p><p>＊注意：二类形容词也可以用于这种句型。接续方式为：</p><p>二类形＋なら＋二类形＋な＋ほど  （多用于口语）    　　  </p><p>或：二类形＋であれば＋二类形＋な＋ほど   （多用于书面语）    </p><p>子供は元気なら元気なほどいいです。    子供は元気であれば元気なほどいいです。</p></li><li><p>で／へ／から／まで／ど　＋　の：第6课学习了に／で／へ／から／まで／ど　＋　は的用法，其实，这些助词还可以后续の，除了に以外；    </p><p>空港から＊市内までの＊｢アクセス|指交通、接驳、可达性等，英语“access”的音译。｣がよくなりました。    北京から東京への＊便は1日に10便以上あります。    </p><p>これ母｢への|表示“给、向”的意思，指向某人或某事物。｣プレゼントです。</p><p>X　これは母にのプレゼントです。</p></li></ol><p>1.45.2　表現と言葉の説明</p><ol><li><p>「交通｜こうつう」の便がいい：表示交通方便，基本课文中用的是ホテルや交通の便（住宿和交通的便利），不能单说ホテルの便がいい。因为 <strong>「便（びん）」</strong> 一般用于指代“交通工具”的航班、班次等，通常与 <strong>「アクセス」</strong>（接驳，交通）或 <strong>「交通」</strong> 等词语结合使用。</p><p>反义形式是交通の便が悪い。    </p><p>ホテルや交通の便がよくなりましたからね。    この辺は交通の便が悪いので，＊｢部屋代|へやだい：指“房间的费用、房租、房价”。｣はあまり高くないです。</p><p>＊ライトアップ「されています｜是“する”的被动形式」：外来词ライトアップ＋します构成的复合词的被动形式。指夜间给建筑物或纪念碑等打上灯光，引人注目；    </p><p>ライトアップされていますね。うーん，見れば見るほどきれいだある。</p><p>＊以前：表示较近的过去。也可以说前に。与汉语的以前用法基本相同，不过日语的以前前面不可以加修饰语，如不能说：X あなたが来る以前、X 10年以前。以前有时候也可以+に，但一般不加に；    </p><p>以前住んでいた「ことがある｜表示“曾经有过某种经验或经历”，用来表达自己曾经做过某件事情。这个结构常用于描述过去的经验。」んですが,とても住みやすいところですよ。    </p><p>彼には、以前あったことがあります。我曾经和他见过面（或与他有过某种交往）。    </p><p>この写真は以前に見たことがあります。</p></li><li><p>＊なんか：意思与38课学过的なんだか相同，表示一种理由不明确的感觉或判断 ，都是口语形式，なんか比なんだか更随便一些。</p><p>相当于汉语当中的总觉得，有点..なんか東京に似ていますね。このお菓子の味，なんか変ですね。</p></li><li><p>～に｢似ています|にています｣：前面的に表示相似的对象；なんか東京に似ていますね。お嬢さんはご主人に似ていますね。　　</p><p>アクセスがよくなりました：用于交通及计算机方面，引申衔接，连接。    </p><p>新し高速道路ができて，空港から市内までのアクセスがよくなりました。    </p><p>今の＊時間帯は込んでいるから，インターネットのアクセスが悪い。</p><p>｢軽く|かるく｣食べていきましょう：两种含义：一种表示味道清淡，不油腻，另一种表示分量少；    </p><p>じゃあ，何か軽く食べていきましょう。[分量]    </p><p>ちょっとおなかの「調子｜ちょうし：是指“状态、情况、状况”。合起来，<strong>おなかの調子</strong> 就是指“肚子的状态”。」をが悪いので，＊軽いものをください。[味道清淡，不油腻]</p></li></ol>              </div>            </details><p>1.46　これは「柔らかく｜やわらかい」て，「まるで｜复测，表示简直、完全像，强调相似度」本物の「毛皮｜けがわ」のようです</p><details class="folding-tag" ><summary> 比喻，推测 </summary>              <div class='content'>              <p>1.46.1　文法説明</p><ol><li><p>「名＋の」／「动（简体形）」ようです　　②[比喻] </p><p>「　名　」／「动（简体形）」みたいです    　②[比喻]</p><p>44课学习了表示推测的用法，这两个形式还可以用来表示比喻，表示比喻时多用まるで呼应使用；    </p><p>これは柔らかくて，まるで本物の「毛皮｜けがわ」のようです。    </p><p>まるでヨーロッパの「町並み｜まちなみ」を見ているようですね。    この野菜，まるで「果物｜くだもの」みたいですね。</p><p>除用于句尾以外，经常以～ような／～みたいな＋名词，或～ように／～みたいに＋动词／形容词的形式来修饰名词、动词或形容词；</p><p>まるでテレビのドラマのような＊「出来事｜できごと：表示“事件、事情、发生的事情”。通常指有一定意义或特别的事情。」ですね。鳥のように空を飛んでみたいなあ。</p><p>先生みたいに上手に日本語が話せるようになりたいです。</p></li><li><p>「名1」＋らしい＋「名2」[典型性]：44课学习了~らしいです表示推测的用法，～らしい还可以用来表示名词2具有名词1的典型特征，多数情况下与いかにも呼应使用。    </p><p>この着物は[いかにも|典型的]日本らしい【柄|がら】ですね。　（いかにも，典型的；がら，柄，花纹）    </p><p>今日は春らしい天気です。    ＊南京路はいかにも上海らしいところですよ。</p><p>如果名词１和名词２为同一个名词，则表示为真正 意义上的，像样的..    </p><p>仕事らしい仕事はしたことがありません。    ＊【このごろ|最近、这段时间】忙しくて，食事らしい食事をしていません。</p></li><li><p>「名（时间）」時間＋まで表示动作持续的最后时间，如3時までレポートを書きます（报告写到3点，表示持续到3点）。</p><p>形式上与其相似的時間＋までに，表示事态发生或完成期间的终点，例如：    </p><p>3時間までにレポートを書きます（三点前完成报告）。    </p><p>明日も9時までにこの書類を完成させなければなりません。（なければなりません／ないと，必须）    </p><p>今月の末までに，新しい家を見つけたいです。</p><p>来月の＊初めまでには事務所＊開設の準備を済ませたいです。（済ませます，すませます，办完，搞完）</p></li><li><p>「名词+の」／「动（简体形）」＋間／間に：表示某种行为或事态的持续时间段，经常与副词ずっと一起使用。    </p><p>学校が休みの間，アルバイトをします。（学校放假期间打工）</p><p>～間に表示事态发生或完成的时间范围，学校が休みの間に，アルバイトをします。</p><p>学校が休みの間，アルバイトをする【つもり|打算、计划】【なんだ|是语气助词，表示确认或解释，通常用于口语中。】。</p><p>部屋の中にを見ている間，ずっと外で車の音が【していました|动词<strong>する</strong>的过去进行时，表示过去某个时间持续发生的动作或状态。】よ。</p><p>私が留学している間に，家の周りも【ずいぶん|表示“非常、很大程度上”，用于强调变化的程度。】【変わりました|かわる】。子供が寝ている間に，部屋を掃除しました。</p><p>赤ちゃんが寝ている間に，洗濯物をしました。わたしは夏休みの間，ずっと自家にました。</p></li><li><p>「名」のような「味｜あじ」／＊においがします：感觉到某种味道或气味时，使用：この牛乳，「変な｜へんな：奇怪、异常的」【味|あじ】するけど，いつ買ったの？</p><p>在这种表达的基础上，前面加上本课所学的表示比喻的～ようです，就成为：～のような味／においがします；</p><p>この野菜，＊レモンのような味がしますね。    </p><p>このスープは，日本のみそ汁のようなにおいがします。    </p><p>除了味／におい之外，表示听觉的、感觉时，也用がします的形式，即声／音／感じがします（有声音／感觉）。    外で子供の声がします。外でずっと車の音がしていましたよ。    </p><p>ここには「昔｜むかし：以前」来たことがある感じがします。    </p><p>＊注意：这里的～します绝对不可以说成 ～あります，即Xにおいがあります、X声があります；    </p><p>＊另外：表示身体状况的词语也可以加在　がします的前面使用，例如：頭痛がします、寒気がします；    </p><p>さっきから，ちょっと＊【吐き気|はきけ】がするんです。（はきけ，吐き気，恶心想吐）</p></li></ol><p>1.46.2　表現と言葉の説明</p><ol><li><p>済ませたい：他动词，结束某件事。与此对应的自动词是*済みます，表示事情结束。    </p><p>来月の初めまでには，事務所「開設｜かいせつ」の「準備｜じゅんび」を「済ませたいです｜すませる：完成，做完某事」。    </p><p>事務所開設の準備が【済みました|すみました：“済む：すむ”（结束、完成）的过去式，表示某事已经完成。】。    外で食事を済ませました。    使用了“済ませる”，表示说话人<strong>主动完成</strong>了吃饭这件事情。</p><p>食事はもう済みました。　使用了“済む”，表示事情完成了、强调结果，关注的是完成的状态，而不是过程。</p></li><li><p>～んじゃないですか　[婉转陈述意见的表达②]：43课学习了～のではないのでしょうか，～んじゃないですか的意思基本接近んじゃない，都是一种完整陈述意见的表达，不过其礼貌程度比～のではないのでしょうか略低；    </p><p>ここ，いいんじゃないですか。    さっきのはもっと【広かった|ひろかった】んじゃないですか。    </p><p>最近，あの人「暇｜ひま」なんじゃないですか。</p></li><li><p>いかにも：表示特别像某种样子或浓厚地具有某种性质，多与～らしい呼应使用。</p><p>～らしい有表示推测和表示典型性的意思，与いかにも呼应使用时，只能表示典型性；    </p><p>うちの子供は将来宇宙飛行士になりたいんだって。ーーいかにも子供らしい夢ね。    </p><p>じゃあ，南京路に行きましょう。いかにも上海らしい所ですよ。    </p><p>眼鏡をかけているあの人は，いかにも大学の先生らしいです。</p></li></ol>              </div>            </details><p>1.47 周先生は明日日本へ「行かれます｜单纯的被动形式也是尊他形式的一种」</p><details class="folding-tag" ><summary> 尊他语 - 点击查看详情 </summary>              <div class='content'>              <ol><li><p>敬语：对于会话中涉及的人物或者听话人表示敬意，现代日语的敬语可粗略分为三类：    </p><p>❶　尊他语：抬高会话中的人物或听话人表示敬意。    </p><p>❷　自谦语：压低自己或说话一方表示敬意。</p><p>❸　礼貌语：通过使用～です、～ます，表示对听话人的敬意。</p></li><li><p>尊他语的特殊形式：</p></li></ol><table border="1">   <thead>      <tr>      <th>动词</th>      <th>基本形</th>      <th>尊他语基本形</th>      <th>尊他ます形</th>      <th>尊他命令形</th>      </tr>   </thead>   <tbody>      <tr>      <td>見る</td>      <td>見る</td>      <td>ご覧になる</td>      <td>ご覧になります</td>      <td>ご覧</td>      </tr>      <tr>      <td>食べる</td>      <td>食べる</td>      <td>召し上がる</td>      <td>召し上がります</td>      <td>召し上がれ</td>      </tr>      <tr>      <td>飲む</td>      <td>飲む</td>      <td>召し上がる</td>      <td>召し上がります</td>      <td>召し上がれ</td>      </tr>      <tr>      <td>行く</td>      <td>行く</td>      <td>いらっしゃる</td>      <td>いらっしゃいます</td>      <td>いらっしゃい</td>      </tr>      <tr>      <td>来る</td>      <td>来る</td>      <td>おいでになる</td>      <td>おいでになります</td>      <td>おいで</td>      </tr>      <tr>      <td>いる</td>      <td>いる</td>      <td>いらっしゃる</td>      <td>いらっしゃいます</td>      <td>いらっしゃい</td>      </tr>      <tr>      <td>する</td>      <td>する</td>      <td>なさる</td>      <td>なさいます</td>      <td>なさい</td>      </tr>      <tr>      <td>言う</td>      <td>言う</td>      <td>おっしゃる</td>      <td>おっしゃいます</td>      <td>おっしゃい</td>      </tr>      <tr>      <td>くれる</td>      <td>くれる</td>      <td>くださる</td>      <td>くださいます</td>      <td>ください</td>      </tr>      <tr>      <td>～ている</td>      <td>～ている</td>      <td>～ていらっしゃる</td>      <td>～ていらっしゃいます</td>      <td>～ていらっしゃい</td>      </tr>      <tr>      <td>～てくれる</td>      <td>～てくれる</td>      <td>～てくださる</td>      <td>～てくださいます</td>      <td>～てください</td>      </tr>   </tbody></table><ol><li><p>「动」（ら）れます：动词的被动形式也可以作为尊他语的一种，但与被动句不同，这里指示单纯的将动词改为（ら）れます，而不改变句子成分及助词等；</p><p>周先生は日本へ行かれます。今朝何時に起きられましたか。部長毎朝公園を散歩されるそうです。</p></li><li><p>お＋「动1/动2（第一连用形）」になります：这是尊他语的另一种表述方式，动1/动2的第一连用形＋になります。但是动1/动2当中去掉ます后只有一个音节的单词，例如：見ます、寝ます、います，则不可以用于这种形式。3类动词也不可以。</p></li></ol><table border="1">   <thead>      <tr>      <th>动词类型</th>      <th>动词（基本形）</th>      <th>第一连用形</th>      <th>尊敬语</th>      </tr>   </thead>   <tbody>      <tr>      <td>一类动词</td>      <td>読みます</td>      <td>読み</td>      <td>お読みなります</td>      </tr>      <tr>      <td>二类动词</td>      <td>決めます</td>      <td>決め</td>      <td>お決めなります</td>      </tr>   </tbody></table><p>   お客様はもうお帰りなりました。</p><p>   お食事はもうお済みになりましたか。</p><p>   旅行の日程はもうお決めになりましたか。</p><ol><li><p>お＋「动1/动2（第一连用形）」ください　　</p><p>ご＋「３类动词汉字部分」ください</p><p>劝说听话人做有益于听话人或有益于公共利益的事情时，可用这种形式，但是动1/动2当中去掉ます后只有一个音节的单词，例如：見ます、寝ます、います，则不可以用于这种形式。3类动词也不可以。</p><table border="1">  <thead>    <tr>      <th>动词类型</th>      <th>动词（基本形）</th>      <th>第一连用形</th>      <th>尊敬语</th>    </tr>  </thead>  <tbody>    <tr>      <td>一类动词</td>      <td>歩きます</td>      <td>あるき</td>      <td>おあるきください</td>    </tr>    <tr>      <td>二类动词</td>      <td>食べます</td>      <td>食べ</td>      <td>お食べください</td>    </tr>    <tr>      <td>三类动词</td>      <td>紹介します</td>      <td>紹介</td>      <td>ご紹介ください</td>    </tr>  </tbody></table></li></ol><ol><li><p>总结：本课学习了尊他语的三种形式：其中　～（ら）れます表示较轻微的敬意，另外两种表示较深的敬意；</p><p>有特殊尊他形式的动词，一般不使用～おになります的形式；</p><p>既有特殊形式又可用于 お　～になります形式的只有食べます和飲みます这两个动词，他们的特殊尊他形式召し上がります更具有敬意；</p></li></ol>              </div>            </details><p>1.48　お荷物は私がお待ちします</p><details class="folding-tag" ><summary> 自谦语 - 点击查看详情 </summary>              <div class='content'>              <p>1.48.1　文法説明</p><ol><li><p>自谦语：通过压低说话人自身或说话人一方的形式来表示尊敬的表达方式，跟别人谈及自己的家人或自己公司的上级时，也需要用自谦语。</p></li><li><p>自谦语的特殊形式：</p><table border="1">  <thead>    <tr>      <th>基本形</th>      <th>自谦语（基本形）</th>      <th>自谦语（ます形）</th>    </tr>  </thead>  <tbody>    <tr>      <td>見る</td>      <td>拝見する</td>      <td>拝見します</td>    </tr>    <tr>      <td>食べる</td>      <td>いただく</td>      <td>いただきます</td>    </tr>    <tr>      <td>飲む</td>      <td>飲む（无自谦语变化）</td>      <td>飲みます（无自谦语变化）</td>    </tr>    <tr>      <td>行く</td>      <td>参る／うかがう</td>      <td>参ります／うかがいます</td>    </tr>    <tr>      <td>来る</td>      <td>来る（无自谦语变化）</td>      <td>来ます（无自谦语变化）</td>    </tr>    <tr>      <td>聞く</td>      <td>伺う</td>      <td>伺います</td>    </tr>    <tr>      <td>する</td>      <td>いたす</td>      <td>いたします</td>    </tr>    <tr>      <td>言う</td>      <td>申す（もうす）</td>      <td>申します</td>    </tr>    <tr>      <td>あげる</td>      <td>差し上げる</td>      <td>差し上げます</td>    </tr>    <tr>      <td>もらう</td>      <td>いただく</td>      <td>いただきます</td>    </tr>    <tr>      <td>知っている</td>      <td>存じている</td>      <td>存じております</td>    </tr>    <tr>      <td>～てあげる</td>      <td>～て差し上げる</td>      <td>～て差し上げます</td>    </tr>    <tr>      <td>～てもらう</td>      <td>～ていただく</td>      <td>～ていただきます</td>    </tr>  </tbody></table><p>明日，私がそちらへ伺います。    中国の北京から参りました。    </p><p>コピーは私がいたいします    黄教授に論をみて意だたきました。        </p><p>案内状，拝見いたしました。（拝見，見る的自谦语）</p></li><li><p>お＋「动1/动2（第一连用形）」します　　ご＋「三类动词的汉字部分」します这是自谦语当中使用最多的一种表达形式，例如：お話しします、ご連絡します。动词的第一连用形只有一个音节和三类动词来ます、します不能用于这种形式；</p><table border="1">  <thead>    <tr>      <th>动词类型</th>      <th>动词（基本形）</th>      <th>第一连用形</th>      <th>尊敬语</th>    </tr>  </thead>  <tbody>    <tr>      <td>一类动词</td>      <td>はなします</td>      <td>話し</td>      <td>お話しします</td>    </tr>    <tr>      <td>二类动词</td>      <td>見せます</td>      <td>見せ</td>      <td>お見せします</td>    </tr>    <tr>      <td>三类动词</td>      <td>連絡します</td>      <td>連絡</td>      <td>ご連絡します</td>    </tr>  </tbody></table><p>お荷物私がお持ちします。    </p><p>昨日メールをおくりましたんですが..　ーーええ,拝見しました先はど返事をおだししました。    </p><p>明日の午後,ご連絡します。</p></li><li><p>「动」ていただけますか　[请求③]：～いただきます：～ていただ来ます用于请求对方为自己做某事时，要变成いただけます，实际上这是～ていただきます的可能形式。</p><p>更加礼貌的形式是：いただけませんか。この服，ちょっと小さいので，取り替えていただけますか。</p><p>この服，ちょっと小さいので，取り替えていただけませんか。</p><p>教えていただけますか。教えていただけませんか。</p></li><li><p>「动」（さ）せていただきます：使用频率较高，自谦程度高于お／ご～します。构成方式在动词使役形式て形后面＋いただきます。</p><p>早速，資料を届けさせていただきます。    明日，もう一度連絡させていただきます。</p><p>非常礼貌的请求对方允许自己做某事时，可以使用：～させていただけますか／させていただきませんか。    </p><p>頭が痛いんですが，帰らせていただけますか。    来週の水曜日，休ませていただきませんか。</p></li><li><p>ございます／「名」でございます：あります更为礼貌的说法是ございます，～です更加礼貌的说法是～でございます。</p><p>すみません，この近くにコンビニがありますか。ーーはい，ございます。</p><p>ホテルの前の道を右に行かれますと，左にございます。社長，１つお伺いしたいことがございます。</p><p>[接电话时] はい，JC企画上海事務所でございます。あのう，お客様，＊おつりでございます。</p></li></ol><p><strong>～である：是です的古语，同时也是です在现代语种的书面语；</strong></p><p>1.48.2  表現と言葉の説明</p><ol><li><p>动词以外的尊他语形式：上一课学习了表示尊他的动词形式，本课学习了表示自谦的动词形式。在使用敬语的时候，不只是动词，同一个句子里的一部分名词、形容词有时候也要使用相应的敬语形式。下面是一些常见的名词和形容词的敬语形式；</p><p>⑴　尊他语</p></li></ol><div class="table-container"><table><thead><tr><th>ご利用　　利用</th><th>お食事　　饭</th><th>お荷物　　行李</th></tr></thead><tbody><tr><td>お手紙　　信</td><td>お客様　　客人</td><td>ご家族　　家人</td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th>お元気　　精神好</th><th>お忙しい　　忙</th></tr></thead><tbody><tr><td>お若い　　年轻</td><td>お暇　　　　闲暇</td></tr></tbody></table></div><p>   一度お会いしたいんですが，＊明日はお忙しいでしょうか。</p><p>   ​家を建てられたそうですね。お若い<a href="https://docs.google.com/document/d/1l_ZreTaSpfFiniwh1Niq7zZ9Ao7WotmHtmUsOEERvjE/edit#bookmark=id.yvd81ju0jue8">のに</a>，立派ですね。</p><p>   ​ご両親はお元気ですか。</p><p>   ​お暇<a href="https://docs.google.com/document/d/1l_ZreTaSpfFiniwh1Niq7zZ9Ao7WotmHtmUsOEERvjE/edit#bookmark=id.le5id86wybhb">なら</a>，ちょっと手伝っていただきたいんですが。</p><p>   ⑵　自谦语 </p><div class="table-container"><table><thead><tr><th>普通说法</th><th>自谦语</th></tr></thead><tbody><tr><td>わたし</td><td>私く</td></tr><tr><td>私たち</td><td>私ども</td></tr><tr><td>会社</td><td>＊社</td></tr><tr><td>ひと</td><td>＊もの</td></tr></tbody></table></div><p>私は，李秀麗と申します。</p><p>こちらは私どもの新しい製品でございます。</p><p>帰っ<a href="https://docs.google.com/document/d/1l_ZreTaSpfFiniwh1Niq7zZ9Ao7WotmHtmUsOEERvjE/edit#bookmark=id.cjxhod5mapu5">たら</a>，すぐ社の者に資料を送らせます。</p><ol><li><p>明日（みょうにち）和昨日（さくじつ）：明日有あした、あす、みょうにち三种读法，郑重程度依次加重。</p><p>昨日也有きのう、さくじつ两种读法，さくじつ较为郑重。</p></li><li><p>何のお構いもしませんで[寒暄语⑨]：客人离开时，主人往往说一些没能招待好之类的话，这时候，常用的一句话就是：何のお構いもしませんで,表示没能招待好，非常抱歉的心情。</p><p>也可以说成何のお構いもできません。</p><p>そろそろ失礼いたします。どうもお邪魔したしました。ーー何のお構いもしませんで。</p><p>先日はいろいろとごちそうになりました。どうもありがとうございました。</p><p>ーーいいえ，何のお構いもできませんで。</p></li><li><p>右も左も分かりません：到了新地方，对周围的情况一点也不了解。</p><p>大学を卒業し<a href="https://docs.google.com/document/d/1l_ZreTaSpfFiniwh1Niq7zZ9Ao7WotmHtmUsOEERvjE/edit#bookmark=id.f16gbxu03hzb">たばかり</a>で,右も左も分かりませんが，一生懸命頑張りますので，ご指導よろしくお願いいたします。</p><p>日本に着い<a href="https://docs.google.com/document/d/1l_ZreTaSpfFiniwh1Niq7zZ9Ao7WotmHtmUsOEERvjE/edit#bookmark=id.f16gbxu03hzb">たばかり</a>で，まだ右も左も分かりませんが，どうぞよろしくお願いいたします。</p><p>いたします就是します的敬语-自谦语</p></li><li><p>＊おります／～ております：います更为谦逊的说法是おります；</p><p>　　　　　相应的～ています更为谦逊的说法是～ております；</p><p>​    午後はずっと社におりますが。</p><p>​    ご両親はどちらにらっしゃいますか。ーー両親は名古屋におります。</p><p>​    ＊いつもお世話になっております。</p><p>​    吉田課長におあいしたいんですが。ーー＊申し訳ございません。吉田は＊ただ今外出しております。</p></li></ol>              </div>            </details>              </div>            </details><h2 id="初级上册-第十一单元"><a href="#初级上册-第十一单元" class="headerlink" title="初级上册-第十一单元"></a>初级上册-第十一单元</h2><details class="folding-tag" ><summary> 被动形、まま、使役形、ようです-推测 </summary>              <div class='content'>              <p>1.41李さんは部長に褒められました</p><details class="folding-tag" ><summary> 被动形式：られます </summary>              <div class='content'>              <p> 1.41.1文法説明</p><ol><li><p>被动形式：表示做主语的人或事物承受某种动作或影响的表达方式，构成方式按照动词类型分为三种情况：    </p><p>❶一类动词：ない形的ない变成れる；    </p><p>❷二类动词：ない形的ない变成られる；    </p><p>❸三类动词：来（く）る变成来られる，する变成される。</p>   <table>      <thead>         <tr>               <th rowspan="2">类别</th>               <th rowspan="2">基本形</th>               <th rowspan="2">ない形</th>               <th colspan="2">被动形式</th>         </tr>         <tr>               <th>基本形</th>               <th>ます形</th>         </tr>      </thead>      <tbody>         <tr>               <td rowspan="9">一类动词</td>               <td>書く</td>               <td>書かない</td>               <td>書かれる</td>               <td>書かれます</td>         </tr>         <tr>               <td>急ぐ</td>               <td>急がない</td>               <td>急がれる</td>               <td>急がれます</td>         </tr>         <tr>               <td>死ぬ</td>               <td>しなない</td>               <td>死なれる</td>               <td>死なれます</td>         </tr>         <tr>               <td>読む</td>               <td>読まない</td>               <td>読まれる</td>               <td>読まれます</td>         </tr>         <tr>               <td>飛ぶ</td>               <td>飛ばない</td>               <td>飛ばれる</td>               <td>飛ばれます</td>         </tr>         <tr>               <td>売る</td>               <td>うらない</td>               <td>売られる</td>               <td>売られます</td>         </tr>         <tr>               <td>買う</td>               <td>かわない</td>               <td>買われる</td>               <td>買われます</td>         </tr>         <tr>               <td>待つ</td>               <td>待たない</td>               <td>待たれる</td>               <td>待たれます</td>         </tr>         <tr>               <td>話す</td>               <td>話さない</td>               <td>話される</td>               <td>話されます</td>         </tr>         <tr>               <td rowspan="2">二类动词</td>               <td>食べる</td>               <td>食べない</td>               <td>食べられる</td>               <td>食べられます</td>         </tr>         <tr>               <td>見る</td>               <td>見ない</td>               <td>見られる</td>               <td>見られます</td>         </tr>         <tr>               <td rowspan="2">三类动词</td>               <td>来る</td>               <td>こない</td>               <td>来られる</td>               <td>来られます</td>         </tr>         <tr>               <td>する</td>               <td>しない</td>               <td>される</td>               <td>されます</td>         </tr>      </tbody>   </table></li></ol><p>​    ＊（ら）れます的活用方式与二类动词相同。</p><ol><li><p>「名」は（「名」に）「动」（ら）れます：表示被动时，动作对象做主语，动作主体用助词に表示：</p><p>部長は　李さんを褒めました。李さんは　部長に　ほめられました。李さんは部長に褒められませんでした。</p><p>李さんは小野さんに食事に[＊誘われ|动词 <strong>誘う</strong>（邀请）的被动形，表示“被邀请”。]ました。</p><p>＊参考：表示收受益时通常使用~てもらいます的形式；    </p><p>李さんは友達に＊助けられました。（客观叙述，不表示受益）    </p><p>李さんは友達に助けてもらいました。（表示受益）</p></li><li><p>「名」は「名」に「名」を「动」（ら）れます：日语当中还有一种物主做主语的被动句，即某事物的拥有者在被动句里做主语，而事物在被动句里仍然充当宾语，这种被动句一般表示该事物的拥有者收到了某种麻烦或损失；</p><p>森さんは　馬さんの　カメラを　[壊|こわ]しました。馬さんは　森さんに　カメラを　壊されました。</p><p>李さんは昨日犬にてをかまれました。森さんは田中さんに本を汚されました。</p></li><li><p>「名」は「名」に「动」（ら）れます：还有一种纯粹表示受害的被动句，这种句型当中，受害者不是直接而是间接的承受某种事态的影响。自动词和他动词都可以用于这种句式当中，另外，这种被动句没有否定形式；</p><p>小鳥が逃げました。陳さんは　小鳥に　逃げられました。</p><p>張さんは隣の人に「夜遅くまで｜よるおそくまで：直到很晚的晚上」「騒がれました｜さわがれる」。食事中，隣の人にタバコを吸われました。</p><p>这种被动句里，助词に前面一般是人物或动物，但有时候也可以是 雨或 雪，不过这时后续动词必须用降ります。</p><p>わたしたちは雨に降られました。</p></li><li><p>「名」が／は　「动」（ら）れます：还有一种用事物来做主语的被动句。动作主体一般是某一不确定的人群，一般不在句中出现；</p><p>2010年に上海で万博が開かれます。2010年の万博は上海で開かれます。</p><p>駅前に高いビルが建てられました。</p></li><li><p>「名」は「名」によって「动」（ら）れます：在用事物做主语的被动句里，有时动词的主体是特定的，这时候主体用によって来提示，不可以用に代替哦；</p><p>この車は日本の有名なデザイナーによって設計されました。</p><p>＊万有引力の法則は＊ニュートンによって＊発見されました。</p><p>この本は山田先生によって書かれました。</p></li></ol><p> 1.41.2表現と言葉の説明</p><ol><li><p>～とも接在数量词后，表示该数量的全部。数量词一般在10以内；</p><p>二日とも雨に降られて，大変でしたよ。</p><p>社員は3人いますが，今は3人とも出かけています。</p><p> . ＊いやあ[叹词]：主要为男性使用。用于感到不好意思，或情绪激动等 ；        </p><p>いやあ，＊参りましたよ、タクシーで帰ってきたんですが，渋滞に＊巻き込まれて。    </p><p>いやあ，小野さん，久しぶり！</p><p> . 【参り|まいります：较为正式和谦逊的表达方式，通常用于表示“去”或“来”。这个词在日常会话中使用较少，通常出现在较为礼貌和谦虚的语境中。】ました：用于遇到 困难或麻烦而感到苦恼。应用课文中，表示堵车后森因十分疲倦而苦恼的心情；    </p><p>事故でもあったのかな。</p><p>次の電車，なかなか来ないけど。ーーええ。参りましたね。</p><p>会議が始まってしまいますね。    参りましたよう。雨に降られて，＊びしょぬれです。</p><p> . ｢巻き込まれて|まきこまれる｣：用于表示说话人被卷进某种不好的事情当中而受到了影响。动词巻き込む多以这种被动形式使用，前面的消极事态用助词に表示；    </p><p>パリ行きの飛行機は　大きな＊嵐に　巻き込まれてしまいました。    </p><p>あの会社の課長は　＊汚職事件に巻き込まれて，辞職したそうです。</p></li></ol>              </div>            </details><p>1.42テレビをつけたまま、出かけてしまいました</p><details class="folding-tag" ><summary> まま：表示理应改变的状态保持着现状，去进行另外的动作 </summary>              <div class='content'>              <p> 1.41.２文法説明</p><ol><li><p>「小句（动词た形／ない形）」まま，「小句2」</p><p>​                        「名」　＋　の＋まま，「小句」表示将理应改变的状态保持着去进行另外的动作。    </p><p>テレビをつかたまま，出かけてしまいました。    李さんはコートを着たまま，ベットで寝てしまいました。    </p><p>馬さんは＊行き先を＊告げないまま，家を出てしまいました。</p><p>前接名词时，用名词+の＋まま的形式： わたしたちは＊空腹のまま，出発しました。</p><p>＊注意：まま前，不可以使用敬体。</p></li><li><p>「小句1（简体形）」のに，「小句2」：虽然，但是，表示转折；</p><p>小句1如果是二类形容词小句或名词小句，要用＋な＋の的形式：</p><p>目覚ましをかけておいたのに，今朝は起きられませんでした。</p><p>今日はこんなに寒いのに，森さんは寒くないと言いました。</p><p>この家は駅から近くて便利なのに，買う人がいました。</p><p>田中さんは作家なのに，読書が嫌いです。</p><p>森さんは昨日病気[名]だったのに，＊出勤しました。</p><p>*注意：のに前一般不适用敬体：電源を入れましたのに，【動きませんでした。|うごきます，動きます，运转】。</p><p>~が，～けど的意思与のに相近，但其前后两个小句独立性强，因此小句1的句尾可以使用です、ます、でしょう等形式结尾，并且小句2可以为表示祈使的句型，与此相反，~のに前后两个小句独立性较弱，小句1不可以使用です、ます、でしょう等形式结尾，且小句2不可以为表示祈使的小句。    </p><p>寒いですが，換気のために窓を開けてください。　X 寒いのに，換気のために窓を開けてください。</p><p> . 「小句（简体形）」はずです：理应，应该；用于对所推测的内容非常有把握的情况：    </p><p>❶二类形容词小句+な＋はずです    </p><p>❷    名词小句     +の＋はずです会議は5時までですから，もうすぐ終わるはずです。 </p><p>この映画は人気がありますから，＊観客は多いはずです。キムさんはこの大学の学生のはずです。</p><p>由于~はずです表示的是根据某种理由做出的判断，因此即可以用于说话人亲身经历过但记忆并不十分准确的情况，也可以用于实际情况与自己考虑的不一致。</p><p>たしか，書類は机の上に置いたはずです。清水さんはまだ来ていませんが，今日は来るはずです。</p><p> . 「小句（简体形）」はずがありません：~はずです的否定形式，也可以说成～はずはないです；    </p><p>張さんは入院中ですから，旅行に行くはずがありません。    </p><p>7月のオーストラリアは冬ですから，暑いはずがありません。    </p><p>大田さん，遅いですね。ーーええ。でも，大田さんは責任者ですから，送れるはずないんですが..    </p><p>森さんはスキーがあんなに上手ですから，初心者のはずがありません。</p></li></ol><p> 1.42.2表現と言葉の説明</p><ol><li><p>【目覚まし|めをさます的简略形式，意思是“醒来”。这里特指“闹钟”（目覚まし時計，めざましどけい 的简称）。】をかけます：目覚まし時計的省略说法，设定时间一般说目覚ましをかけます，也可以说目覚ましを＊セットします，＊アラームをセットします；</p></li><li><p>おととい送ったんですものね：~ですもの表示原因，理由。一般用于关系亲密的人之间，与~ですから相比，~ですもの的语气较弱，主要用于表示与 说话人本身相关联的理由。因此常常具有一种申明自己的行为是正当的语感。使用者多为女性。</p><p>今月から給料が上がったそうですね。ーーこんなにたくさん仕事しているんですもの。＊当然でしょう。</p><p>孩子和部分女性使用~ですもの的简体形式~だもの，常简化发音成为~だもん，包含一种撒娇的语感。</p><p>どうして宿題しないの？　ーー学校にノートを忘れちゃったんだもん。</p></li><li><p>せっかく～のに：39课学习了せっかく（特意），可以与本课学习的のに呼应使用，表示对自己或对方的付出没有得到相应的回报或没有收到预期的效果而表示惋惜、遗憾的心情。</p><p>せっかくアメリカに留学したのに，英語が上手になりませんでした。</p><p>せっかく教えてあげたのに，彼は全部忘れてしまいました。</p><p>せっかく来てくれたのに，＊留守にしてすみませんした。</p></li><li><p>こちらこそ：哪里哪里..</p></li><li><p>＊早速（さっそく）：表示迅速进行某种动作行为。すぐ也有相同的意思，但是早速倾向于表示说话人或听话人积极主动地开始行动，而不能用于客观描写。</p><p>早速の＊お返事，どうもありがとうございました。</p><p>早速ですが，＊次回会議の＊日程(にってい)をお知らせします。</p></li></ol>              </div>            </details><p> 1.43陳さんは、息子をアメリカに留学させます</p><details class="folding-tag" ><summary> 使役形式：させます </summary>              <div class='content'>              <p> 1.43.1文法説明</p><ol><li><p>使役形式：表示使役主体强制或指示动作主体进行动作地语法形式，也可以用来表示使役主体对动作主体行为的许可或放任。构成方式如下：    </p><p>❶一类动词：ない形的ない变成せる；    </p><p>❷二类动词：ない形的ない变成させる；    </p><p>❸三类动词：来る变成来させる，する变成させる。</p><table border="1" style="border-collapse: collapse; text-align: center;">  <thead>    <tr>      <th>动词类型</th>      <th>基本形</th>      <th>ない形</th>      <th>使役形基本形</th>      <th>使役形ます形</th>    </tr>  </thead>  <tbody>    <!-- 一类动词 -->    <tr>      <td rowspan="9">一类动词</td>      <td>書く</td>      <td>書かない</td>      <td>書かせる</td>      <td>書かせます</td>    </tr>    <tr>      <td>急ぐ</td>      <td>急がない</td>      <td>急がせる</td>      <td>急がせます</td>    </tr>    <tr>      <td>死ぬ</td>      <td>死なない</td>      <td>死なせる</td>      <td>死なせます</td>    </tr>    <tr>      <td>読む</td>      <td>読まない</td>      <td>読ませる</td>      <td>読ませます</td>    </tr>    <tr>      <td>飛ぶ</td>      <td>飛ばない</td>      <td>飛ばせる</td>      <td>飛ばせます</td>    </tr>    <tr>      <td>売る</td>      <td>売らない</td>      <td>売らせる</td>      <td>売らせます</td>    </tr>    <tr>      <td>買う</td>      <td>かわない</td>      <td>買わせる</td>      <td>買わせます</td>    </tr>    <tr>      <td>待つ</td>      <td>待たない</td>      <td>待たせる</td>      <td>待たせます</td>    </tr>    <tr>      <td>話す</td>      <td>話さない</td>      <td>話させる</td>      <td>話させます</td>    </tr>    <!-- 二类动词 -->    <tr>      <td rowspan="2">二类动词</td>      <td>食べる</td>      <td>食べない</td>      <td>食べさせる</td>      <td>食べさせます</td>    </tr>    <tr>      <td>見る</td>      <td>見ない</td>      <td>見させる</td>      <td>見させます</td>    </tr>    <!-- 三类动词 -->    <tr>      <td rowspan="2">三类动词</td>      <td>来る</td>      <td>こない</td>      <td>来させる</td>      <td>来させます</td>    </tr>    <tr>      <td>する</td>      <td>しない</td>      <td>させる</td>      <td>させます</td>    </tr>  </tbody></table></li></ol><p>*注意：させます与二类动词的活用方式相同。</p><ol><li><p>「」は「」を「自动词」（さ）せます：日语的使役句型当中，使役主体作主语。动词为自动词时，动作主体助词用を表示；李さんは出張します。</p><p>部長は李さんを出張させます。陳さんは，息子をアメリカに留学させます。</p><p>田中さんは公園で子供を遊ばせています。あの課長は部下を休ませません。</p></li><li><p>「名」は「名」に「名」を「他动」（さ）せます：使役句型当中，使役主体做主语，如果是他动词，动作主体用助词に表示。不使用を表示动作主体，是因为要尽量避免在同一个句子中重复使用“を”的缘故；</p><p>森さんは　歌を歌います。</p><p>陳さんは　森さんに　歌を　歌わせます。X　</p><p>陳さんは　森さんを　歌を歌わせます。</p><p>部長は大田さんにレポートを書かせました。</p><p>先生は生徒にこの本を読ませます。</p><p>先生は生徒にたくさんの覚えてさせました。</p><p>＊参考：使役被动形式：由使役形式+被动形式构成，一般表示一种被强迫性的动作，具体构成方式：    </p><p>❶一类动词：ない形的ない变成される；    </p><p>❷二类动词：ない形的ない变成させされる；    </p><p>❸三类动词：来るーー来させられる、するーーさせられる。</p><p>＊選手は　走ります。＊監督は　選出を　走られます。選手は　監督に　走らされます。</p></li><li><p>「动」（さ）せてください：请求别人允许自己做某事用~（さ）せてください；</p><p>说话人一般不需要出现在这个句型当中，如果需要特别强调，可以使用“わたしを”、“私に”的形式；    </p><p>疲れました。（わたしを）少し休ませてください。    </p><p>すみません,（私に）ちょっとこの自転車を使わせてください。    </p><p>この仕事は私にやらせてください。</p><p> . 「动」やすいです／にくいです：表示某事物的性质，其接续方式为第一连用形+やすいです／にくいです；    </p><p>动词第一连用形+やすいです／にくいです。～やすいです表示易于，~にくいです表示难于..            </p><p>このボールペンはとても書きやすいです。        この本は読みやすいです。        </p><p>この店の場所は分かりにくかったです        運動をしている人は太りにくいです。</p><p>1.43.2　表現と言葉の説明</p></li><li><p>お手伝い[动词转换为名词]：是动词手伝います的第一连用形前接表示尊重的お构成的名词。</p><p>日语当中一部分动词的第一连用形可以直接做名词使用，下面是几个常用的例子：</p><p>休み　　　　考え　　　　手伝い　　　　</p><p>乗り換え（のりかえ）　　　持ち帰り　　＊申し出（もうしで）</p></li><li><p>行ってもらいます和行かせます：28课学习的~てもらいます表示说话人请别人做某事的用法，这种用法和使役形式的功能相近。两者之间的区别是：使役形式是直接命令别人，语气强硬，而~てまらいます则是委托、请别人做某事，语气柔和；</p><p>CSコンスの＊プレゼン,誰に行ってもらいましょうか。ーー森君と李さんをいかせるつもりです。</p><p> . ～のではないでしょうか[婉转陈述 意见的表达①]：表示否定+疑问，相当于汉语当中的：不是~吗？整体上相当于～と思います，但要比～と思います更加委婉。句尾读降调；    </p><p>*アルファベットは分かりにくいので，避けた方がいいのではないでしょうか。    </p><p>＊免税店では，＊女性向けの商品がよく＊売れるのではないでしょうか。</p><p> . ＊ぐっと[拟声词②]：表示动作急促，力度大，引申为变化的幅度大活动做迅猛；    </p><p>森さんは小野さんの手をぐっと＊ひっ張りました。    </p><p>商品の＊イメージがぐっとよくなって，＊消費者が安心して買えると思います。</p></li><li><p>郑重地口语表达：       </p><p>​    正式口语体                                              非正式口语体</p><p>*言うまでもなく（不言而喻）             もちろん（当然）</p><p>~のではないでしょうか（我想~）　　～んじゃない（我想~）　　　　　　</p><p>やはり（仍然）　　　　　　　　　　　やっぱり（还是）　　　　　　　　　　　　　</p><p>など（之类）　　　　　　　　　　　　　＊なんか（等等）</p></li></ol>              </div>            </details><p>1.44 「玄関｜げんかん」のところに誰かいるようです</p><details class="folding-tag" ><summary> 推测，ようです、らしい </summary>              <div class='content'>              <p>1.44.1　文法説明</p><ol><li><p>「小句（简体形）」ようです①[推测]    　　     </p><p>​           「名」＋の＋ようです①[推测]</p><p>表示根据说话人感知地某种情况进行推测。</p><p>二类形容词小句把其简体形地た换成な，成为二类形+な＋ようです；    </p><p>玄関のところに誰かいるようです。    店の前には【＊行列|ぎょうれつ、队伍，排队】ができています。</p><p>あの店の料理はおいしいようです。【値段|ねだん：价格或价钱】はほかの店の【＊倍|ばい，倍数】です。</p><p>ここの料理は【＊かなり|程度高】＊【豪華|ごうか】なようです。　　</p><p>前接名词时，用名＋の＋ようです地形式：遠くから何か飛んできます。</p><p>飛行機のようですね。ーーそのようですね。</p></li><li><p>「小句（简体形）」みたいです　①　[推测]：与ようです基本相同，也表示根据说话人感知地某种情况进行推测，是相对比较随意地说法，不用于书面语。二类形容词小句和名词小句把其简体形的だ换成みたいです。    </p><p>小野さんは森さんをよく見ていますね。小野さんは森さんが好きみたいです。</p><p>「雨の音｜あめのおと」が聞こえません。雨が「やんだ｜动词“やむ”（停止，指雨停）的过去式，表示“雨停了”」みたいです。そこの人はみんなコートを「着ています｜きる、动词“着る”（穿衣服）的进行时，意思是“正在穿”或“穿着”。」。</p><p>外は寒いみたいです。雲が｢＊広がっています｜ひろがります：扩展，蔓延」。明日は雨みたいですよ。</p></li><li><p>「小句（简体形）」らしいです　[推测].[传闻]：既可以表示根据某种情况的推测，又可以用来婉转地叙述挺来的信息。小句为二类形容词和名词小句时，将简体形的だ换成らしいです；</p><p>今度の社員旅行は韓国へ行くらしいです。李さんは【頭|あたま】が｢痛|いたい｣いらしいです。</p><p>林さんはお酒が好きらしいですよ。電気が「消えて｜きえて：熄灭，消失」います。</p><p>李さんは【出かけた|でかけて：外出，离开家】らしいです。【＊パトカーの|表示“警车”，是外来词，来自英文的“patrol car”。】＊【サイレン|表示“警笛”或“警报声”，通常是指警车、救护车等的鸣笛。】が聞こえます。近所で【事故|じこ】があったらしいです。</p><p>＊参考：~ようです和～らしいです都可以表示推测。站在第三者的角度客观地叙述推测地结论时，两中表述方式都可以用，但是，直接对被 观察、对被测地人发话时，则只可以用ようです；</p><p>[看到小李房间关着灯地情况下].[看着激烈咳嗽地对方]李さんは出かけたらしいです。                     </p><p>風邪を引いたようですね。李さんは「出掛けた｜でかけた：出去了」ようです。　　　　　　</p><p>X風邪を引いたらしいですね。</p></li><li><p>「动词／一类形／二类形」過ぎます：表示某种动作或事物的性质等超过了正常的量或程度。接续方式按照词形不同分为三种情况：    </p><p>❶動詞：第一连用形；    </p><p>❷一类形：词尾的い换成過ぎます；    </p><p>❸二类形：直接后续過ぎますが；過ぎます的活用规则与二类动词一样。    </p><p>昼ご飯を食べ過ぎました。    このスープは熱すぎませんか。    この説明は複雑過ぎます。</p></li><li><p>「一类形」+ さ：构成某种状态名词</p></li></ol><p>1.44.2 表現と言葉の説明</p><ol><li><p>試験に【合格|ごうかく】しました：考试考中了，に表示成功或失败的对象；</p><p>*おかげさまで：用于对对方的关心、惦念表示感谢时，可以只用おかげさまで，也可以后续一些其他寒暄语；    </p><p><strong>おかげ（お加減）</strong>：原本是“加減（かげ）”的尊敬形式，意味着“影响”、“庇佑”或“帮助”。其中：</p><ul><li><strong>加（か）</strong>：指“增加、附加”。</li><li><strong>減（げん）</strong>：指“减少”。</li></ul><p>词语中的“加減”通常指事物的影响，尤其是指外部的影响或因素，后来的用法逐渐偏向表示“托某人的福”或“由于某人的帮助”。</p><ul><li>演变：“おかげ”作为“お加減”的尊敬形式，后来逐渐在日常用语中用来表示“托……的福”或“得到了……的帮助”的意思，语气上带有谦逊和感恩。</li><li>“さまで”则是对“おかげ”进行尊敬的附加，增强礼貌和尊敬的语气。</li><li><strong>様（さま）</strong>：指“尊敬”或“样子、方式”的意思。在某些情况下，它用来表示对某人、某事的尊敬或礼貌。</li><li>“で”是日语中的助词，常用于表示手段、方法、状态等。在“さまで”这个结构中，助词“で”起到连接的作用，表达“在某种状态下”或“由于某种方式/形式”的意思。</li></ul></li></ol><p>   森さん，「动力」，売れ行きが＊好調のようですね。ーーええ，おかげさまで。    </p><p>   風邪はいかがですか。ーーええ，おかげさまで，元気になりました。</p><ol><li><p>＊けっこう[表示程度的副词⑦]：有多种含义，应用课文中けっこう評判がいいみたい当中，けっこう表示受欢迎的程度比自己预想的要高，与14课学习过的なかなか意思相近，但是なかなか只能用于不能量化的程度，如いい、おいしい，而けっこう可以；</p><p>ここのレストラン，初めて来たけど，【けっこう|相当，挺】【美味し|おいしい】ね。この「ビル｜building」はけっこう高いね。</p></li><li><p>＊何と言っても：表示从多种因素中着重选择一种，原意是：不管别人怎么说..相当于汉语当中的不管怎么说；</p><p>何と言っても美味しさです。ご「主人｜しゅじん」のどこが好きですか。ーー何と言っても，｢まじめ|真面目：指认真的、踏实的、严肃的性格，通常用来形容一个人有责任感、不浮躁、做事认真。｣で優しいところです。</p><p>デザインが＊しゃれていて：表示产品的设计新颖，日语的动词用来表示某种性质时，需要用~ています的形式，而不能只用ます的形式；    </p><p>デザインが「しゃれていて｜由动词“しゃれる”（有品味、时尚）和连用形“ていて”组成，表示某人或某物“有品味、时尚、别致”。」，人気があるみたいですね。  （联想，～てみます：尝试做某事）    </p><p>この【帽子|ぼうし】，しゃれているでしょうか？ーー本当ね。色もすてきね。</p></li><li><p>受ける：表示收到别人赞赏或欢迎。</p><p>それに，「ネーミング｜naming」も受けるたようです。今，ヨーロッパで，日本の＊【アニメ|是“动画”的外来语】が受けているそうです。</p><p>＊パワー：Power，本意是力量，日语中用来表示意志力，干劲，能量等；    </p><p>CSコンスでは，もう次の商品の開発を始めているらしいですよ。ーーすごいパワーですね。</p></li><li><p>＊【控えめ|ひかえめ】：有两种含义，一种是分量少，一种是做事有节制。应用课文在的＊甘さが控えめ用的是第一中意思。第二种意思用于表示态度或性格，日本文化极重谦逊，因此控えめな＊態度（谨慎的态度）、控えめな性格（拘谨的性格）往往可以得到好的评价。</p><p>健康のため、お酒を控えめにしようと思います。＊新入社員の山田君は，とても控えめで＊「おとなしい｜表示“温和的、安静的、不张扬的”。可以用来形容人或动物，」＊「性格｜せいかく」です。    </p></li><li><p>ビアガーデン：庭院式啤酒店，包括楼顶上的露天酒吧在内；</p></li><li><p>社員旅行：</p></li></ol>              </div>            </details>              </div>            </details><h2 id="初级上册-第十单元"><a href="#初级上册-第十单元" class="headerlink" title="初级上册-第十单元"></a>初级上册-第十单元</h2><details class="folding-tag" ><summary> ば形、可能形、 て/ないで、ところです </summary>              <div class='content'>              <p>1.37優勝すれば，オリンピックにしゅつじょうすることができます</p><details class="folding-tag" ><summary> ば形、なら、でも、とか～とか </summary>              <div class='content'>              <p> 1.37.1文法説明</p><ol><li>ば形：用于表示假定条件,分为一类形容词ば形和动词ば形；                                                                                                                      动词ば形：     ①把基本形地最后一个音变成相应地e段音，+再加ば；　②二类动词：基本形的る变成れば；③把来る变成来れば，する变成すれば；</li></ol><html lang="zh"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>表格居中</title>    <style>        table {            border-collapse: collapse;            width: 80%;            margin: 20px auto;        }        th, td {            border: 1px solid #000;            padding: 8px;            text-align: center; /* 水平居中 */            vertical-align: middle; /* 垂直居中 */        }        th {            background-color: #f2f2f2;        }    </style></head><body>    <table>        <tr>            <th>类别</th>            <th>基本形</th>            <th></th>            <th>ば形</th>        </tr>        <tr>            <td rowspan="10">一类动词</td>            <td>書く</td>            <td>→</td>            <td>かけば</td>        </tr>        <tr>            <td>急ぐ</td>            <td>→</td>            <td>急げば</td>        </tr>        <tr>            <td>飛ぶ</td>            <td>→</td>            <td>飛べば</td>        </tr>        <tr>            <td>読む</td>            <td>→</td>            <td>読めば</td>        </tr>        <tr>            <td>死ぬ</td>            <td>→</td>            <td>死ねば</td>        </tr>        <tr>            <td>待つ</td>            <td>→</td>            <td>待てば</td>        </tr>        <tr>            <td>売る</td>            <td>→</td>            <td>売れば</td>        </tr>        <tr>            <td>買う</td>            <td>→</td>            <td>買えば</td>        </tr>        <tr>            <td>話す</td>            <td>→</td>            <td>話せば</td>        </tr>        <tr>            <td>食べる</td>            <td>→</td>            <td>食べれば</td>        </tr>        <tr>            <td rowspan="3">二类动词</td>            <td>見る</td>            <td>→</td>            <td>見れば</td>        </tr>        <tr>            <td>寝る</td>            <td>→</td>            <td>寝れば</td>        </tr>        <tr>            <td>食べる</td>            <td>→</td>            <td>食べれば</td>        </tr>        <tr>            <td rowspan="2">三类动词</td>            <td>来る</td>            <td>→</td>            <td>来れば</td>        </tr>        <tr>            <td>する</td>            <td>→</td>            <td>すれば</td>        </tr>    </table></body></html><p>一类形容词的变换规则，是将词尾的い变为ければ；ない　→　なければ；　　楽しい　→　楽しければ； </p><ol><li><p>「小句1」ば，「小句2」：表示小句2的成立必须以小句1的事态产生为前提条件，原则上句尾不可以使用表示意志、希望、命令、请求的表达方式。但是，如果小句1的谓语为状态性谓语或者小句1和小句2主语 不同时，不受这个条件约束； </p><p>この＊大会で　優勝　す　れば，オリンピックに出場することができます。 李さんに　聞　けば，分かりますよ。部屋がもう少し　広　ければ　いいのですが。 雨が　降らなけれ　ば，ハイキングに行きましょう。 </p></li><li><p>「小句（简体形）」なら，「小句2」：用于根据交谈时或的现场情况来陈述自己的意见或想法，以及向对方提出请求或忠告。小句2为判断、命令、提议等表示说话者主管立场的内容。小句1为二类形容词小句和名词小句时，其简体形的だ换成なら； </p><p>天安門へ行くなら，地下鉄が便利ですよ。 今日は忙しいんですが..　　ーー忙しいなら，行かなくてもいいですよ。 </p><p>今夜，もし暇なら，一緒に食事に行きませんか。</p></li><li><p>「名」でも　[示例]：17课学习了全面肯定的~でも，35课学习了表示极端例子的~でも。其实，~でも还可以用于举出几个选项中有代表性的一项，一般不用于过去时态的句子；</p><p> 映画でも見に行きませんか。運動でもしたらどうですか。コーヒーでも飲みませんか。 </p><p>X　わたしは昨日喫茶店でコーヒーでも飲みました。 </p></li><li><p>「名1」とか「名2」とか／「小句1」とか「小句2」とか：用于例句同样性质的几个例子； </p><p>パーティーで，戴さんとか楊さんとか，いろいろな人に会いました。 コートとか靴とか，たくさん買いました。 海外旅行に行きたいとか，新しい車がほしいとか，＊ぜいたくなことばかり言いていますよ。 </p><p>＊注意：名词+とか＋名词+とか的说法表达的意思和名词+や+名词+など基本相同。但是~とか～既可以连接名词又可以连接小句，而~や～只能连接名词。另外，~とか~只用于口语，~や~既可以用于口语，又可以用于书面语；</p><p>1.37.2表現と言葉の説明</p></li><li><p>条件表达方式小节：31课学习了~と，35课学习了~たら，本课学习了~ば和~なら，上面这些表达方式归纳、比较如下： </p><p>❶　~たら和~ば：表示如果~，要是~之类的假定条件时，多用~たら或~ば。其中，～たら的使用条件没有限制，~ば有限制，当前面的小句表示动作或变化时，后面的小句则不能是~たいです、～てください等表示意志、请求的形式； </p><p>雨が降ったら，窓を閉めてください。　X　雨が降れば，窓を閉めてください。 </p><p>另外，当~たら后面的小句时过去式时，表示发现了某种情况，~ば没有这种用法； </p><p>窓を開けたら，富士山が見えました。X窓を開ければ，富士山が見えました。 </p><p>小句为二类形容词小句和名词小句时，把简体形的だ换成~なら。 </p><p>明日晴れなら，私も行きます。　明日晴れだったら，私も行きます。 </p><p>❷　～と：用于前项一旦成立，后向就必然成为现实的复句里。这种情况下，复句使用~たら虽然不算错误，但是不够自然，另外 ～的后面不能使用表示意志或请求的表达方式； </p><p>スイッチを押すと，電気がつきます。スイッチを押したら，電気がつきます。</p><p>スイッチを押したら，すぐ部屋を出してください。 X スイッチを押すと，すぐ部屋を出てください。 </p><p>和~たら一样，~と可以用于表示发现了某种情况，后面的句子同样使用过去式； </p><p>窓を開けると，富士山が見えました。 </p><p>❸　～なら：多用于以对方的某种意志或愿望为前提而提出某种建议。这种用法　～たら、～ば、～と都不具备。 </p><p>新鮮な魚を買いたいんですが.. ーー魚買うなら，駅前のスーパーがいいですよ。 </p><p>X　魚を買ったら，駅のスーパーがいいですよ。 </p><p>X　魚を買うと，駅前のスーパーがいいですよ。 </p><p>X　魚を買えば，駅前のスーパーがいいですよ。 </p><p>不过，如果前项不是对方的意志或愿望，只是某种兴趣或嗜好，则～なら和～たら是通用的；</p><p>野菜が嫌いなら，食べなくてもいいですよ。野菜が嫌いだったら，食べなくてもいいですよ。 </p><p>X    野菜が嫌いだと，食べなくてもいいです。 </p></li><li><p>買っちゃった：33课学过的～でしまった的口语形式（～でしまった由でしまいました转变而来），语义基本相同，但相比之下令人不愉快的语气稍弱一些。 見ちゃった。今，＊こっそり＊つまみ食いしたでしょう？あっ，財布を忘れちゃった。 どこかにいってしまいました </p></li><li><p>2時間＊ちょっとですね：意思是两小时多一点 ，～ちょっと常用于口语，还可以接在各种数量词后面； 給料は1か月25万円ちょっとです。塩は＊小さじ2杯ちょっと入れます。 </p><p> . ＊さすが：表示受到高度评价的人物名副其实，确实如别人所评价的那样；    さすが「＊世界遺産」です。＊東大合格ですか。さすが加藤さんの息子さんです。</p></li></ol>              </div>            </details><p> 1.38戴さんは英語が話せます  </p><details class="folding-tag" ><summary> 可能形式 </summary>              <div class='content'>              <ol><li><p>可能形式：表示能够进行某种动作的形式，与20课学习过的～ことができます所表示的意义相同；    </p><p>❶一类动词：基本形最后一个音变成相应的え段音，再＋る；    </p><p>❷二类动词：基本形的る变成られる；    </p><p>❸三类动词：把来る变成来られる（こられる），する变成できる；</p></li></ol><html lang="ja"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>可能形表格</title>    <style>        table {            border-collapse: collapse; /* 合并边框 */            width: 90%; /* 表格宽度 */            margin: 20px auto; /* 居中表格 */        }        th, td {            border: 1px solid #000; /* 边框 */            padding: 10px; /* 内边距 */            text-align: center; /* 水平居中 */            vertical-align: middle; /* 垂直居中 */        }        th {            background-color: #f2f2f2; /* 表头背景色 */        }    </style></head><body>    <table>        <tr>            <th rowspan="2">動詞の種類</th>            <th rowspan="2">基本形</th>            <th rowspan="2">可能形（基本形）</th>            <th rowspan="2">→</th>            <th rowspan="2">可能形（ます形）</th>        </tr>        <tr></tr>        <tr>            <td rowspan="8">一类動詞</td>            <td>書く</td>            <td>かける</td>            <td rowspan="8">→</td>            <td>かけます</td>        </tr>        <tr>            <td>急ぐ</td>            <td>いそげる</td>            <td>急げます</td>        </tr>        <tr>            <td>飛ぶ</td>            <td>とべる</td>            <td>飛べます</td>        </tr>        <tr>            <td>読む</td>            <td>読める</td>            <td>読めます</td>        </tr>        <tr>            <td>死ぬ</td>            <td>しねる</td>            <td>しねます</td>        </tr>        <tr>            <td>待つ</td>            <td>待てる</td>            <td>待てます</td>        </tr>        <tr>            <td>売る</td>            <td>売れる</td>            <td>売れます</td>        </tr>        <tr>            <td>買う</td>            <td>買える</td>            <td>買えます</td>        </tr>        <tr>            <td rowspan="2">二类動詞</td>            <td>食べる</td>            <td>食べられる</td>            <td rowspan="2">→</td>            <td>食べられます</td>        </tr>        <tr>            <td>見る</td>            <td>見られる</td>            <td>見られます</td>        </tr>        <tr>            <td rowspan="3">三类動詞</td>            <td>寝る</td>            <td>寝られる</td>            <td rowspan="3">→</td>            <td>寝られます</td>        </tr>        <tr>            <td>来る</td>            <td>こられる</td>            <td>来られます</td>        </tr>        <tr>            <td>する</td>            <td>できる</td>            <td>できます</td>        </tr>        <tr>            <td>複合動詞</td>            <td>散歩する</td>            <td>散歩できる</td>            <td>→</td>            <td>散歩できます</td>        </tr>    </table></body></html><p>​    <strong>＊可能形式的活活用方式与二类动词相同：</strong></p><div class="table-container"><table><thead><tr><th style="text-align:center">可能基本形</th><th style="text-align:center">ない形</th><th style="text-align:center">た形</th><th style="text-align:center">なかったら</th></tr></thead><tbody><tr><td style="text-align:center">書ける</td><td style="text-align:center">書けない</td><td style="text-align:center">書けた</td><td style="text-align:center">書けなかった</td></tr><tr><td style="text-align:center">食べられる</td><td style="text-align:center">食べられない</td><td style="text-align:center">食べられた</td><td style="text-align:center">食べられなかった</td></tr><tr><td style="text-align:center">来られる</td><td style="text-align:center">来られない</td><td style="text-align:center">来られた</td><td style="text-align:center">来られなかった</td></tr></tbody></table></div><p><strong>＊注意：使用～ことができます时，动词前的助词不发生变化。但使用可能形式时，动词前面的を常常变成が。</strong></p><ol><li><p>「小句（基本形／ない形）」ように，小句：表示为了使某种状态成立的意思，一般前接非意志性动词的基本形、ない形，或者意志形动词的可能形式的基本形、ない形；</p><p>よく　見える　ように，大きく書きました。風を引かない　ように，気をつけています。</p><p>いつでも出られる　ように，準備してあります。子供が触れない　ように，この薬は＊棚の一番上に置きましょう。</p><p>～ように和～ために：两者用法不同。ように前面一般是非意志性的变化或状态，因此往往前接可能形式的基本形、ない形，而ために表示的是意志性动作的目的，因此通常前接动词的基本形；</p><p>日本に留学するために，貯金しています。</p><p>日本に留学できるように，貯金しています。</p><p>另外，～ように前面的主语可以后面句子的注意不一致，而～ために前后句子的主语必须一致；</p><p>ために表示目的，~ように则终于条件成立；</p><p>ほかの人がけがをしないように，森さんが割れた＊コップを（捨てました|すてます）。</p><p>森さんはコンサートのチケットを買うために，並べました。</p></li><li><p>「小句（基本形／ない形）」ようになります：表示能力、状况、习惯等变成了某种状态。ように一般前接非意志性动词的基本形、ない形，或者意志形动词的可能形式的基本形、ない形；</p><p>けがが治って，歩けるようになります。＊赤ちゃんは1歳をすぎると，言葉を話すようになります。</p><p>＊平仮名を間違えないようになりました。着物を自分で着られるようになりました。</p></li><li><p>「小句（基本形／ない形）」ようにします：表示努力使某种行为、状况变为现实。ように一般前接非意志性动词的基本形、ない形。表述平时留心做某种已经成为习惯的行为时，常常使用 ～ようにしています。</p><p>陳さんは毎日，英字新聞を読むようにしています。毎朝，7時に起きるようにしています。</p><p>のどが痛いので，今日はあまり「話さない｜单纯的ない形，去掉ます的尾音升至あ段 + ない」ようにします。健康のために，＊【徹夜|てつや】しないようにします。</p><p>1.38.2表現と言葉の説明</p></li><li><p>＊入り組んでいます：表示事物之间相互交织，极其复杂的样子，常常用于形容如应用课文中迷宫一样的胡同、道路，或者极其复杂的谈话内容；</p><p>この道は入り組んでいますが，＊通り抜けられますよ。</p><p>王さん，さっきの部長の話，分かりましたか。ーーいいえ，話が入り組んでいて，＊半分ぐらいしか分かりませんでした。</p></li><li><p>＊なんだか：表示一种理由不明确的感觉或判断，多用于表述说话者的心理活动。</p><p>なんだか残念です。(总觉得遗憾)</p><p>なんだかうれしいです。(也不知道为什么很高兴)</p><p>この道，暗くて，なんだか怖いですね。ーー大丈夫ですよ。ここは安全ですよ。</p><p>＊エンジンがなんだかおかしい。故障かもしれない。（简体小句+かもしれません，表示发生概率50%）</p></li><li><p>見えます和見られます：見えます表示客观上由于眼力或空间等因素可以看到；見られます则表示由于人工干预可以看到；同样的，聞けます和聞こえます的区别也是一样；</p><p>＊聞きます是一类动词，可能形态变形规则与見ます不同哦！</p></li></ol><div class="table-container"><table><thead><tr><th style="text-align:center">ます形</th><th style="text-align:center">基本形</th><th style="text-align:center">可能形基本形</th><th style="text-align:center">可能形ます形</th></tr></thead><tbody><tr><td style="text-align:center">見えます</td><td style="text-align:center">見える</td><td style="text-align:center">見られる</td><td style="text-align:center">見られます</td></tr><tr><td style="text-align:center">聞きます</td><td style="text-align:center">聞くる</td><td style="text-align:center">聞ける</td><td style="text-align:center">聞けます</td></tr></tbody></table></div><ol><li><p>ら抜き言葉：日常会話中，有人常常把寝られます、食べられます等二类动词的可能形式，以及来られます，说成寝れます、食べれます、来れます，省略“ら”，这种无ら形式，被称作ら抜き言葉。</p><p>按照何博士的讲解，应该是日本人为了好读，近年来使用的人不断在增加；</p><p>朝早く起きられますか。→　朝早く起きれますか。</p><p>１人で浴衣が着られるようになりました。→　１人で浴衣が着れるようになりました。</p><p>明日10時に来られますか。→　明日10時に来れますか。</p><p>飛行機の中で映画が見られます。→　飛行機の中で映画が見れます。</p></li></ol>              </div>            </details><p> 1.39眼鏡をかけて　本を読みます</p><details class="folding-tag" ><summary> て・ないで、ために、ていきます・きます </summary>              <div class='content'>              <p> 1.39.1文法説明</p><ol><li><p>「小句1」て　＋「小句2」／「小句1」ないで　＋「小句2」： 表示进行小句2的动作主体处于小句1的状态，小句1的句尾使用动词て形或动词ない形+で； </p><p>眼鏡をかけて本を読みます。 手を挙げて横断歩道を渡ります。 今日は傘を持たないで出かけました。 </p><p>～ないで也可以说成～ずに，～ずに是古日语的残留形式，多见于书面语； </p><p>今日は傘を持たずに出かけました。 </p><p>之前学过的~て：①表示动作相继发生；②表示并列；③表示原因、理由等连接动词的三种用法，前面这些用法中，~て前后的主语可以不一致，然而本课表示动作主体的状况的~て，前后的主语必须一致； </p><p>春が過ぎて，夏が来ました。 李さんが来てくれて，私は（うれしい）嬉しいかったです。　</p><p>「动」てくれます：表示说话人以外的主语为说话人或说话人一方的人做某事； </p></li><li><p>「小句1（简体形）」ために，「小句2」②　[原因、理由] </p><p>「名词」+の＋ために，「小句2」②　[原因、理由] </p><p>「二类形」+な＋ために，「小句2」②　[原因、理由] </p><p>表示小句1是小句2的原因、理由。小句1表示非意志性的事态或状态： </p><p>事故があったために，電車が遅れたんです。 明日マラソン大会があるために，この道路は＊通行禁止になります。 </p><p>小句2为二类形容词小句时，使用二类形+な＋ために的形式，多用于书面语或比较郑重地场合： この＊村は交通が不便なために，住んでいる人が少ないです。 </p><p>前接名词时，用名词+の＋ために的形式： 道路工事のために，道が込んでいます。 ＊注意：11课学习过的~から、30课学习过的~ので、36课学习过的~て，都表示原因、理由，与前面这些用法相比，~ために更多地用于表示不情愿的事情的原因； </p><p>部長になったから，給料が＊増えました。 </p><p>部長になったので，給料が増えました。 </p><p>部長になって，給料が増えました。 </p><p>X　部長になったために，給料が増えました。 </p><p>另外，~から、～ので、～て可以用来结尾，~ために不可以用来结尾； </p><p>うん，事故があったから。 うん，事故があったんで。 うん，事故があって。 Xうん，事故があったために。 </p></li><li><p>「动」ていきます／きます，具体使用方式分为以下几种情况： </p><p>❶　～ていきます／きます表示以说话人为起点的移动的方向 接在帰ります、歩（ある）きます、走（はし）ります、泳ぎます、飛びます、乗ります等表示移动的动词后面，~ていきます表示由近到远的移动，~てきます表示由远到近的移动。相当于汉语当中的去和来。 李さんは急いで帰っていきました。 ずいぶんたくさん人が乗ってきましたね。（ずいぶん，相当，非常） </p><p>❷　~ています／きます表示一种独立的动作，~て前面的动词也表示一种独立的动作。动词て形+いきます／きます，分别表示两个相继发生的动作； 去年，日本で歌舞伎を見てきました。 （なさい，比命令形稍微客气一些的说法）疲れているんでしょ？ちょっと休んでいきなさい。 </p><p>❸　～ています／きます表示一种独立的动作，て前面的动词表示动作主体的情况，这里的～て实际相当于本课语法解释1里面的て； 子供を病院に＊連れています。 明日お弁当を持ってきてください。 </p><p>❹　～てきます还可以用来表示循环性的动作； ちょっと手紙を出してきます。 ちょっと手を洗ってきます。ここで待っていてください。（待っています，います→て形→いて）</p><p>1.39.2表現と言葉の説明</p></li><li><p>も　[超出想象]：可以用来表示数量比事先预想的或应有的多的时候的心情，应用课文中在2度（两次）后面加も，表示说话人觉得因为发生火灾而烧过两次实在太多了。    </p><p>天安門は，火事（かじ）のために二度も焼けたことがあるんですよ。    </p><p>今日は3*リットルも水を飲みました。</p></li><li><p>＊遠く（とおく）：31课学习了一类形容词词尾的い变成く后可以用作副词，不过遠く、近く属于例外，一般不用来修饰动词，而是用作名词 ，表示远处、近处的意思；</p><p>今朝は＊霧（きり）がかかっているために，遠くまで見えないと思いますが..　（掛かります，自动词）近くに銀行はありませんか。</p></li><li><p>＊ぜったい：絶対，既可以修饰否定内容，也可以 修饰肯定内容。有时后面＋に，成为絶対に，意思不变；</p><p>私は映画を見て，絶対来たいと思っています。森さん，約束（やくそく）の時間は7時です。</p><p>絶対に遅れないでください。</p><p> . ＊ぜっかく：特意，好不容易，对某种行为或事态的价值应充分利用。应用课文中表示既然来了北京，就应该利用在北京逗留的时间特意参观一些地方。一般用来修饰动词，但也有在です前面的情况，如せっかくですから，せっかくですが..当别人劝说自己做某事时，接受对方的好意时，用せっかくですから，拒绝时使用せっかくですが..    </p><p>せっかく北京へきて，ここを見ないで帰ることはできませんよ。</p><p>一般来讲是 动词原形+ことができます，但是否定的话，相当于做话题使用，助词可以改为 は 强调。比如：</p><p>日本に行くことができます。能够去日本。行くことはできません。コーヒー入れましたらか，どうぞ。ーーせっかくですが..時間がないので、失礼します。</p></li></ol>              </div>            </details><p> 1.40</p><details class="folding-tag" ><summary> ところです、たばかりです、始めます・出します、続けます、終わります </summary>              <div class='content'>              <p> 1.40.1文法説明</p><ol><li><p>「动」ところです：表示处于某种阶段，根据前接动词形式的不同，有以下几种情况：    </p><p>❶「动词（基本形）」ところです：表示动词即将进行；</p><p>これから友達と食事に行くところです。これから家を出るところです。</p><p>今，風呂に入るところなので，後でこちらから電話します。    </p><p>❷「动」ているところです：表示持续的动作；</p><p>森さんは会議の資料をそろえている　ところです。今，調べている　ところです。本を読んでいる　ところです。    </p><p>～ているところです表示包含若干个阶段的某事态目前的进展状况，例如：</p><p>从大阪分公司乘新干线前往东京总公司的职员接到总公司电话，问他：今，どこにいますか。这时候一般回答：新幹線に乗っていることろです。    </p><p>～ているところです一般不能前接非意志性动作： X 今，ドアが開いていることろです。    </p><p>❸「动」たところです：表示动作或事件刚刚结束；</p><p>馬さんは，今，空港に着いた　ところです。そのニュースは，たった今　聞いた　ところです。</p><p>さっき，家に帰ってきた　ところです。</p></li><li><p>「动」たばかりです：表示动作刚刚结束，与上面动词た形+ところです用法基本相同；</p><p>このモノレールは，去年　かいつうした　ばかりです。わたしは，先月中国に　きた　ばかりです。</p><p>この本は，昨日　読んだばかりです。</p><p>～た　ばかりです可以表示动作行为结束后较长一段时间的事态，与此相反，~たところです一般用于表示动作行为结束后经过的时间极短的事态，特别是说话人所在的现场的情况。    </p><p>あの二人は去年結婚したばかりです。　Ｘ あの二人は去年結婚したところです。    </p><p>準備は出来ましたか。ーーはい。今準備ができたところです。　Ｘ はい，今準備ができたばかりです。</p></li><li><p>「动」始めます／出します：表示动作或变化的开始，前接动词第一连用形。～始めます用于表示动作、变化开始，而~出します则侧重于表示突然出现了某种情况。</p><p>この本は，昨日　読み　始めたばかりです。雨が降り始めました。だんだん人が帰り始めましたね。</p><p>子供が　泣き　出して，困りました。</p><p>さっきまであんなに＊機嫌（きげん，情绪）がよかった，急に怒り（おこり）出してびっくりしました。</p><p>あんな是形容动词，“那样的……”，加上に变为副词，这里是修饰形容词「よかった」。　びっくりします　吓一跳。</p></li><li><p>「动」続けます：表示动作或状态的不间断的持续，其接续方式为第一连用形+続けます；</p><p>（つつみます，包みます；つづけます，続けます，持续）    </p><p>古い建物を修理しながら　使い　続けていました。3時間歩き　続けます。車の＊オイルが＊漏れ続けています。</p><p>2時間前からずっと立ち続けています。もう疲れた。\</p><p>*注意：降ります不可以后续続けます，而要改为用続きます；雨が1週間降り続きます。</p></li><li><p>「动」終わります：表示动作或行为的结束。该动作具有一定的量。</p><p>その本は　もう　読み　終わりました。先週もらった薬はもう飲み終わりました。</p><p>1.40.2表現と言葉の説明</p></li><li><p>＊お待たせしました：让您久等了。<strong>使役形</strong>用于表达“让/使某人做某事”。</p></li><li>チケット和券：券一般用于与具体用途构成复合，例如：入場券、招待券、回数券等；</li><li>まだ＊耳の＊奥に音楽が残っています。</li></ol>              </div>            </details>              </div>            </details><h2 id="初级上册-第九单元"><a href="#初级上册-第九单元" class="headerlink" title="初级上册-第九单元"></a>初级上册-第九单元</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p> 1.33 電車が急にまりました</p><details class="folding-tag" ><summary> 自动词和他动词 </summary>              <div class='content'>              <p> 1.33.1 文法説明</p><ol><li><strong>自动词和他动词 ②：18课学习了自动词和他动词的基本概念，现在着重介绍日语中在词形上有对应关系的自动词和他动词；❶自动词词尾部分是aru，他动词是 eru：掛かる・＊掛ける、＊閉まる・閉める、止まる・止める等；❷自动词词尾部分是eru／ru，他动词是su：消える・消す、壊れる・壊す、落ちる・落とす等；❸还有一些对应关系不规则的：割れる・＊割る、＊付く・付ける；❹完全同形的：閉じる，但这种情况极少。</strong></li></ol><ol><li><p><strong>「自动」ています　④[结果状态②]：之前学习大都是他动词，现在学习自动词。</strong></p><p><strong>分两种情况，当自动词是动作的时候，～ています表示动作正在进行；</strong></p><p><strong>当自动词是表示变化的时候，～ています表示结果的存续；</strong></p><p><strong>词形上有对应关系的自动词后续～ています，均表示结果存续：</strong></p><p><strong>部屋の電気が消えています。壁には大きな絵が　掛かって　います。</strong></p><p><strong>この自動車は　壊れ　ています。</strong></p></li></ol><p>   <strong>自动词て形／自动词た形＋います都可以表示结果存续，た形偏重变化的完成，て形偏重变化后的结果状态：部屋の電気が消えています。房间的灯灭着。侧重结果状态。</strong></p><p>   <strong>（消えます，2类动词） 部屋の電気が消えました。房间的灯灭了。侧重瞬间的变化。</strong></p><p>   <strong>他动词后续～ています一般表示现在进行，偶有例外，例如：16课学习过的森さんは車をもっています。以及，吉田さんは眼鏡をかけています。</strong></p><ol><li><p><strong>「动」てしまいます：表示该动作所产生的结果是另外不愉快的事情：</strong></p><p><strong>森さんはボーナスを全部使っ　てしまいました。大切な書類を＊うっかり忘れ　てしまいました。</strong></p><p><strong>無理をすると，病気になっ　てしまいますよ。</strong></p><p><strong>有时候也只用来表示动作的完成，而没有结果令人补愉快的意思：</strong></p><p><strong>この本はもう読んでしまいました。＊最後まで食べてしまいましょう。</strong></p></li><li><p><strong>「动」／「形」そうです②　[样态][推测]：用于描述说话人对某种事物样态的观感或根据某种情形推测事态的发展。</strong></p><p><strong>其接续方式为：动词ます形去掉ます后＋そうです；一类形容词去掉词尾い＋そうです；</strong></p><p><strong>二类形容词后面直接＋そうです；このケーキはとても美味しそうです。</strong></p><p><strong>李さんは仕事が大変そうです。雨が降りそうです。</strong></p><p><strong>あの人は将来＊偉くなりそうです。</strong></p><p><strong>表示否定时分为两种情况：❶前接形容词：～そうではありません ; ❷接动词时：～そうにありません。</strong></p><p><strong>あまりおいしそうではありません。</strong></p><p><strong>雨は＊やみそうにありません。 （やみます，１类动词，停止）</strong></p><p><strong>此外，前接ない和いい这两个双音节词语时，属于特殊情况，前者用なさそうです，后者用よさそうです：    </strong></p><p><strong>今日は会議がなさそうです。    この本はとてもよさそうです。</strong></p><p><strong>＊参考：～そうです不仅用于句尾，还用于名词、动词的前面。用于名词前时，用～そうな的形式，用于动词前时，用～そうに的形式：美味しそうなケーキですね。子供たちは楽しそうに遊んでいます。</strong></p></li></ol><p>　1.33.2　表現と言葉の説明</p><ol><li><p><strong>自动词和他动词的用法,需要展开说一下:</strong></p><p><strong>比如：在好久没来的街道一角发现了一座新建的公寓，日语一般说:あっ，アパートが＊建った，使用自动词。</strong></p><p><strong>同样这种情况，如果说成：アパートを作った或アパートを＊建てた，则表达的重点则集中到了谁造的上面。上</strong></p><p><strong>面这种情形，说话人只是在眺望作为街道景观的公寓，而并关注建造的主体，所以使用自动词。反之，如果时自己集资建造房子，则需要用他动词，即：今年，家を建てました。</strong></p><p><strong>在会议上谈到确定了新的计划时，可以有两种说法：1. 新しい＊清涼飲料水に決まりました；2. 新しい企画は清涼飲料水に決めました；以上两种说法，前者自动词，强调“已经定下来的结果”，后者他动词，则会促使听话人去意识决定的主体，甚至给人一种以自己为中心做了决定的印象。当说话人自己主持会议，或者以自己为主体进行决策时，暂且不说，否则使用这种表达方式是不恰当的。例如：学生应当说授業が始まりました，而不能说ーー授業を始めました；会议的参加者一般说会議が始まります，而不能说会議を始めます。</strong></p></li><li><p><strong>～かしら：22课学习了表示疑问的简体助词かな，～かしら和～かな语义相近，但多为女性使用。在没有听话人的情况下使用，～かしら是一种吐露自己内心疑问的自言自语的表达方式。如果有听话人在场，则为向对方发问。应用课文中的用例是前者。</strong></p><p><strong>森さんたちはもう来ているかしら。</strong></p><p><strong>[对着店员]この服，ちょっと大きいかしら。</strong></p></li><li><p><strong>それにしても：用于尽管认可了作为前提的某种状况或事项，但说话人仍有另外的感觉或认识。应用课文中的大勢＊並んでいるわね，是说机场的拥挤虽然是正常情况，但今天的拥挤程度也太不寻常了。</strong></p><p><strong>それにしても，大勢並んでいるわね。森さん遅いですね。ーー少し遅れると言いていましたよ。　　　　</strong></p><p><strong>（おくれます，２类动词，迟到）それにしても遅いですよ。もう30分過ぎました。</strong></p></li><li><p><strong>＊お久しぶりです　[寒暄语⑦]：应用课文中，小李首先用お久しぶりです向小野打招呼，小野只用お久しぶり来回应，因为有お的前缀，并不显得不好，反而增加了一种亲切感呢。</strong></p></li><li><p><strong>*相変わらずですね：意思是情况没有变化，相当于中文的还是老样子阿！</strong></p></li><li><p><strong>お元気そうで，何よりです　[寒暄语⑧]：何よりです的完整形式是，何よりいいことです（比什么都好），整句的意思是你看上去挺精神的，这比什么都好。不过虽然是寒暄语，但由于包含一种我一直惦记着你的健康状况的语感，所以一般只用于朋友相隔一段时间后再会时，对初次见面的人不能使用。</strong></p></li></ol>              </div>            </details><p> 1.34 壁にカレンダーが開けてあります</p><details class="folding-tag" ><summary> 「他动」てあります　ておきます　てみます </summary>              <div class='content'>              <p> 1.34.1　文法説明</p><ol><li><p><strong>「他动」てあります：表示有意识进行的动作结果状态的存续，不涉及动作的主体，只涉及动作的对象；</strong></p><p><strong>壁にカレンダーが　掛けてあります。窓があけてあります。</strong></p><p><strong>パスポートは＊バックの中に　いれ　てあります。</strong></p><p><strong>壁に　　わたし　が　カレンダーを　掛けました。我在墙上挂挂历了。</strong></p><p><strong>壁に カレンダーが　掛けてあります。        墙上挂着挂历。</strong></p></li><li><p><strong>「动」ておきます：表示为做某种准备而有意识进行的动作，有为了某种目的而将动作的结果或效果留下来的意味；</strong></p><p><strong>お客さんが来る前，部屋を　掃除し　ておきます。</strong></p><p><strong>明日は忙しいです。今夜はゆっくり　休ん　でおいて　ください。（～てください，表示请求）*訪問する前に，一度電話して　おきます。＊帰りの切符を　買っ　ておきますか。ーーいいえ，買っ　ておかなくてもいいです。</strong></p></li><li><p><strong>「动」てみます：表示尝试做某事：</strong></p><p><strong>太田さんは中国語で手紙を書い　てみました。</strong></p><p><strong>おいしそうですね。食べ　てみます。（しらべ，调查，おかしい，奇怪）</strong></p><p>**　それは＊おかしい。もう一度　調べ　てみてください。</p></li><li><p><strong>「小句（基本形）」ために，「小句2」①　[目的]         </strong></p><p><strong>「名」＋の＋ために，「小句2」①　[目的]</strong></p><p><strong>～ために表示目的，前后两个小句的主语相同：日本に　留学する　ために，お金をためています。</strong></p><p><strong>運動を　する　ために，新しい靴を買いました。林さんは駅へ　行く　ために，バスに乗りました。</strong></p><p><strong>前接名词时 ，用名词+の＋ために的形式：留学　の　ために，日本語を勉強しています。健康の　ために，毎日あるいています。</strong></p><p>1.34.2 表現と言葉の説明</p></li><li><p><strong>＊とっておきのお店：とっておきの＋名词，表示为了某种场合或用途而特别留着的东西或场所。    </strong></p><p><strong>これはとっておきのお酒です。どうぞ。今日は　パーティーがあるから，とっておきのネクタイをしよう。</strong></p><p><strong>应用课文中的とっておきのお店是指为了欢迎小野特别推荐的独具特色的餐馆。</strong></p></li><li><p><strong>*うわあ　[叹词⑦]：用于表示看到某种事物时产生的感动或惊讶。</strong></p><p><strong>うわあ，綺麗に＊焼いてありますね。うわあ，＊ひどい＊事故ですね。</strong></p><p> . <strong>＊しっかり：有多种意思，应用课文中表示充分、充足；    </strong></p><p><strong>小野さん，今日はしっかり食べておいてください。</strong></p><p> . <strong>ハードスケジュール：hard schedule，表示计划要做的事情很多，实施起来困难；        </strong></p><p><strong>明日からハードスケジュールで，＊あちこち行きますからね。    </strong></p><p><strong>課長はいつもハードスケジュールで，とても忙しいです。</strong></p><p> . <strong>あちこち：本来的形式是あちらこちら，会话中一般短缩为あちこち或 あっちこっち；    　　</strong></p><p><strong>夏休みにあちこち旅行しました。　　</strong></p><p><strong>久しぶりに運動したので，体のあちこちが痛いです。［久しぶりに～］本身就表达“隔了很久才做某事”的意思　　</strong></p><p><strong>＊注意：日语只存在那在前，这在后的说法，不存在こちあち，这样说不可以的。</strong></p><p> . <strong>もったいない：表示没有做到物尽其用，人尽其能而感到非常遗憾。    </strong></p><p><strong>料理がたくさん＊残ってしまいましたが，＊このまま捨てるのはもったいないです。    </strong></p><p><strong>時間がもったいないので，タクシーで行きましょう。    彼がしているのは，大変簡単な仕事なんです。    </strong></p><p><strong>それはもったいないですね。彼は＊非常に＊優秀な人ですから。</strong></p><p> . <strong>用餐习惯：在日本，主人准备的东西，习惯上客人要全部吃光，如果饭菜生下了，主人会担心时饭菜不好吃，或者不合客人的口味。客人如果觉得饭菜太多吃不了的话，一般选择一开始就对一部分饭菜不动筷子。    ①米饭用左手端起来吃；    ②嘴里有饭的时候不说话；    ③不往桌子上放鱼刺菜根等；    ④分食大盘菜时，先把菜夹到个人用的小蝶后再吃，用公筷或筷子的另一头。</strong></p></li></ol>              </div>            </details><p> 1.35 明日雨が降ったら、マラソン大会は中止です</p><details class="folding-tag" ><summary> たら ても　だけ　しかない　でも </summary>              <div class='content'>              <p> 1.35.1文法説明</p><ol><li><p>「小句1（过去形式）」たら，「小句2」：～たら用于表示 假定条件。其接续方式是把过去形式的た换成たら。不过二类形容词和名词的过去否定形式~ではなかった后续たら时，要去掉其中的は，变成～でなかったら。    </p><p>明日雨が　降ったら，マラソン大会は　中止です。寒かったら，窓を閉めてください。</p><p>＊表現が　＊変だっ　たら，教えてください。鉛筆たっ　たら，＊消しゴムで消すことができますよ。</p><p>明日　雨でなかっ　たら，ハイキングに行きます。</p><p>礼貌的说法:敬体形的ます／です后续~たら，换成~ましたら，でしたら的形式。</p><p>一类形容词后续~たら时，不用敬体形；    問題がありましたら，教えてください。    </p><p>表現が《変｜へん》でしたら，「直します｜なおします，直します，修改」。　</p><p>X　寒いでしたら，窓を閉めてください。　X　寒かったら，窓を閉めてください。</p></li><li><p>「小句１」ても，「小句２」：用于表示小句1成立时小句2也理应成立，但事实上 却没有成立。具有无论发生什么事情 ，其结果都是相同的意味。</p><p>接续方式是て形的て换成ても、でも；日本へ　帰っても，中国語の勉強を続けてください。</p><p>薬を　飲んでも，この病気は直りません。仕事が忙しくても，＊休日には休みます。</p><p>準備が　＊完全でも，＊最終点検は＊必要です。休日でも，働きます。</p><p>～ても除了用于假定情况以外，还可以用于表示已经发生的情况：その言葉は，辞書で調べても，分かりませんでした。</p></li><li><p>「名」だけ：只，仅仅，表示这就是全部，不再有其他的意思；</p><p>今年の夏休みは3日だけです。森さんと馬さんだけがお酒を飲みます。</p><p>私はその料理だけを食べませんでした。</p><p>だけ后面的助词が和を，有时省略：森さんと馬さんだけお酒を飲みます。私はその料理だけ食べませんでした。</p></li><li><p>「名」しか＋否定形式：表示除了举出的一项外，其他的都不是这样的意思。同　~だけ＋肯定形式的意思基本相同。</p><p>细微区别：~だけ只用来表示一种客观的限定，而~しか～ない带有主观感情色彩；</p><p>会議室には李さんしかいません。　　会議室には李さんだけがいます。私は水しか飲みません。　　　　　　</p><p>私は水だけを飲みます安全な所はここしかありません。　　安全な所はここだけです。</p><p>上述细微区别，在它们和数量词 一起使用时表现得尤其明显：</p><p>北京には　3日しか＊滞在することができません。北京には　３かだけ滞在することができます。</p><p> . 「名」でも：[提示极端的例子]：表示即便如此，其结果也一样的意思；    その＊計算は子供でもできます。    その計算は大人でもできません。    よく＊効く薬でも，たくさん飲むと体によくありません。</p><p>＊よく的原型是よい，よい是好的意思，よい是一类形容词，将い变成く加动词</p><p>1.35.2　表現と言葉の説明</p></li><li><p>何かあった：这里的あった不表示物体的存在，而是表示发生了某种事情；馬さんは元気がないね。何かあったのかな。駅前で何かあったんですか。人が集まっていますよ。           </p></li><li><p>＊あと～：除可后续少し外，还可以后续ひとり、一つ、三日等数量词，表示只要再有 一个很少的量，就可以完成某事或使某事成立；すみません。あと少しだけ待ってください。出発まであと10分です。       </p></li><li><p>どの家でも：和どこの家でも意思相同，表示哪家都，每家都.. 的意思。</p><p>どの可以后续会社、果物等表示事物的 名词；北京では，餃子はどの家でも，自分たちで作って食べます。</p><p>最近では，どの会社でも，事務所にパソコンがあります。</p><p>若指人时，则不能说 Xどの人でも而要用だれでも，指时间时要用 いつでも。</p><p>此外，日语中没有每家、每人的说法；</p><p>このテレビゲームは簡単ですから，だれでもできます。　</p><p>（込みます，拥挤）このお店はいつでも込んでいます。</p></li><li><p>本のとおりに：是日语中常用的固定用法，表示~那样的意思。</p><p>本のとおりに的意思是，书上说的那样。本のとおりに作っても，なかなかうまくできないんです。　　</p><p>（うまく，上手く）きのは天気予報のとおりに，大雨が降りました。</p></li><li><p>なかなか②　[表示程度的副词⑤]：14课学习了表示程度的なかなか，其实它还可以和否定形式呼应来使用，表示事态的发展并没有所期待的那么简单或者不能轻易地实现：本のとおりに作っても，なかなかうまくできないんです。</p><p>（かぜをひきます，感冒了；なおります，治ります）　風邪を引いてしまって，なかなか治りません。</p></li><li><p>＊だんだん　[表示程度地副词⑥]：表示事物逐渐发生变化，用于变化程度不很显著地状况。常常和~なります等表示变化地表达方式呼应使用 ；何度も作ると，だんだん上手になりますよ。</p><p>秋になると，紅葉の＊葉がだんだん赤くなります。～と用于表示恒常状态</p><p> . 30個は大丈夫ですよ：助词は接在数量词后，与肯定形式呼应使用时，表示该数量为最低限度；    </p><p>小野さんが作った餃子だったら，30個は大丈夫ですよ。　    </p><p>このカメラの修理はどのぐらいかかりますか。ーーそうですね..　10日はかかりますよ。</p></li><li><p>去熟人家里做客：</p></li></ol>              </div>            </details><p> 1.36遅くなって、すみません</p><details class="folding-tag" ><summary> て表示原因、理由 に・のに 用途、基准　ばかり 持续重复性的动作 </summary>              <div class='content'>              <ol><li><p>「小句1」て，「小句2」[原因，理由]：         </p><p>第14课和16课学习了~て将几个动作连接起来的用法，这种形式还可以用来表示原因、理由。</p><p>小句1是小句2的原因、理由，不过小句2不可以是祈使句：</p><p>遅くなって，すみません。＊最初は言葉が＊通じなくて，とても困りました。</p><p>森さんは頭が痛くて，会社を休みました。</p><p>説明が上手です，【よく|よく的原型是よい，よい是好的意思，よい是一类形容词，将い变成く加动词】わかりました。父は大阪の＊出身で，いつも＊関西弁で話します。</p></li><li><p>「名」に　[用途、基准]：表示用途时，前面是具体说明用途的名词，后面一般是使います等动词。</p><p>この写真は何に使いますか。ーーパスポートの申請に使います。</p><p>~に表示基准时，前面的名词是基准，后面一般是表示评价的形容词。</p><p>スーパーが近いので，このマンションは買い物に便利です。</p><p>この本は，大人には易しいです。しかし，子供には難しいです。</p></li><li><p>「动（基本形）」のに　[用途][基准]：前面学习了名词+に表示用途和基准。动词基本形+の＋に也可以用于表示用途和基准；</p><p>この写真はパスポートを申請するのに使います。</p><p>この＊フライパンは＊卵焼きを作るのに使います。このマンションは買い物するのに便利です。</p><p> . 「名」ばかり「动」：表示例举的事物全部相同；    </p><p>「 动 て（形）」ばかりいます：表示总是发生同样的事情，或总是进行同样的动作；        </p><p>何で野菜ばかり食べているんですが。ーー今，ダイエット中はなんです。        </p><p>林さんはカラオケで古い歌ばかり歌います。 張さんは毎日お酒を飲んでばかりいます。        </p><p>森さんはいつも＊失敗してばかりいます。</p></li></ol><p>＊注意：~ばかり和~だけ都可以 表示限定，但其用法有以下三点差异：</p><p>❶～だけ可以用来限定数字，~ばかり不可以。表示只吃了3个，可以用 3つだけ食べました，如果用3つばかり食べました，尽管语法没错，但表示的不是限定的意思；</p><p>❷～だけ可以和否定形式呼应使用，~ばかり不可以；</p><p>❸～だけ只表示没有例外，~ばかり则含有反复进行同一动作的意思：お茶だけ飲んでいます。（只喝了一点茶，用于只喝了一杯茶而没有和其他任何饮料的情况）。而お茶ばかり飲んでいます（只是一个劲的喝茶，必须用于一杯接一杯的喝了好几杯茶的情况）。另外，ばかり有一种不太理想的含义。</p><ol><li><p>「小句（动词简体形）」のが＋見えます／聞こえます：</p><p>空港の入り口に警官が立っているのが見えます。</p><p>（さわぎます，騒ぎます，吵闹）隣の部屋で子供たちが騒いでいるのが聞こえますか。ーーはい。よく聞こえます。</p><p>彼が車に乗ったのが見えました。</p><p>＊参考：小句的谓语为一类形时，用一类形+の的形式，为二类形时，用二类形+な＋の的形式；    </p><p>森さんが嬉しいのが分かります。    日本語が簡単なのがよく分かりました。</p><p>1.36.2　表現と言葉の説明</p></li><li><p>＊凧：风筝。</p></li><li><p>＊ほんと：本当（ほんとう）的口语缩略形式。</p></li><li><p>＊とにかく：虽然事情很多，但不一一罗列而优先陈述某事时使用。应用课文中用于 讲在北京生活吃过各种各样的苦，但其中语言不通是最困难的；とにかく最初は言葉が通じなくて，とても困りました。</p></li><li><p>*ペラペラ　[拟声词①]：应用课文当中的意思，是指外语说的非常流利：李さんは日本語がぺらぺらです。</p></li><li><p>擬音語・擬態語：模仿人、动物或物体发出 的声音以及描述某种样态的词，汉语叫做拟声词。日语当中拟声词特别多，日本人无论在口语还是书面语中都大量使用拟声词，功能一般相当于副词；</p><p>犬がワンワン＊鳴いています。雨がザーザー降っています。</p><p>子供がすやすや＊眠っています。道が＊くねくね曲がっています。</p></li><li><p>＊量り売り：日本以前的蔬菜、佐料等都是按斤卖，即量り売り，但是现在超市 ，蔬菜等一般都是以盒装或袋装为单位销售。</p></li></ol>              </div>            </details>              </div>            </details><h2 id="初级上册-第八单元"><a href="#初级上册-第八单元" class="headerlink" title="初级上册-第八单元"></a>初级上册-第八单元</h2><details class="folding-tag" ><summary> 动词命令形- 点击查看详情 </summary>              <div class='content'>              <p> 1.29 電気を消せ</p><details class="folding-tag" ><summary> 动词的命令形-意志形 </summary>              <div class='content'>              <p>1.29.1 文法説明</p><ol><li>动词的命令形：说话人对听话人下命令时使用的表达形式，构成方式分为三种情况：<ol><li>一类动词：把基本形的最后一个音变成相应え段上的音；</li><li>二类动词：基本形的る变成ろ；</li><li>三类动词：把来る（くる）变成こい，する变成しろ；</li></ol></li></ol><table border="1">  <thead>    <tr>      <th>分类</th>      <th>基本形（发音）</th>      <th>基本形（汉字）</th>      <th>命令形</th>    </tr>  </thead>  <tbody>    <!-- 一类动词 -->    <tr>      <td rowspan="9">一类动词</td>      <td>かく</td>      <td>書く</td>      <td>かけ</td>    </tr>    <tr>      <td>いそぐ</td>      <td>急ぐ</td>      <td>いそげ</td>    </tr>    <tr>      <td>とぶ</td>      <td>飛ぶ</td>      <td>とべ</td>    </tr>    <tr>      <td>よむ</td>      <td>読む</td>      <td>よめ</td>    </tr>    <tr>      <td>しぬ</td>      <td>死ぬ</td>      <td>しね</td>    </tr>    <tr>      <td>まつ</td>      <td>待つ</td>      <td>まて</td>    </tr>    <tr>      <td>うる</td>      <td>売る</td>      <td>うれ</td>    </tr>    <tr>      <td>かう</td>      <td>買う</td>      <td>かえ</td>    </tr>    <tr>      <td>はなす</td>      <td>話す</td>      <td>はなせ</td>    </tr>    <!-- 二类动词 -->    <tr>      <td rowspan="3">二类动词</td>      <td>たべる</td>      <td>食べる</td>      <td>たべろ</td>    </tr>    <tr>      <td>みる</td>      <td>見る</td>      <td>みろ</td>    </tr>    <tr>      <td>ねる</td>      <td>寝る</td>      <td>ねろ</td>    </tr>    <!-- 三类动词 -->    <tr>      <td rowspan="2">三类动词</td>      <td>くる</td>      <td>来る</td>      <td>こい</td>    </tr>    <tr>      <td>する</td>      <td>する</td>      <td>しろ</td>    </tr>  </tbody></table><p><strong>電気を消せ；　書類を速く　提出しろ；</strong></p><ol><li><p><strong>「动」なさい：比动词的命令形稍微客气一些的方式，多用于老师对学生或者父母对孩子提出要求，其接续方式为动词第一连用形＋なさい；</strong></p><p><strong>質問に　答え　なさい；早くお風呂に　入り　なさい；</strong></p></li><li><p><strong>「动（基本形）」な　[禁止]：用于禁止听话人做某事；</strong></p><p><strong>ここに　車を　止める　な；タバコを　吸う　な；</strong></p></li><li><p><strong>「动」て／「动」ないで：日常生活中经常使用的表示祈使的说法，不论男女都经常使用，不过一般用于关系较为亲密的人：</strong></p><p><strong>もうちょっと　急い　で；　　ちゃんと話を　聞い　て；　　＊遠慮し　ないで；</strong></p><p><strong>＊参考：命令形　～なさい、～な　和～て／～ないで相比适用范围非常有限，一半用于上下级或尊卑关系非常明确的非正式场合，不过在紧急情况下，也可以对上级说＊逃げろ。但是，虽然是紧急情况之下，要求对方救助、帮助自己时也不可以使用命令形，而要使用动词て形；</strong></p></li><li><p><strong>「名」＋　という　＋「名２」：提供对方不知道的新信息时，在表示新信息的词语后面要加という：</strong></p><p><strong>それは　フジ　という　花です；わたしは　東京の　＊世田谷　という　ところ　に住んでいます；</strong></p><p><strong>田中さん　という　名前は　日本人の　名前です；</strong></p></li><li><p><strong>「名１」は「名」／「小句」＋という＋「名２」です：～という也可以用于给名词1下定义或对其进行解释，这时候名词2多为いみ（意味）等词语，小句可以是命令形，简体形或简体形＋な：</strong></p><p><strong>このマークは　タバコを吸うな　という　意味です；</strong></p><p><strong>このマークは　ここで＊止まれ　という　意味です；</strong></p><p><strong>この　＊標識は　駐車禁止　という　意味です；</strong></p><p>1.29.2　表現と言葉の説明</p></li><li><p><strong>命令形，禁止形的用法：如前面语法解释的那样，命令形、禁止形给人一中粗鲁的印象，所以使用场合很少，但是在遇到紧急情况时有必要使用命令形。此外，命令形也是体现男性同伴之间亲密给关系的一种语体，但要尽量恰到好处的使用，例如：</strong></p><p><strong>❶用于男性为主的工作单位的上司对部下：*おい，早くかたづけろ；ここでタバコを吸うな；</strong></p><p><strong>❷用于关系亲密的男性朋友之间：さあ，もっと飲めよ；友達なんだから，遠慮するな；＊如年龄相差悬殊，即使关系较为亲密，仍然要注意区分，对年长者一半不应使用；</strong></p><p><strong>❸用于紧急场合：危ない！止まれ！触るな！熱いぞ！＊即使是紧急场合，女性也一半不使用命令形，而要用动词て形，例如：止まって。表示禁止的时候说触らないで！</strong></p><p><strong>❹用于观看体育比赛时，女性也使用：*頑張れ！ ＊シュートしろ！</strong></p><p><strong>❺用于直接引用含有委托、要求等祈使含义的话语或用于解释词语，男女都可以使用：課長は　書類を早く　提出しろ　と言いました；立入禁止は　ここに入るな　という　意味です；</strong></p></li><li><p><strong>ないといけません的省略形式：～ないといけません　～なければなりません等说法句子较长，因此在不影响理解的情况下，常常省略后面的部分。例如，应用课文中：“～と言わないとね”，这是“～と言わないといけないね”省略了“いけない”之后的形式。</strong></p><p><strong>另外，～なければなりません也可以省略后半部分，只说～なければ；</strong></p><p><strong>例如：この　＊場合は　歌ってください　と言わないとね；時間がないから，急がないと..日本語の　＊テレビ講座が　9じから始まります。見なければ。　　</strong></p></li><li><p><strong>～かたをする：22课学习了动词＋方表示动作方式的用法，描述这种方式进行动作时，可用～方＋をします的形式：</strong></p><p><strong>＊そんな　＊乱暴な言い方をしない　でください；あの人は　いつも　＊変わった考え方をします；</strong></p><p><strong>言います的表达重点在于所说的内容，而应用课文重的言い方をします不涉及所说的内容，而用来指说的方法；</strong></p></li></ol>              </div>            </details><p> 1.30 もう11時だから寝よう</p><details class="folding-tag" ><summary> 动词的意志形 </summary>              <div class='content'>              <p> 1.30.1文法説明</p><ol><li><p>动词的意志形：是说话人当场表示自己的决心、意志的表达形式，其构成方式如下：</p><p>一类动词：基本形最后一个音变成相应的お段音的长音；</p><p>二类动词：基本形的る变成よう；</p><p>三类动词：来る变成こよう，する变成しよう；</p></li></ol><table border="1">  <thead>    <tr>      <th>分类</th>      <th>基本形（发音）</th>      <th>基本形（汉字）</th>      <th>意志形</th>    </tr>  </thead>  <tbody>    <!-- 一类动词 -->    <tr>      <td rowspan="9">一类动词</td>      <td>かく</td>      <td>書く</td>      <td>かこう</td>    </tr>    <tr>      <td>いそぐ</td>      <td>急ぐ</td>      <td>いそごう</td>    </tr>    <tr>      <td>とぶ</td>      <td>飛ぶ</td>      <td>とぼう</td>    </tr>    <tr>      <td>よむ</td>      <td>読む</td>      <td>よもう</td>    </tr>    <tr>      <td>しぬ</td>      <td>死ぬ</td>      <td>しのう</td>    </tr>    <tr>      <td>まつ</td>      <td>待つ</td>      <td>まとう</td>    </tr>    <tr>      <td>うる</td>      <td>売る</td>      <td>うろう</td>    </tr>    <tr>      <td>かう</td>      <td>買う</td>      <td>かおう</td>    </tr>    <tr>      <td>はなす</td>      <td>話す</td>      <td>はなそうと</td>    </tr>    <!-- 二类动词 -->    <tr>      <td rowspan="3">二类动词</td>      <td>たべる</td>      <td>食べる</td>      <td>たべよう</td>    </tr>    <tr>      <td>みる</td>      <td>見る</td>      <td>見よう</td>    </tr>    <tr>      <td>ねる</td>      <td>ねよう</td>      <td>ねろ</td>    </tr>    <!-- 三类动词 -->    <tr>      <td rowspan="2">三类动词</td>      <td>くる</td>      <td>来る</td>      <td>こよう</td>    </tr>    <tr>      <td>する</td>      <td>する</td>      <td>しよう</td>    </tr>  </tbody></table><p><strong>动词的意志形，实际上是17课学习过的～ましょう的简体形，因此除了表示意志外，还可以表示提议：</strong></p><p><strong>もう11時だから寝よう。仕事が終わってから，飲みに　行こうよ。手伝おうか。</strong></p><ol><li><p><strong>手伝おうか。「动（意志形）」と思います：说话人向听话人表示自己要做某事的意志时，一般不单独使用意志形而是用意志形＋と思います的形式。</strong></p><p><strong>意志形＋と思います和意志形所表示的意思一样，但要比单纯的意志形更加礼貌、温和；</strong></p><p><strong>今日，会社を　休もう　と思います。もう遅いので，そろそろ　帰ろう　と思います。</strong></p></li><li><p><strong>「动（意志形）」と思っています：表示自己把某种意志持续了一段时间：</strong></p><p><strong>明日病院へ　行こう　と思っています。今度，長江下リを　しよう　と思っています。</strong></p><p><strong>その問題について，もう少し　考えよう　と思っています。</strong></p><p><strong>“意志形”“～ようと思います”“～ようと思っています”三者区别如下：</strong></p><p><strong>❶表示当场形成的意志时，只可以使用意志形；</strong></p><p><strong>❷　～ようと思います、～ようと思っています都表示决心和意志，但由于后者属于～ています的形式，因此有一种决心或意志尚未最后形成的语感；</strong></p></li><li><p><strong>「小句1」ので，「小句2」：～ので表示原因、理由，既可以跟在简体形后，也可以跟在敬体形后，但一般接简体形较多，小句1为二类形容词小句或名词小句时，把其简体形的だ变成な再加ので，成为　なので；</strong></p><p><strong>荷物が重いので，宅配便で送ります。香港からお客さんが来るので，空港へ迎えに行きます。</strong></p><p><strong>ここは静かなので，とても気に入っています。もう＊終電の時間なので，帰ります。</strong></p><p><strong>＊注意：～ので和～から相比，较为礼貌和郑重，多用于正式场合，～ので，口语发音往往发成～んで；       小句2表示提议时，必须使用～から；</strong></p><p><strong>電車が遅れたんで，遅刻しました。すみません。如果上面的～んで改用为～から，则显得申诉的理由强烈；</strong></p><p><strong>もう時間がないから，早く行こうよ。这里由于小句2表示提议，所以只能用から，不可以使用んで；</strong></p><p>1.30.2表現と言葉の説明</p></li><li><p><strong>そろそろ：用于表示做某事或事态发生的时间渐渐紧迫时：</strong></p><p><strong>そろそろ食事の時間ですよ。　　</strong></p><p><strong>つゆ（梅雨）そろそろ＊梅雨が始まりますね。去别人家里做客，发掘该回到家的时间到了，一般要说そろそろ失礼します：あっ，もう9時ですね。そろそろ失礼しないと..ーーそうですか。気をつけて　帰ってください。</strong></p><p><strong>另外,使用そろそろ＋～ましょうか或そろそろ＋意志形＋か的形式，表示随着时间的紧迫该一起做某事，是提醒或催促对方和自己一起行动的一种说法。</strong></p><p><strong>馬さん，みんな＊そろったから，そろそろ＊出発しょうか。――ええ，そうしましょう。</strong></p></li><li><p><strong>それじゃ：是それでは的较为随意的说法，多用于口语：</strong></p><p><strong>どうして　昨日　来なかったんですか。熱があったんです。</strong></p><p><strong>それじゃ，＊仕方ないですね。</strong></p></li><li><p><strong>まあ：表示并不十分理想，但还能过得去的程度，用于调控自己或对方的不满情绪：</strong></p><p><strong>*報告書ができました。これでいいですか。－－時間もないから，まあいいですよ。</strong></p></li><li><p><strong>自言自语时的“な”：自言自语时，可在简体形后＋な表示感叹，由于是自言自语，因此不用于敬体形。なあ，是将な音拖长，用于较强烈的感叹。</strong></p><p><strong>今日は本当に寒いな。あっ，財布を忘れた！</strong></p><p><strong>困ったなあ。すみません，出かけようとした時に電話があったんです。ーー＊そうか。それじゃ，まあ，仕方ないな。</strong></p></li><li><p><strong>楽しみです：意思=楽しみにしています，表示盼望，期待的心情。</strong></p><p><strong>わたしは花が好きでなので，楽しみです。要表示请你愉快的期待着时，要说楽しみにしてください。</strong></p><p><strong>夏休みはどこか行きますか。ーーええ，ヨーロッパへ旅行に行こうと思っています。今からとても楽しみです。</strong></p><p><strong>来週わたしの家に遊びに来てください。ーー本当ですか。ありがとうござい。たくさん料理を作りますから，楽しみにしてください。</strong></p><p><strong>另外，指感到愉悦 的事物、兴趣或娱乐时，也可以说楽しみです：時々孫に会うのが，父の楽しみです。</strong></p></li><li><p><strong>行楽地：众人去游览的名胜古迹，设有旅游设施及娱乐设施的场所，在日语当中统称为行楽地（こうらくち）、相当于汉语里的景点。在日本，当春季樱花盛开，秋季枫叶烂漫，或者黄金周前后的连休，行楽地到处都是人山人海，去行楽地的汽车往往把附近的公路堵得水泄不通。</strong></p></li><li><p><strong>～でいっぱい：表示一个场所或某个容器已经达到饱和状态，不可能再容纳更多的人或物：</strong></p><p><strong>この季節は，どの行楽地も人でいっぱいですよ。　　</strong></p><p><strong>（まちあいしつ，待合室。かんじゃ，患者。）　</strong></p><p><strong>病院の＊待合室は＊患者でいっぱいです。＊灰皿がタバコの＊吸殻でいっぱいになりました。</strong></p></li></ol>              </div>            </details><p> 1.31このボタンを押すと、電源が入ります</p><details class="folding-tag" ><summary> と表示恒常状态 - ことが　あります　有时发生 </summary>              <div class='content'>              <p> 1.31.1 文法説明</p><ol><li><p><strong>「小句１（动词基本形/ない形）」と，「小句2」：“～と”用在表述恒常性状态、真理、反复性状态、习惯内容的复句里，表示小句1是小句2的条件；</strong></p><p><strong>このボタンを押すと，電源が入ります。[恒常性状态]</strong></p><p><strong>食べ物を食べないと，＊人間は＊生きることができません。[真理]</strong></p><p><strong>わたしは，その店へ行くと，いつもコーヒーを飲みます。[反复的状态]</strong></p><p><strong>此外，～と还可以表示由于，某种行为而发现了新的情况：この道をまっすぐ行くと，デパートがあります。＊カーテンを開けると，＊美しい山が見えました。～と连接的复句，小句2不能是自己的意志、愿望或向听话人提出要求、劝诱等内容。夜になると，電気が＊つきます。　X夜になると，食事に行きましょう。</strong></p></li><li><p><strong>「动词（基本形/ない形）ことがあります」：表示有时会发生某种事态，往往和たまに、時々等副词连用;</strong></p><p><strong>そのパソコンは，たまに　フリーズする　ことがあります。</strong></p><p><strong>時々寝坊する　ことがあります。たまに　朝ご飯を　食べない　ことがあります。</strong></p><p><strong>＊注意：与 第21课学习过的～た形＋ことがあります表示 过去曾经做过某事，是完全不相同、不相关连的句型。</strong></p></li><li><p><strong>形容词的副词用法：有的形容词可以像副词一样修饰动词，这时候一类形容词要把词尾的い变成く，二类形容词后面要＋に。</strong></p><p><strong>早く家に帰ります。馬さんは　とても上手に　レポートを　まとめました。</strong></p><p><strong>静かにドアを閉めてください。</strong></p></li><li><p><strong>「小句（简体形）」でしょうか：句尾使用でしょうか表示疑问的句子，是礼貌程度较高的表达方式。比如：来るでしょうか、来ますか，虽意思相同，但来るでしょうか的礼貌程度较高。</strong></p><p><strong>动词小句和一类形小句以简体形后续でしょうか，二类形和名词小句其简体形的だ换成でしょうか即可：    </strong></p><p><strong>李さんは来るでしょうか。　　　　　李さんは来ますか。    </strong></p><p><strong>馬さんはもう帰ったでしょうか。　　馬さんはもう帰りますか。    </strong></p><p><strong>3月の東京は寒いでしょうか。　　　3月の東京は寒いですか。    </strong></p><p><strong>これは中国のお菓子でしょうか。　　これは中国のお菓子ですか。</strong></p><p>1.31.2表現と言葉の説明</p></li><li><p><strong>きちんと：用于表示正确、无误、恰当等意思。基本课文B当中，表示每日都正经的用早餐。</strong></p><p><strong>朝ご飯は毎日きちんとたべますか。　　部屋をきちんとかたづけてください。</strong></p></li><li><p><strong>卓球台ですか？公園で？　[叮问的说法]</strong></p><p><strong>日本人对再公园打乒乓球的场面时很难想象的。因此森非常吃惊的反问马时，采用了这一表达方式。正常的语序应该是：公園で卓球をするんですか。但再吃惊的时候，人们往往暂时抛开这一规则，先去问自己关心的部分，因此往往一个问句变成了两个连续的短问句。わたしが浴衣を作ります。－－浴衣ですか？自分で？明日からアメリカへ出張します。－－えっ。出張ですか？アメリカ？～でできた：表示用～做成～时，日语一般不说～で作った～而说～でできた：　　その公園には＊コンクリートででできた＊卓球台があるんです。    それは＊プラスチックでできた箱です。    これは＊ひすいでできた＊白鳥のブローチです。    木でできたおもちゃを孫に買ってあげました。ほど／ぐらい：数量词＋ほど／数量词＋ぐらい都表示大致的数量或分量。但是表示某序列中的一点时，可以用ぐらい而不能用ほど。ここから　300＊メートルほど行くと，スポーツセンターがあります。わたしは30歳ぐらいからスポーツを始めました。ここから＊二つ目ぐらいの信号を右に曲がったところに，確かスーパーが　ありましたよね。这里不可以 使用ほど。另外，ぐらい可以接在この／その／あの／どの后面，但ほど不能：[用受比划着大小]このぐらいの＊サイズの箱が欲しいんですが。ただし：表示基本肯定前面句子内容的基础上，附加一些条件、限制，或者补充一些例外的情况，意思与 しかし相似，但しかし可以用来接续与之前完全相反的内容，而ただし则只能用来表示对前句内容的部分限制或补充：このスポーツセンターは，誰でも利用することができます。ただし，有料ですが。このスポーツセンターは，誰でも利用することができます。ただし，会費は高いです。このプールは女性は利用することができます。しかし，男性はだめです。</strong></p></li></ol>              </div>            </details><p> 1.32今度の日曜日に遊園地へ行くつもりです</p><details class="folding-tag" ><summary>  </summary>              <div class='content'>              <ol><li><p><strong>「動（基本形/ない形）」つもりです：表示说话前已经形成的意、打算。与30课学习过的动词意志形＋と思っています意思相同：</strong></p><p><strong>今度の日曜日に遊園地へ行く　つもりです。ボーナスで　車を　買う　　つもりです。</strong></p><p><strong>もうタバコは　吸わない　つもりです。</strong></p><p><strong>＊注意：对长辈或上级用～つもりですか直接提问不礼貌。前面学习过的～ようと思います和～ようと思っています同样的也不能用于向长辈或上级提问。</strong></p></li><li><p><strong>「动（基本形／ない形）」ことにします／ことにしました：表示说话人自己决定实施某种行为;</strong></p><p><strong>明日から毎日運動する　ことにします。今日からお酒を飲まない　ことにします。</strong></p><p><strong>明日，友達と映画を見に行く　ことにしました。</strong></p><p><strong>広州へは飛行機で　行く　ことにしました。今年の夏は旅行に　行かない　ことにしました。</strong></p></li><li><p><strong>「动（基本形/ない形）」ことになりました：表示由于某种外在原因导致形成了某种决定：</strong></p><p><strong>来月から　給料が　上がる　ことになりました。月曜日から3日間，香港へ　出張する　ことになりました。</strong></p><p><strong>今週は会議を　＊行わない　ことになりました。</strong></p><p><strong>＊注意：～ことにします／～ことになります里的こと不可以用の代替。</strong></p><p><strong>来月，日本へ旅行に　　行く　ことにしました。</strong></p><p><strong>此外，～ことになりました可用于婉转的表述根据自己的意志决定的事情：私たち，結婚することになりました。私は来月から中国へ留学することになりました。</strong></p></li><li><p><strong>「简体小句」そうです　①[传闻]：明确表示某信息不是源于自己的直接感知，而是从别人那里听到的，提示消息来源需要使用～によると；</strong></p><p><strong>馬さんの息子さんは，今年小学校に入学するそうです。</strong></p><p><strong>＊天気予報によると，明日は雨だそうです。</strong></p><p><strong>森さんは来週の土曜日は暇だそうです。</strong></p><p><strong>＊～そうです不区分过去、否定和疑问形式：</strong></p><p><strong>森さんは来週の土曜日は暇ではないそうです。</strong></p><p><strong>这里绝对不可以使用そうではありません，因为就没有这种用法。</strong></p><p>1.32.2表現と言葉の説明</p></li><li><p><strong>今度の日曜日に：日语的今度与汉语的这次相比，语义要宽泛得多，有时相当于汉语的下次，例如本课出现的今度の日曜日，就是指说话时间之后的星期天。</strong></p><p><strong>今度の日曜日に　遊園地へ行くつもりです。今度の会議は午前10時からです。</strong></p></li><li><p><strong>ボーナス：除每月的基本工资外，另外支付的奖金。在日本，一般6月份和年底各支付一次。公司不同，每年支付的奖金月数也会不同，但奖金都是以每月的基本工资X月数的形式来计算的。发放奖金期间，各种商店会举报各种促销活动。</strong></p></li><li><p><strong>*ずっと[期间]：第12课学习了副词ずっと，表示程度差异很大的意思，现在学习其表示在某一期限内动作、状态一直持续的用法，連休中はずっと～的意思，就是连休期间一直～</strong></p><p><strong>天気予報によると，連休中はずっと晴れだそうですよ。佐藤さんは先月からずっと入院しています。</strong></p></li><li><p><strong>メールがあって：表示收到了电子邮件。同样的，電話／手紙／フアックス也可以用～がある的表达形式；</strong></p><p><strong>先週，小野さんからメールがありました。</strong></p><p><strong>彼女から電話があって，明日のパーティーに来ると言いていました。</strong></p></li><li><p><strong>＊お邪魔する：原意是妨碍别人做某事。也表示到别人家里去拜访的意思。进门要说お邪魔します，离开时要说お邪魔しました。</strong></p><p><strong>[出门离开时，在被访者的 门厅]では，とてもお邪魔しました。　－－また来てください。</strong></p></li><li><p><strong>～てほしい　[表示对他人的愿望]：17课学习了～たい，表示说话人自己想做某事的愿望，当表示希望别人去做某事时，则要用～てほしい，但是这种表达方式礼貌程度较低，不能对长辈或上级使用。</strong></p><p><strong>先生にわたしの友達を紹介したいです。田中さんに日本人の友達を紹介してほしいです。</strong></p><p><strong>（手伝います，てつだいます）　すみません。ちょっと手伝ってほしいんですが..</strong></p></li><li><p><strong>～って　②　[～と／～というひとは的缩略形式]：22课学习了表示传闻的～って，在很随便的对话中，表示引用的～と言います／と思っています中的～と，以及～という人は等，也往往说成～って。</strong></p><p><strong>应用课文在中的：手伝ってほしいって言っていました。其本来形式为：</strong></p><p><strong>手伝ってほしいと言っていました。大田さんって，どんな人ですか。其本来形式为：大田さんという人は，どんな人ですか。</strong></p><p><strong>如果表示引用的助词と前面的音节是大田さん的ん，由于～んって比较难发音，因此往往出现促音脱落的现象，即发成大田さんて。何と言いますか的缩略形式何ていますか，也是基于同样理由的例子，为了好读一些。もしもし，今何て言った？　－－少し遅れる　って言ったの。</strong></p></li></ol>              </div>            </details>              </div>            </details><h2 id="初级上册-第七单元"><a href="#初级上册-第七单元" class="headerlink" title="初级上册-第七单元"></a>初级上册-第七单元</h2><details class="folding-tag" ><summary> 动词简体形 - 动词简体小句 点击查看详情 </summary>              <div class='content'>              <p> 1.25　これは　明日会議で使う資料です</p><details class="folding-tag" ><summary> 动词简体形/简体小句 点击查看详情 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">文法</button><button type="button" class="tab">基本课文</button><button type="button" class="tab"><i class="fas fa-bomb"></i>应用课文</button></div><div class="tab-contents"><div class="tab-item-content active"><p> 1.25.1　文法説明</p><ol><li><p>「动（简体形）」+「名」／「小句（动词简体形）」+ 「名」：具体的说，表示习惯或将要发生的动作时，用动词的基本形，表示动作已经完成时，用动词的た形，</p><p>例如： これは　明日会議で　使う　資料です； あれは　森さんが　＊今夜＊泊まる　ホテルです； あれは　＊倒産した　会社です； </p><p>＊需要特别注意：名词前不可以使用敬体形，以及，名词前不可以加“の”； </p></li><li><p>「小句（动词简体形）」+ 「名」は　「名」／「形」です：动词小句 修饰名词而形成的名词短语，常常用来做主语：</p><p>私が　明日乗る飛行機は　中国航空です；　小野さんが　作る料理は　おいしいです； </p><p>森さんが　買った本は　これです； </p><p>日语较汉语相比，名词前面常常有较长的定语：きのう　父は　デパートで　日本製のカメラを　買いました。その　カメラは　やすかったです。这两个句子可以合起来，变成：きのう　父が　デパートで　買った日本製の　カメラは　とても　安かったです。 </p></li><li><p>「小句（动词简体形）」+「名」を／に／から　「动」ます：动词简体形小句，也可以用做主语以外的其他句子成分：中国で買ったCDを　友達に貸しました；中国へ　転勤した友達　に　手紙を書きます； わたしが　知らない人から　手紙が　来ました。 </p><p>＊修饰名词的动词小句中的主语，使用“が”，不能用“は”； </p></li><li><p>「小句（一类形/二类形/名）」+ 「名」：</p><p>❶名词＋が＋一类形 ＋です用来修饰名词时，一类形容词用基本形； </p><p>❷名词＋が＋二类形容词＋です修饰名词时，二类形容词＋です要变成二类形容词＋な的形式； </p><p>❸名词1＋が＋名词2＋です修饰名词时，名词2＋です要变成名词2＋の的形式； </p><p>入り口が　広い＋あの建物　→ 入り口が　広い　あの建物が　わたしの　会社です； 操作が　簡単です　＋　パソコン　→ 操作が　簡単な　パソコンが　欲しいです； ＊数学が専門です＋先生　→ 数学が　専門の先生が　やすみました； </p><p>＊注意，与汉语不同，形容词修饰名词时，不能加の！</p><p>1.25.2 表現と言葉の説明</p></li><li><p>～のところ：名词后加～のところ，可以把本来不表示场所的名词标记为表示场所的词语，例如： </p><p>あの窓のところに　いる人は　誰ですか； </p><p>李さん，すぐ課長のところへ　行って　ください；　――すぐ，立刻、马上； </p></li><li><p>あれ[指人的词]：これ／あれ　本来是指示事物的代词，但有时候也用于指示人，由于这种代指礼貌程度较低，所以直接用来指示人的时候，只限于指示或介绍自己的家人或不下。当然，如果本人不在场或在远处听不到谈话的情况下，不在此例：あれは受付の戴さんですよ；これはうちの＊営業課の田中です； </p></li><li><p>～でしたね：用于表示确认、双方都知道的确认，单纯的询问用～ですか； 日本と中国の　＊時差は　1時間でしたね。－－　ええ、日本の　ほうが1時間早いです； ～でしたね可与副词たしか（確か）呼应使用：今日の会議はたしか3時からでしたね。－－ええ、そうです； 助词ね也可以单独用来表示确认，不过对于以前知道，但现在不太记得确切的事情进行确认的时候，要用でしたね； </p></li><li><p>＊大きな：第九课学习了大きい、小さい，大きな、小さな也表示同样的意思，但只能用来修饰名词，不能用来结尾，其他一类形容词没有这种要求； あそこにある　大きな　しろい　たてものは　何ですか； 小さなかばんが欲しいです； ＊このあたり：表示某一场所的周边，可接在この／その／あの／どの等连体词后面，还可以接在具体的场所名词后面，如：新宿のあたり（新宿一带）；　　　　  </p></li><li><p>この　あたりは　よく　＊渋滞します； 馬さんはどちらですか。－－＊エレベーターのあたりにいましたよ；</p></li></ol></div><div class="tab-item-content"><ol><li>これは　明日　会議で　使う　資料です； </li><li>私が　明日　乗る　飛行機は　中国航空です； </li><li>中国で　買ったCDを友達に貸しました； </li><li>操作が　簡単なパソコンが　欲しいです；</li></ol><p>A：李さん，この　人は　誰ですか。　――　その人は　中国で　とても　人気がある女優です。 </p><p>B：あの窓のところにいる人は　誰ですか。　――　あれは　受付（うけつけ，接待处）の戴さんですよ。 </p><p>C：何をしているんですか。　――昨日　李さんに　もらった　本を読んでいます。 </p><p>D： この会社で　歌が　いちばん上手な人は誰ですか。――　もりさんだと思います。</p></div><div class="tab-item-content"><p><strong>森：今日　泊まる（泊まります的简体形）ホテルは天安飯店でしたね。</strong></p><p><strong>李：ええ。１か月ぐらいホテルに泊まって（泊まります的て形）ください。ゆっくり住むところを探しましょう。</strong></p><p><strong>森：ずいぶん　まっすぐな　道路ですね。</strong></p><p><strong>馬：これは　空港と　北京市街を　結ぶ高速道路で，市街まで　だいたい30っぶんぐらいです。</strong></p><p><strong>森：あっ，これ，日本の歌ですね。</strong></p><p><strong>馬：はい，そうです。日本人の友達にもらったCDです。</strong></p><p><strong>森：日本の歌が　好きなんですか。</strong></p><p><strong>馬：ええ，大好きです。中国に　は　日本の歌が　好きな人が　たくさんいますよ。</strong></p><p><strong>森：あそこにある大きな白い建物は　何ですか。</strong></p><p><strong>李：あれは　最近できた　建物ですね。馬さん，知っていますか。</strong></p><p><strong>馬：ああ，あれは自動車の部品工場ですよ。</strong></p><p><strong>森：だいぶ車が　多くなりましたね。</strong></p><p><strong>馬：ええ。今走っている道路は三環路ですが，このあたりは　よく　渋滞します。</strong></p><p><strong>李：三環路は　北京でいちばんこうつうりょう（交通量）が多い道路ですからね。*</strong></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><p> 1.26 これは自転車に　二人で　乗るは　危ないです</p><details class="folding-tag" ><summary> 主要是简体小句 - 点击查看详情 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">文法</button><button type="button" class="tab">基本课文</button><button type="button" class="tab"><i class="fas fa-bomb"></i>应用课文</button></div><div class="tab-contents"><div class="tab-item-content active"><p>1.26.1 文法説明</p><ol><li><p><strong>「小句（动词简体形）」＋の　＋は　「形」です：动词小句后＋の使其名词化，表示做某动作的意思。这种名词化形式作主语，而谓语是表示性质或状态的一类或二类形容词时，主语要用助词“は”提示；</strong></p><p><strong>例如：自転車に二人でのるのは　危ないです；パソコンで表を作るのは　楽しいです；</strong></p><p><strong>＊第11课学习了好きです、嫌いです、上手です等表示好恶、能力的形容词，如果名词化之后的动词小句是这一类形容词的对象时，要用助词が来表示；</strong></p><p><strong>例如：李さんは　絵をかくのが　好きですね。――はい，＊色鉛筆でスケッチする　の　が　大好きです；　　　わたしは　自転車に乗る　のが　下手です。</strong></p><p><strong>＊注意：好きです等表示好恶能力的形容词的对象做话题使用时，要用助词は提示：絵をかくのは好きですか。――いいえ、絵をかくのは嫌いです。</strong></p></li><li><p><strong>「小句（动词简体形）」＋の／こと　＋を　「动」：动词小句的名词化形式，还可以用来做宾语：</strong></p><p><strong>手紙を出すのを　忘れました；　森さんが発現するのを　聞きました；　林さんは　掃除するのを　やめました；</strong></p><p><strong>李さんは　小野さんが　料理を作るのを　手伝います；</strong></p><p><strong>＊这种名词化形式做宾语时，の／こと可以互换：李さんは部長に報告するの（＝こと）を忘れました，但是如果句尾是知らせます、伝えます、話します等表示语言行为的动词时，要用こと而不能使用の：　李さんは森さんが休むこと（这里只可以用こと）を伝えました；</strong></p><p><strong>＊如果句尾的动词是見ます、聞きます等表示感知的动词，或手伝います、やめます、＊防ぎます等表示直接作用于对象的动词时，则要使用の而不能使用こと；</strong></p><p><strong>李さんは　森さんが　車から降りるの（Xこと）を　見ます；　李さんは　森さんが　荷物を運ぶの（Xこと）を　手伝いました；</strong></p></li><li><p><strong>「小句（简体）」でしょう　[推测]：表示说话人对听话人和自己都不能断定的事实进行推测，常与たぶん呼应使用，动词小句和一类形容词小句用简体形后续でしょう，二类形容词小句和名词小句把简体形的だ换成でしょう，～でしょう的简体形为～だろう。　　　　　　</strong></p><p><strong>例如：明日の朝は大雨になるでしょう；森さんは知らないでしょう；この本の値段(ねだん)は分かりませんが，たぶん高いでしょう；＊桜の季節ですから，京都はたぶんにぎやかでしょう；今年はたぶん＊ほうさく（豊作）だろう；これはたぶんだれかの＊忘れ物だろう；会議はもう終わっただろう；</strong></p></li><li><p><strong>「小句（简体形）」かもしれません：表示可能发生的事，一般概率为50%，动词小句和一类形容词小句用简体形后续かもしれません；二类形容词小句和名词小句则把简体形的だ换成かもしれません即可；</strong></p><p><strong>森さんは今日会社を休む　　かもしれません；あの二人は＊仲がいいですね。－－あの二人は結婚する　　かもしれませんね；＊クレジットカードを　落とした（おとします，丢掉，丢失）　かもしれません；来週は暇かもしれません；明日は雪かもしれません；</strong></p><p><strong>＊注意：～でしょう与～かもしれません相比，表示的概率更高；</strong></p><p><strong>*参考：因为概率一般为50%，所以可以在同一个动作的肯定形和否定形后面并列使用两个かもしれません；例如：明日は雨が降るかもしれませんが，降らないかもしれません；</strong></p><p>1.26.2　表現と言葉の説明</p></li><li><p><strong>もしかしたら：口语形式，用于可能性较低的场合，一般与～かもしれません、～ではありません等呼应使用：</strong></p><p><strong>例如：馬さんはまだ来ませんね。－－もしかしたら，今日は来ないかもしれませんよ；　　　</strong></p><p><strong>もしかしたら，大田さんではありませんか。－－ええ，そうですが..＊</strong></p></li><li><p><strong>それで：表示前面的句子为后面句子的原因、理由；</strong></p><p><strong>日本には＊握手(あくしゅ)の＊習慣がありません。それで，＊つい握手するのを忘れます。今日から＊光デパートは春節セールです。それで，朝から＊お客さんがたくさんいました。</strong></p><p><strong>应用课文当中，一对方叙述的事情为理由，说话人使用それで引出其导致的结果：日本には握手（あくしゅ）の習慣がないんですね；ーーええ，そうなんです。それで，つい握手するのを忘れます；今日から光デパートは新春セールなんですね。－－ああ，それで，朝からお客さんがたくさんんですね；だから也表示原因、理由，但是与それで相比，语气较强，且后面可以接续表示祈使或推测的句子，而それで不行；*すぐに会議が始まります。だから（这里不可以使用それで），急いでください；＊鈴木さんは仕事があります。だから，明日のパーティーにはこないでしょう；</strong></p></li><li><p><strong>つい：表示无意所为形成的某种后果，包含对意想不到的后果感到不快，后悔的语感：バーゲン会場では，つい何でも買いたくさんなります；</strong></p></li><li><p><strong>.　＊あいさつ回り：到了新单位或迁入新居后，去拜访有关单位或周围邻居的行为，本来是あいさつして回ります，现在为了方便，多用あいさつ回り这种名词形式，例如：あいさつ回りをします、あいさつ回りに行きます；</strong></p></li><li><p><strong>.　寒暄时的动作：与人初次见面或者与朋友，熟人见面时，中国人、欧美人一般是握手，日本人是一边说初めまして、こんにちは等，一边鞠躬。即便是好朋友，亲戚等关系较亲密的人之间，也不太有握手，拥抱等身体接触行为。</strong></p></li></ol></div><div class="tab-item-content"><ol><li><strong>自転車に二人で乗るのは　危ないです；</strong></li><li><strong>手紙を出すのを忘れました；</strong></li><li><strong>あしたの朝は　大雨になるでしょう；</strong></li><li><strong>森さんは今日会社を休むかもしれません；</strong></li></ol><p><strong>A：李さんは　絵をかくのが好きですね。――ええ，大好きです。でも，あまり上手ではありませんよ。</strong></p><p><strong>B：吉田さんが転勤したのを知っていますか。――えっ，本当ですか。知りませんでした。</strong></p><p><strong>C：会議は何時に終わりますか。――2時には終わるでしょう。</strong></p><p><strong>D：馬さんはまだ来ませんね。――もしかしたら，今日は来ないかもしれませんよ。</strong></p></div><div class="tab-item-content"><p><strong>楊：初めまして，楊です。森：初めまして，森です。よろしくお願いします。</strong></p><p><strong>陳：日本には握手の習慣がないんですね。　（ありません对应的其简体形为：ない）</strong></p><p><strong>森：ええ、そうなんです。それで，つい握手するのを忘れます。（する是三类动词し的基本形（简体形））</strong></p><p><strong>森：中国では握手するのが普通何ですか。</strong></p><p><strong>陳：ええ，そうですよ。日本にはお辞儀のほかのあいさつはないんですか。（ない是ある的否定形式）森：そうですね..　手をあげたり，握手したりする人もいますが，ほとんどお辞儀ですね。（し的简体形する）</strong></p><p><strong>戴：陳さん，森さんの午後の予定はあいさつ回りですね。</strong></p><p><strong>陳：ええ。今1時半ですから，これから四社ぐらい回ることができる（できます简体形）でしょう。</strong></p><p><strong>戴：そうですね。5社行くことができるかもしれませんよ。森さん，次は握手するのを忘れないでください。</strong></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><p> 1.27 子供のとき、大きな地震が　ありました</p><details class="folding-tag" ><summary> 还是简体小句 - 点击查看详情 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">文法</button><button type="button" class="tab"><i class="fas fa-bomb"></i>课文</button></div><div class="tab-contents"><div class="tab-item-content active"><p> 1.27.1 文法説明</p><ol><li><p><strong>「小句(简体形)」＋時：表示时间的名词短语分以下几种情况：</strong></p><p><strong>❶小句为动词小句时的情况：⑴　～する（基本形）＋時，表示后项动作实现时前项动作尚未完成；⑵　～した（た形）＋時，表示后项动作实现时，前项动作已经完成；</strong></p><p><strong>❷小句为一类形容词小句时，用其简体形直接后续時；</strong></p><p><strong>❸小句为二类形容词小句和名词小句时：⑴　二类形容词＋な＋時；⑵名词＋の＋時；</strong></p><p><strong>小句是一类形、二类形和名词小句时，前项是后项的动作进行的时间：</strong></p><p><strong>子供の時，大きなが　地震が　ありました；日本に行く時，たくさんお土産を　買いました；</strong></p><p><strong>日本に行った時，たくさんお土産を　買いました；忙しい　時，家族みんなで　仕事をします；　</strong></p><p><strong>暇な　時，私は考える　町で　買い物をします；</strong></p><p><strong>＊注意：只有名词做修饰语时，如子供の時，才在こども和時之间＋の，其他情况一律不能加の；</strong></p><p><strong>＊参考：表示一次性的、个别的情况时，也可以在～時后面加に，即～時に的形式：</strong></p><p><strong>例如：＊この前，友達が　病気の時に，わたしが＊看病しました；❌友達が病気の時に，いつも私が看病しました；</strong></p></li><li><p><strong>「动」ながら：表示同一主题同时进行两个动作，其中后面的动作为主要动作；接续方式为动词的第一连用形，即动词ます形去掉ます后＋ながら；</strong></p><p><strong>李さんはテレビを　　見ながら　食事をしています；その＊ことを　考えながら　　歩いていました；</strong></p></li><li><p><strong>「小句（简体形）」でしょう？　[确认]：表示～でしょう存在两种用法：</strong></p><p><strong>❶一种是确认对方比自己更为熟悉的事情，这种用法含有说话人请听话人告诉自己某种信息的语感，读升调；</strong></p><p><strong>❷另一种用于对方和自己意见呢不同，或者叮问对方时，这时でしょう读降调；</strong></p><p><strong>例如：李さん，明日パーティーに　行くでしょう？　　李さんは優しくて，親切でしょう？        　このお菓子まずいね。（这个点心真难吃）――えっ！まずい？おいしいでしょう。        　　　　　　　　　　　　　　　　　お母さん，わたしの＊日記，見たでしょう。</strong></p><p><strong>＊参考：～ね也用于向对方进行确认，但是～ね仅仅用于说话人认为自己和听话人双方意见一致的情况。而～でしょう则可用于对方和自己意见不一致时，所以如果用于确认对方的意见和自己的意见大体一致的事情时，会显得有些不礼貌，这种情况应该使用～ね。如在路上相逢，双方都觉得天气炎热：今日は暑いですね。</strong></p></li><li><p><strong>「动」ています：15課　16課分别学习了动词て形＋います，表示动作正在进行和动作的结果状态，这里再学习一个新的用法——表示反复或习惯性的动作：葉子さんはアルバイトをしながら学校に通っています；北京＊行きの飛行機は1時間に＊1便飛んでいます；在表示习惯性的动作时，动词＋ています可以用动词的ます形来代替：わたしは毎日散歩しています；わたしは毎日散歩します；</strong></p><p><strong>＊注意：表示习惯性动作时，～ています和～ます都可以使用，但是如果句子里使用先月から这类表示时间七点的形式，则一般要用ています，不能用～ます；</strong></p><p><strong>わたしは先月から毎晩太極拳をしています；×わたしは先月から毎晩太極拳します；</strong></p><p><strong>わたしは毎朝太極拳をします；＊表示正在从事的工作，可以用[表示职业的名词]＋を＋しています的形式：わたしは＊高校の＊教師をしています；</strong></p></li><li><p><strong>「名」で：表示原因，理由：仕事で，楊さんと会っていたんですよ。</strong></p></li><li><p><strong>「名」と会います：第8课学习了～に会います，其中的に表示对象的用法，而使用表示互动行为的动词时，进行同一动作的另一方要使用と来表示，如：結婚します、＊けんかします等表示互动行为的动词，只能用“と”、あいます可以用に，也可以用と，不过需要注意用と时，含有互动的语感；</strong></p><p><strong>仕事で，楊さんとあっていたんですよ；田中さんは佐藤さんと結婚しました；</strong></p><p><strong>＊参考：AはBと～中，A是主语；AとBとが～这一表述中，AB都是主语，其中B后面的と可以在实际表达中省略；</strong></p><p>1.27.2 表現と言葉の説明</p></li><li><p><strong>アルバイト：学生利用课外时间去工作的情况，汉语一般译为打工；</strong></p></li><li><p><strong>学校に通っています：“通います”表示定期往来于同一个场所，与 表示目的地的に一起使用，行きます也与表示目的地的に一起使用，但只表示从一个地方移动到另一个地方，没有通います包含的往返的意思；</strong></p><p><strong>例如：田中さんは毎日＊スポーツセンターに通っています；　　　</strong></p><p><strong>田中さんは時々　スポーツセンターに行きます；</strong></p></li><li><p><strong>＊おおぜい：表示人多，大勢の人（很多人），人が大勢います（有许多人），用于修饰名词、动词，一般不能用来做谓语，如“×人が大勢います”、“たくさん”也用来表示人多，但同时又可以用于人以外的事物，而大勢却只可以用来表示人：今朝，公園を散歩し時，大勢の人が集まっているのを見ました；教室に学校が大勢います；</strong></p></li><li><p><strong>＊お年寄り：年寄り（としより）前面加上表示敬语的お，是既有敬意又有亲切感的“老人”的说法，但是，お年寄り不能直接用来称呼对方，直接称呼时，使用*お爺さん、＊おばあさん；お年寄りが多ったでしょう？</strong></p></li><li><p><strong>*そう言えば：由正在进行的对话或说话现场的某种情况联想到另外一些情况时使用，应用课文中，小戴谈及公园而 回忆起小时候的事情，因此使用了そう言えば：そういえば，小さい時，よく祖母といっしょに公園へ行きました；そういえば，さっきから戴さんがいませんね；</strong></p></li><li><p><strong>＊へえ[叹词⑥]：表示对听来的信息感到惊讶或钦佩；</strong></p><p><strong>小さい時，よく祖母と　いっしょに公園へ行きました；――へえ，一緒に運動したんですか。</strong></p><p><strong>加藤さんの息子さんはえの展覧会で＊賞をもらったんですよ；――へえ，すごいですね；</strong></p></li><li><p><strong>公園　　[日本和中国的不同]：在日本，即使只有一般长椅，一个小游戏设施的小地方，只要人们可以在这里休息或散步的，都可以成为公园，一般不收费。</strong></p></li></ol></div><div class="tab-item-content"><p> 基本课文</p><ol><li><strong>子供のとき，大きな地震がありました；</strong></li><li><strong>映画を見るとき，いつも一番後ろの席に座ります；</strong></li><li><strong>李さんはテレビを見ながら食事をしています；</strong></li><li><strong>李さん，明日パーティーに行くでしょう？</strong></li></ol><p><strong>A：学生の時，何を勉強しましたか。－－日本の経済について勉強しました；</strong></p><p><strong>B：馬さん，暇な時，この書類を整理してください。－－はい，わかりました；</strong></p><p><strong>C：葉子さんはアルバイトをしながら学校に通っているんですよ。－－そうですか。なかなか大変ですね；</strong></p><p><strong>D:森さん，昨日，駅前の喫茶店にいたでしょう？－－はい，仕事で，楊さんと会っていたんです；</strong></p><p> 应用课文</p><p><strong>森：今朝，公園を散歩している時，大勢の人が集まっているのを見ました；</strong></p><p><strong>李：ああ，お年寄りが多かったでしょう？</strong></p><p><strong>森：ええ，太極拳やラジオ体操をしていました。</strong></p><p><strong>李：朝の運動ですよ。社交ダンスをしている人たちもいたでしょう？</strong></p><p><strong>森：ええ，いました。ほかに，踊りながら歌を歌っている人もいましたよ。</strong></p><p><strong>森：公園に入る時，入園料を払いました（はらいます）が，どの公園も有料ですか。</strong></p><p><strong>李：ええ。有料の公園が多いですね。</strong></p><p><strong>森：じゃあ，朝の運動をしているお年寄りたちも入園料を払う（はらいます的基本形）んですね。（ん＝の）</strong></p><p><strong>李：そうですよ。でも，毎日利用する（利用します　3类动词）人は割引があるんです。</strong></p><p><strong>戴：そう言えば，小さい時，よく祖母といっしょに公園へ行きました。</strong></p><p><strong>森：へえ，一緒に運動をしたんですか。</strong></p><p><strong>戴：いいえ。わたしは遊びながら祖母が太極拳をするのを見ました。（する是します简体形）</strong></p><p><strong>李：休みの時，わたしも公園でジョギングをしています。</strong></p><p><strong>戴：朝や夕方の涼しい時に　スポーツをするのは気持ちがいいですよね。（「小句（动词简体形）」＋の　＋は　「形」です）</strong></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><p> 1.28 馬さんは　わたしに　地図を　くれました</p><details class="folding-tag" ><summary> あげます　くれます　点击查看详情 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">文法</button><button type="button" class="tab"><i class="fas fa-bomb"></i>课文</button></div><div class="tab-contents"><div class="tab-item-content active"><p> 1.28.1文法説明</p><ol><li><p><strong>「名１[人]」　は「名２[人]」に　「名[物]」を　くれます：</strong></p><p><strong>第八课学习了“あげます”、“もらいます”，现在学习くれます，它表示给说话人或者说话人一方的人某物。</strong></p><p><strong>あげます、もらいます、くれます都译为“给”，但是表达的角度不同。</strong></p><p><strong>例如：小野さんは森さんにチョコレートをあげました。</strong></p><p><strong>如果把森さん换成わたし，那么あげます也相应的需要换成くれます；馬さんはわたしに地図をくれました；小野さん，この本を私にくれますか；昨日，馬さんが妹に旅行のお土産をくれました；</strong></p><p><strong>＊参考：日语中，一般采用以说话人作主语进行叙述的说法，因此与林さんが私に本をくれました相比，日语多用“わたしは林さんに本をもらいました”的说法；</strong></p></li><li><p><strong>「动」てあげます：第八课学习了あげます，表示说话人或者说话人一方的人给予别人物品的用法，其实动词て形＋あげます还用来表示说话人或者说话人一方为别人做某事的用法。别人用助词に来提示，不过需要注意的是，一般情况下别人这一部分不出现在句子里：</strong></p><p><strong>例如：森さんはお年寄りの荷物を持って　あげました；おじいさんが孫に本を読んで　あげました；</strong></p><p><strong>この本をあなたに　貸して　あげます；　Xこの本をわたしに貸して　あげます；</strong></p></li><li><p><strong>「动」て　もらいます：第八课学习了“もらいます”表示得到物品的用法，这里进一步学习表示说话人或说话人一方的人请别人做某事的用法 ——「动」て　　もらいます。</strong></p><p><strong>用法包括两种含义：❶说话人请别人做某事；  ❷说话人承受了由于别人的动作而带来的恩惠；</strong></p><p><strong>森さんは李さんに北京を案内して　もらいました；係りの人に　切符を　＊交換して　もらいました；林さん，もう少し　待って　もらいたいのですか。――わかりました。</strong></p><p><strong>别人用助词に来提示，不过需要注意的是，一般情况下别人这一部分不出现在句子里。</strong></p></li><li><p><strong>「动」てくれます：表示说话人以外的主语为说话人或说话人一方的人做某事；</strong></p><p><strong>女の人がわたしの財布を　拾って　くれました；友達がおもしろい本を　教えて　くれました；</strong></p><p><strong>如整个句子为疑问句形式，也可用于委托关系亲密的人为自己做事：ごみを　出して　くれますか。――いいですよ。委托别人帮自己做某事时，使用否定形式 てくれませんか会更加礼貌、客气。森君，この手紙をコピーしてくれませんか。</strong></p><p>1.28.2表現と言葉の説明</p></li><li><p><strong>～てあげます：正如前面语法解释讲过的那样，～てあげます表示说话人或说话人一方的人为别人做某事，不过因为这种形式含有恩赐与对方的意思，显得不太礼貌，因此不能面对面直接对尊长使用。</strong></p><p><strong>应用课文当中森和马时对等关系，所以可以说 あんなして　あげます；</strong></p><p><strong>❶对等关系时：李さん，わたしが持ってあげますよ。――どうもありがとう。对尊长说话时，用征求对方意见的形式：～ましょうか：</strong></p><p><strong>❷动作接受者时长辈或上级时：先生，わたしが　持ちましょうか。――どうもありがとう。</strong></p></li><li><p><strong>＊それに：用于前后句的内容为累加关系，多见于口语：陳さんに＊不動産屋さんを＊紹介てもらいました。それに，李さんや馬さんもいろいろと探してくれています；あのレストランの料理はとてもおいしいです。それに，店の＊雰囲気もとてもいいです；</strong></p></li><li><p><strong>～先（さき）：表示移动性动作的到达地点或归属。应用课文中的！引っ越し先表示搬迁迁入的地址：引っ越し先が決まったら，連絡してください；出張さきのホテルから電話がありました；</strong></p></li></ol><ol><li><p><strong>＊どの辺：询问大致的场所时，可以使用どの辺，回答时一般要像应用课文中的“国際貿易センターの近くです”那样 ，回答一个大致的场所，也可以只回答地名：引っ越し先がきまりました。――どの辺ですか。――新宿です。</strong></p><p><strong>第25课学习了表示周边的～あたり，～辺也表示同样的意思。不过，～辺必须和この／その／あの／どの等 词一起使用 ，如どの辺／その辺／あの辺。不能加在表示具体场所的名词后面。</strong></p><p><strong>駅のあたりには＊飲食店がたくさんあります。「X駅の辺」</strong></p></li><li><p><strong>＊家具はどうしたんですか：どうしたんですか可以用于不同的场面，表示多种意思，在本课应用课文中，表示询问某物的购入方式。</strong></p><p><strong>家具はどうしたんですか。――もう買いました。明日＊届けてもらいます。</strong></p><p><strong>そのチケット，どうしたんですか。――＊インターネットで買ったんです。</strong></p></li></ol></div><div class="tab-item-content"><p> 基本课文</p><ol><li><strong>馬さんはわたしに地図をくれました；</strong></li><li><strong>森さんはお年寄りの荷物を持ってあげました；</strong></li><li><strong>森さんは李さんに北京を案内してもらいました；</strong></li><li><strong>女の人がわたしの財布を拾ってくれました；</strong></li></ol><p><strong>A：すてきなマフラーですね。――ええ，小野さんが誕生日にくれたんです。</strong></p><p><strong>B：森さんは明日引っ越しですね。――ええ，みんなで手伝ってあげましょう。</strong></p><p><strong>C：この文章の意味が分からないんですが..　――戴さんに訳してもらいましょう。英語が得意ですから。</strong></p><p><strong>D：おいしいお茶を送ってくれて，どうもありがとう。――いいえ，どういたしまして。</strong></p><p> 应用课文</p><p><strong>加藤：森君，住むところはもう決まったの？</strong></p><p><strong>森：いいえ，まだなんです。さっき，陳さんに不動産屋さんを紹介して　もらいました。それに，李さんや馬さんもいろいろと探してくれています。</strong></p><p><strong>森：支社長，引っ越し先がきまりました。</strong></p><p><strong>加藤：それはよかった。どの辺？　</strong></p><p><strong>森：国際貿易センターの近くです。　</strong></p><p><strong>馬：国貿ですか。あの辺はよく知っています。　</strong></p><p><strong>森：そうなんですか。　</strong></p><p><strong>馬：ええ。今度近所を案内してあげますよ。　</strong></p><p><strong>森：ありがとうございます。　</strong></p><p><strong>戴：森さん，引っ越しは明日ですね。　</strong></p><p><strong>森：ええ。馬さんと李さんが手伝いに来てくれます。　</strong></p><p><strong>戴：家具はどうしたんですか。　</strong></p><p><strong>森：もう買いました。明日届けてもらいます。冷蔵庫は，支社長が　くれました。</strong></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details>              </div>            </details><h1 id="1-日本語の基礎入門"><a href="#1-日本語の基礎入門" class="headerlink" title="1.日本語の基礎入門"></a>1.日本語の基礎入門</h1><h2 id="初级上册-第六单元"><a href="#初级上册-第六单元" class="headerlink" title="初级上册-第六单元"></a>初级上册-第六单元</h2><details class="folding-tag" ><summary> 动词た形 - 敬体形 - 简体形 - したり点击查看详情 </summary>              <div class='content'>              <p> 1.21 わたしは　すき焼きを　食べた　ことが　あります</p><details class="folding-tag" ><summary> 动词た形 - 点击查看详情 </summary>              <div class='content'>              <p> 1.21.1　文法説明</p><ol><li><p>動詞的た形：て形的て换成た，で换成だ；</p><p>*き→いて；ぎ→いで；び、み、に→んで；ち、り、い→って;し→して；</p></li></ol>   <table>     <tr>       <th>类别</th>       <th colspan="2">ます形</th>       <th>→</th>       <th>て形</th>       <th>た形</th>     </tr>     <tr>       <td rowspan="9">一类动词</td>       <td>書きます</td>       <td>かきます</td>       <td>→</td>       <td>かいて</td>       <td>かいた</td>     </tr>     <tr>       <td>行きます</td>       <td>いきます</td>       <td>→</td>       <td>いって</td>       <td>いった</td>     </tr>     <tr>       <td>急ぎます</td>       <td>いそぎます</td>       <td>→</td>       <td>いそいで</td>       <td>いそいだ</td>     </tr>     <tr>       <td>飛びます</td>       <td>とびます</td>       <td>→</td>       <td>とんで</td>       <td>とんだ</td>     </tr>     <tr>       <td>読みます</td>       <td>よみます</td>       <td>→</td>       <td>よんで</td>       <td>よんだ</td>     </tr>     <tr>       <td>死にます</td>       <td>しにます</td>       <td>→</td>       <td>しんで</td>       <td>しんだ</td>     </tr>     <tr>       <td>待ちます</td>       <td>まちます</td>       <td>→</td>       <td>まって</td>       <td>まった</td>     </tr>     <tr>       <td>売ります</td>       <td>うります</td>       <td>→</td>       <td>うって</td>       <td>うった</td>     </tr>     <tr>       <td>買います</td>       <td>かいます</td>       <td>→</td>       <td>かって</td>       <td>かった</td>     </tr>     <tr>       <td rowspan="2">二类动词</td>       <td>食べます</td>       <td>たべます</td>       <td>→</td>       <td>たべて</td>       <td>たべた</td>     </tr>     <tr>       <td>見ます</td>       <td>みます</td>       <td>→</td>       <td>みて</td>       <td>みた</td>     </tr>     <tr>       <td rowspan="2">三类动词</td>       <td>来ます</td>       <td>きます</td>       <td>→</td>       <td>きて</td>       <td>きた</td>     </tr>     <tr>       <td>します</td>       <td>します</td>       <td>→</td>       <td>して</td>       <td>した</td>     </tr>   </table><ol><li><p>「動[た形]」ことが　あります：表示过去的经历，相当于汉语的曾经.. 过，通常用于半年之前发生的事，在叙述昨天等距离现在很近的经历时，不能使用；否定形式为 动词た形＋ことが　ありません； </p><p>私は　すきやきを　食べた　ことが　あります；　　</p><p>北京へ　行った　ことが　ありますか。 </p><p>－－いいえ、一度も　行った　ことが　ありません； </p><p>－－いいえ，ありません； </p></li><li><p>「動[た]」後で，～／「名」＋の＋後で：表示一个动作在另一个动作之后发生； </p><p>会社が　終わった　後で，飲みに　行きます。　映画を　見た　後で，食事を　しました。 </p><p>上一课学习的～前に：～前に前面的动词形式必须为基本形，～後で前面的动词形式必须是た形； </p></li><li><p>「動[た]」ほうが　いいです：在两种事物中进行选择，否定形式为动词ない形＋ほうが　いいです； </p><p>もっと　野菜を　食べた　ほうがいいですよ；*そんなに　慌てない　ほうがいいですよ； ホテルを　予約した　ほうがいいですか；</p></li><li><p>「動」ましょうか　[提议]：何か　食べましょうか。－－はい，お願いします。 </p><p>まどを　閉めましょうか。－－いいえ，閉めないで　ください；</p><p> 荷物を　持ちましょうか。－－はい，お願いします；</p><p>1.21.2　表現と言葉の説明</p></li><li><p>その　ほうが　いいです：动词的た形和ない形可以后续ほうが　いいです，互为肯否，名词也可以后续 ほうが　いいです，表示比较、选择的意思； </p><p>りんごと　ミカンと　どちらが　いですか。－－私はリンゴの　ほうが　いいです； 速いですから，飛行機の　ほうが　いいです； </p><p>ビールの　グラスは，これと　あれと　どちらいいですか； ーーこれの　ほうが　いいです； </p><p>デザインは，この　車と　あの　車と　ほうが　いいです； ーーあの　ほうが　いいです； </p><p>口语中谈到对方的事情时，可以用ほうが　いいです表示接受对方的建议：ホテルを　予約した　ほうが　いいですか；－－そうですね。連休したから，その　ほうが　いいですね； </p><p>すぐに　吉田さんに　連絡した　ほうがいいですね。すぐに　電話してください； </p></li><li><p>連休：连续的休假，成为连休； \</p></li><li><p>何度か：相当于汉语的几次的意思;类似的还有何人か、何冊，在表示不定数量时，日语中疑问词后面必须＋か；  仕事の　後で，何度か　見に行った　ことが　あります； </p></li><li><p>*9時過ぎ：表示时间或年龄的词语后面 ～過ぎ（すぎ）、表示超过了该范围；用来表示超出年龄时，直接数词＋過ぎ，不＋歳；　　　　　　　　　　　　</p><p>ゆうべ　10時過ぎに　*地震が　ありました； </p></li><li><p>その　*泥棒は　いくつぐらいでしたか。ーーそうですね。三十過ぎでした； </p></li><li><p>歌舞伎：</p></li></ol>              </div>            </details><p>1.22　森さん　毎晩　テレビを　見る　</p><details class="folding-tag" ><summary> 敬体形 - 简体形 点击查看详情 </summary>              <div class='content'>              <p> 1.22.1文法説明</p><ol><li>動詞的ます／ません／ました／ませんでした，都属于敬体形，基本形，ない形，た形，等都属于简体形；但是，一类形容词、二类形容词和名词本身是不区分敬体形和简体形的，只有在做谓语时才得以区分；</li><li>动词的简体形:</li></ol><table>  <tr>    <th rowspan="2">现在/将来时</th>    <th>肯定</th>    <td>買います</td>    <td>買う (基本形)</td>    <td>あります</td>    <td>ある</td>  </tr>  <tr>    <th>否定</th>    <td>買いません</td>    <td>買わない (ない形)</td>    <td>ありません</td>    <td>ない</td>  </tr>  <tr>    <th rowspan="2">过去</th>    <th>肯定</th>    <td>買いました</td>    <td>買った (た形)</td>    <td>ありました</td>    <td>あった</td>  </tr>  <tr>    <th>否定</th>    <td>買いませんでした</td>    <td>買わなかった (なかった形)</td>    <td>ありませんでした</td>    <td>なかった</td>  </tr></table><table >  <tr>    <th rowspan="2" colspan="2">时态</th>    <th colspan="2">动词「買う」</th>    <th colspan="2">动词「ある」</th>  </tr>  <tr>    <th>敬体</th>    <th>简体</th>    <th>敬体</th>    <th>简体</th>  </tr>  <tr>    <th rowspan="2">现在/将来时</th>    <th>肯定</th>    <td>買います</td>    <td>買う (基本形)</td>    <td>あります</td>    <td>ある</td>  </tr>  <tr>    <th>否定</th>    <td>買いません</td>    <td>買わない (ない形)</td>    <td>ありません</td>    <td>ない</td>  </tr>  <tr>    <th rowspan="2">过去</th>    <th>肯定</th>    <td>買いました</td>    <td>買った (た形)</td>    <td>ありました</td>    <td>あった</td>  </tr>  <tr>    <th>否定</th>    <td>買いませんでした</td>    <td>買わなかった (なかった形)</td>    <td>ありませんでした</td>    <td>なかった</td>  </tr></table><p>​    森さんは　毎晩　テレビ　を　見る；コーヒーを、飲む？　－－ううん、飲まない。</p><p>​    昨日　テレビ、見た？　－－ううん、見なかった。</p><p>3.一类形容词谓语形式的简体形： </p><table>  <tr>      <th></th>      <th></th>      <th>敬体</th>      <th>简体</th>  </tr>  <tr>      <td>现在将来</td>      <td>肯定</td>      <td>忙しいです</td>      <td>忙しい</td>  </tr>  <tr>      <td></td>      <td>否定</td>      <td>忙しく　ないです</td>      <td>忙しく　ない</td>  </tr>  <tr>      <td>过去</td>      <td>肯定</td>      <td>忙し　かったです</td>      <td>忙し　かったです</td>  </tr>  <tr>      <td></td>      <td>否定</td>      <td>忙しく　なかったです</td>      <td>忙しく　なかった</td>  </tr></table><p>​    *一类形容词的简体形：去です、不加だ；这里还应参照上册第九课,一类形容词做谓语时的过去式变形；</p><p>​    その　カレー，おいしい？　――ううん，*あんまり　おいしく　ないよ。 </p><p>​    昨日の　試験，どうだった？　――ちょっと　難しかった。</p><p>4.二类形容词谓语形式的简体形：</p><table>  <tr>      <th></th>      <th></th>      <th>敬体</th>      <th>简体</th>  </tr>  <tr>      <td>现在将来</td>      <td>肯定</td>      <td>簡単です</td>      <td>簡単だ</td>  </tr>  <tr>      <td></td>      <td>否定</td>      <td>簡単では　ありません</td>      <td>簡単では　ない</td>  </tr>  <tr>      <td>过去</td>      <td>肯定</td>      <td>簡単でした</td>      <td>簡単では　なかった</td>  </tr>  <tr>      <td></td>      <td>否定</td>      <td>簡単では　ありませんでした</td>      <td>簡単では　なかった</td>  </tr></table><p>この　ネクタイ，派手？――ううん，全然　派手じゃ　ないわ。</p><p> 森さんのアパート、静か？- うん、静かだよ。</p><ol><li><p>名词谓语形式的简体形：与二类形的规则完全一致，包括过去式变形，也完全一致；</p><pre><code> 今日は　曇だ；明日は　水曜日だね？――水曜日じゃないよ。木曜日だよ。 昨日，*スキー場は 雪だった？――ううん，雪じゃ　なかったよ。いい　天気だった。</code></pre></li><li><p>「小句」けど「小句」[转折][铺垫]：用于口语； 昨日の　試験，どうだった？――ちょっと　むずかったけど，まあまあ　できたよ。 来週，<em>送別会を　するけど，</em>都合は　どうかな？</p><p>1.22.2 表現と言葉の説明</p></li><li><p>简体会话：</p><p>❶敬体和简体：お母さん，あの　<em>おもちゃが　ほしい；　（孩子和母亲对话） 昨日　駅前で　大きい　</em>火事が　あった；（日记） *</p><p>❷简体疑问：简体表示疑问时，名词句、形容词句省略敬体形句尾的～ですか，句尾读升调； 动词句则要把动词敬体形变为简体形，并去掉表示疑问的助词か，句尾读升调，加上问号“？”； ――これ，日本製？ </p><p>❸うん和ううん：简体会话中，はい说成うん，いいえ说成ううん。 </p><p>❹简体助词：かな和の，只能跟在简体形后面： ①かな：自言自语，如有听话人在场，则表示通过让对方听到自己自问自答而让向对方提供一种不太确实的信息；今日　李さんは　来るかな？ ②の：用于要求说明或确认某事:ああ，<em>清水君，どうしたの?   寒いの？ ＊どうしたの的变化由来：词根：どう，怎样，如何→どうします、どうしましたか？→どうしする→どうしたの？ </em></p><p><em>❺～って①[传闻]：</em>太田，今度　中国へ　*転勤だって→简体形的転勤だ後＋って，表示传闻； </p><p>❻省略④　[简体句的省略]：简体句子中的一些音往往不发，例如：森さんの　電話番号，知ってる？省略了ている的い，電話番号を中的助词を也被省略； </p></li><li><p>わ／よ：基本课文中的全然　派手じゃないわ中的わ，主要是女性使用，男性一般词尾用よ；近年来，这种区分越来越模糊，女性也逐渐使用よ； 例如：この　<em>携帯，とても　便利よ；あそこが　わたしの　うち（です）よ； わ／よ都可以跟在简体形或敬体形的后面：あのう，すみません。この　靴，ちょっと　大きいですわ； </em>「名１」が　「名２」です / 「名２」は　「名１」です; <em>叙述直接观察到的事物时,使用　[名1]が　「動詞」的形式，新信息做主语； </em>何、だれ、どこ、いつ等疑问词做主语时，只能用＋が的形式，因为这些词只能表示新信息； </p></li><li><p>电话号码的读法：一字，逐字读，可在局号和个人号码之间＋の；電話番号は　3493-3945です；</p></li></ol><p>4.*～方：动词ます形去掉ます后加上方，表示～的做法，例如：話します→話し方；</p><div class="table-container"><table><thead><tr><th style="text-align:center">ます</th><th style="text-align:center">del ます</th><th style="text-align:center">～方　做法</th></tr></thead><tbody><tr><td style="text-align:center">話します</td><td style="text-align:center">話し</td><td style="text-align:center">話し方</td></tr><tr><td style="text-align:center">読みます</td><td style="text-align:center">読み</td><td style="text-align:center">読み方</td></tr><tr><td style="text-align:center">作ります</td><td style="text-align:center">作り</td><td style="text-align:center">作り方</td></tr><tr><td style="text-align:center">やります</td><td style="text-align:center">やり</td><td style="text-align:center">やり方</td></tr><tr><td style="text-align:center">使います</td><td style="text-align:center">使い</td><td style="text-align:center">使い方</td></tr></tbody></table></div>              </div>            </details><p>1.23　休みの日　散歩したり　買い物に行ったり　します</p><details class="folding-tag" ><summary> たり 点击查看详情 </summary>              <div class='content'>              <p> 1.23.1　文法説明</p><ol><li><p>「動」たり　「動」たり　します：用于列举若干有代表性的动作，只需将动词た形变为たり； </p><p>小野さんは　　休みの日，散歩したり　買い物に　行ったり　します； 吉田さんは　日曜日には　何を　しますか。――家の　掃除を　したり　洗濯を　したり　します； </p></li><li><p>「一类形」かったり　「一类形」かったりです： </p><p>「二类形」だったり　「二类形」だったりです： </p><p>「名」だったり　「名」だったりです： </p><p>​    以上用法用于表示状况有多种可能，将一类形容词、二类形容词&amp;名词的过去简体形的～かった、～だった重的た，变为たり；形容词出现的情况，一般互为反义词，例如： </p><p>飛行機の　チケットは　高かったり　安かったりです；</p><p> マンションの　部屋は　広かったり　狭かったりです； </p><p>この　公園は　時間に　よって　静かだったり　にぎやかだったりです； </p><p>日本語の　先生は　中国人だったり　日本人だったりです； </p></li><li><p>「小句」＋　か：表示不确定的内容； </p><p><strong>（１）「小句」＋　か　どうか：将不包含疑问词的疑问句作为一个长句中的从句 ，将动词、一类形容词的敬体形变为简体形，并在后面加上“か　どうか”；</strong> </p><p>（私は）今年の　夏，北京へ　行きますか。＋　私は　分かりません； </p><p>→ 私は　今年の夏，北京へ　行くか　どうか　分かりません； </p><p>小野さんに　仕事が　終わったか　どうか　聞いて　ください； </p><p>另外，也可以重复使用动词的基本形和ない形：私は　今年の夏，北京へ　行くか　行かないか　分かりません；私は　この　料理が　辛いか　辛くないか　知りません； </p><p>如果～か　どうか前面为名词或二类 形容词，则在名词或二类形容词后面直接后续 ～か　どうか,无需按照简体形的变化规则——在名词或二类形容词后面＋だ； </p><p>キムさんは　中国人ですか。＋　私は　知りません。 </p><p>→ 私は　キムさんが　中国人か　どうか　知りません； </p><p>→ 私は　キムさんが　中国人か　中国人では　ないか　知りません；</p><p> ⑵　「疑问词小句」＋　か：将包含何、だれ、どこ的疑问句作为一个长句中的一部分使用时，需要将疑问词小句的动词、一类形的敬体形变为简体形，然后＋か； </p><p>かぎが　どこに　あるか　　教えて　ください；　</p><p>昨日　何を　食べたか　忘れました； どの　料理が　辛いか　知りません； </p><p>か前面如果是名词或二类形容词，直接＋か，而无需按照基本形的固定变形后续＋だ；</p><p>1.23.2　表現と言葉の説明</p></li><li><p>～によって：相当于汉语的“根据…”，也可以　*～に　よります的形式用于句尾； </p><p>飛行機の　チケットは　季節に　よって　高かったり　安かったりです； </p><p>結婚式の　やり方は　国に　よって　*違います； </p><p>この　電車は　いつも　*こみますか。－－いえ，時間に　よります； </p><p> . 高かったり　安かったり，いろいろ　あります：一类形、二类形及名词后续たり时，句尾并不总是要后续です、如应用课文中所    出的那样，后面还可以跟其他形式； </p><p>浴衣は　高かったり　安かったり，いろいろ　あります； この　店の　料理は　<em>味が　</em>濃かったり　*薄かったり，毎回　違います； </p><p><em>通勤は　電車だったり　車だったり，日に　よって　違います； </em></p></li><li><p>あっ，そうだ：突然想到某事的表达，相当于汉语当中的“啊，对了”“啊，想起来了”； あの，そうだ。*生地を，買って　作りますよ；あの　人の　名前は…　ええと，あっ，そうだ，田中さんですよ； </p></li><li><p>浴衣（ゆかた）：</p></li></ol>              </div>            </details><p>1.24　李さんは　もうすぐ　来ると　思います</p><details class="folding-tag" ><summary> 思います - 点击查看详情 </summary>              <div class='content'>              <p> 1.24.1文法説明</p><ol><li><p>[小句（简体形）]と　思います：表示说话人的思考内容时，在句子后面增加：と　思います； </p><p>例如：李さんは　もう　すぐ　くる　と　思います；　田中さんは　来ない　と　思います； </p><p>この　本は　おもしろい　と　思います；明日は　いい天気だ　と　思います； </p></li><li><p>「名（1人）」は　「小句简体形」と言いました； </p><p>向第三者转述他人所说的话时，在所说的话后面＋　と　言いました： 陳さんは　パーティーに　行く　と　言いました；森さんは　中国語の　試験は　むずかった　と　言いました； </p><p>有一种情况，需要明确指出是向谁说出的话，需要在句子中加入“名词＋に”，例如： 小野さんは　李さんに　ちょっと　休みたい　と　言いました； </p><p>如果转述某人反复说起的事情，用“～と　言って　います”表示， 例如：来週の　＊パイキングに　張さんも　いきたい　と　言って　います </p></li><li><p>～のです／んです：</p><p> ⑴　～のです／んです：表示所谈论的内容与前句或前项内容有关联，用于说明状况，解释原因、理由。“～のです”常用于书面语，“んです”多用于口语，前面接简体形，名词和二类形容词的现在将来时态的肯定型，“だ”要换成“な”； </p><p>例如：すみません，頭が　痛いんです； タバコは　＊やめた　ほうがいいですよ； ――そうなんですが，止める　ことが　できないんです； </p><p>＊すごい　人気ですね； ――ええ，あの　歌手は　日本では　とても　有名なんです； </p><p>これ，京都の　お土産なんです。どうぞ。 </p><p>(2)どうして　～のですか    ／んですか：11課学习了用于询问理由的“どうしてですか”，其实，更加完整的形式是“どうして　～のですか／んですか”。回答时也要使用这种形式，例如：</p><p> どうして　食べないんですか。――もう　おなかが　いっぱいなんです。 </p><p>昨日，どうして　休んだんですか。――頭が　痛かったんです。 どうして　遅刻したんですか。――＊寝坊したんです。 </p></li><li><p>「小句」が，「小句」[铺垫]：16课，学习了“が”表示转折的用法，此外“が”可以用来提示接下来要说的内容，这种用法成为铺垫，与22课学习的“けど”相比，“が”较多用于书面语，例如： </p><p>東京タワーへ　行きたいんですが，どうやって　行きますか；（我想去东京塔，怎么走好呢？） </p><p>李さんを　探して　いるんですが，どこに　いますか；（我在找小李，她在哪儿？） </p><p>明日から　連休ですが，どうするか　決めましたか？（明天开始就是长假了，你想好了怎么过吗？） </p><p>明日から　連休だけど　どうするか　決めた（きまります）？（明天开始就是长假了，你想好了怎么过吗？）</p><p>1.24.2表現と言葉の説明</p></li><li><p>～と　思います：一般用于向别人陈述自己的想法，日本人即便自己很确定某个观点，但在向别人陈述时，也尽量避免使用绝对性的说法，因而通常在句子后加上“～　と　思います”以缓和语气，例如： </p><p>今日は　＊外出しない　ほうが　いい　と　思います； この　色の　ほうが　似合う　と　思います； </p></li><li><p>どうやって～　[询问方法]： </p><p>どうやって由疑问词“どう”与动词“やる”的て形，即“やって”结合而成；</p><p> “どうして”也是由疑问词“どう”和动词“する”的て形，即“して”结合而成； </p><p>一般来说，询问方法是使用“どうやって”，询问理由时使用“どうして”；</p><p> 東京タワーへ　行きたいんですが，どうやって　行きますか； </p><p>どうして　食べないんですか。 </p></li><li><p>～に　ついて：相当于汉语当中的“关于～”，一般后续“考えます（思考）”“思います；”“＊研究します”等表示思维活动的词语。用做标题时，如“日本の　音楽に　ついて（关于日本音乐）”，一般省略后面的动词； </p><p>例如：日本の　音楽に　ついて　どう　思いますか；（关于日本音乐，你怎么看？） </p></li><li><p>*とうとう：副词，相当于汉语当中的“终于”“结局”“到底”等，表示不论结果好坏，想到的事态经过一定的阶段终于实现了。例如：とうとう　＊お別れですね。（终于要分别了。）息子が　とうとう　大学を　卒業しました。 </p></li><li><p>分别的寒暄 [寒暄语⑥]：</p><p>⑴　＊お世話に　なりました：受到别人的照顾和帮助，分手时所说的表示感谢的话； </p><p>ありがとうございました。本当に　お世話になりました；</p><p>根据实际情况，今后将要得到别人的帮助或指导时，用“お世話になります”， 初めまして，李です。これから　お世話になります。 </p><p>(2)～に　＊よろしく　お伝え　ください：请向～问好。“よろしく　お伝え　ください。”是“よろしく　　伝えて　ください。”的敬语形式，如果需要进一步加重语气，则可在前面加上“どうぞ”，成为“どうぞ　よろしく　お伝え　ください。” 例如：どうぞ　吉田課長に　よろしく　お伝え　ください。 李さんに　よろしく。 </p><p>(3)“＊お元気で”／“＊お気をつけて”：“お元気で（请多保重）”一般用于时间较长的分离，意为祝愿对方身体健康，对方必须是身体健康状况良好的人。与此相反，第15课学习过的“お大事に（请多保重）”则只用于对生病的人或受伤的人使用。“おきを　つけて（小心）”用于一般性的分别，意为祝愿对方路途平安、顺利。例如：李さん，お元気で｡;   李さん，どうぞ おきを つけて｡ </p></li><li><p>*出張中：表示某个动作正在进行，用“～中”，发音为“ちゅう”。一类、二类动词后续“～中”时，用ます形去掉ます的形式。三类动词后续“中”时，用去掉“します”的形式。三类动词“来ます”不能后续“中”。</p><p>另外，也并不是所有的一类、二类动词都可以后续“中”：課長は　出張中ですが，李さんに　よろしくと　言って　いましたよ； 森さんに　何度も　電話を　掛けましたが，話し中でした。</p></li></ol>              </div>            </details>              </div>            </details><h2 id="初级上册-第五单元"><a href="#初级上册-第五单元" class="headerlink" title="初级上册-第五单元"></a>初级上册-第五单元</h2><details class="folding-tag" ><summary> 欲しい - なります - ない - 基本形 点击查看详情 </summary>              <div class='content'>              <p> 1.17 わたしは　新しい　洋服が　欲しいです</p><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p> 1.17.1　文法説明</p><ol><li>「名」が　欲しいです：表示愿望时：「名詞1」は　「名詞２」が　欲しいです； （あなたは）　何が　欲しいですか；――新しい　パソコンが　欲しいです； </li><li>「名詞」を　「動詞」たいです：相当于汉语“想～”的意思，“たいです”前面接动词去ます结尾后的形式； 以上这两种句式，陈述句时，第一人称为主语，疑问句时，则第二人称“あなた”为主语，两种情况可通过句子的前后关系判断出来，因此常常省略。 （私は）映画を　みたいです；今日は　お酒を　飲みたくないです； （あなたは）何を　したいですか。　――　何もしたくありません； </li><li>「動詞」ませんか：动词的否定形式“～ません”加上表示疑问的“か”，表面上是一种疑问形式，但是语法功能是表示提议,例如：いっしょに　お茶を　飲みませんか；少し　休みませんか； </li><li>「動詞」ましょう：动词的ます结尾换成“ましょう”，表示提议，ちょっと　休みましょ； <em>そろそろ　行きましょう； いっしょに　お茶を　飲みましょう； “ましょう”的礼貌程度，不如“～ませんか”更高； </em></li><li><em>疑问词＋でも：表示在任何情况下，事态都都相同，例如：いつでも　電話を　して　ください； 李さん，何を　食べたいですか。――何でも　いいです；だれでも　分かります；</em></li><li><p>ね②　[缓和语气]：除了第四课的ね表示确认以外，ね也有舒缓自己心情或想法并传达给对方的用法，例如：“<em>まず　</em>恋人が　欲しいですね”、“まじめで　優しい　人が　いいですね”就属于这种用法；  日本料理で　何が　いちばん　好きですか。――そうですね。やっぱり　お寿司ですね；</p><p>1.17.2  表現と言葉の説明</p></li><li><p>ほしです　和 飲みませんか　[愿望，希望和邀请]：这种直接询问他人愿望的表达方式，对长辈或上级使用时，会显得不太礼貌，对长辈或上级，或不太熟悉的人，一般使用“どうですか”或“～ませんか”；デパートへ　買い物に　行きます。李さんも　いっしょに　どうですか。 ――はい，いきたいです； </p></li><li><p>*今年中に：10课学习了表示整个范围的场所、时间的～中に的用法； ～中に表示该期间结束之前的意思，一般接在表示未来某一特定时间的词后，如“今日、明日、今週、来週、今年”等后面；</p><p>其中“今日、明日、今年”后续～中に时，读“～じゅうに”； “～週、～月（がつ／げつ）”后续～中に时，读“～ちゅうに”； 今年中に（～じゅうに）　結婚したい　です；来週中に（～ちゅうに）もう　一度　連絡します；</p></li><li><p>ぜひ：一定，必定，后续“～たい”、“～てください”、“～ましょう”时，是表达强烈愿望或意志的提议形式；<em>お汁粉？　ぜひ　食べたいです；</em>今度　ぜひ　家へ　来てください； </p></li><li><p>お汁粉：年糕小豆汤； </p></li><li><p>*初詣：新年第一次参拜，祈祷许愿。</p></li></ol>              </div>            </details><p> 1.18携帯電話は　とても　小さく　なりました</p><details class="folding-tag" ><summary> 状态变化 - 涉及形容词、名词，动词 点击查看详情 </summary>              <div class='content'>              <p> 1.18.1　文法説明</p><p>1.「一类形」くなります：一类形容词通常表示静止的状态，但是可以使用一类形容词＋なります的形式来表示性质或状态的变化，其构成方式是把一类形容词的词尾“い”变为“く”＋なります；</p><div class="table-container"><table><thead><tr><th style="text-align:right">一类形</th><th style="text-align:center"></th><th style="text-align:left"></th></tr></thead><tbody><tr><td style="text-align:right">暖かい</td><td style="text-align:center"><strong>→</strong></td><td style="text-align:left">暖かくなります</td></tr><tr><td style="text-align:right">小さい</td><td style="text-align:center"><strong>→</strong></td><td style="text-align:left">小さくなります</td></tr><tr><td style="text-align:right">安い（やすい）</td><td style="text-align:center"><strong>→</strong></td><td style="text-align:left">安くなります</td></tr></tbody></table></div><p>だんだん　暖か　く　なります；　携帯電話は　ちいさく　なりました；</p><p>2.「二类形」／「名」　に　なります：示性质或状态的变化；</p><div class="table-container"><table><thead><tr><th style="text-align:center">二类形、名词</th><th style="text-align:center"></th><th>～に　なります</th></tr></thead><tbody><tr><td style="text-align:center">元気</td><td style="text-align:center"><strong>→</strong></td><td>元気に　なります</td></tr><tr><td style="text-align:center">医者</td><td style="text-align:center"><strong>→</strong></td><td>医者に　なります</td></tr></tbody></table></div><p>もう　元気に　なります；　息子は　医者に　なります；　来年　*社会人に　なります；</p><p>3.「一类形」 します：用于因主语的意志性动作、作用而引起的事物状态发生变化的情形；</p><div class="table-container"><table><thead><tr><th style="text-align:center">一类形</th><th style="text-align:center"></th><th>～く　します</th></tr></thead><tbody><tr><td style="text-align:center">大きい</td><td style="text-align:center"><strong>→</strong></td><td>大きくします</td></tr><tr><td style="text-align:center">冷たい</td><td style="text-align:center"><strong>→</strong></td><td>冷たくします</td></tr></tbody></table></div><p><strong>テレビの　音を　大きく　なります；　ジュースを　冷たく　なります；</strong></p><p>4.「二类形」／「名」　に　します：因主语的意志作用而引起的事物状态发生变化的情形；</p><div class="table-container"><table><thead><tr><th style="text-align:center">二类形</th><th style="text-align:center"></th><th>～に　します</th></tr></thead><tbody><tr><td style="text-align:center">きれい</td><td style="text-align:center"><strong>→</strong></td><td>きれいに　します</td></tr><tr><td style="text-align:center">きんえん</td><td style="text-align:center"><strong>→</strong></td><td>禁煙に　します</td></tr></tbody></table></div><p>へやを　きれいに　して　ください；　会議室を　禁煙に　します； </p><p>餐厅点餐时，可使用 ～に　します，例如：カリーに　します；コーヒーに　します； </p><p>这是把自己决定的事情告诉对方的一种方式；</p><p>5.「一类形／二类形＋な」ほうが　いいです：比较事物，认为其中一个较好，表示自己的选择，或向别人提议； 旅行の　荷物は　軽い　ほうが　いいです；　　子供は　元気な　ほうが　いいです； 部屋は　広い　ほうが　いいです；　　　公園は　静かな　ほうが　いいです；</p><ol><li>自动词和他动词：自动词，是不带宾语的动词，表示不考虑外力影响的情况下，主语自主进行的动作，或自然发生的变化，其主语用が提示；他动词：主语作用于宾语而使其发生变化； 窓　が　<em>開きました；　　　　　　　　　</em>タイムサービス　が　始まります； （私は）窓を　開きました；　　　　（デパートが）　タイムサービスを　始まります； します是他动词， なります是自动词；</li></ol><p>を： 1. 「名詞」を　「動詞」：动作的对象用助词“を”表示，读作“お”； </p><p>2.「名詞」を　ください：请… 可以用于花钱购物，也可以用于不花钱的索取； </p><p>3.「名詞[人]」は「名詞[人]」に　「名詞[物]」を　あげます：相当于汉语的“给”，例如：わたしは　小野さんに　お土産を　あげます。小野さんは　森さんに　チョコレート　を　あげました；</p><p>4.電話／*フアックス／メールを　まらいました：表示收到通信的表达方式；</p><p>5.*おねがいします　[请求①]：请求对方做某事时，用「名詞＋（を）　お願いします」； </p><p>6.「名[场所]」を　「動詞」「经过」、[离开]：经过的场合用を来表示，常用的动词有 ：通ります、渡ります、過ぎます。を和动词でます、卒業します等搭配使用时，表示离开的场所；</p><p>7.お金を　*下ろします：下ろします，意思是将上面的东西取下来，お金を　下ろします的意思是取钱，属于固定搭配用法。 </p><p>8.「名詞」を　「動詞」たいです：相当于汉语“想～”的意思，“たいです”前面接动词去ます结尾后的形式；</p><p> 1.18.2表現と言葉の説明</p><p>こえ（声）和（おと）音：日语中人和动物发出的声音为声，物体发出的声音为音； 子供の　声が　うるさいですね；　テレビの　音を　大きく　します； ＊まとめて：把若干个汇总在一起，在日语中称作まとめます，如：まとめて買います； <em>お正月は　洋服が　安く　なりますから，まとめて　買います； 3.　</em>3割引き：さんわりびき；此外可以用百分比的说法，如85折，用百分比表示为15％（15パーセント引き），也读作15パーセント； 4.　<em>似合います：自动词，相当于汉语当中的相称，合适；以人或物做话题时，分别这样使用： 「人」は　「物」が　似合います；　　「物」は　「人」に　似合います； （李さんは）ほうが　いいですね。よく　似合います；　この　</em>シャツは　父に　似合いません； 5. <em>間もなく 和 </em>もう　すぐ　：两者都表示一会，不久的意思，但間もなく更为郑重，可用于し书面语，而 もうすぐ多用于口语； 間もなく　タイムサービス　<em>時間です；　もうすぐ　6時に　なります； 6. </em>さらに和まっと：两者都是更加的意思，さらに语气较为郑重。例如：間もなく　タイムサービスの　時間です。さらに　お安くします；今から　7時まで　まっと　安く　なります； 7. <em>さあ：向对方提出建议或促使对方做某事，只用于口语： 今から　七時にまで　もっと　安くなります。さあ，行きましょう； さあ，今から　試験を　始めますよ。</em>準備は　いいですか。 8.　*新春セール：</p>              </div>            </details><p> 1.19 部屋の　かぎを　　忘れないで　ください</p><details class="folding-tag" ><summary> 动词的ない形 - 点击查看详情 </summary>              <div class='content'>              <p> 1.19.1文法説明</p><p>1.动词的ない形，变化方式如下： </p><p>​    一类动词：ます形动词去掉ます后的最后一个音变成相应的“あ”段音后，＋ない／わない；</p><p>​    二类动词：ます形去掉ます后＋ない；</p><p>​    三类动词：来（き）ます　→　来（こ）ます，　します　→ しない；</p><table>  <tr>    <th>类别</th>    <th>ます形</th>    <th>あ段</th>    <th>ない形</th>  </tr>  <tr>    <td rowspan="9">一类动词</td>    <td>書きます</td>    <td>かきます</td>    <td>かかない</td>  </tr>  <tr>    <td>急ぎます</td>    <td>いそぎます</td>    <td>いそがない</td>  </tr>  <tr>    <td>飛びます</td>    <td>とびます</td>    <td>とばない</td>  </tr>  <tr>    <td>読みます</td>    <td>よみます</td>    <td>よまない</td>  </tr>  <tr>    <td>死にます</td>    <td>しにます</td>    <td>しなない</td>  </tr>  <tr>    <td>待ちます</td>    <td>まちます</td>    <td>またない</td>  </tr>  <tr>    <td>売ります</td>    <td>うります</td>    <td>うらない</td>  </tr>  <tr>    <td>買います</td>    <td>かいます</td>    <td>かわない</td>  </tr>  <tr>    <td>話します</td>    <td>はなします</td>    <td>はなさない</td>  </tr>  <tr>    <td rowspan="2">二类动词</td>    <td>食べます</td>    <td>たべます</td>    <td>食べない</td>  </tr>  <tr>    <td>見ます</td>    <td>みます</td>    <td>みない</td>  </tr>  <tr>    <td rowspan="2">三类动词</td>    <td>来ます</td>    <td>きます</td>    <td>こない</td>  </tr>  <tr>    <td>します</td>    <td>します</td>    <td>しない</td>  </tr></table><ol><li>「動」ないで　ください：表示否定命令；部屋の　かぎを　忘れないで　ください； この部屋には*入らないで　ください；無理を　しないで　ください； </li><li>「動」なければ　なりません：表示必须，可以用ないと　いけません代替； 李さんは　今日　早く　帰ら　なければ　なりません；　この　薬は　毎日飲まなければ　なりません；　すぐに　書類を　送ら　ないと　いけえません； </li><li>「動」　なくても　いいです：表示不做某事也可以，相当于前面なければなりません的否定，接续方法是将动词ない形中的ない换成なくてもいいです； 明日は　残業し　なくてもいいです；　<em>慌て　なくてもいいです；　靴を　</em>脱がなくてもいいです； </li><li><p>「名１」が　「名２」です / 「名２」は　「名１」です; <em>叙述直接观察到的事物时,使用　[名1]が　「動詞」的形式，新信息做主语； </em>何、だれ、どこ、いつ等疑问词做主语时，只能用＋が的形式，因为这些词只能表示新信息；</p><p>1.19.2　表現と言葉の説明</p></li><li><p>なければなりません　和 ～ないと　いけません：前者比后者较为正式，多用于书面语，后者多用于口语，也可以省略为～ないと；　子供は　6歳から　学校へ　行かないと　なりません； あっ，8時ですね。もう　えきへ　いかないと； </p></li><li><em>初心者（しょしんしゃ）、</em>上級者（じょうきゅうしゃ）； 森さん，<em>英会話の　勉強は　どうですか。――</em>やっと　先月　*上級クラスに　入りました； </li><li>何度も：何＋量词＋も＋肯定形式，是表示数量多的说法；而四课语法解释5，何＋も＋动词的否定，表示完全没有／一点也没有；第十三课语法解释1，何＋量词 用于对数量的提问； 何度も　<em>転びましたが，とても　おもしろいです； </em>のどが　*渇きましたから、水を　何杯も　飲みました； </li><li>*だいぶ[表示程度的副词④]：表示程度相当高，用于～なりました等表示变化的句型中时，突出变化的程度；  昨日は　だいぶ　お酒を　飲みました；　　　風邪は　よく　なりましたか； ――だいぶ　よく　なりました； </li><li>大丈夫です：与汉语意思不同，日语中大丈夫表示没问题的意思； 上級者の　<em>コースには　入らないで　ください；――大丈夫です。</em>心配しないで　ください； </li><li>残業 *</li><li>スキー</li></ol>              </div>            </details><ol><li>スミスさんは　ピアノを　弾く　ことが　できます</li></ol><details class="folding-tag" ><summary> 动词的基本形-点击查看详情 </summary>              <div class='content'>              <p> 1.20.1 文法説明</p><ol><li><p>动词的基本形：动词ます形去掉ます的形式和基本形的关系如下：</p><p>一类动词：去掉ます后的发音为い段，基本形最后的发音在う段；</p><p>二类动词：去掉ます后＋る；</p><p>三类动词：基本形分别为来る和する；</p></li></ol><table border="1">  <tr>    <th>类别</th>    <th>ます形</th>    <th>去掉ます</th>    <th>あ段</th>    <th>基本型</th>  </tr>  <tr>    <td rowspan="9">一类动词</td>    <td>書きます</td>    <td>かき</td>    <td>→</td>    <td>書く (かく)</td>  </tr>  <tr>    <td>急ぎます</td>    <td>いそぎ</td>    <td>→</td>    <td>急ぐ (いそぐ)</td>  </tr>  <tr>    <td>飛びます</td>    <td>とび</td>    <td>→</td>    <td>飛ぶ (とぶ)</td>  </tr>  <tr>    <td>読みます</td>    <td>よみ</td>    <td>→</td>    <td>読む (よむ)</td>  </tr>  <tr>    <td>死にます</td>    <td>しに</td>    <td>→</td>    <td>死ぬ (しぬ)</td>  </tr>  <tr>    <td>待ちます</td>    <td>まち</td>    <td>→</td>    <td>待つ (まつ)</td>  </tr>  <tr>    <td>売ります</td>    <td>うり</td>    <td>→</td>    <td>売る (うる)</td>  </tr>  <tr>    <td>買います</td>    <td>かい</td>    <td>→</td>    <td>買う (かう)</td>  </tr>  <tr>    <td>話します</td>    <td>はなし</td>    <td>→</td>    <td>話す (はなす)</td>  </tr>  <tr>    <td rowspan="2">二类动词</td>    <td>食べます</td>    <td>たべ</td>    <td>→</td>    <td>食べる (たべる)</td>  </tr>  <tr>    <td>見ます</td>    <td>み</td>    <td>→</td>    <td>見る (みる)</td>  </tr>  <tr>    <td rowspan="2">三类动词</td>    <td>来ます</td>    <td>き</td>    <td>→</td>    <td>来る (くる)</td>  </tr>  <tr>    <td>します</td>    <td>し</td>    <td>→</td>    <td>する (する)</td>  </tr></table>              </div>            </details>              </div>            </details><h2 id="初级上册-第四单元"><a href="#初级上册-第四单元" class="headerlink" title="初级上册-第四单元"></a>初级上册-第四单元</h2><details class="folding-tag" ><summary> 动词、形容词/名词的て形 点击查看详情 </summary>              <div class='content'>              <p>1.13机の上に　本が　あります</p><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p> 1.13.1文法説明</p><ol><li>「名[数量]」　＋　「動詞」：数量词在前，量词因所修饰的事物种类不同而不同； 例如：たまごを　<em>１こ　たべます；　本を　２冊　買いました；　緑茶を　</em>3杯　飲みました；</li></ol><div class="table-container"><table><thead><tr><th style="text-align:center">量词</th><th style="text-align:center">使用对象</th><th style="text-align:center">量词</th><th style="text-align:center">使用对象</th></tr></thead><tbody><tr><td style="text-align:center">～本（ほん）</td><td style="text-align:center">细长的物品</td><td style="text-align:center">~人</td><td style="text-align:center">人</td></tr><tr><td style="text-align:center">～杯（はい）</td><td style="text-align:center">容器内的饮料</td><td style="text-align:center">～台（だい）</td><td style="text-align:center">机械或车辆，电脑</td></tr><tr><td style="text-align:center">～匹（ひき）</td><td style="text-align:center">小动物，猫，狗，鱼，等</td><td style="text-align:center">～枚（まい）</td><td style="text-align:center">薄、平的东西</td></tr><tr><td style="text-align:center">～頭（とう）</td><td style="text-align:center">大动物，牛马，等</td><td style="text-align:center">～冊（さつ）</td><td style="text-align:center">书，笔记本</td></tr><tr><td style="text-align:center">～羽（は）</td><td style="text-align:center">鸟，兔</td><td style="text-align:center">～歳（さい）</td><td style="text-align:center">年龄</td></tr><tr><td style="text-align:center">～番（ばん）</td><td style="text-align:center">顺序</td><td style="text-align:center">～回（さい）</td><td style="text-align:center">次数</td></tr><tr><td style="text-align:center">～足（そく）</td><td style="text-align:center">成对的东西，鞋，袜子</td><td style="text-align:center">～着（ちゃく）</td><td style="text-align:center">衣服等</td></tr><tr><td style="text-align:center">～つ</td><td style="text-align:center">1-9岁的年龄; 立体、抽象的<br>事物, 选项, 等</td><td style="text-align:center">～個（こ）</td><td style="text-align:center">立体的东西；空容器或器皿；<br>抽象的，如密码；</td></tr></tbody></table></div><p>   【注意】：询问数量时，在“何”+ 量词，如：何こ、何本、何冊，何读作なん；</p><ol><li>「名[時間]」＋　[動詞]：表示时间数量的词语和动词一起使用，说明动作、状态的持续时间，此种情况下，表示时间数量的词语后不能　＋“に”； 如：李さんは　毎日　７時間　働きます；森さんは　九時間　寝ます；*昼　1時間　休みます； </li><li>「名[时间]」に　「名[次数]」＋「動詞」：表示一定时间内进行若干次动作时，使用这个句型； 李さんは　1週間に　二回　プールへ　行きます；　この　花は　二年に　<em>1度　</em>咲きます；</li><li>动词的ます形：目前学习的动词均为ます形动词，去掉ます结尾以后的形式，在后面的各种句型中会经常使用，需要特别注意；</li><li>「名[场所]」へ　「動詞」に　いきます／来ます：表示移动的行为目的时，使用动词ます形去掉ます后的形式，例如：午後　郵便局へ　荷物を　出しに　行きます；</li><li><p>「名[数量]」＋　で：用于不称重量的，按个售卖的东西，例如：この　ケーキは　3個で　五百円です；不过需要特别注意，数量是1的时候，不加で，例如：この　ケーキは　1個　二百円です；</p><p>1.13.2表現と言葉の説明</p></li><li><p>数的数法：（１）数词和量词：日语中数的数法又两种：一种是依据汉字发音的数法，即：いち、に、さん、し、ご　…；另一种是日本数法，即ひ、ふ、み、よ、いつ、む、や、ここ、とお；数词和量词的读法，由于组合不同会发生一些变化。</p><p>​     ～台、～枚、～番等，属于读法不发生变化的类型； </p><p>​    ～個、～階、～回等量词，与数字1，6，8，10结合时，数字读音 发生促音变； </p><p>​    ～本、～杯、～匹等量词，与数字1，3，6，8，10结合时，数字和量词的读音都会发生改变；</p></li></ol><div class="table-container"><table><thead><tr><th style="text-align:right"></th><th style="text-align:right">日本語</th><th style="text-align:left">の方</th><th style="text-align:center">台、枚、番</th><th style="text-align:center">個､回､階</th><th style="text-align:center">本、杯、匹</th></tr></thead><tbody><tr><td style="text-align:right"></td><td style="text-align:right">～つ</td><td style="text-align:left">～人</td><td style="text-align:center">台</td><td style="text-align:center">～個</td><td style="text-align:center">~本</td></tr><tr><td style="text-align:right">1</td><td style="text-align:right">ひとつ</td><td style="text-align:left">ひとり</td><td style="text-align:center">いちだい</td><td style="text-align:center">いっこ</td><td style="text-align:center">いっほん</td></tr><tr><td style="text-align:right">2</td><td style="text-align:right">ふたつ</td><td style="text-align:left">ふたり</td><td style="text-align:center">にだい</td><td style="text-align:center">にこ</td><td style="text-align:center">にほん</td></tr><tr><td style="text-align:right">3</td><td style="text-align:right">みっつ</td><td style="text-align:left">さんにん</td><td style="text-align:center">さんだい</td><td style="text-align:center">さんこ</td><td style="text-align:center">さんばん</td></tr><tr><td style="text-align:right">4</td><td style="text-align:right">よっつ</td><td style="text-align:left">よにん</td><td style="text-align:center">よんだい</td><td style="text-align:center">よんこ</td><td style="text-align:center">よんほん</td></tr><tr><td style="text-align:right">5</td><td style="text-align:right">いつつ</td><td style="text-align:left">ごにん</td><td style="text-align:center">ごだい</td><td style="text-align:center">ごこ</td><td style="text-align:center">ごほん</td></tr><tr><td style="text-align:right">6</td><td style="text-align:right">むっつ</td><td style="text-align:left">ろくにん</td><td style="text-align:center">ろくだい</td><td style="text-align:center">ろっこ</td><td style="text-align:center">ろっぽん</td></tr><tr><td style="text-align:right">7</td><td style="text-align:right">ななつ</td><td style="text-align:left">ななにん</td><td style="text-align:center">ななだい</td><td style="text-align:center">ななこ</td><td style="text-align:center">ななほん</td></tr><tr><td style="text-align:right">8</td><td style="text-align:right">やっつ</td><td style="text-align:left">はちにん</td><td style="text-align:center">はちだい</td><td style="text-align:center">はっこ</td><td style="text-align:center">はっぽん</td></tr><tr><td style="text-align:right">9</td><td style="text-align:right">ここのつ</td><td style="text-align:left">きゅうにん</td><td style="text-align:center">きゅうだい</td><td style="text-align:center">きゅうこ</td><td style="text-align:center">きゅうほん</td></tr><tr><td style="text-align:right">10</td><td style="text-align:right">とお</td><td style="text-align:left">じゅうにん</td><td style="text-align:center">じゅうだい</td><td style="text-align:center">じゅっこ</td><td style="text-align:center">じゅうほん</td></tr><tr><td style="text-align:right">何</td><td style="text-align:right">いくつ</td><td style="text-align:left">なんにん</td><td style="text-align:center">なんだい</td><td style="text-align:center">なんこ</td><td style="text-align:center">なんぼい</td></tr></tbody></table></div><p><strong><em>7人也 可以读作しちにん；\</em>上表只是部分搭配表；</strong></p><p>​    （2）週に　２回：週に2回，其完整表达是“1週間に　2回”，像这样以一定期间为基准表述频率时，可省略数字1和間，而使用“週に　～回”的形式。同样的，１にちに成为日に，１か月に成为月に，1年に成为年に；例如：日に　二十本ぐらい　　<em>タバコを　　</em>吸います。 </p><p>​    (3) *生ビールを　３つ：最近，常有省区量词，而直接使用ひとつ，ふたつ，或使用1個、2個..的方式计数的情况；</p><ol><li>くらい／ぐらい：数量词后面加上くらい或ぐらい，表示大概的数量，意思相同，有时还与副词*だいたい连用。询问时使用“どのぐらい”或“どれぐらい”； 例如：ここから　駅まで　＊1キロメートルくらいです； この　パソコンは　いくらでしたか。――だいたい　２０万円ぐらいです； </li><li>どのぐらい　かかりますか：用于时间和金钱，相当于汉语的“需要，花费”； 例如：家から　会社まで　どのぐらい　かかりますか。――電車で　1時間ぐらい　かかります； </li><li>飲みに　行きます：不指明喝什么时，就是喝酒，跟汉语差不多； </li><li>*とりあえず：先… / 从具有可能性的几种动作或选项中，暂且先选择其中一种，暗示其他动作说事项等一下还会进行，常用在饭店点菜时；</li></ol>              </div>            </details><p> 1.14 昨日　デパートへ　行って、買い物しました</p><details class="folding-tag" ><summary> 动词的て形 - 点击查看详情 </summary>              <div class='content'>              <p> 1.14.1文法説明</p><ol><li><p>动词的て形：上一课学习了动词的ます形，现在学习て形，这是动词形式当中最为复杂，同时也最为基础的一种变形，需要反复记忆和联系； 动词，因其形态变化方式不同，可以分为三类： 一类动词：动词的ます形去掉ます后的最后一个音位于い段的动词，绝大部分属于一类动词； 二类动词：最后一个音位于え段的动词，以及少部分位于い段的动词（初级阶段约15个）； 三类动词：きます、します和以します结尾的，属于三类动词； 一类动词的て形变换方式为，去掉ます后＋て，产生相应的音变，规律如下： き——いて；　ぎ——いで；　“び、み、に”——んで；　“う、ち、り”——って；　し——して； 二类动词和三类动词的て形，都是ます形去掉ます之后，直接　＋　て； </p></li><li><p>「動詞」て　「動詞」　[相继发生①]：表示两个以上的动作相继发生时的用法，例如：昨日　でぱーとへ　行って　買い物しました；家へ　帰って，宿題を　します； </p></li><li><p>「動詞」てから　「動詞」[相继发生②]：语义和「動詞」て形 ＋「動詞但要注意的是，てから不能再一个人句子中反复使用两次以上，例如：李さんは　毎晩　ラジオを　聞いてから　寝ます； </p></li><li><p>「動詞」て　ください：请求某人做某事：ここに　住所と　名前を　書いて　ください； </p></li><li><p>「名[场所]」を　「動詞」「经过」、[离开]：经过的场合用を来表示，常用的动词有 ：通ります、渡ります、過ぎます。を和动词でます、卒業します等搭配使用时，表示离开的场所； </p><p>このバスは　駅前を　通ります；この　<em>道を　まっすぐ　行って，</em>橋を　渡って　ください； 李さんは　毎朝　七時に　家を　でます；　わたしは　来年　大学を　卒業します；</p><p>1.14.2表現と言葉の説明</p></li><li><p>句子的连接方式：～て是连接相继发生①②动作的形式，但是连接多了会让人难以理解，所以一般之链接两项或者三项。需要连接更多时，可使用それから； 図書館へ　行って，勉強を　します。それから　家へ　帰って，手紙を　書きます； </p></li><li><p>買い物します[三类动词]：します前接汉字词或外来词，可以构成新的三类动词；</p><p>|     汉字词 |            |            |           外来词 |        |<br>| ————-: | ————— | ————— | ———————-: | ——— |<br>| 出張します | しゅっちょ | 仕事します | ジョギングします | 慢跑   |<br>| 旅行します | りょこ     | 掃除します | プレゼントします | 送礼物 |<br>| 食事します | しょくじ   | 散歩します | フアックスします | 发传真 |<br>| 料理します | りょうり   | 整理します |     コピーします | 复印   |</p><p><em>这种类型的动词,也可以说就是名词＋を＋します的形式；*</em></p></li><li><p>駅前：指车站周边的整个区域，如需明确表示车站前，要用駅の前； このバスは　駅前を　通りますか；　昨日　駅の前で　森さんに　会いました； </p></li><li><p>*なかなか① [表示程度的副词②]：后续 肯定表达时，表示从说话者自己的判断标准来看，程度属于上乘，比说话者预想的程度要高，含有评价对方的含义，因此注意对上级或长辈不可以使用； </p></li><li><p>～て　くださいませんか[请求②]:是 ～て　ください的更为礼貌的形式； </p></li><li><p>もう②：前面第八课学过的副词もう①，是已经的意思。这一课的もう②是马上、就要的意思因此，句尾使用现在将来时，例如：李さん，もう　会社を　出ますか。 </p></li><li><p>*すみませんが，～[搭话③]：すみません本意为对不起，＋せんが，～ 用来表示不好意思，麻烦你； </p></li><li><p><em>そうして　ください：指示物品的代词“これ／それ／あれ”，指示状态，动作时，需要使用“こう／＊そう／</em>ああ”（这样，那样）；例如，应用课文中的，そうして　ください；</p></li><li><p>お金を　*下ろします：下ろします，意思是将上面的东西取下来，お金を　下ろします的意思是取钱，属于固定搭配用法。</p></li></ol>              </div>            </details><p>1.15小野さんは　今　新聞を　読んでいます</p><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p> 1.15.1文法説明</p><ol><li><p>「動詞」て　います [正在进行]：表示动作或变化正在进行；如标题； </p></li><li><p>「動詞」ても　いいです：表示许可；相当于汉语的“可以”； </p></li><li><p>「動詞」ては　いけません：表示禁止；例如，教室で　物を　食べては　いけません。 </p></li><li><p>「名[附着点]」に　「動詞」：人，或物体，停留在椅子或交通工具上时，附着点用“に”表示；</p></li><li><p>「名[目的地]」に　「動詞」：除第六课的表示移动行为目的的助词“へ”以外，也可用“に”来表示，例如：李さんは　病院　に　いきます；李さんは　家に　帰りました； </p><p>*总结：目前为止に的用法有： </p><ol><li>表示存在的场所，公園に　*ベンチが　あります； </li><li>表示时间，例如5時に　帰ります； </li><li>表示所要见的对象，友達に　会います； </li><li>表示移动的行为目的,本を　買いに　行きます； </li><li>表示附着点，車に　乗ります； 这些用法不能与へ通用，只有表示 行きます、来ます、帰ります等典型的移动动词的目的时，に和へ才可以通用；</li></ol><p>1.15.2表現と言葉の説明</p></li><li><p>请求许可时的回答方式：</p><p>（1）肯定：对“～ても　いいですか”进行肯定回答时，如果根据自己的心情或判断表示许可，可以回答“どうぞ”、“かまいません”；如果不是根据 自己的判断，而是基于社会惯例或公共准则进行回答时，可以说いいです、*大丈夫です； </p><p>（2）否定：对“～ても　いいですか”进行否定回答时，如依据自己的心情或喜好做出回答，可以说“いえ，それは　ちょっと…（不行，这个有点..）”，或者使用“すみません、から..（对不起，因为…）”；而如果是根据社会准则或相关法律做出回答，可以回答：“いけません”、“*だめます”； </p></li><li><p>ボートに　乗ります：坐船，划船的意思； </p></li><li><p>*もちろんです：是应用课文中“もちろん　やすんでも　いいです”的省略形式； </p></li><li><p><em>無理を　しては　いけませんよ：由“無理を　します”转换而成； </em></p></li><li><p>*ゆっくり：表示动作速度慢，此外还可以用来表示“好好地”，例如：じゃあ，病院へ　行ってから，ゆっくり　休んで　ください； </p></li><li><p>薬を　出します：意思是医生给患者开处方； </p></li><li><p>*お大事に　[寒暄语⑤]：用于对生病或受伤的人表示关心，是“どうぞ　おだいじに　して　ください”的省略盛世，不能对身体健康的人使用；</p></li></ol>              </div>            </details><p>1.16 ホテルの　部屋は　広くて　明るいです</p><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p> 1.16.1文法説明</p><ol><li>「一类形」て　「一类形」[并列①]：一类形容词的并列，是将词尾い变为くて； 明るい　→ あかるい　→ 明るくて；　新しい　→ あたらしい　→ 新しくて； この　リンゴは　大きくて，甘くて，おいしいです； </li><li>「二类形」で　「二类形」[并列②]：二类形容词的并列，使用二类形容词的て形； 簡単→かんたん→簡単で；　親切→しんせつ→親切で；　にぎやか→にぎやかで； この　コンピュータの　操作は　簡単で　便利です；　森さんは　親切で　*優しいです； </li><li>「名１」で　「名２」[并列③]：跟二类形容词一样，中间　＋　で； この　<em>機械は　</em>にっちゅ電気の　<em>製品で，</em>中国製です； </li><li>「動詞」て　います　②　[结果状态①]：上一课学习了「動詞」て　います [正在进行]，除此以外，还可以用来表述结果状态；例如：森さんは　車を　持って　います；　わたしは　北京に　住んで　います；　　田中さん　を　*知って　いますか。</li><li>「小句」が，「小句」[转折]：相当于汉语当中的“但是，可是”：三か月　パソコンを　勉強しましたが，まだ　あまり　できません；この　リストランは　おいしいですが，ちょっと　高いです； </li><li>まだ＋「動詞（否定）」：表示没有达到所询问的内容的程度，相当于汉语的“还没有”； 何年ぐらい　日本語を　勉強しましたか；二年　勉強しました。でも、まだ　あまり　できません； 此外，对用もう提问的句子做否定回答时，使用 まだ～て　いません的形式； 小野さんは　もう　*結婚して　いますか。いいえ，まだ　結婚して　いません；</li></ol><p> 1.16.2表現と言葉の説明</p><p>1.日语中描写相貌身材时，身体部位名词与相应的形容词组合用法如下：</p><div class="table-container"><table><thead><tr><th style="text-align:right">身体部位</th><th style="text-align:right">形容词</th><th></th></tr></thead><tbody><tr><td style="text-align:right">脚 / 指 / 指头</td><td style="text-align:right">長い / 太い（ふとい、粗，胖）</td><td>短い  /  細い（ほそい）</td></tr><tr><td style="text-align:right">足 / 脚</td><td style="text-align:right">大きい</td><td>小さい</td></tr><tr><td style="text-align:right">目</td><td style="text-align:right">大きい</td><td>小さい</td></tr><tr><td style="text-align:right">鼻</td><td style="text-align:right">高い</td><td>低い（ひくい）</td></tr><tr><td style="text-align:right">顔</td><td style="text-align:right">大きい</td><td>小さい</td></tr><tr><td style="text-align:right">背 / 个子</td><td style="text-align:right">高い</td><td>ひくい</td></tr></tbody></table></div><p>2.　*入場料：汉语主要使用～费来表示各种费用，日语根据前接词的不同，有几种说法：</p><div class="table-container"><table><thead><tr><th style="text-align:center"><strong>*～費</strong></th><th><strong>会費；光熱費：照明,供热,供暖费；交通費；食費：伙食费</strong></th></tr></thead><tbody><tr><td style="text-align:center"><strong>*～料</strong></td><td><strong>入場料：门票；使用料：使用费；送料：运费；手数料：手续费</strong></td></tr><tr><td style="text-align:center"><strong>*～代</strong></td><td><strong>電気代：电费；水道代：水费；タクシー代：出租车费；食事代：餐费；</strong></td></tr></tbody></table></div><ol><li>外来词②　[外来词和英语字母]：使用英语单词首字母组合的缩略词不断增加，如：ID，IT； </li><li>IDカードは　ありますか：至此，分别学习了あります／います可以用来: ①表述事物存在；②在某处发生某事； ③本文中，则表示所有:私は車が　2台　あります；森さんは　弟　が　2人　います； </li><li>*ちゃんと：副词，表示没错，或处于正常状态，只用于口语；</li><li>*ほら：你看，瞧！ </li><li>*ずいぶん　[表示程度的副词③]：表示程度很高，内容上无论好坏； </li><li>*派手：花哨；反义词：地味：朴素，质朴；</li><li>嫌いじゃ　ありますん：表示不喜欢也并不讨厌，形式虽是否定的，但是语义上是肯定的；</li></ol>              </div>            </details>              </div>            </details><h2 id="初级上册-第三单元"><a href="#初级上册-第三单元" class="headerlink" title="初级上册-第三单元"></a>初级上册-第三单元</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p> 1.12李さんは　森さんより　若いですね</p><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p> 1.12.1文法説明</p><ol><li><p>「名１」は　「名２」より　　一类形/二类形  です：名1比名2更… </p></li><li><p>「名2」は　「名1」の　ほうが　一类形/二类形  です：名2比名1更..</p></li><li><p>「名１」は　「名２」ほど　一类形くないです／二类形　では　ありません； 名1程度上不及名2，注意句尾必须使用否定形式； </p></li><li><p>「名１」の　中で　「名２」が　いちばん　一类形/二类形  です： 表示在某名词1范围内，名词2最具有该形容词的性质； </p></li><li><p>「名１」と　「名２」と　どちらが　　一类形/二类形  ですか： 询问两种事物中，哪一种更…  どちら是二选一时使用的疑问词，在口语中有时说成どっち，回答时用：～の　ほんが，如果两者程度相当，使用どちらも　…　です。询问范围为两种事物时，无论询问的是人还是时间，都可以使用どちらが，三种以上时不可以 用； </p></li><li><p>どの「名」／いつ／どれ／だれ／何が　いちばん　一类形/二类形　ですか： 询问三个以上的事物当中，哪一个更具该形容词特性时使用，根据对象不同，需要区别集中以疑问词，どの　～　が　、　どれが　或　何が　用来对物提问，だれが提问人，时间则用 いつが； </p><p>被选择的事物见于上下文或眼前时，使用　どの　～が　　或 どれが　，否则用何が。</p><p>1.12.2表現と言葉の説明</p></li><li><p>＊最近：近来一段时间，与汉语不同，日语当中的最近不能用于表示将来的时间； </p></li><li>～が　いいです：いい 相当于汉语的好，根据上下文也可表述多种意思，例如： 箱根の　お土産は　なにが　いいですか。――寄木細工が　いいです。 </li><li>＊やっぱり：比やはり更为随意的说法，谈，例如：やっぱり　あめが　ふりましたね；</li><li>～が…　[话说到一半时]：例如，安納、そこは　わたしの　*席ですが…</li></ol>              </div>            </details><p> 1.11小野さんは　歌が　好きです</p><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p> 1.11.1文法説明</p><ol><li><p>「名詞」は　「名詞」が　「形容词」です：好きです、嫌いです、怖いです等表达情感好恶的形容词可以使用这种句式； </p></li><li><p>「名詞」は　「名詞」が　わかります／できます：分かります、できます、上手です、下手です、<em>苦手です等有关能力的词，也可以使用这种句式，包括动词； </em></p></li><li><p>*「名詞」や　「名詞」：　连接词，作用相当于“と”，区别在于“や”用于只列出多个项目中的两项的情形，“と”可以列举多项； </p></li><li><p>“～から”和“*だから” [原因、理由]：～から接在表示原因、理由的句尾；だから是表示原因、理由的连接词，更为礼貌的说法是ですから；から构成表示原因、理由小句的一部分，放在小句句尾，而だから独立使用在结果句子的前面；</p></li><li><p>表示频率的副词：其中，あまり、全然因频率实在太低，后面需要接否定形式；</p><p>| いつも | よく | 時々 | たまに | <code>あまり</code> | <code>全然</code> |<br>| :——: | :—: | :—: | :——: | :———: | :——: |<br>| 100％  | 70％ | 50％ |  20％  |   10％   |  0％   |</p></li><li><p>どうしてですか：询问事由时使用，相当于汉语的“为什么”。回答时在谓语后面加“から”。</p><p>1.11.2表現と言葉の説明</p></li><li><p>ばく：谈话中，男性对关系比较亲密的人自称时使用的第一人称代词，女性不可以用；</p></li><li>ホテルで　写真展が　あります：NO.４学习了「场所」に　「物」が　あります。这里将「物」替换成为摄影展、联欢会、会议等表示事件的名词，表示在某处发生某事，发生的场所用助词“で”表示，例如：来週，金曜日の　よる　七時から，ほてるで　パーていーが　あります。</li><li>いかがですか：No.10学习了“どうですか”，意思为征求对方的意见或想法，也用于向对方提出某种建议或推荐某物的场合，“いかがですか”就是比“どうですか”更为礼貌表的说法，对长辈或上级使用。向对方提出建议或向对方推荐某物时，与其直接说“これが　いいですよ（这个很好阿）”，不如用“～は　どうですか／いかがですか（…怎么样？）”，这样更委婉，没有强加给别人的感觉； 此外，拒绝对方的建议或推荐是，直接使用“いいえ”显得很不礼貌，其他较委婉的表达方式，例如：今は　結構です。或　さっき　飲みましたから。　等等。</li><li>そうですね　②：NO.7学习了“そうですね”表示同意对方提议的用法，其实“そうですね”还可以用在疑问句后面，表示说话人在思考接下来要说的内容，“そうですね”前面＋“うーん”，也用于表示思考怎么回答，例如：日本の　食べ物は　どうですか。――うーん，そうですね，とても　おいしいです。でも，ちょっと　高いです。</li><li>*迷います：犹豫，用于难以立即做出选择的场合，例如：たくさん　料理が　ありますね。何を　食べますか。――うーん，迷いますね；</li><li>*気に　入りました：相当于汉语的“喜欢”，但不表示自己的原有爱好，仅用于第一次见到某事物而感到中意，对象用“が”提示。“気に　入りました”仅在朋友或熟人之间使用，对长辈不能使用；例如：気に　入りましたか。――はい、とても。　　この　赤い　かばんが　気に　いりましたから，これを　買います；</li><li>省略③：　[避免重复谓语的回答方式]：北京ダックは　おいしですね。――ええ、とても。</li></ol>              </div>            </details><p> 1.10京都の　红叶は　有名です</p><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p> 1.10.1文法説明</p><ol><li><p>「名詞」は　「二类形」 です／でした：不以“い”结尾的形容词为二类形容词，做谓语时词尾＋です，过去式是でした； </p></li><li><p>「名詞」は　「二类形」では　ありません　／　では　ありませんでした：口语中，“では”一般说成“じゃ”； </p></li><li><p>「名詞」は　「二类形」な　「名詞」です：二类形容词形容修饰名词时 ＋　な； 例如：ならは　静か　な　町です。ならは　にぎやか　な　町では　ありません； </p></li><li><p>「名詞」でした：名词做谓语时的过去形式， 其否定形式是：“「名詞」＋では（じゃ）ありませんでした”； </p></li><li><p>どんな　「名詞」：询问人或事物的性质时，用“どんな＋名詞”， 例如：横浜は　どんな　町ですか。――とても　にぎやかな　まちです。 張さんは　どんな　人ですか。――親切な　人です。 注意：何の　由询问内容和材料的两种用法，而どんな只用于询问性质； </p></li><li><p>どうですか：询问对方对某状态的意见或感想，过去式为　どうでしたか。另外，どうですか有时还用于劝诱对方进行某动作； </p></li><li><p>“でも”和“そして”：でも（但是）表示转折关系，そして（而且）表示并列关系； </p></li><li><p>常见的二类形容词： </p><p>| 好き | 嫌い | 賑やか（にぎやか、繁华,热闹） | 静か（しずか） |<br>| :—: | :—: | :—————————————-: | :——————: |<br>| 便利 | 不便 |        綺麗（きれい）         |   暇（ひま）   |<br>| 元気 | 簡単 |             親切              |      有名      |</p></li></ol>              </div>            </details><p> 1.9四川料理は　辛い　です</p><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p> 1.9.1文法説明</p><ol><li><p>「名詞」は「一类形」です：以“い”结尾的形容词为一类形容词，做谓语时后面＋です；</p></li><li><p>「一类形」做谓语时的否定形式：将词尾的“い”变成“く”＋“ないです”或“ありません”； 需要特别注意：いいです的否定形式是“よく　ないです”或“よく　ありません”； </p></li><li><p>3.「一类形」做谓语时的过去形式：将词尾的“い”变为“かった＋です”，否定形式则变为“く　なかったです”或“く　ありませんでした”。 需要特别注意：“いいです”的过去形式为：“よかったです”，过去否定形式为：“よく　ありませんでした”。 </p></li><li><p>4.「一类形」＋　「名詞」：可以直接修饰名词； </p></li><li><p>“を”→“は”：コーヒーを　飲みます　当中，を前面的名词做话题或进行比较时，使用助词は，即コーヒーは　飲みます／コーヒーは　飲みませんか。 </p></li><li><p>あまり「一类形／動詞（否定）」：表示程度不高，例如：この　スープは　あまり　熱くないです。試験は　あまり　難しくないです／難しくありませんでした； </p></li><li><p>表示程度的副词 ①： “あまり”“全然”要与否定形式 呼应； とても／大変（たいへん）　＞　少し／ちょっと　＞　あまり～ません　＞　全然～ません 很，非常                      一点                 不太             根本不 </p></li><li><p>常见的一类形容词： </p><p>新しい　　　　　　古い　　　　　　　　熱い　　　　　　　つめい </p><p>高い　　　　　　　低い　　　　　　　　暑い　　　　　　　　寒い </p><p>貴い　　　　　　　安い　　　　　　　　おおい　　　　　　少ない </p><p>難しい　　　　　*易しい　　　　　　　広い　　　　　　　　狭い </p><p>大きい　　　　　小さい　　　　　　　　遠い　　　　　　　　近い </p><p>いい　　　　　　悪い　　　　　　　　楽しい　　　　　　つまらない</p><p>1.9.2表現と言葉の説明</p></li><li><p>“多い”和“少ない”：不同于其他一类形容词，不能单独修饰名词，；例：“*たくさんの～ </p></li><li>子供用：相当于汉语～用的意思，例如：女性用、お客様用（来宾用）、ワイン用の　<em>クラス； </em></li><li>あら「叹词③」：女性在感到惊讶或不解时使用的词语，由あれ变化而来。 </li><li>熱く　ないですか　[否定疑问句]：对于这种疑问句，回答时“はい”和“いいえ”都可以使用； 例如：熱　くない　ですか。ーー　はい、ないです。／いいえ、熱くない　です; </li><li>*ああ　[叹词④]：对对方提问或建议做出肯定回答或仅作为搭腔使用，同“はい”、“ええ”相比，其搭腔语气比肯定语气要重一些； </li><li>*ちょうど　いい：ちょうど　いいです（正合适） </li><li>“お湯”和 “水（みず）”：“お湯”是热水 、开水的意思，而“水”仅指凉水。因此可以说“熱い　お湯”，“冷たい　水”，但不能说“熱い　水”； </li><li>味道的表达方式：<em>甘い／</em>（塩）辛い／<em>酸っぱい／辛い／</em>苦い　等。其中“辛い”由咸和辣两种意思，需要特别区分是，“咸”可以说“塩辛い”或“しょっぱい”。此外，“おい（美味）しい”表达好吃或好喝，“まずい”表达不好吃或不好喝，包括水也一样；</li></ol>              </div>            </details>              </div>            </details><h2 id="初级上册-第二单元"><a href="#初级上册-第二单元" class="headerlink" title="初级上册-第二单元"></a>初级上册-第二单元</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p> 1.8李さんは　日本語で　手紙を　書きます</p><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p> 1.8.1文法説明</p><ol><li>「名詞[工具]」で　「動詞」：除NO.6学习了表示交通的助词“で”，它还可以用来表示其他手段及原材料，例如：手紙を　*速達　で　送りました。新聞紙　で　紙飛行機を　作りました； </li><li>「名詞[人]」は「名詞[人]」に　「名詞[物]」を　あげます：相当于汉语的“给”，例如：わたしは　小野さんに　お土産を　あげます。小野さんは　森さんに　チョコレート　を　あげました；</li><li>もらいました：与あげます相反； </li><li>「名詞[人]」に　会います：相当于汉语“见”，所要见的对象用助词“に”来提示。 例如：李さんは　明日　長島さんに　会います。私は　森さんに　会いました。 </li><li>よ　[提醒]： </li><li><p>もう①：意思相当于汉语的“已经”；</p><p>1.8.2表現と言葉の説明</p></li><li><p>～から／に　もらいます：从某人那里接受某物，“に”较为常用，“から”较为正式，给与的一方是“会社”或“学校”时使用；</p></li><li>“あげます”的用法：有单方面强加于人的印象，一般用“どうぞ”或“どうですか”；</li><li>“<em>さっき”和“たった　今”：刚才/刚刚； </em></li><li><em>4. 電話／</em>フアックス／メールを　まらいました：表示收到通信的表达方式； </li><li>スケジュール表の　*件：～の　件（～一事）是一种比较郑重的表达方式，多用于比较正式的场合，也用于传真或邮件中，例如：“件名：スケジュール表の　件”；</li><li>*おねがいします　[请求①]：请求对方做某事时，用「名詞＋（を）　お願いします」； </li><li>*分かりました：相当于汉语中的“明白了”，除此之外，还有对对方说的话表示承诺或应答的意思； </li><li>フアックスも　メールも：也、都，用法与中文有点区别； </li><li>*前に　[時間]：“に”有时可以省略； </li><li>箱根。</li></ol>              </div>            </details><p> 1.7李さん　は　毎日　コーヒーを　飲みます</p><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p> 1.7.1文法説明</p><ol><li>「名詞」を　「動詞」：动作的对象用助词“を”表示，读作“お”； </li><li>「名詞[场所]」で　「動詞」：动作的场所用助动词“で”表示：需要特别注意，存在于场所使用助词“に”，在场所发生的动作使用助动词“で”； </li><li>「名詞」か　「名詞」：相当于汉语的“或者”； </li><li><p>「名詞」を　ください：请… 可以用于花钱购物，也可以用于不花钱的索取；</p><p>1.72表現と言葉の説明</p></li><li><p>“何”的两种读法：“なん”和“なに”：基本读音为“なに”，在助动词“の”以及量词前时，读作“なん”。在“で”前，可任意使用两种读法； </p></li><li>そうですか：读降调时，表示理解了所听到的信息，相当于汉语的“是吗”。句尾读升调时，则表示对听到的信息有所质疑； </li><li>そうですね①：用于同意对方的提议，“ね”的读音不能拉长，因为拉长后语义将会发生变化； </li><li>じゃあ：接别人的话题，相当于汉语的“那么”，“じゃあ”是比较随意的说法，正式场合用“では”； </li><li>寒暄语④ <ol><li>失礼します： </li><li>いってらっしゃい：以还要返回为前提，要离开的人一般说“行ってまいります”。较为随便的说法为“行ってきます”。对方回答“いってらっしゃい”，其中包含期盼对方“早点回来”的意思；</li><li>“<em>ただいま”　“</em>お帰りなさい”：回到家或公司，回来的人说“ただいま”，在家或单位的人说“お帰りなさい（你回来了）”；</li><li>“いらっしゃいませ”　“＊かしこまりました”：欢迎光临、明白了，语气非常郑重，多为店员对顾客使用。“いらっしゃいませ”中省略“ませ”，语气则较为随意，常用于亲近或熟悉的人； </li></ol></li><li>すみません[搭话②]： </li><li>親子丼： コンビニ：24時間便利店。</li></ol>              </div>            </details><p> 1.6吉田さんは　来月　中国へ　行きます</p><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p> 1.6.1文法説明</p><ol><li><p>「名詞[场所]」 へ　「動詞」：使用“へ”接续表示移动的动词时，“へ”读作“え”； </p></li><li><p>「名詞[场所]」から　「動詞」：移動的起点用助词 “から”表示； </p></li><li><p>「名詞[人]」と　「動詞」：共同做某事的对象用助词“と”表； </p></li><li><p>「名詞[交通工具]」で　「動詞」：交通手段用助词“で”，步行特殊，用“歩いて”； </p></li><li><p>「名詞[场所]」から　「名詞[场所]」まで　「動詞」：表示移动的范围，后接移动动词； </p></li><li><p>「に／で／へ／から／まで／と」＋は：NO.5-6学习了助词“は”表示对比，除此之外，“は”也可以跟在“に／で／へ／から／まで／と”的后面形成一种复合形式。 </p><p>例如：私の　部屋には　電話が　あります。韓国へは　行きました。中国へは　行きませんでした。</p><p>1.6.2表現と言葉の説明</p></li><li><p>*たしか：表示不完全有把握的记忆，有（凭自己的记忆）应该是～的意思； </p><p>例如：あの　人は　だれですか。――たしか　李さんの　会社の　人です。 </p></li><li><p>“～です”的用法②：简介叙述句子的手段； </p></li><li><p>“家”和“うち”：描述建筑时一般用“いえ”，着重指家人时一般用“うち”。另，“うち”的原本意思即“我家”的意思，需要注意的是，使用“いえ”表示“我家”时必须说“私の　家”； </p></li><li><p>*まっすぐ　帰りました：“まっすぐ”表示笔直，与“帰ります”呼应使用时表示“径直”去某处的意思，例如：今日は　まっすぐ　帰ります。 </p></li><li><p>“それ”的用法，除了指示眼前的事物，也可以代指前述的事物或事件； 例如：毎日　夜　十一時まで　働きます。――それは　大変ですね。 </p></li><li><p>お疲れ様でした　[寒暄语③] </p></li><li><p>自転車： </p></li><li><p>最終電車：一般简称为“終電”。</p></li></ol>              </div>            </details><p> 1.5森さんは　七時に　起きます</p><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <p> 1.5.1文法説明</p><ol><li>今／～時／～分です：表示现在的时间； </li><li>「動詞」ます／「動詞」ません　｜　「動詞」ました／「動詞」ませんでした； </li><li>「名詞[時間]」に「動詞」：表現动作发生的時間時，要在时间后+助词“に”； 如：森さんは　七時　に　起きます；　学校は　八時半　に　始まります； </li><li>「名詞[時間]」から　「名詞[時間]」まで　「動詞」：表示动作发生在某个期间；</li><li>いつ「動詞」ますか　：询问动作或事态发生的时间用“いつ”，如询问的时间较为具体，则在具体时间词语后+に，例如：何時に、何曜日に、何日に。对持续性动作或事态的起点或重点进行提问，用“いつから”“何曜日まで”等； </li><li><p>は [对比] ：NO.1 学习了提示主语的助词“は”，“は”还可以用来表示对比，对比时发音略重，例如：“小野さんは　今日は　休みます。”、“いつもは　七時ごろです。”；</p><p>1.5.2表現と言葉の説明</p></li><li><p>人称②　[在单位工作]：在会社称呼上司时，一般可直接称呼其职务，例如：“課長”，或者在职务前+姓，例如：“吉田課長”。也有直接亲昵的称呼其姓名的情况，例如：“吉田さん”； </p></li><li>～です的用法①：对于已经明确的内容，在做出的相应回答不需要重复时，可以简洁的表达为“～です”； </li><li>毎朝　何時に　起きますか：两个名词叠加表示时间时，前面的名词包含“每”时 ，直接叠加，不加 “の”，当前面的时间名词不包括“每”时，两个时间名词之间可以+“の”，也可不加； </li><li>～ごろ：接在表示时间的词语后面，表示大致的时间范围，例如：～分、～時、～日、～曜日、～月、～年 等，例如：昨日　12時半ごろ　寝ました；</li></ol>              </div>            </details>              </div>            </details><h2 id="初级上册-第一个单元"><a href="#初级上册-第一个单元" class="headerlink" title="初级上册-第一个单元"></a>初级上册-第一个单元</h2><details class="folding-tag" ><summary> 点击查看详情 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab">初级-上册第一个单元 1</button><button type="button" class="tab">初级-上册第一个单元 2</button><button type="button" class="tab">初级-上册第一个单元 3</button><button type="button" class="tab active">初级-上册第一个单元 4</button></div><div class="tab-contents"><div class="tab-item-content"><p> 1.1李さんは　中国人　です</p><p> 1.1.1文法説明</p><ol><li><p>「名詞」　は　です：　　… 是 … “は”用于提示主题，读作“わ”；</p></li><li><p>「名詞」　は　では　ありませこん　：相当于汉语的…不是…，では　ありません　中的“では”，在口语中可以被“じあ”代替。</p></li><li><p>疑问句及应答： </p><p>（1）.「名詞」は　「名詞」ですか：　相当于汉语 …是…吗？助词“か”接在句尾表示疑问，不使用“？”，回答时用“はい”或“いいえ”。 </p><p>（2）. 应答：回答疑问句时，可以只用“はい”、“いいえ”，也可以在“はい”之后加上“そうです”，“いいえ”之后加上“ちかいます”，即：“はい、そうです。”、“いいえ、ちかいます”。不知道时，用“わかりません”。</p></li><li><p>「名詞」の　「名詞」[从属机构、国家][属性] </p><p>助词“の”链接名词和名词，表示前面的名词是后面名词从属的机构、国家或属性。 Attention：日语中无论名词之间是什么关系，一般加“の”，例如：“わたしの　父”，而汉语中表示为我父亲”。</p><p>1.1.2表現と言葉の説明</p></li><li><p>人称①：（1） “わたし”　“あなた”　“あの　人” 日语中的人称代词，一般来说，第一人称是“わたし”，第二人称是“あなた”，第三人称是“あの　人”。 （２）　～さん：称呼别人是，无论男女，都在其姓名后面+“さん”，“さん”只用于他人的姓名后，不用于自己的姓名后。 </p></li><li>省略①：会话中，多省略第一、第二人称主语，例如： （あなたは）　吉田さんですか。 ――いいえ、（わたしは）　吉田じや　ありません。（わたしは）森です。 小野さんは　会社員ですか。 ――はい、（わたしは）　JC企画の　社員です。 </li><li>あっ　「叹词①」：句尾的促音，使用：“LTU”或“XTU”组合即可打出来。 </li><li>“どうぞ　よるしう　お願いします”：自我介绍时，在说完自己的姓名或公司名之后，接着说.. 相当于汉语的“请多关照”，有时也用省略的说法“どうぞ　よろしく”或“よろしく　お願いします”，但“どうぞ　よろしく　お願いいたします。”是较为礼貌的说法。 其中，如改用“…お願いいたします。”的形式，则是更加礼貌的用法。 对方回答时，一般先说“こちらこそ”。</li></ol></div><div class="tab-item-content"><p> 1.2これは　ほん　です</p><p> 1.2.1 文法説明</p><ol><li>「これ／それ／あれ」は　「名詞」です：【代词】相当于汉语“这，这个、那，那个”；</li><li>だれですか／何ですか：“だれ”比较礼貌的说法是*“どなた”；</li><li>「名詞」の　「名詞」：表示所属：　私のかぎ；田中さん　の　車；</li><li>「この／その／あの」　「名詞」は　「名詞」です：【连体词，连接名词】；</li><li><p>どれ／どの　「名詞」：三个以上的事物的情形下使用的疑问词，修饰名词时用“どの”。</p><p>1.2.2表現と言葉の説明</p></li><li><p>方　「礼貌语言①」：相当于汉语（这/那/哪）位； </p></li><li>询问年龄 「礼貌语言②」：“何歳ですか。”或更加礼貌的问法“おいくつですか”。全年龄段适用。不过需要注意的是，日语直接询问孩子的年龄时，一般用“いくつ？”或“何歳？” </li><li>どうぞ：用于给或赠与对方物品，或劝对方进餐，相当于汉语的“请”； </li><li>「叹词②」：えっ：对对方说出的话感到意外或吃惊时使用，*わあ：感动或吃惊时发出的声音； </li><li>“はい”、“ええ”：ええ是はい较随意的说法、只用于肯定对方的疑问。在别人叫自己的名字，必须使用“はい”做回应，而不能用“ええ”； </li><li>外来词,使用片假名来表示；</li><li>どうも用于加强 ありがとうございます。所表示的谢意。但是，在略表谢意是，可以只说“どうも”。</li></ol></div><div class="tab-item-content"><p> 1.3ここは　デパートです</p><p>1.3.1文法説明</p><ol><li>「ここ／そこ／あそこ」は　「名詞」です：指示场所的代词，所表示的位置关系，与「これ／それ／あそれ」相一致； </li><li>「名詞」は　「名[场所]」です：表示名词存在的场所。 </li><li>「名詞」は　どこですか。：用于询问存在的场所。 </li><li>「名詞」も　「名詞」です。：助词“も”，相当于汉语当中的“也”； </li><li>「名詞」は　「名詞」ですか，「名詞」ですか。：答案 有多种可能，询问其中一种时可重复使用位于“～ですか”； </li><li><p>「名詞」は　いくらですか。：询问价钱时，用“いくら”。</p><p>1.3.2表現と言葉の説明</p></li><li><p>1階：量词； </p></li><li><p>省略②：[谓语的省略]：会话中的进一步询问，一般省略已经说过一遍的谓语部分； </p></li><li><p>礼貌语言 ③： </p><p>a.「こちら／そちら／どちら」原本是表示方向的说法，是「ここ／そこ／あそこ」的礼貌说法； </p><p>b. “*お国は　どちらですか。”、“会社は　どちらですか”：询问来自那个国家时，一般使用国は　どちらですか。国前面+お则是更礼貌的说法，但要注意不是所有的名词前面都可以+お。另外，“会社は　どちらですか。包含两层含义：一种是询问公司所在地，一种是询问公司名称，具体判定要根据上下文； </p></li><li><p>缩略词：“パソコン”由“パーソナルコンピューター”简化而来，故称为缩略词； </p></li><li><p>あのう　[搭话　①]：用于搭讪或引起对方注意，另外，再说的难以启齿的事情时、或开启一个新的话题时，以及向别人提出请求时，也可以用“あのう”。 </p></li><li><p>～ですか　[确认]：用于进一步确认对方所说的信息，句尾读升调。 一百，一千，在日语中表示为百，千，前面不加１，但是一万，一千万，一亿，则需要在前面加上量词1；</p></li></ol><div class="table-container"><table><thead><tr><th style="text-align:right">100以上</th><th></th><th style="text-align:right">1000</th><th></th><th style="text-align:right">10000</th><th></th></tr></thead><tbody><tr><td style="text-align:right">100</td><td>ひゃく</td><td style="text-align:right">1000</td><td>せん</td><td style="text-align:right">10000</td><td>いちまん</td></tr><tr><td style="text-align:right">200</td><td>にひゃく</td><td style="text-align:right">2000</td><td>にせん</td><td style="text-align:right">100000</td><td>じゅうまん</td></tr><tr><td style="text-align:right">300</td><td>さんびゃく</td><td style="text-align:right">3000</td><td>さんぜん</td><td style="text-align:right">1000000</td><td>ひゃくまん</td></tr><tr><td style="text-align:right">400</td><td>よんひゃく</td><td style="text-align:right">4000</td><td>よんせん</td><td style="text-align:right">10000000</td><td>いっせんまん</td></tr><tr><td style="text-align:right">500</td><td>ごひゃく</td><td style="text-align:right">5000</td><td>ごせん</td><td style="text-align:right">100000000</td><td>いちおく</td></tr><tr><td style="text-align:right">600</td><td>ろっぴゃく</td><td style="text-align:right">6000</td><td>ろくせん</td><td style="text-align:right"></td><td></td></tr><tr><td style="text-align:right">700</td><td>ななひゃく</td><td style="text-align:right">7000</td><td>ななせん</td><td style="text-align:right">9002</td><td>きゅうせん　に</td></tr><tr><td style="text-align:right">800</td><td>はちぴゃく</td><td style="text-align:right">8000</td><td>はっせん</td><td style="text-align:right">9020</td><td>きゅうえん　にじゅう</td></tr><tr><td style="text-align:right">900</td><td>きゅうひゃく</td><td style="text-align:right">9000</td><td>きゅうせん</td><td style="text-align:right">9200</td><td>きゅうせんにひゃく</td></tr></tbody></table></div></div><div class="tab-item-content active"><p> 1.4部屋に　机と　椅子が　あります</p><p> 1.4.1文法説明</p><ol><li>“あります”、“います”：表示存在：“あります”用于无意志的对象，例如花草，桌子椅子，“います”用于人和动物等具有意志的对象； <ol><li>「名詞[场所]」に　「名詞[物/人]」が　あります／います 「名詞[物/人]」は　</li><li>「名詞[场所]」に　あります／います NO3.学习了“～は　どこですか。”这个句型也可以用“～は　どこに　ありますか／いますか”。 哪里有 ~ ？ </li></ol></li><li>「名詞」と　「名詞」[并列]：相当于汉语当中的“和”； </li><li>上／下／前／後ろ／隣／中／外：表示具体位置时，用“名词+の＋上／下／前／後ろ／隣／中／外”，不同于中文里的“桌子上”、“椅子下”，日语中“の”不能省略； </li><li>ね　[确认]，读升调； </li><li><p>疑问词　+　も　＋　「動詞（否定）」：表示全面否定； *教室に　だれも　いません；　　＊冷蔵庫に　何も　ありません；</p><p>1.4.2表現と言葉の説明</p></li><li><p>“上”表示的范围：仅表示垂直上方，日语中“壁のう上に”指墙的垂直上方，屋顶。墙壁的表面用“壁に”：壁に　<em>スイッチ　あります。 </em></p></li><li><em>ええと：被问及某事，思考该如何回答时的语气词； </em></li><li><em>“ご家族／ご兄弟／ご両親（Ryousinn）”[礼貌语言④]：说到对方亲属时的礼貌说法+ご； </em></li><li><em>兄弟：跟中文不同，日语中的“兄弟”是指同一父母下的兄弟姐妹； </em></li><li><em>“</em>JR”和“地下鉄”； </li><li>人い暮らし：离开家人一个人生活的状态，被称为“一人暮らし”。</li></ol></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> 日语 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日语 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown语法与外挂标签写法汇总</title>
      <link href="/posts/2013454d/"/>
      <url>/posts/2013454d/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Markdown语法自带格式"><a href="#1-Markdown语法自带格式" class="headerlink" title="1.Markdown语法自带格式"></a>1.Markdown语法自带格式</h1><div class="note info flat"><p>参考：<a href="https://blog.csdn.net/u014061630/article/details/81359144">Markdown语法图文全面详解(10分钟学会)</a></p></div><div class="note warning flat"><p>注意：此页面偶尔会存在CSS冲突问题!</p></div><h2 id="1-1-代码块"><a href="#1-1-代码块" class="headerlink" title="1.1 代码块"></a>1.1 代码块</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">\```shell</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VSCode终端</span></span><br><span class="line">hexo clean; hexo s</span><br><span class="line">hexo clean; hexo g; hexo d</span><br><span class="line">git add .; git commit -m &quot;npm publish&quot;; npm version patch; </span><br><span class="line">git push</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cmder终端</span></span><br><span class="line">hexo clean &amp;&amp; hexo s</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br><span class="line">git add . &amp;&amp; git commit -m &quot;npm publish&quot; &amp;&amp; npm version patch</span><br><span class="line">git push</span><br><span class="line">\```</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VSCode终端</span></span><br><span class="line">hexo clean; hexo s</span><br><span class="line">hexo clean; hexo g; hexo d</span><br><span class="line">git add .; git commit -m &quot;npm publish&quot;; npm version patch; </span><br><span class="line">git push</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cmder终端</span></span><br><span class="line">hexo clean &amp;&amp; hexo s</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br><span class="line">git add . &amp;&amp; git commit -m &quot;npm publish&quot; &amp;&amp; npm version patch</span><br><span class="line">git push</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="1-2-多级标题"><a href="#1-2-多级标题" class="headerlink" title="1.2 多级标题"></a>1.2 多级标题</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="section"># H1</span></span><br><span class="line"><span class="section">## H2</span></span><br><span class="line"><span class="section">### H3</span></span><br><span class="line"><span class="section">#### H4</span></span><br><span class="line"><span class="section">##### H5</span></span><br><span class="line"><span class="section">###### H6</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>见本文章标题!</p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="1-3-文字样式"><a href="#1-3-文字样式" class="headerlink" title="1.3 文字样式"></a>1.3 文字样式</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">u</span>&gt;</span></span>下划线演示<span class="language-xml"><span class="tag">&lt;/<span class="name">u</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">文字<span class="strong">**加粗**</span>演示</span><br><span class="line"></span><br><span class="line">文字<span class="emphasis">*斜体*</span>演示</span><br><span class="line"></span><br><span class="line">文本<span class="code">`高亮`</span>演示</span><br><span class="line"></span><br><span class="line">文本~~删除~~线演示</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">size</span> = <span class="string">5</span>&gt;</span></span>5号字<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">face</span>=<span class="string">&quot;黑体&quot;</span>&gt;</span></span>黑体<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">blue</span>&gt;</span></span>蓝色<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">td</span> <span class="attr">bgcolor</span>=<span class="string">MistyRose</span>&gt;</span></span>这里的背景色是：MistyRosen，此处输入任意想输入的内容<span class="language-xml"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p><u>下划线演示</u></p><p>文字<strong>加粗</strong>演示</p><p>文字<em>斜体</em>演示</p><p>文本<code>高亮</code>演示</p><p>文本<del>删除</del>线演示</p><font size = 5>5号字</font><font face="黑体">黑体</font><font color=blue>蓝色</font><table><tr><td bgcolor=MistyRose>这里的背景色是：MistyRosen，此处输入任意想输入的内容</td></tr></table></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><div class="note info flat"><p>上述要点可参考:<a href="https://blog.csdn.net/qq_43732429/article/details/108034518">【Markdown语法】字体颜色大小及文字底色设置</a></p></div><h2 id="1-4-引用"><a href="#1-4-引用" class="headerlink" title="1.4 引用"></a>1.4 引用</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="quote">&gt;  Java</span></span><br><span class="line"><span class="quote">&gt; 二级引用演示</span></span><br><span class="line"><span class="quote">&gt; MySQL</span></span><br><span class="line"><span class="quote">&gt; &gt;外键</span></span><br><span class="line"><span class="quote">&gt; &gt;</span></span><br><span class="line"><span class="quote">&gt; &gt;事务</span></span><br><span class="line"><span class="quote">&gt; &gt;</span></span><br><span class="line"><span class="quote">&gt; &gt;<span class="strong">**行级锁**</span>(引用内部一样可以用格式)</span></span><br><span class="line"><span class="quote">&gt; </span></span><br><span class="line"><span class="quote">&gt; ....</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><blockquote><p> Java<br>二级引用演示<br>MySQL</p><blockquote><p>外键</p><p>事务</p><p><strong>行级锁</strong>(引用内部一样可以用格式)</p></blockquote><p>….</p></blockquote></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="1-5-分割线"><a href="#1-5-分割线" class="headerlink" title="1.5 分割线"></a>1.5 分割线</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="strong">**<span class="emphasis">*</span></span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><hr><hr></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="1-6-列表-跟空格都可以"><a href="#1-6-列表-跟空格都可以" class="headerlink" title="1.6 列表(*,+,-跟空格都可以)"></a>1.6 列表(*,+,-跟空格都可以)</h2><h3 id="1-6-1-无序列表"><a href="#1-6-1-无序列表" class="headerlink" title="1.6.1 无序列表"></a>1.6.1 无序列表</h3><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">*</span> Java</span><br><span class="line"><span class="bullet">*</span> Python</span><br><span class="line"><span class="bullet">*</span> ...</span><br><span class="line"></span><br><span class="line"><span class="bullet">+</span> Java</span><br><span class="line"><span class="bullet">+</span> Python</span><br><span class="line"><span class="bullet">+</span> ...</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> Java</span><br><span class="line"><span class="bullet">-</span> Python</span><br><span class="line"><span class="bullet">-</span> ...</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ul><li>Java</li><li>Python</li><li>…</li></ul><ul><li>Java</li><li>Python</li><li>…</li></ul><ul><li>Java</li><li>Python</li><li>…</li></ul></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="1-6-2-有序列表"><a href="#1-6-2-有序列表" class="headerlink" title="1.6.2 有序列表"></a>1.6.2 有序列表</h3><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="section"># 注意后面有空格</span></span><br><span class="line"><span class="bullet">1.</span> </span><br><span class="line"><span class="bullet">2.</span> </span><br><span class="line"><span class="bullet">3.</span> </span><br><span class="line"><span class="bullet">4.</span> </span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li></li><li></li><li></li><li></li></ol></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="1-7-图片"><a href="#1-7-图片" class="headerlink" title="1.7 图片"></a>1.7 图片</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="section"># 本地图片</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/assets/pusheencode.webp&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;示例图片&quot;</span> <span class="attr">style</span>=<span class="string">&quot;zoom:50%;&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="section"># 在线图片</span></span><br><span class="line">![<span class="string">code</span>](<span class="link">https://cdn.jsdelivr.net/gh/fomalhaut1998/markdown_pic/img/code.png</span>)</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>本地图片:<br><img src="/assets/pusheencode.webp" alt="示例图片" style="zoom:50%;" /><br>在线图片:<br><img src="https://cdn.jsdelivr.net/gh/fomalhaut1998/markdown_pic/img/code.png" alt="code"></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="1-8-表格"><a href="#1-8-表格" class="headerlink" title="1.8 表格"></a>1.8 表格</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">| 项目标号 | 资金     | 备注 |</span><br><span class="line">| -------- | -------- | ---- |</span><br><span class="line">| 1        | 100，000 | 无   |</span><br><span class="line">| 2        | 200，000 | 无   |</span><br><span class="line">| 3        | 300,600  | 重要 |</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><div class="table-container"><table><thead><tr><th>项目标号</th><th>资金</th><th>备注</th></tr></thead><tbody><tr><td>1</td><td>100，000</td><td>无</td></tr><tr><td>2</td><td>200，000</td><td>无</td></tr><tr><td>3</td><td>300,600</td><td>重要</td></tr></tbody></table></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="1-9-公式"><a href="#1-9-公式" class="headerlink" title="1.9 公式"></a>1.9 公式</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$$</span><br><span class="line">\Gamma(z)=\int<span class="emphasis">_0^\infty t^&#123;z-1&#125;e^&#123;-t&#125;dt.</span></span><br><span class="line"><span class="emphasis">$$</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><script type="math/tex; mode=display">\Gamma(z)=\int_0^\infty t^{z-1}e^{-t}dt.</script></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h1 id="2-Butterfly外挂标签"><a href="#2-Butterfly外挂标签" class="headerlink" title="2.Butterfly外挂标签"></a>2.Butterfly外挂标签</h1><div class="note info flat"><p>这部分参考安知鱼:<a href="https://anzhiy.cn/posts/7d58.html">基于Butterfly的外挂标签引入</a></p></div><h2 id="2-1-行内文本样式-text"><a href="#2-1-行内文本样式-text" class="headerlink" title="2.1 行内文本样式 text"></a>2.1 行内文本样式 text</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% u 文本内容 %&#125;</span><br><span class="line">&#123;% emp 文本内容 %&#125;</span><br><span class="line">&#123;% wavy 文本内容 %&#125;</span><br><span class="line">&#123;% del 文本内容 %&#125;</span><br><span class="line">&#123;% kbd 文本内容 %&#125;</span><br><span class="line">&#123;% psw 文本内容 %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">1.</span> 带 &#123;% u 下划线 %&#125; 的文本</span><br><span class="line"><span class="bullet">2.</span> 带 &#123;% emp 着重号 %&#125; 的文本</span><br><span class="line"><span class="bullet">3.</span> 带 &#123;% wavy 波浪线 %&#125; 的文本</span><br><span class="line"><span class="bullet">4.</span> 带 &#123;% del 删除线 %&#125; 的文本</span><br><span class="line"><span class="bullet">5.</span> 键盘样式的文本 &#123;% kbd command %&#125; + &#123;% kbd D %&#125;</span><br><span class="line"><span class="bullet">6.</span> 密码样式的文本：&#123;% psw 这里没有验证码 %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li>带 <u>下划线</u> 的文本</li><li>带 <emp>着重号</emp> 的文本</li><li>带 <wavy>波浪线</wavy> 的文本</li><li>带 <del>删除线</del> 的文本</li><li>键盘样式的文本 <kbd>command</kbd> + <kbd>D</kbd></li><li>密码样式的文本：<psw>这里没有验证码</psw></li></ol></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-2-行内文本-span"><a href="#2-2-行内文本-span" class="headerlink" title="2.2 行内文本 span"></a>2.2 行内文本 span</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">配置参数</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% span 样式参数(参数以空格划分), 文本内容 %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><code>字体</code>: logo, code</li><li><code>颜色</code>: red,yellow,green,cyan,blue,gray</li><li><code>大小</code>: small, h4, h3, h2, h1, large, huge, ultra</li><li><code>对齐方向</code>: left, center, right</li></ol></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">-</span> 彩色文字</span><br><span class="line">在一段话中方便插入各种颜色的标签，包括：&#123;% span red, 红色 %&#125;、&#123;% span yellow, 黄色 %&#125;、&#123;% span green, 绿色 %&#125;、&#123;% span cyan, 青色 %&#125;、&#123;% span blue, 蓝色 %&#125;、&#123;% span gray, 灰色 %&#125;。</span><br><span class="line"><span class="bullet">-</span> 超大号文字</span><br><span class="line">文档「开始」页面中的标题部分就是超大号文字。</span><br><span class="line">&#123;% span center logo large, Volantis %&#125;</span><br><span class="line">&#123;% span center small, A Wonderful Theme for Hexo %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ul><li>彩色文字<br>在一段话中方便插入各种颜色的标签，包括：<span class='p red'>红色</span>、<span class='p yellow'>黄色</span>、<span class='p green'>绿色</span>、<span class='p cyan'>青色</span>、<span class='p blue'>蓝色</span>、<span class='p gray'>灰色</span>。</li><li>超大号文字<br>文档「开始」页面中的标题部分就是超大号文字。<br><span class='p center logo large'>Volantis</span><br><span class='p center small'>A Wonderful Theme for Hexo</span></li></ul></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-3-段落文本-p"><a href="#2-3-段落文本-p" class="headerlink" title="2.3 段落文本 p"></a>2.3 段落文本 p</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">配置参数</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% p 样式参数(参数以空格划分), 文本内容 %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><code>字体</code>: logo, code</li><li><code>颜色</code>: red,yellow,green,cyan,blue,gray</li><li><code>大小</code>: small, h4, h3, h2, h1, large, huge, ultra</li><li><code>对齐方向</code>: left, center, right</li></ol></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">-</span> 彩色文字</span><br><span class="line">在一段话中方便插入各种颜色的标签，包括：&#123;% p red, 红色 %&#125;、&#123;% p yellow, 黄色 %&#125;、&#123;% p green, 绿色 %&#125;、&#123;% p cyan, 青色 %&#125;、&#123;% p blue, 蓝色 %&#125;、&#123;% p gray, 灰色 %&#125;。</span><br><span class="line"><span class="bullet">-</span> 超大号文字</span><br><span class="line">文档「开始」页面中的标题部分就是超大号文字。</span><br><span class="line">&#123;% p center logo large, Volantis %&#125;</span><br><span class="line">&#123;% p center small, A Wonderful Theme for Hexo %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ul><li>彩色文字<br>在一段话中方便插入各种颜色的标签，包括：<p class='p red'>红色</p>、<p class='p yellow'>黄色</p>、<p class='p green'>绿色</p>、<p class='p cyan'>青色</p>、<p class='p blue'>蓝色</p>、<p class='p gray'>灰色</p>。</li><li>超大号文字<br>文档「开始」页面中的标题部分就是超大号文字。<p class='p center logo large'>Volantis</p><p class='p center small'>A Wonderful Theme for Hexo</p></li></ul></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-4-引用note"><a href="#2-4-引用note" class="headerlink" title="2.4 引用note"></a>2.4 引用note</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">通用配置</button><button type="button" class="tab">语法格式</button><button type="button" class="tab">参数配置</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">note:</span><br><span class="line">  # Note tag style values:</span><br><span class="line">  #  - simple    bs-callout old alert style. Default.</span><br><span class="line">  #  - modern    bs-callout new (v2-v3) alert style.</span><br><span class="line">  #  - flat      flat callout style with background, like on Mozilla or StackOverflow.</span><br><span class="line">  #  - disabled  disable all CSS styles import of note tag.</span><br><span class="line">  style: simple</span><br><span class="line">  icons: false</span><br><span class="line">  border<span class="emphasis">_radius: 3</span></span><br><span class="line"><span class="emphasis">  # Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6).</span></span><br><span class="line"><span class="emphasis">  # Offset also applied to label tag variables. This option can work with disabled note tag.</span></span><br><span class="line"><span class="emphasis">  light_</span>bg<span class="emphasis">_offset: 0</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="section"># 自带icon</span></span><br><span class="line">&#123;% note [class] [no-icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"><span class="section"># 外部icon</span></span><br><span class="line">&#123;% note [color] [icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>1.自带icon</p><div class="table-container"><table><thead><tr><th>参数</th><th style="text-align:center">用法</th></tr></thead><tbody><tr><td>class</td><td style="text-align:center">【可选】标识，不同的标识有不同的配色 （ default / primary / success / info / warning / danger ）</td></tr><tr><td>no-icon</td><td style="text-align:center">【可选】不显示 icon</td></tr><tr><td>style</td><td style="text-align:center">【可选】可以覆盖配置中的 style （simple/modern/flat/disabled）</td></tr></tbody></table></div><p>2.外部icon</p><div class="table-container"><table><thead><tr><th>参数</th><th style="text-align:center">用法</th></tr></thead><tbody><tr><td>class</td><td style="text-align:center">【可选】标识，不同的标识有不同的配色 （ default / blue / pink / red / purple / orange / green ）</td></tr><tr><td>no-icon</td><td style="text-align:center">【可选】可配置自定义 icon (只支持 fontawesome 图标, 也可以配置 no-icon )</td></tr><tr><td>style</td><td style="text-align:center">【可选】可以覆盖配置中的 style （simple/modern/flat/disabled）</td></tr></tbody></table></div></div><div class="tab-item-content"><details class="folding-tag" blue><summary> 1.自带icon </summary>              <div class='content'>              <p>1.<code>simple</code>样式<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% note simple %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default simple %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary simple %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success simple %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info simple %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning simple %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger simple %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><br>2.<code>modern</code>样式<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% note modern %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default modern %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary modern %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success modern %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info modern %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning modern %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger modern %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure></p><p>3.<code>flat</code>样式</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% note flat %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default flat %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary flat %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success flat %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info flat %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning flat %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger flat %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>4.<code>disabled</code>样式</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% note disabled %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default disabled %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary disabled %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success disabled %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info disabled %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning disabled %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger disabled %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>5.<code>no-icon</code>样式</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default no-icon %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary no-icon %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success no-icon %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info no-icon %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning no-icon %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger no-icon %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 2.外部icon </summary>              <div class='content'>              <p>1.<code>simple</code>样式</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; simple %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; simple %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; simple %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; simple%&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; simple %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; simple %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; simple %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>2.<code>modern</code>样式</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; modern %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; modern %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; modern%&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; modern %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; modern %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; modern %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>3.<code>flat</code>样式</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; flat %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; flat %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; flat %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; flat%&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; flat %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; flat %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; flat %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>4.<code>disabled</code>样式</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; disabled %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; disabled %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; disabled %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; disabled %&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; disabled %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; disabled %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; disabled %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>5.<code>no-icon</code>样式</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue no-icon %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink no-icon %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red no-icon %&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange no-icon %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple no-icon %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green no-icon %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>              </div>            </details></div><div class="tab-item-content"><details class="folding-tag" blue><summary> 1.自带icon </summary>              <div class='content'>              <p>1.<code>simple</code>样式</p><div class="note simple"><p>默认 提示块标签</p></div><div class="note default simple"><p>default 提示块标签</p></div><div class="note primary simple"><p>primary 提示块标签</p></div><div class="note success simple"><p>success 提示块标签</p></div><div class="note info simple"><p>info 提示块标签</p></div><div class="note warning simple"><p>warning 提示块标签</p></div><div class="note danger simple"><p>danger 提示块标签</p></div>2.`modern`样式<div class="note modern"><p>默认 提示块标签</p></div><div class="note default modern"><p>default 提示块标签</p></div><div class="note primary modern"><p>primary 提示块标签</p></div><div class="note success modern"><p>success 提示块标签</p></div><div class="note info modern"><p>info 提示块标签</p></div><div class="note warning modern"><p>warning 提示块标签</p></div><div class="note danger modern"><p>danger 提示块标签</p></div><p>3.<code>flat</code>样式</p><div class="note flat"><p>默认 提示块标签</p></div><div class="note default flat"><p>default 提示块标签</p></div><div class="note primary flat"><p>primary 提示块标签</p></div><div class="note success flat"><p>success 提示块标签</p></div><div class="note info flat"><p>info 提示块标签</p></div><div class="note warning flat"><p>warning 提示块标签</p></div><div class="note danger flat"><p>danger 提示块标签</p></div><p>4.<code>disabled</code>样式</p><div class="note disabled"><p>默认 提示块标签</p></div><div class="note default disabled"><p>default 提示块标签</p></div><div class="note primary disabled"><p>primary 提示块标签</p></div><div class="note success disabled"><p>success 提示块标签</p></div><div class="note info disabled"><p>info 提示块标签</p></div><div class="note warning disabled"><p>warning 提示块标签</p></div><div class="note danger disabled"><p>danger 提示块标签</p></div><p>5.<code>no-icon</code>样式</p><div class="note no-icon flat"><p>默认 提示块标签</p></div><div class="note default no-icon flat"><p>default 提示块标签</p></div><div class="note primary no-icon flat"><p>primary 提示块标签</p></div><div class="note success no-icon flat"><p>success 提示块标签</p></div><div class="note info no-icon flat"><p>info 提示块标签</p></div><div class="note warning no-icon flat"><p>warning 提示块标签</p></div><div class="note danger no-icon flat"><p>danger 提示块标签</p></div>              </div>            </details><details class="folding-tag" blue><summary> 2.外部icon </summary>              <div class='content'>              <p>1.<code>simple</code>样式</p><div class="note icon-padding simple"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon-padding simple"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding simple"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding simple"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding simple"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding simple"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><p>2.<code>modern</code>样式</p><div class="note icon-padding modern"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon-padding modern"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding modern"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding modern"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding modern"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><p>3.<code>flat</code>样式</p><div class="note icon-padding flat"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding flat"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon-padding flat"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding flat"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding flat"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding flat"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding flat"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><p>4.<code>disabled</code>样式</p><div class="note icon-padding disabled"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding disabled"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon-padding disabled"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding disabled"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding disabled"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding disabled"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding disabled"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><p>5.<code>no-icon</code>样式</p><div class="note no-icon flat"><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue no-icon flat"><p>2021年快到了….</p></div><div class="note pink no-icon flat"><p>小心开车 安全至上</p></div><div class="note red no-icon flat"><p>这是三片呢？还是四片？</p></div><div class="note orange no-icon flat"><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple no-icon flat"><p>剪刀石头布</p></div><div class="note green no-icon flat"><p>前端最讨厌的浏览器</p></div>              </div>            </details></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-5-上标标签-tip"><a href="#2-5-上标标签-tip" class="headerlink" title="2.5 上标标签 tip"></a>2.5 上标标签 tip</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">配置参数</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% tip [参数，可选] %&#125;文本内容&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><code>样式</code>: success,error,warning,bolt,ban,home,sync,cogs,key,bell</li><li><code>自定义图标</code>: 支持fontawesome。</li></ol></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% tip %&#125;default&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip info %&#125;info&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip success %&#125;success&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip error %&#125;error&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip warning %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bolt %&#125;bolt&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban %&#125;ban&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip home %&#125;home&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip sync %&#125;sync&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip cogs %&#125;cogs&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip key %&#125;key&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bell %&#125;bell&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip fa-atom %&#125;自定义font awesome图标&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><div class="tip "><p>default</p></div><div class="tip info"><p>info</p></div><div class="tip success"><p>success</p></div><div class="tip error"><p>error</p></div><div class="tip warning"><p>warning</p></div><div class="tip bolt"><p>bolt</p></div><div class="tip ban"><p>ban</p></div><div class="tip home"><p>home</p></div><div class="tip sync"><p>sync</p></div><div class="tip cogs"><p>cogs</p></div><div class="tip key"><p>key</p></div><div class="tip bell"><p>bell</p></div><div class="tip fa-atom"><p>自定义font awesome图标</p></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-6-动态标签-anima"><a href="#2-6-动态标签-anima" class="headerlink" title="2.6 动态标签 anima"></a>2.6 动态标签 anima</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">示例源码</button><button type="button" class="tab">配置参数</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% tip [参数，可选] %&#125;文本内容&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><div class="note info flat"><ol><li>将所需的CSS类添加到图标（或DOM中的任何元素）。</li><li>对于父级悬停样式，需要给目标元素添加指定CSS类，同时还要给目标元素的父级元素添加CSS类<code>faa-parent animated-hover</code>。（详情见示例及示例源码）<br>You can regulate the speed of the animation by adding the CSS class or . faa-fastfaa-slow</li><li>可以通过给目标元素添加CSS类<code>faa-fast</code>或<code>faa-slow</code>来控制动画快慢。</li></ol></div></div><div class="tab-item-content"><p>   1.On DOM load（当页面加载时显示动画）</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>2.调整动画速度<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated faa-fast %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated faa-slow %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><br>3.On hover（当鼠标悬停时显示动画）<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated-hover %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated-hover %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><br>4.On parent hover（当鼠标悬停在父级元素时显示动画）<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% tip warning faa-parent animated-hover %&#125;<span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;faa-horizontal&quot;</span>&gt;</span></span>warning<span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-parent animated-hover %&#125;<span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;faa-flash&quot;</span>&gt;</span></span>ban<span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure></p></div><div class="tab-item-content"><p>1.On DOM load（当页面加载时显示动画）</p><div class="tip warning faa-horizontal animated"><p>warning</p></div><div class="tip ban faa-flash animated"><p>ban</p></div>2.调整动画速度<div class="tip warning faa-horizontal animated faa-fast"><p>warning</p></div><div class="tip ban faa-flash animated faa-slow"><p>ban</p></div>3.On hover（当鼠标悬停时显示动画）<div class="tip warning faa-horizontal animated-hover"><p>warning</p></div><div class="tip ban faa-flash animated-hover"><p>ban</p></div>4.On parent hover（当鼠标悬停在父级元素时显示动画）<div class="tip warning faa-parent animated-hover"><p class="faa-horizontal">warning</p></div><div class="tip ban faa-parent animated-hover"><p class="faa-flash">ban</p></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-7-复选列表-checkbox"><a href="#2-7-复选列表-checkbox" class="headerlink" title="2.7 复选列表 checkbox"></a>2.7 复选列表 checkbox</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">配置参数</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% checkbox 样式参数（可选）, 文本（支持简单md） %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><code>样式</code>: plus, minus, times</li><li><code>颜色</code>: red,yellow,green,cyan,blue,gray</li><li><code>选中状态</code>: checked</li></ol></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% checkbox 纯文本测试 %&#125;</span><br><span class="line">&#123;% checkbox checked, 支持简单的 [<span class="string">markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>) 语法 %&#125;</span><br><span class="line">&#123;% checkbox red, 支持自定义颜色 %&#125;</span><br><span class="line">&#123;% checkbox green checked, 绿色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox yellow checked, 黄色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox cyan checked, 青色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox blue checked, 蓝色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox plus green checked, 增加 %&#125;</span><br><span class="line">&#123;% checkbox minus yellow checked, 减少 %&#125;</span><br><span class="line">&#123;% checkbox times red checked, 叉 %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><div class='checkbox'><input type="checkbox" />            <p>纯文本测试</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>支持简单的 <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> 语法</p>            </div><div class='checkbox red'><input type="checkbox" />            <p>支持自定义颜色</p>            </div><div class='checkbox green checked'><input type="checkbox" checked="checked"/>            <p>绿色 + 默认选中</p>            </div><div class='checkbox yellow checked'><input type="checkbox" checked="checked"/>            <p>黄色 + 默认选中</p>            </div><div class='checkbox cyan checked'><input type="checkbox" checked="checked"/>            <p>青色 + 默认选中</p>            </div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>蓝色 + 默认选中</p>            </div><div class='checkbox plus green checked'><input type="checkbox" checked="checked"/>            <p>增加</p>            </div><div class='checkbox minus yellow checked'><input type="checkbox" checked="checked"/>            <p>减少</p>            </div><div class='checkbox times red checked'><input type="checkbox" checked="checked"/>            <p>叉</p>            </div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-8-单选列表-radio"><a href="#2-8-单选列表-radio" class="headerlink" title="2.8 单选列表 radio"></a>2.8 单选列表 radio</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">配置参数</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% radio 样式参数（可选）, 文本（支持简单md） %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><code>颜色</code>: red,yellow,green,cyan,blue,gray</li><li><code>选中状态</code>: checked</li></ol></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% radio 纯文本测试 %&#125;</span><br><span class="line">&#123;% radio checked, 支持简单的 [<span class="string">markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>) 语法 %&#125;</span><br><span class="line">&#123;% radio red, 支持自定义颜色 %&#125;</span><br><span class="line">&#123;% radio green, 绿色 %&#125;</span><br><span class="line">&#123;% radio yellow, 黄色 %&#125;</span><br><span class="line">&#123;% radio cyan, 青色 %&#125;</span><br><span class="line">&#123;% radio blue, 蓝色 %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><div class='checkbox'><input type="radio" />            <p>纯文本测试</p>            </div><div class='checkbox checked'><input type="radio" checked="checked"/>            <p>支持简单的 <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> 语法</p>            </div><div class='checkbox red'><input type="radio" />            <p>支持自定义颜色</p>            </div><div class='checkbox green'><input type="radio" />            <p>绿色</p>            </div><div class='checkbox yellow'><input type="radio" />            <p>黄色</p>            </div><div class='checkbox cyan'><input type="radio" />            <p>青色</p>            </div><div class='checkbox blue'><input type="radio" />            <p>蓝色</p>            </div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-9-时间轴-timeline"><a href="#2-9-时间轴-timeline" class="headerlink" title="2.9 时间轴 timeline"></a>2.9 时间轴 timeline</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">配置参数</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% timeline 时间线标题（可选）[,color] %&#125;</span><br><span class="line">&lt;!-- timeline 时间节点（标题） --&gt;</span><br><span class="line">正文内容</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&lt;!-- timeline 时间节点（标题） --&gt;</span><br><span class="line">正文内容</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><code>title</code>:标题/时间线</li><li><code>color</code>:<code>timeline</code>颜色:default(留空) / blue / pink / red / purple / orange / green</li></ol></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% timeline 时间轴样式,blue %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-07-24 [<span class="string">2.6.6 -&gt; 3.0</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases</span>) --&gt;</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> 如果有 <span class="code">`hexo-lazyload-image`</span> 插件，需要删除并重新安装最新版本，设置 <span class="code">`lazyload.isSPA: true`</span>。</span><br><span class="line"><span class="bullet">2.</span> 2.x 版本的 css 和 js 不适用于 3.x 版本，如果使用了 <span class="code">`use_cdn: true`</span> 则需要删除。</span><br><span class="line"><span class="bullet">3.</span> 2.x 版本的 fancybox 标签在 3.x 版本中被重命名为 gallery 。</span><br><span class="line"><span class="bullet">4.</span> 2.x 版本的置顶 <span class="code">`top: true`</span> 改为了 <span class="code">`pin: true`</span>，并且同样适用于 <span class="code">`layout: page`</span> 的页面。</span><br><span class="line"><span class="bullet">5.</span> 如果使用了 <span class="code">`hexo-offline`</span> 插件，建议卸载，3.0 版本默认开启了 pjax 服务。</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-05-15 [<span class="string">2.6.3 -&gt; 2.6.6</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6</span>) --&gt;</span><br><span class="line"></span><br><span class="line">不需要额外处理。</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-04-20 [<span class="string">2.6.2 -&gt; 2.6.3</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3</span>) --&gt;</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> 全局搜索 <span class="code">`seotitle`</span> 并替换为 <span class="code">`seo_title`</span>。</span><br><span class="line"><span class="bullet">2.</span> group 组件的索引规则有变，使用 group 组件的文章内，<span class="code">`group: group_name`</span> 对应的组件名必须是 <span class="code">`group_name`</span>。</span><br><span class="line"><span class="bullet">2.</span> group 组件的列表名优先显示文章的 <span class="code">`short_title`</span> 其次是 <span class="code">`title`</span>。</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><div class="timeline blue"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>时间轴样式</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-07-24 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases">2.6.6 -&gt; 3.0</a></p></div></div><div class='timeline-item-content'><ol><li>如果有 <code>hexo-lazyload-image</code> 插件，需要删除并重新安装最新版本，设置 <code>lazyload.isSPA: true</code>。</li><li>2.x 版本的 css 和 js 不适用于 3.x 版本，如果使用了 <code>use_cdn: true</code> 则需要删除。</li><li>2.x 版本的 fancybox 标签在 3.x 版本中被重命名为 gallery 。</li><li>2.x 版本的置顶 <code>top: true</code> 改为了 <code>pin: true</code>，并且同样适用于 <code>layout: page</code> 的页面。</li><li>如果使用了 <code>hexo-offline</code> 插件，建议卸载，3.0 版本默认开启了 pjax 服务。</li></ol></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-05-15 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6">2.6.3 -&gt; 2.6.6</a></p></div></div><div class='timeline-item-content'><p>不需要额外处理。</p></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-04-20 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3">2.6.2 -&gt; 2.6.3</a></p></div></div><div class='timeline-item-content'><ol><li>全局搜索 <code>seotitle</code> 并替换为 <code>seo_title</code>。</li><li>group 组件的索引规则有变，使用 group 组件的文章内，<code>group: group_name</code> 对应的组件名必须是 <code>group_name</code>。</li><li>group 组件的列表名优先显示文章的 <code>short_title</code> 其次是 <code>title</code>。</li></ol></div></div></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-10-链接卡片-link"><a href="#2-10-链接卡片-link" class="headerlink" title="2.10 链接卡片 link"></a>2.10 链接卡片 link</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% link 标题, 链接, 图片链接（可选） %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% link 糖果屋教程贴, https://akilar.top/posts/615e2dec/, https://cdn.cbd.int/akilar-candyassets@1.0.36/image/siteicon/favicon.ico %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><div class="tag link"><a class="link-card" title="糖果屋教程贴" href="https://akilar.top/posts/615e2dec/"><div class="left"><img src="https://cdn.cbd.int/akilar-candyassets@1.0.36/image/siteicon/favicon.ico"/></div><div class="right"><p class="text">糖果屋教程贴</p><p class="url">https://akilar.top/posts/615e2dec/</p></div></a></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-11-按钮-btns"><a href="#2-11-按钮-btns" class="headerlink" title="2.11 按钮 btns"></a>2.11 按钮 btns</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">参数配置</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% btns 样式参数 %&#125;</span><br><span class="line">&#123;% cell 标题, 链接, 图片或者图标 %&#125;</span><br><span class="line">&#123;% cell 标题, 链接, 图片或者图标 %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li>圆角样式：rounded, circle</li><li>增加文字样式：可以在容器内增加 <code>&lt;b&gt;</code>标题<code>&lt;/b&gt;</code>和<code>&lt;p&gt;</code>描述文字<code>&lt;/p&gt;</code></li><li>布局方式：<br>默认为自动宽度，适合视野内只有一两个的情况。</li></ol><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>wide</td><td>宽一点的按钮</td></tr><tr><td>fill</td><td>填充布局，自动铺满至少一行，多了会换行</td></tr><tr><td>center</td><td>居中，按钮之间是固定间距</td></tr><tr><td>around</td><td>居中分散</td></tr><tr><td>grid2</td><td>等宽最多2列，屏幕变窄会适当减少列数</td></tr><tr><td>grid3</td><td>等宽最多3列，屏幕变窄会适当减少列数</td></tr><tr><td>grid4</td><td>等宽最多4列，屏幕变窄会适当减少列数</td></tr><tr><td>grid5</td><td>等宽最多5列，屏幕变窄会适当减少列数</td></tr></tbody></table></div></div><div class="tab-item-content"><p>1.如果需要显示类似「团队成员」之类的一组含有头像的链接</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% btns circle grid5 %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><p>2.或者含有图标的按钮<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% btns rounded grid5 %&#125;</span><br><span class="line">&#123;% cell 下载源码, /, fas fa-download %&#125;</span><br><span class="line">&#123;% cell 查看文档, /, fas fa-book-open %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure></p><p>3.圆形图标 + 标题 + 描述 + 图片 + 网格5列 + 居中<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% btns circle center grid5 %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1&#x27;</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&#x27;fab fa-apple&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">b</span>&gt;</span></span>心率管家<span class="language-xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line">  &#123;% p red, 专业版 %&#125;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_pro.png&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1&#x27;</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&#x27;fab fa-apple&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">b</span>&gt;</span></span>心率管家<span class="language-xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line">  &#123;% p green, 免费版 %&#125;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_lite.png&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure></p></div><div class="tab-item-content"><p>1.如果需要显示类似「团队成员」之类的一组含有头像的链接</p><div class="btns circle grid5">            <a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a>          </div>2.或者含有图标的按钮<div class="btns rounded grid5">            <a class="button" href='/' title='下载源码'><i class='fas fa-download'></i>下载源码</a><a class="button" href='/' title='查看文档'><i class='fas fa-book-open'></i>查看文档</a>          </div>3.圆形图标 + 标题 + 描述 + 图片 + 网格5列 + 居中<div class="btns circle center grid5">            <a href='https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1'>  <i class='fab fa-apple'></i>  <b>心率管家</b>  <p class='p red'>专业版</p>  <img src='https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_pro.png'></a><a href='https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1'>  <i class='fab fa-apple'></i>  <b>心率管家</b>  <p class='p green'>免费版</p>  <img src='https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_lite.png'></a>          </div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-12-github卡片-ghcard"><a href="#2-12-github卡片-ghcard" class="headerlink" title="2.12 github卡片 ghcard"></a>2.12 github卡片 ghcard</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">参数配置</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% ghcard 用户名, 其它参数（可选） %&#125;</span><br><span class="line">&#123;% ghcard 用户名/仓库, 其它参数（可选） %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>使用<code>,</code>分割各个参数。写法为：<code>参数名=参数值</code><br>以下只写几个常用参数值。</p><div class="table-container"><table><thead><tr><th><strong>参数名</strong></th><th>取值</th><th>释义</th></tr></thead><tbody><tr><td>hide</td><td>stars,commits,prs,issues,contribs</td><td>隐藏指定统计</td></tr><tr><td>count_private</td><td>true</td><td>将私人项目贡献添加到总提交计数中</td></tr><tr><td>show_icons</td><td>true</td><td>显示图标</td></tr><tr><td>theme</td><td>查阅:<a href="https://github.com/anuraghazra/github-readme-stats/blob/master/themes/README.md">Available Themes</a></td><td>主题</td></tr></tbody></table></div></div><div class="tab-item-content"><p>1.用户信息卡片</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">| &#123;% ghcard fomalhaut1998 %&#125; | &#123;% ghcard fomalhaut1998, theme=vue %&#125; |</span><br><span class="line">| -- | -- |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=buefy %&#125; | &#123;% ghcard fomalhaut1998, theme=solarized-light %&#125; |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=onedark %&#125; | &#123;% ghcard fomalhaut1998, theme=solarized-dark %&#125; |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=algolia %&#125; | &#123;% ghcard fomalhaut1998, theme=calm %&#125; |</span><br></pre></td></tr></table></figure><p>2.仓库信息卡片</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=vue %&#125; |</span><br><span class="line">| -- | -- |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=buefy %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-light %&#125; |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=onedark %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-dark %&#125; |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=algolia %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=calm %&#125; |</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>1.用户信息卡片</p><div class="table-container"><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=calm&show_owner=true"/></a></td></tr></tbody></table></div><p>2.仓库信息卡片</p><div class="table-container"><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=calm&show_owner=true"/></a></td></tr></tbody></table></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-13-github徽标-ghbdage"><a href="#2-13-github徽标-ghbdage" class="headerlink" title="2.13 github徽标 ghbdage"></a>2.13 github徽标 ghbdage</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">配置参数</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% bdage [right],[left],[logo]||[color],[link],[title]||[option] %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><code>left</code>：徽标左边的信息，必选参数。</li><li><code>right</code>: 徽标右边的信息，必选参数，</li><li><code>logo</code>：徽标图标，图标名称详见<a href="https://simpleicons.org/">simpleicons</a>，可选参数。</li><li><code>color</code>：徽标右边的颜色，可选参数。</li><li><code>link</code>：指向的链接，可选参数。</li><li><code>title</code>：徽标的额外信息，可选参数。主要用于优化SEO，但<code>object</code>标签不会像<code>a</code>标签一样在鼠标悬停显示<code>title</code>信息。</li><li><code>option</code>：自定义参数，支持<a href="https://shields.io/">shields.io</a>的全部API参数支持，具体参数可以参看上文中的拓展写法示例。形式为<code>name1=value2&amp;name2=value2</code>。</li></ol></div><div class="tab-item-content"><p>1.基本参数,定义徽标左右文字和图标</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% bdage Theme,Butterfly %&#125;</span><br><span class="line">&#123;% bdage Frame,Hexo,hexo %&#125;</span><br></pre></td></tr></table></figure><p>2.信息参数，定义徽标右侧内容背景色，指向链接</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% bdage CDN,JsDelivr,jsDelivr||abcdef,https://metroui.org.ua/index.html,本站使用JsDelivr为静态资源提供CDN加速 %&#125;</span><br><span class="line">//如果是跨顺序省略可选参数，仍然需要写个逗号,用作分割</span><br><span class="line">&#123;% bdage Source,GitHub,GitHub||,https://github.com/ %&#125;</span><br></pre></td></tr></table></figure><p>3.拓展参数，支持shields的API的全部参数内容</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% bdage Hosted,Vercel,Vercel||brightgreen,https://vercel.com/,本站采用双线部署，默认线路托管于Vercel||style=social&amp;logoWidth=20 %&#125;</span><br><span class="line">//如果是跨顺序省略可选参数组，仍然需要写双竖线||用作分割</span><br><span class="line">&#123;% bdage Hosted,Vercel,Vercel||||style=social&amp;logoWidth=20&amp;logoColor=violet %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>1.基本参数,定义徽标左右文字和图标</p><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Butterfly-Theme-orange?logo=&color=orange&link=&"></object><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Hexo-Frame-orange?logo=hexo&color=orange&link=&"></object><p>2.信息参数，定义徽标右侧内容背景色，指向链接</p><object class="ghbdage" style="margin-inline:5px" title="本站使用JsDelivr为静态资源提供CDN加速" standby="loading..." data="https://img.shields.io/badge/JsDelivr-CDN-orange?logo=jsDelivr&color=abcdef&link=https://metroui.org.ua/index.html&"></object>//如果是跨顺序省略可选参数，仍然需要写个逗号,用作分割<object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/GitHub-Source-orange?logo=GitHub&color=orange&link=https://github.com/&"></object><p>3.拓展参数，支持shields的API的全部参数内容</p><object class="ghbdage" style="margin-inline:5px" title="本站采用双线部署，默认线路托管于Vercel" standby="loading..." data="https://img.shields.io/badge/Vercel-Hosted-orange?logo=Vercel&color=brightgreen&link=https://vercel.com/&style=social&logoWidth=20"></object>//如果是跨顺序省略可选参数组，仍然需要写双竖线||用作分割<object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Vercel-Hosted-orange?logo=Vercel&color=orange&link=&style=social&logoWidth=20&logoColor=violet"></object></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-14-网站卡片-sites"><a href="#2-14-网站卡片-sites" class="headerlink" title="2.14 网站卡片 sites"></a>2.14 网站卡片 sites</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% sitegroup %&#125;</span><br><span class="line">&#123;% site 标题, url=链接, screenshot=截图链接, avatar=头像链接（可选）, description=描述（可选） %&#125;</span><br><span class="line">&#123;% site 标题, url=链接, screenshot=截图链接, avatar=头像链接（可选）, description=描述（可选） %&#125;</span><br><span class="line">&#123;% endsitegroup %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% sitegroup %&#125;</span><br><span class="line">&#123;% site xaoxuu, url=https://xaoxuu.com, screenshot=https://i.loli.net/2020/08/21/VuSwWZ1xAeUHEBC.jpg, avatar=https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/avatar/avatar.png, description=简约风格 %&#125;</span><br><span class="line">&#123;% site inkss, url=https://inkss.cn, screenshot=https://i.loli.net/2020/08/21/Vzbu3i8fXs6Nh5Y.jpg, avatar=https://cdn.jsdelivr.net/gh/inkss/common@master/static/web/avatar.jpg, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% site MHuiG, url=https://blog.mhuig.top, screenshot=https://i.loli.net/2020/08/22/d24zpPlhLYWX6D1.png, avatar=https://cdn.jsdelivr.net/gh/MHuiG/imgbed@master/data/p.png, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% site Colsrch, url=https://colsrch.top, screenshot=https://i.loli.net/2020/08/22/dFRWXm52OVu8qfK.png, avatar=https://cdn.jsdelivr.net/gh/Colsrch/images/Colsrch/avatar.jpg, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% site Linhk1606, url=https://linhk1606.github.io, screenshot=https://i.loli.net/2020/08/21/3PmGLCKicnfow1x.png, avatar=https://i.loli.net/2020/02/09/PN7I5RJfFtA93r2.png, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% endsitegroup %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><div class="site-card-group"><a class="site-card" href="https://fomalhaut1998.com"><div class="img"><img src="https://i.loli.net/2020/08/21/VuSwWZ1xAeUHEBC.jpg"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/avatar/avatar.png"/><span class="title">fomalhaut1998</span><span class="desc">简约风格</span></div></a><a class="site-card" href="https://inkss.cn"><div class="img"><img src="https://i.loli.net/2020/08/21/Vzbu3i8fXs6Nh5Y.jpg"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/inkss/common@master/static/web/avatar.jpg"/><span class="title">inkss</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a><a class="site-card" href="https://blog.mhuig.top"><div class="img"><img src="https://i.loli.net/2020/08/22/d24zpPlhLYWX6D1.png"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/MHuiG/imgbed@master/data/p.png"/><span class="title">MHuiG</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a><a class="site-card" href="https://colsrch.top"><div class="img"><img src="https://i.loli.net/2020/08/22/dFRWXm52OVu8qfK.png"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/Colsrch/images/Colsrch/avatar.jpg"/><span class="title">Colsrch</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a><a class="site-card" href="https://linhk1606.github.io"><div class="img"><img src="https://i.loli.net/2020/08/21/3PmGLCKicnfow1x.png"/></div><div class="info"><img src="https://i.loli.net/2020/02/09/PN7I5RJfFtA93r2.png"/><span class="title">Linhk1606</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-15-行内图片-inlineimage"><a href="#2-15-行内图片-inlineimage" class="headerlink" title="2.15 行内图片 inlineimage"></a>2.15 行内图片 inlineimage</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">参数配置</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% inlineimage 图片链接, height=高度（可选） %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><code>高度</code>：height=20px</li></ol></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">这是 &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif %&#125; 一段话。</span><br><span class="line"></span><br><span class="line">这又是 &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif, height=40px %&#125; 一段话。</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>这是 <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif" style="height:1.5em"/> 一段话。</p><p>这又是 <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif" style="height:40px;"/> 一段话。</p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-16-单张图片-image"><a href="#2-16-单张图片-image" class="headerlink" title="2.16 单张图片 image"></a>2.16 单张图片 image</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">参数配置</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% image 链接, width=宽度（可选）, height=高度（可选）, alt=描述（可选）, bg=占位颜色（可选） %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li>图片宽度高度：width=300px, height=32px</li><li>图片描述：alt=图片描述（butterfly需要在主题配置文件中开启图片描述）</li><li>占位背景色：bg=#f2f2f2</li></ol></div><div class="tab-item-content"><p>1.添加描述：<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, alt=每天下课回宿舍的路，没有什么故事。 %&#125;</span><br></pre></td></tr></table></figure><br>2.指定宽度<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px %&#125;</span><br></pre></td></tr></table></figure><br>3.指定宽度并添加描述：<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, alt=每天下课回宿舍的路，没有什么故事。 %&#125;</span><br></pre></td></tr></table></figure><br>4.设置占位背景色：<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, bg=#1D0C04, alt=优化不同宽度浏览的观感 %&#125;</span><br></pre></td></tr></table></figure></p></div><div class="tab-item-content"><p>1.添加描述：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="每天下课回宿舍的路，没有什么故事。"/></div><span class="image-caption">每天下课回宿舍的路，没有什么故事。</span></div>2..指定宽度<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" style="width:400px;"/></div></div>3.指定宽度并添加描述：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="每天下课回宿舍的路，没有什么故事。" style="width:400px;"/></div><span class="image-caption">每天下课回宿舍的路，没有什么故事。</span></div>4.设置占位背景色：<div class="img-wrap"><div class="img-bg" style="background:#1D0C04"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="优化不同宽度浏览的观感" style="width:400px;"/></div><span class="image-caption">优化不同宽度浏览的观感</span></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-17-音频-audio"><a href="#2-17-音频-audio" class="headerlink" title="2.17 音频 audio"></a>2.17 音频 audio</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% audio 音频链接 %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% audio https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3 %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><div class="audio"><audio controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3' type='audio/mp3'>Your browser does not support the audio tag.</audio></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-18-视频-video"><a href="#2-18-视频-video" class="headerlink" title="2.18 视频 video"></a>2.18 视频 video</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">标签语法</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% video 视频链接 %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><code>对齐方向</code>：left, center, right</li><li><code>列数</code>：逗号后面直接写列数，支持 1 ～ 4 列。</li></ol></div><div class="tab-item-content"><p>1.100%宽度</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br></pre></td></tr></table></figure><p>2.50%宽度<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% videos, 2 %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% endvideos %&#125;</span><br></pre></td></tr></table></figure><br>3.25%宽度</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% videos, 4 %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% endvideos %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>1.100%宽度</p><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div>2.50%宽度<div class="videos" col='2'><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div></div>3.25%宽度<div class="videos" col='4'><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-19-相册-gallery"><a href="#2-19-相册-gallery" class="headerlink" title="2.19 相册 gallery"></a>2.19 相册 gallery</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">参数配置</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><p>1.gallerygroup 相册图库<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>2.gallery 相册<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">markdown 圖片格式</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure></p></div><div class="tab-item-content"><ul><li>gallerygroup 相册图库</li></ul><div class="table-container"><table><thead><tr><th>参数名</th><th>释义</th></tr></thead><tbody><tr><td>name</td><td>图库名字</td></tr><tr><td>description</td><td>图库描述</td></tr><tr><td>link</td><td>链接到对应相册的地址</td></tr><tr><td>img-url</td><td>图库封面</td></tr></tbody></table></div><ul><li><p>gallery 相册</p><p>区别于旧版的Gallery相册,新的Gallery相册会自动根据图片长度进行排版，书写也更加方便，与markdown格式一样。可根据需要插入到相应的md。无需再自己配置长宽。<strong>建议在粘贴时故意使用长短、大小、横竖不一的图片</strong>，会有更好的效果。（尺寸完全相同的图片只会平铺输出，效果很糟糕）</p></li></ul></div><div class="tab-item-content"><p>1.gallerygroup 相册图库</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup MC 在Rikkaの六花服务器里留下的足迹 &#x27;/gallery/MC/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/1.jpg %&#125;</span><br><span class="line">&#123;% galleryGroup Gundam 哦咧哇gundam哒！ &#x27;/gallery/Gundam/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907110508327.png %&#125;</span><br><span class="line">&#123;% galleryGroup I-am-Akilar 某种意义上也算自拍吧 &#x27;/gallery/I-am-Akilar/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907113116651.png %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>2.gallery 相册</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![](<span class="link">https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg</span>)</span><br><span class="line">![](<span class="link">https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg</span>)</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>1.gallerygroup 相册图库</p><div class="gallery-group-main"><figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/1.jpg' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">MC</div>  <p>在Rikkaの六花服务器里留下的足迹</p>  <a href='/gallery/MC/'></a>  </figcaption>  </figure><figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907110508327.png' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">Gundam</div>  <p>哦咧哇gundam哒！</p>  <a href='/gallery/Gundam/'></a>  </figcaption>  </figure><figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907113116651.png' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">I-am-Akilar</div>  <p>某种意义上也算自拍吧</p>  <a href='/gallery/I-am-Akilar/'></a>  </figcaption>  </figure></div>2.gallery 相册<div class="gallery-container" data-type="data" data-button="">      <div class="gallery-items">[{"url":"https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg","alt":""},{"url":"https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg","alt":""}]</div>    </div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-20-折叠框-folding"><a href="#2-20-折叠框-folding" class="headerlink" title="2.20 折叠框 folding"></a>2.20 折叠框 folding</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><p>1.gallerygroup 相册图库<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% folding 参数（可选）, 标题 %&#125;</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg</span>)</span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure><br><!-- tab 参数配置 --></p><ol><li><p><code>颜色</code>：blue, cyan, green, yellow, red</p></li><li><p><code>状态</code>：状态填写 open 代表默认打开。</p></li></ol></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% folding 查看图片测试 %&#125;</span><br><span class="line"></span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg</span>)</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding cyan open, 查看默认打开的折叠框 %&#125;</span><br><span class="line"></span><br><span class="line">这是一个默认打开的折叠框。</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding green, 查看代码测试 %&#125;</span><br><span class="line">假装这里有代码块（代码块没法嵌套代码块）</span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding yellow, 查看列表测试 %&#125;</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> haha</span><br><span class="line"><span class="bullet">-</span> hehe</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding red, 查看嵌套测试 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding blue, 查看嵌套测试2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding 查看嵌套测试3 %&#125;</span><br><span class="line"></span><br><span class="line">hahaha <span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;height:24px&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><details class="folding-tag" ><summary> 查看图片测试 </summary>              <div class='content'>              <p><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg" alt=""></p>              </div>            </details><details class="folding-tag" cyan open><summary> 查看默认打开的折叠框 </summary>              <div class='content'>              <p>这是一个默认打开的折叠框。</p>              </div>            </details><details class="folding-tag" green><summary> 查看代码测试 </summary>              <div class='content'>              <p>假装这里有代码块（代码块没法嵌套代码块）</p>              </div>            </details><details class="folding-tag" yellow><summary> 查看列表测试 </summary>              <div class='content'>              <ul><li>haha</li><li>hehe</li></ul>              </div>            </details><details class="folding-tag" red><summary> 查看嵌套测试 </summary>              <div class='content'>              <details class="folding-tag" blue><summary> 查看嵌套测试2 </summary>              <div class='content'>              <details class="folding-tag" ><summary> 查看嵌套测试3 </summary>              <div class='content'>              <p>hahaha <span><img src='https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png' style='height:24px'></span></p>              </div>            </details>              </div>            </details>              </div>            </details></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-21-分栏-tab"><a href="#2-21-分栏-tab" class="headerlink" title="2.21 分栏 tab"></a>2.21 分栏 tab</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">配置参数</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% tabs Unique name, [index] %&#125;</span><br><span class="line">&lt;!-- tab [Tab caption] [@icon] --&gt;</span><br><span class="line">Any content (support inline tags too).</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><p>Unique name :</p><ul><li><p>选项卡块标签的唯一名称，不带逗号。</p></li><li><p>将在#id中用作每个标签及其索引号的前缀。</p></li><li><p>如果名称中包含空格，则对于生成#id，所有空格将由破折号代替。</p></li><li><p>仅当前帖子/页面的URL必须是唯一的！</p></li></ul></li><li><p>[index]:</p><ul><li><p>活动选项卡的索引号。</p></li><li><p>如果未指定，将选择第一个标签（1）。</p></li><li><p>如果index为-1，则不会选择任何选项卡。</p></li><li><p>可选参数。</p></li></ul></li><li><p>[Tab caption]:</p><ul><li><p>当前选项卡的标题。</p></li><li><p>如果未指定标题，则带有制表符索引后缀的唯一名称将用作制表符的标题。</p></li><li><p>如果未指定标题，但指定了图标，则标题将为空。</p></li><li><p>可选参数。</p></li></ul></li><li><p>[@icon]:</p><ul><li><p>FontAwesome图标名称（全名，看起来像“ fas fa-font”）</p></li><li><p>可以指定带空格或不带空格；</p></li><li><p>例如’Tab caption @icon’ 和 ‘Tab caption@icon’.</p></li><li><p>可选参数。</p></li></ul></li></ol></div><div class="tab-item-content"><p>1.Demo 1 - 预设选择第一个【默认】</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% tabs test1 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>2.Demo 2 - 预设选择tabs</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% tabs test2, 3 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>3.Demo 3 - 没有预设值</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% tabs test3, -1 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>4.Demo 4 - 自定义Tab名 + 只有icon + icon和Tab名</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% tabs test4 %&#125;</span><br><span class="line">&lt;!-- tab 第一个Tab --&gt;</span><br><span class="line"><span class="strong">**tab名字为第一个Tab**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab @fab fa-apple-pay --&gt;</span><br><span class="line"><span class="strong">**只有图标 没有Tab名字**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab 炸弹@fas fa-bomb --&gt;</span><br><span class="line"><span class="strong">**名字+icon**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>1.Demo 1 - 预设选择第一个【默认】</p><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">test1 1</button><button type="button" class="tab">test1 2</button><button type="button" class="tab">test1 3</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>This is Tab 1.</strong></p></div><div class="tab-item-content"><p><strong>This is Tab 2.</strong></p></div><div class="tab-item-content"><p><strong>This is Tab 3.</strong></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><p>2.Demo 2 - 预设选择tabs</p><div class="tabs"><div class="nav-tabs"><button type="button" class="tab">test2 1</button><button type="button" class="tab">test2 2</button><button type="button" class="tab active">test2 3</button></div><div class="tab-contents"><div class="tab-item-content"><p><strong>This is Tab 1.</strong></p></div><div class="tab-item-content"><p><strong>This is Tab 2.</strong></p></div><div class="tab-item-content active"><p><strong>This is Tab 3.</strong></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><p>3.Demo 3 - 没有预设值</p><div class="tabs"><div class="nav-tabs no-default"><button type="button" class="tab">test3 1</button><button type="button" class="tab">test3 2</button><button type="button" class="tab">test3 3</button></div><div class="tab-contents"><div class="tab-item-content"><p><strong>This is Tab 1.</strong></p></div><div class="tab-item-content"><p><strong>This is Tab 2.</strong></p></div><div class="tab-item-content"><p><strong>This is Tab 3.</strong></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><p>4.Demo 4 - 自定义Tab名 + 只有icon + icon和Tab名</p><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">第一个Tab</button><button type="button" class="tab"><i class="fab fa-apple-pay"></i></button><button type="button" class="tab"><i class="fas fa-bomb"></i>炸弹</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>tab名字为第一个Tab</strong></p></div><div class="tab-item-content"><p><strong>只有图标 没有Tab名字</strong></p></div><div class="tab-item-content"><p><strong>名字+icon</strong></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-22-诗词标签-poem"><a href="#2-22-诗词标签-poem" class="headerlink" title="2.22 诗词标签 poem"></a>2.22 诗词标签 poem</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">参数配置</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><ol><li><code>title</code>：诗词标题</li><li><code>author</code>：作者，可以不写</li></ol></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% poem 水调歌头,苏轼 %&#125;</span><br><span class="line">丙辰中秋，欢饮达旦，大醉，作此篇，兼怀子由。</span><br><span class="line">明月几时有？把酒问青天。</span><br><span class="line">不知天上宫阙，今夕是何年？</span><br><span class="line">我欲乘风归去，又恐琼楼玉宇，高处不胜寒。</span><br><span class="line">起舞弄清影，何似在人间？</span><br><span class="line"></span><br><span class="line">转朱阁，低绮户，照无眠。</span><br><span class="line">不应有恨，何事长向别时圆？</span><br><span class="line">人有悲欢离合，月有阴晴圆缺，此事古难全。</span><br><span class="line">但愿人长久，千里共婵娟。</span><br><span class="line">&#123;% endpoem %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><div class='poem'><div class='poem-title'>水调歌头</div><div class='poem-author'>苏轼</div><p>丙辰中秋，欢饮达旦，大醉，作此篇，兼怀子由。<br>明月几时有？把酒问青天。<br>不知天上宫阙，今夕是何年？<br>我欲乘风归去，又恐琼楼玉宇，高处不胜寒。<br>起舞弄清影，何似在人间？</p><p>转朱阁，低绮户，照无眠。<br>不应有恨，何事长向别时圆？<br>人有悲欢离合，月有阴晴圆缺，此事古难全。<br>但愿人长久，千里共婵娟。</p></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-23-阿里图标-icon"><a href="#2-23-阿里图标-icon" class="headerlink" title="2.23 阿里图标 icon"></a>2.23 阿里图标 icon</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">参数配置</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% icon [icon-xxxx],[font-size] %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><code>icon-xxxx</code>：表示图标<code>font-class</code>,可以在自己的阿里矢量图标库项目的<code>font-class</code>引用方案内查询并复制。</li><li><code>font-size</code>：表示图标大小，直接填写数字即可，单位为<code>em</code>。图标大小默认值为<code>1em</code>。</li></ol></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% icon icon-rat<span class="emphasis">_zi %&#125;&#123;% icon icon-rat,2 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-ox_</span>chou,3 %&#125;&#123;% icon icon-ox,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-tiger<span class="emphasis">_yin,5 %&#125;&#123;% icon icon-tiger,6 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-rabbit_</span>mao,1 %&#125;&#123;% icon icon-rabbit,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-dragon<span class="emphasis">_chen,3 %&#125;&#123;% icon icon-dragon,4 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-snake_</span>si,5 %&#125;&#123;% icon icon-snake,6 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-horse<span class="emphasis">_wu %&#125;&#123;% icon icon-horse,2 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-goat_</span>wei,3 %&#125;&#123;% icon icon-goat,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-monkey<span class="emphasis">_shen,5 %&#125;&#123;% icon icon-monkey,6 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-rooster_</span>you %&#125;&#123;% icon icon-rooster,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-dog<span class="emphasis">_xu,3 %&#125;&#123;% icon icon-dog,4 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-boar_</span>hai,5 %&#125;&#123;% icon icon-boar,6 %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rat_zi"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rat"></use></svg><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-ox_chou"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-ox"></use></svg><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-tiger_yin"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-tiger"></use></svg><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rabbit_mao"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rabbit"></use></svg><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-dragon_chen"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-dragon"></use></svg><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-snake_si"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-snake"></use></svg><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-horse_wu"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-horse"></use></svg><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-goat_wei"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-goat"></use></svg><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-monkey_shen"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-monkey"></use></svg><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rooster_you"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rooster"></use></svg><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-dog_xu"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-dog"></use></svg><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-boar_hai"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-boar"></use></svg></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-24-特效标签wow"><a href="#2-24-特效标签wow" class="headerlink" title="2.24 特效标签wow"></a>2.24 特效标签wow</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">示例源码</button><button type="button" class="tab">渲染演示</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% wow [animete],[duration],[delay],[offset],[iteration] %&#125;</span><br><span class="line">内容</span><br><span class="line">&#123;% endwow %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><code>animate</code>: 动画样式，效果详见<a href="https://animate.style/">animate.css参考文档</a></li><li><code>duration</code>: 选填项，动画持续时间，单位可以是<code>ms</code>也可以是<code>s</code>。例如<code>3s</code>，<code>700ms</code>。</li><li><code>delay</code>: 选填项，动画开始的延迟时间，单位可以是<code>ms</code>也可以是<code>s</code>。例如<code>3s</code>，<code>700ms</code>。</li><li><code>offset</code>: 选填项，开始动画的距离（相对浏览器底部）</li><li><code>iteration</code>: 选填项，动画重复的次数</li></ol></div><div class="tab-item-content"><p>1.flip动画效果。<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__zoomIn,5s,5s,100,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`zoomIn`动画效果，持续`5s`，延时`5s`，离底部`100`距离时启动，重复`10`次</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><br>2.zoomIn动画效果，持续5s，延时5s，离底部100距离时启动，重复10次<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__zoomIn,5s,5s,100,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`zoomIn`动画效果，持续`5s`，延时`5s`，离底部`100`距离时启动，重复`10`次</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><br>3.slideInRight动画效果，持续5s，延时5s<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__slideInRight,5s,5s %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note orange &#x27;fas fa-car&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`slideInRight`动画效果，持续`5s`，延时`5s`。</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><br>4.heartBeat动画效果，延时5s，重复10次。此处注意不用的参数位置要留空，用逗号间隔。<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__heartBeat,,5s,,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note red &#x27;fas fa-battery-half&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`heartBeat`动画效果，延时`5s`，重复`10`次。</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure></p></div><div class="tab-item-content"><p>1.flip动画效果。</p><div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p><code>zoomIn</code>动画效果，持续<code>5s</code>，延时<code>5s</code>，离底部<code>100</code>距离时启动，重复<code>10</code>次</p></div></div><p>2.zoomIn动画效果，持续5s，延时5s，离底部100距离时启动，重复10次</p><div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p><code>zoomIn</code>动画效果，持续<code>5s</code>，延时<code>5s</code>，离底部<code>100</code>距离时启动，重复<code>10</code>次</p></div></div><p>3.slideInRight动画效果，持续5s，延时5s</p><div class='wow animate__slideInRight' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-car"></i><p><code>slideInRight</code>动画效果，持续<code>5s</code>，延时<code>5s</code>。</p></div></div><p>4.heartBeat动画效果，延时5s，重复10次。此处注意不用的参数位置要留空，用逗号间隔。</p><div class='wow animate__heartBeat' data-wow-duration='' data-wow-delay='5s' data-wow-offset=''  data-wow-iteration='10' ><div class="note red icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p><code>heartBeat</code>动画效果，延时<code>5s</code>，重复<code>10</code>次。</p></div></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-25-进度条-progress"><a href="#2-25-进度条-progress" class="headerlink" title="2.25  进度条 progress"></a>2.25  进度条 progress</h2><div class="note info flat"><p>进度条标签参考<a href="https://rongbuqiu.com/jdt.html">沂佰孜猫-给HEXO文章添加彩色进度条</a>。<br>源样式提取自<a href="https://zwying0814.gitbook.io/cuteen/">Cuteen</a>主题。</p></div><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">参数配置</button><button type="button" class="tab">标签语法</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% progress [width] [color] [text] %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><code>width</code>: 0到100的阿拉伯数字</li><li><code>color</code>: 颜色，取值有red,yellow,green,cyan,blue,gray</li><li><code>text</code>:进度条上的文字内容</li></ol></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% progress 10 red 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 30 yellow 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 50 green 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 70 cyan 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 90 blue 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 100 gray 进度条样式预览 %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-red"  style="width: 10%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-yellow"  style="width: 30%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-green"  style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-cyan"  style="width: 70%" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 90%" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-gray"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-26-注释-notation"><a href="#2-26-注释-notation" class="headerlink" title="2.26 注释 notation"></a>2.26 注释 notation</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">参数配置</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% nota [label] , [text] %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><p><code>label</code>: 注释词汇</p></li><li><p><code>text</code>: 悬停显示的注解内容</p></li></ol></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% nota 把鼠标移动到我上面试试 ,可以看到注解内容出现在顶栏 %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p><span class='nota' data-nota='可以看到注解内容出现在顶栏'>把鼠标移动到我上面试试</span></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-27-气泡注释-bubble"><a href="#2-27-气泡注释-bubble" class="headerlink" title="2.27 气泡注释 bubble"></a>2.27 气泡注释 bubble</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">参数配置</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% bubble [content] , [notation] ,[background-color] %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><code>content</code>: 注释词汇</li><li><code>notation</code>: 悬停显示的注解内容</li><li><code>background-color</code>: 可选，气泡背景色。默认为“#71a4e3”</li></ol></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">最近我学到了不少新玩意儿（虽然对很多大佬来说这些已经是旧技术了），比如CSS的&#123;% bubble 兄弟相邻选择器,&quot;例如 h1 + p &#123;margin-top:50px;&#125;&quot; %&#125;，&#123;% bubble flex布局,&quot;Flex 是 Flexible Box 的缩写，意为&quot;弹性布局&quot;，用来为盒状模型提供最大的灵活性&quot;,&quot;#ec5830&quot; %&#125;，&#123;% bubble transform变换,&quot;transform 属性向元素应用 2D 或 3D 转换。该属性允许我们对元素进行旋转、缩放、移动或倾斜。&quot;,&quot;#1db675&quot; %&#125;，animation的&#123;% bubble 贝塞尔速度曲线,&quot;贝塞尔曲线(Bézier curve)，又称贝兹曲线或贝济埃曲线，是应用于二维图形应用程序的数学曲线。一般的矢量图形软件通过它来精确画出曲线，贝兹曲线由线段与节点组成，节点是可拖动的支点，线段像可伸缩的皮筋&quot;,&quot;#de4489&quot; %&#125;写法，还有今天刚看到的&#123;% bubble clip-path,&quot;clip-path属性使用裁剪方式创建元素的可显示区域。区域内的部分显示，区域外的隐藏。&quot;,&quot;#868fd7&quot; %&#125;属性。这些对我来说很新颖的概念狠狠的冲击着我以前积累起来的设计思路。</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>最近我学到了不少新玩意儿（虽然对很多大佬来说这些已经是旧技术了），比如CSS的<span class="bubble-content">兄弟相邻选择器</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;">例如 h1 + p {margin-top:50px;}</span>&lt;/span&gt;，<span class="bubble-content">flex布局</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#ec5830;">Flex 是 Flexible Box 的缩写，意为弹性布局”，用来为盒状模型提供最大的灵活性”</span>&lt;/span&gt;，<span class="bubble-content">transform变换</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#1db675;">transform 属性向元素应用 2D 或 3D 转换。该属性允许我们对元素进行旋转、缩放、移动或倾斜。</span>&lt;/span&gt;，animation的<span class="bubble-content">贝塞尔速度曲线</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#de4489;">贝塞尔曲线(Bézier curve)，又称贝兹曲线或贝济埃曲线，是应用于二维图形应用程序的数学曲线。一般的矢量图形软件通过它来精确画出曲线，贝兹曲线由线段与节点组成，节点是可拖动的支点，线段像可伸缩的皮筋</span>&lt;/span&gt;写法，还有今天刚看到的<span class="bubble-content">clip-path</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#868fd7;">clip-path属性使用裁剪方式创建元素的可显示区域。区域内的部分显示，区域外的隐藏。</span>&lt;/span&gt;属性。这些对我来说很新颖的概念狠狠的冲击着我以前积累起来的设计思路。</p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-28-引用文献-reference"><a href="#2-28-引用文献-reference" class="headerlink" title="2.28 引用文献 reference"></a>2.28 引用文献 reference</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">参数配置</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% referto [id] , [literature] %&#125;</span><br><span class="line">&#123;% referfrom [id] , [literature] , [url] %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><p>referto 引用上标</p><ul><li><p><code>id</code>: 上标序号内容，需与referfrom标签的id对应才能实现跳转</p></li><li><p><code>literature</code>: 引用的参考文献名称</p></li></ul></li><li><p>referfrom 引用出处</p><ul><li><p><code>id</code>: 序号内容，需与referto标签的id对应才能实现 跳转</p></li><li><p><code>literature</code>: 引用的参考文献名称</p></li><li><p><code>url</code>: 引用的参考文献链接，可省略</p></li></ul></li></ol></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">Akilarの糖果屋(akilar.top)是一个私人性质的博客&#123;% referto &#x27;[1]&#x27;,&#x27;Akilarの糖果屋群聊简介&#x27; %&#125;，从各类教程至生活点滴，无话不谈。建群的目的是提供一个闲聊的场所。博客采用Hexo框架&#123;% referto &#x27;[2]&#x27;,&#x27;Hexo中文文档&#x27; %&#125;，Butterfly主题&#123;% referto &#x27;[3]&#x27;,&#x27;Butterfly 安装文档(一) 快速开始&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">本项目参考了Volantis&#123;% referto &#x27;[4]&#x27;,&#x27;hexo-theme-volantis 标签插件&#x27; %&#125;的标签样式。引入<span class="code">`[tag].js`</span>，并针对<span class="code">`butterfly`</span>主题修改了相应的<span class="code">`[tag].styl`</span>。在此鸣谢<span class="code">`Volantis`</span>主题众开发者。</span><br><span class="line">主要参考内容包括各个volantis的内置标签插件文档&#123;% referto &#x27;[5]&#x27;,&#x27;Volantis文档:内置标签插件&#x27; %&#125;</span><br><span class="line">Butterfly主题的各个衍生魔改&#123;% referto &#x27;[6]&#x27;,&#x27;Butterfly 安装文档:标签外挂（Tag Plugins&#x27; %&#125;&#123;% referto &#x27;[7]&#x27;,&#x27;小弋の生活馆全样式预览&#x27; %&#125;&#123;% referto &#x27;[8]&#x27;,&#x27;l-lin-font-awesome-animation&#x27; %&#125;&#123;% referto &#x27;[9]&#x27;,&#x27;小康的butterfly主题使用文档&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% referfrom &#x27;[1]&#x27;,&#x27;Akilarの糖果屋群聊简介&#x27;,&#x27;https://jq.qq.com/?<span class="emphasis">_wv=1027&amp;k=pGLB2C0N&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[2]&#x27;,&#x27;Hexo中文文档&#x27;,&#x27;https://hexo.io/zh-cn/docs/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[3]&#x27;,&#x27;Butterfly 安装文档(一) 快速开始&#x27;,&#x27;https://butterfly.js.org/posts/21cfbf15/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[4]&#x27;,&#x27;hexo-theme-volantis 标签插件&#x27;,&#x27;https://volantis.js.org/v5/tag-plugins/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[5]&#x27;,&#x27;Volantis文档:内置标签插件&#x27;,&#x27;https://volantis.js.org/tag-plugins/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[6]&#x27;,&#x27;Butterfly 安装文档:标签外挂（Tag Plugins&#x27;,&#x27;https://butterfly.js.org/posts/4aa8abbe/#%E6%A8%99%E7%B1%A4%E5%A4%96%E6%8E%9B%EF%BC%88Tag-Plugins%EF%BC%89&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[7]&#x27;,&#x27;小弋の生活馆全样式预览&#x27;,&#x27;https://lovelijunyi.gitee.io/posts/c898.html&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[8]&#x27;,&#x27;l-lin-font-awesome-animation&#x27;,&#x27;https://github.com/l-lin/font-awesome-animation&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[9]&#x27;,&#x27;小康的butterfly主题使用文档&#x27;,&#x27;https://www.antmoe.com/posts/3b43914f/&#x27; %&#125;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>Akilarの糖果屋(akilar.top)是一个私人性质的博客<span class="hidden-anchor" id="referto_[1]">&lt;/span&gt;<sup class="reference"><a href="#referfrom_[1]">[1]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Akilarの糖果屋群聊简介</span><span class="reference-title">参考资料</span>&lt;/span&gt;&lt;/span&gt;，从各类教程至生活点滴，无话不谈。建群的目的是提供一个闲聊的场所。博客采用Hexo框架<span class="hidden-anchor" id="referto_[2]">&lt;/span&gt;<sup class="reference"><a href="#referfrom_[2]">[2]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Hexo中文文档</span><span class="reference-title">参考资料</span>&lt;/span&gt;&lt;/span&gt;，Butterfly主题<span class="hidden-anchor" id="referto_[3]">&lt;/span&gt;<sup class="reference"><a href="#referfrom_[3]">[3]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Butterfly 安装文档(一) 快速开始</span><span class="reference-title">参考资料</span>&lt;/span&gt;&lt;/span&gt;</p><p>本项目参考了Volantis<span class="hidden-anchor" id="referto_[4]">&lt;/span&gt;<sup class="reference"><a href="#referfrom_[4]">[4]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">hexo-theme-volantis 标签插件</span><span class="reference-title">参考资料</span>&lt;/span&gt;&lt;/span&gt;的标签样式。引入<code>[tag].js</code>，并针对<code>butterfly</code>主题修改了相应的<code>[tag].styl</code>。在此鸣谢<code>Volantis</code>主题众开发者。<br>主要参考内容包括各个volantis的内置标签插件文档<span class="hidden-anchor" id="referto_[5]">&lt;/span&gt;<sup class="reference"><a href="#referfrom_[5]">[5]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Volantis文档:内置标签插件</span><span class="reference-title">参考资料</span>&lt;/span&gt;&lt;/span&gt;<br>Butterfly主题的各个衍生魔改<span class="hidden-anchor" id="referto_[6]">&lt;/span&gt;<sup class="reference"><a href="#referfrom_[6]">[6]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Butterfly 安装文档:标签外挂（Tag Plugins</span><span class="reference-title">参考资料</span>&lt;/span&gt;&lt;/span&gt;<span class="hidden-anchor" id="referto_[7]">&lt;/span&gt;<sup class="reference"><a href="#referfrom_[7]">[7]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">小弋の生活馆全样式预览</span><span class="reference-title">参考资料</span>&lt;/span&gt;&lt;/span&gt;<span class="hidden-anchor" id="referto_[8]">&lt;/span&gt;<sup class="reference"><a href="#referfrom_[8]">[8]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">l-lin-font-awesome-animation</span><span class="reference-title">参考资料</span>&lt;/span&gt;&lt;/span&gt;<span class="hidden-anchor" id="referto_[9]">&lt;/span&gt;<sup class="reference"><a href="#referfrom_[9]">[9]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">小康的butterfly主题使用文档</span><span class="reference-title">参考资料</span>&lt;/span&gt;&lt;/span&gt;</p><div class="reference-source"><span class="hidden-anchor" id="referfrom_[1]"></span><a class="reference-anchor" href="#referto_[1]">[1]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://jq.qq.com/?_wv=1027&k=pGLB2C0N">Akilarの糖果屋群聊简介</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[2]"></span><a class="reference-anchor" href="#referto_[2]">[2]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://hexo.io/zh-cn/docs/">Hexo中文文档</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[3]"></span><a class="reference-anchor" href="#referto_[3]">[3]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://butterfly.js.org/posts/21cfbf15/">Butterfly 安装文档(一) 快速开始</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[4]"></span><a class="reference-anchor" href="#referto_[4]">[4]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://volantis.js.org/v5/tag-plugins/">hexo-theme-volantis 标签插件</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[5]"></span><a class="reference-anchor" href="#referto_[5]">[5]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://volantis.js.org/tag-plugins/">Volantis文档:内置标签插件</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[6]"></span><a class="reference-anchor" href="#referto_[6]">[6]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://butterfly.js.org/posts/4aa8abbe/#%E6%A8%99%E7%B1%A4%E5%A4%96%E6%8E%9B%EF%BC%88Tag-Plugins%EF%BC%89">Butterfly 安装文档:标签外挂（Tag Plugins</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[7]"></span><a class="reference-anchor" href="#referto_[7]">[7]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://lovelijunyi.gitee.io/posts/c898.html">小弋の生活馆全样式预览</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[8]"></span><a class="reference-anchor" href="#referto_[8]">[8]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://github.com/l-lin/font-awesome-animation">l-lin-font-awesome-animation</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[9]"></span><a class="reference-anchor" href="#referto_[9]">[9]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://www.antmoe.com/posts/3b43914f/">小康的butterfly主题使用文档</a></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-29-PDF展示"><a href="#2-29-PDF展示" class="headerlink" title="2.29 PDF展示"></a>2.29 PDF展示</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">参数配置</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% pdf 文件路径 %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><code>文件路径</code>: 可以是相对路径或者是在线链接</li></ol></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="section"># 1.本地文件:在md文件路径下创建一个同名文件夹，其内放pdf文件名为xxx.pdf的文件</span></span><br><span class="line">&#123;% pdf xxx.pdf %&#125;</span><br><span class="line"><span class="section"># 2.在线链接</span></span><br><span class="line">&#123;% pdf https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/pdf/小作文讲义.pdf %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>2.在线链接(要放到最外层才能起作用)</p><pre><code>&lt;div class=&quot;row&quot;&gt;&lt;embed src=&quot;https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/pdf/小作文讲义.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;&lt;/div&gt;</code></pre></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-30-Hexo-tag-map-插件"><a href="#2-30-Hexo-tag-map-插件" class="headerlink" title="2.30 Hexo-tag-map 插件"></a>2.30 Hexo-tag-map 插件</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">参数配置</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% + 标签值 + 经度 + 纬度 + 文本 + 缩放等级 + 宽 + 高 + 默认图层 + %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><div class="table-container"><table><thead><tr><th style="text-align:center">地图名</th><th style="text-align:center">标签值 &lt;必填&gt;</th><th style="text-align:center">宽 (默认 100%) / 高 (默认 360px)</th><th style="text-align:center">缩放等级 (默认 14)</th><th style="text-align:center">宽 (默认 100%) / 高 (默认 360px)</th><th style="text-align:center">默认图层 (默认 1)</th></tr></thead><tbody><tr><td style="text-align:center">混合地图</td><td style="text-align:center">map</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 3~18</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~7</td></tr><tr><td style="text-align:center">谷歌地图</td><td style="text-align:center">googleMap</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~20</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~3</td></tr><tr><td style="text-align:center">高德地图</td><td style="text-align:center">gaodeMap</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 3~18</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~3</td></tr><tr><td style="text-align:center">百度地图</td><td style="text-align:center">baiduMap</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 4~18</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~2</td></tr><tr><td style="text-align:center">Geoq 地图</td><td style="text-align:center">geoqMap</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~18</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~5</td></tr><tr><td style="text-align:center">openstreet 地图</td><td style="text-align:center">openstreetMap</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~18</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">不支持此参数</td></tr></tbody></table></div><ol><li>参数之间，用英文逗号相隔</li><li>参数必须按上述事例顺序输入，不得为空</li><li>同一个页面，同一组经纬度值，只能插入一个相同标签值的地图 (若有需要，可以将第二个地图上，经度或纬度末尾删除一两个数)</li><li>参数取值必须在上述范围内</li><li>默认图层：即地图叠加层的值，默认常规地图还是卫星地图，可按地图显示顺序取值</li><li>缩放等级，数字越大，地图比例尺越小，显示的越精细</li><li>除标签值外，其他参数选填，但 每个参数的左边的参数必填</li><li>谷歌地图需要外网才能加载查看</li></ol><p>坐标获取：<a href="https://lbs.amap.com/tools/picker">高德地图坐标拾取系统</a> 、<a href="https://api.map.baidu.com/lbsapi/getpoint/index.html">百度地图坐标拾取系统</a></p></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% map 120.101101,30.239119 %&#125;</span><br><span class="line">&#123;% googleMap 120.101101,30.239119, 这里是西湖灵隐寺，据说求姻缘很灵验哦！ %&#125;</span><br><span class="line">&#123;% geoqMap 120.101101,30.239119, 这里是西湖灵隐寺，据说求姻缘很灵验哦！, 13, 90%, 320px, 3 %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div class="map-box" style="margin: 0.8rem 0 1.6rem 0;"><div id="map-120.101101-30.239119" style="max-width:100%; height:360px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div>&lt;/div&gt;<script type="text/javascript">var normalm=L.tileLayer.chinaProvider('GaoDe.Normal.Map',{maxZoom:20,minZoom:1,attribution:'高德地图'});var imgm=L.tileLayer.chinaProvider('GaoDe.Satellite.Map',{maxZoom:20,minZoom:1,attribution:'高德地图'});var imga=L.tileLayer.chinaProvider('GaoDe.Satellite.Annotion',{maxZoom:20,minZoom:1,attribution:'高德地图'});var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:20,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'});routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:21,minZoom:1});var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'}),routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:21,minZoom:1,attribution:'Google Maps'});var normalm1=L.tileLayer.chinaProvider('Geoq.Normal.Map',{maxZoom:21,minZoom:1,attribution:'GeoQ'});var normal=L.layerGroup([normalm]),image=L.layerGroup([imgm,imga]);var baseLayers={"高德地图":normal,"智图地图":normalm1,"谷歌地图":normalMap,"高德卫星地图":imgm,"谷歌卫星地图":satelliteMap,"高德卫星标注":image,"谷歌卫星标注":routeMap};var mymap=L.map('map-120.101101-30.239119',{center:[30.239119,120.101101],zoom:14,layers:[normal],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'放大',zoomOutTitle:'缩小'}).addTo(mymap);</script><br><br></p><p><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div id="googleMap-120.101101-30.239119" style="max-width:100%; height:360px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div><script type="text/javascript">var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:22,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:22,minZoom:1,attribution:'Google Maps'}),routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:22,minZoom:1,attribution:'Google Maps'});var baseLayers={"谷歌地图":normalMap,"谷歌卫星图":satelliteMap,"谷歌卫星标注": routeMap};var overlayLayers={};var mymap=L.map("googleMap-120.101101-30.239119",{center:[30.239119,120.101101],zoom:14,layers:[normalMap],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'放大',zoomOutTitle:'缩小'}).addTo(mymap);var marker = L.marker(['30.239119','120.101101']).addTo(mymap);marker.bindPopup("这里是西湖灵隐寺，据说求姻缘很灵验哦！").openPopup();</script><br><br></p><p><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div id="geoqMap-120.101101-30.239119" style="max-width:90%; height:320px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div><script type="text/javascript">var normalm1=L.tileLayer.chinaProvider('Geoq.Normal.Map',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm2=L.tileLayer.chinaProvider('Geoq.Normal.PurplishBlue',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm3=L.tileLayer.chinaProvider('Geoq.Normal.Gray',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm4=L.tileLayer.chinaProvider('Geoq.Normal.Warm',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm5=L.tileLayer.chinaProvider('Geoq.Theme.Hydro',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normal=L.layerGroup([normalm1,normalm2,normalm3,normalm4,normalm5]);var baseLayers={"智图地图":normalm1,"午夜蓝":normalm2,"灰色":normalm3,"暖色":normalm4,"水系":normalm5};var mymap=L.map("geoqMap-120.101101-30.239119",{center:[30.239119,120.101101],zoom:13,layers:[normalm3],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'放大',zoomOutTitle:'缩小'}).addTo(mymap);var marker = L.marker(['30.239119','120.101101']).addTo(mymap);marker.bindPopup("这里是西湖灵隐寺，据说求姻缘很灵验哦！").openPopup();</script><br><br></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="2-31-隐藏块"><a href="#2-31-隐藏块" class="headerlink" title="2.31 隐藏块"></a>2.31 隐藏块</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">标签语法</button><button type="button" class="tab">参数配置</button><button type="button" class="tab">示例源码</button><button type="button" class="tab">渲染演示</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% hideBlock display,bg,color %&#125;</span><br><span class="line">content</span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li>content：要隐藏的内容</li><li>display：展示前按钮显示的文字（可选）</li><li>bg：按钮的背景颜色（可选）</li><li>color：按钮显示的文字的颜色（可选）</li></ol></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% hideBlock 点我预览, blue %&#125;</span><br><span class="line">这里有张图片：</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://s1.vika.cn/space/2022/10/30/b35fce448bc9404a8d65c3ce1e6e46eb&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;image (1)&quot;</span> <span class="attr">style</span>=<span class="string">&quot;zoom:67%;&quot;</span> /&gt;</span></span></span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><div class="hide-block"><button type="button" class="hide-button" style="background-color:  blue;">点我预览    </button><div class="hide-content"><p>这里有张图片：<br><img src="https://s1.vika.cn/space/2022/10/30/b35fce448bc9404a8d65c3ce1e6e46eb" alt="image (1)" style="zoom:67%;" /></p></div></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>]]></content>
      
      
      <categories>
          
          <category> 演示 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Markdown </tag>
            
            <tag> 外挂标签 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
